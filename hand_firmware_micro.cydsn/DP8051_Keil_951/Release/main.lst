C51 COMPILER V9.51   MAIN                                                                  02/16/2023 11:05:25 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\DP8051_Keil_951\Release\main.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\4.4\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -main.c NOIV LARGE MODDP2 OMF2 VB(1) NOIP INCDIR(.,Generated_Source\PSoC3) FF(3) DB DF(NDEBUG) WL(2) PR(.\DP8051_Keil_951
                    -\Release/main.lst) CD OT(8,SPEED) OJ(.\DP8051_Keil_951\Release\main.obj)

line level    source

*** MESSAGE C286 IN LINE 0 OF (null): license limits optimization to level 5
   1          // ----------------------------------------------------------------------------
   2          // BSD 3-Clause License
   3          
   4          // Copyright (c) 2016, qbrobotics
   5          // Copyright (c) 2017, Centro "E.Piaggio"
   6          // All rights reserved.
   7          
   8          // Redistribution and use in source and binary forms, with or without
   9          // modification, are permitted provided that the following conditions are met:
  10          
  11          // * Redistributions of source code must retain the above copyright notice, this
  12          //   list of conditions and the following disclaimer.
  13          
  14          // * Redistributions in binary form must reproduce the above copyright notice,
  15          //   this list of conditions and the following disclaimer in the documentation
  16          //   and/or other materials provided with the distribution.
  17          
  18          // * Neither the name of the copyright holder nor the names of its
  19          //   contributors may be used to endorse or promote products derived from
  20          //   this software without specific prior written permission.
  21          
  22          // THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  23          // AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  24          // IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  25          // DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  26          // FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  27          // DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  28          // SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  29          // CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  30          // OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  31          // OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  32          // POSSIBILITY OF SUCH DAMAGE.
  33          // ----------------------------------------------------------------------------
  34          
  35          
  36          /**
  37          * \file         main.c
  38          *
  39          * \brief        Firmware main file.
  40          * \date         Feb 14th, 2023
  41          * \author       _Centro "E.Piaggio"_
  42          * \copyright    (C) 2012-2016 qbrobotics. All rights reserved.
  43          * \copyright    (C) 2017-2023 Centro "E.Piaggio". All rights reserved.
  44          * \mainpage     Firmware
  45          * \brief        This is the firmware of the SoftHand Pro board.
  46          * \version      6.3
  47          *
  48          * \details      This is the firmware of the SoftHand Pro board in Master configuration. 
  49          *                               It reads EMG connected to socket and control a motor of an attached SoftHand. 
  50          *                               Also can read and convert analog measurements connected to the PSoC microcontroller.                
  51          *
  52          */
C51 COMPILER V9.51   MAIN                                                                  02/16/2023 11:05:25 PAGE 2   

  53          
  54          
  55          // ----------------------------------------------------------------------------
  56          // This version changes:
  57          //      - not reported
  58          
  59          
  60          //=================================================================     includes
  61          
  62          #include <device.h>
  63          #include <globals.h> // ALL GLOBAL DEFINITIONS, STRUCTURES AND MACROS HERE
  64          #include <interruptions.h>
  65          #include <command_processing.h>
  66          #include <utils.h>
  67          
  68          //==============================================================================
  69          //                                                                 MAIN FUNCTION
  70          //==============================================================================
  71          
  72          int main()
  73          {
  74   1          // Iterator
  75   1          uint8 i;         
  76   1          
  77   1          // Variable declarations for DMA 
  78   1          
  79   1          uint8 DMA_Chan;
  80   1          uint8 DMA_TD[1];
  81   1      
  82   1          //================================     initializations - psoc and components
  83   1      
  84   1          // EEPROM
  85   1      
  86   1          EEPROM_Start();
  87   1          memRecall();                                        // Recall configuration.
  88   1      
  89   1          // FTDI chip enable
  90   1      
  91   1          CyDelay(100);
  92   1          FTDI_ENABLE_REG_Write(0x01);
  93   1          
  94   1          // BOARD LED Enable
  95   1          LED_CTRL_Write(1);
  96   1          //PWM Blink Enable
  97   1          LED_BLINK_EN_Write(0);
  98   1          LED_BLINK_Start();
  99   1          LED_BLINK_WriteCompare(128);
 100   1          
 101   1          // RS485
 102   1      
 103   1          UART_RS485_Stop();                                  // Stop UART.
 104   1          UART_RS485_Start();                                 // Start UART.
 105   1          UART_RS485_Init();
 106   1      
 107   1          UART_RS485_ClearRxBuffer();
 108   1          UART_RS485_ClearTxBuffer();
 109   1      
 110   1          ISR_RS485_RX_StartEx(ISR_RS485_RX_ExInterrupt);     // RS485 isr function.
 111   1      
 112   1      
 113   1          // ADC
 114   1      
C51 COMPILER V9.51   MAIN                                                                  02/16/2023 11:05:25 PAGE 3   

 115   1          ADC_Start();                                        // Start ADC.
 116   1          ADC_SOC_Write(0x01);                                // Force first read cycle.
 117   1         
 118   1          // DMA
 119   1          DMA_Chan = DMA_DmaInitialize(DMA_BYTES_PER_BURST, DMA_REQUEST_PER_BURST, HI16(DMA_SRC_BASE), HI16(DMA_
             -DST_BASE));
 120   1          DMA_TD[0] = CyDmaTdAllocate();                                                                        
             -  // Allocate TD
 121   1          CyDmaTdSetConfiguration(DMA_TD[0], 2 * 4, DMA_TD[0], TD_SWAP_EN | DMA__TD_TERMOUT_EN | TD_INC_DST_ADR)
             -; // DMA Configurations
 122   1          CyDmaTdSetAddress(DMA_TD[0], LO16((uint32)ADC_DEC_SAMP_PTR), LO16((uint32)ADC_buf));                  
             -  // Set Register Address
 123   1          CyDmaChSetInitialTd(DMA_Chan, DMA_TD[0]);                                                             
             -  // Initialize Channel
 124   1          
 125   1          CyDmaChEnable(DMA_Chan, 1);                                                                           
             -  // Enable DMA
 126   1      
 127   1          RS485_CTS_Write(0);                                 // Clear To Send on RS485.
 128   1      
 129   1          // TIMER
 130   1      
 131   1          MY_TIMER_Start();           
 132   1          PACER_TIMER_Start();
 133   1      
 134   1          CYGlobalIntEnable;                                  // Enable interrupts.
 135   1      
 136   1      //========================================     initializations - clean variables
 137   1      
 138   1          //---------------------------------------------------  Initialize reference structure
 139   1          for (i = NUM_OF_MOTORS; i--;) 
 140   1              g_ref.pos[i] = 0;
 141   1          
 142   1          //---------------------------------------------------  Initialize measurement structure
 143   1          for (i = NUM_OF_SENSORS; i--;) { 
 144   2              g_meas.pos[i] = 0;
 145   2              g_meas.rot[i] = 0;
 146   2          }
 147   1          
 148   1          g_refNew = g_ref;                                   // Initialize k+1 measurements structure.
 149   1          
 150   1          // Initalize IMU values
 151   1          for (i = N_IMU_SH; i--;) { 
 152   2              imu_values[i] = 0;
 153   2          }
 154   1          
 155   1          //---------------------------------------------------  Initialize emg structure
 156   1          g_meas.emg[0] = 0;
 157   1          g_meas.emg[1] = 0;
 158   1      
 159   1          pow_tension = 12000;       //12000 mV (12 V)
 160   1          tension_valid = FALSE;                              // Init tension_valid BIT.
 161   1          first_tension_valid = TRUE;
 162   1      
 163   1          reset_last_value_flag = 0;
 164   1      
 165   1          //------------------------------------------------- Initialize package on receive from RS485
 166   1          g_rx.length = 0;
 167   1          g_rx.ready  = 0;
 168   1              
 169   1          // enable master_mode by default
 170   1          
C51 COMPILER V9.51   MAIN                                                                  02/16/2023 11:05:25 PAGE 4   

 171   1          master_mode = 1;
 172   1          count_tension_valid = 0;
 173   1       
 174   1          //============================================================     main loop
 175   1      
 176   1          for(;;)
 177   1          {
 178   2              // Put the FF reset pin to LOW
 179   2              RESET_FF_Write(0x00);
 180   2      
 181   2              // Call function scheduler
 182   2              function_scheduler();
 183   2      
 184   2              //  Wait until the FF is set to 1
 185   2              while(FF_STATUS_Read() == 0){
 186   3                  // On interrupt from RS485
 187   3                  if (interrupt_flag){
 188   4                      // Reset flags
 189   4                      interrupt_flag = FALSE;
 190   4                      // Manage Interrupt on rs485
 191   4                      interrupt_manager();
 192   4                  }
 193   3              };
 194   2      
 195   2              // Command a FF reset
 196   2              RESET_FF_Write(0x01);
 197   2      
 198   2              // Wait for FF to be reset
 199   2              while(FF_STATUS_Read() == 1);
 200   2      
 201   2              if(UART_RS485_ReadRxStatus() & UART_RS485_RX_STS_SOFT_BUFF_OVER)
 202   2                  UART_RS485_ClearRxBuffer();
 203   2          }
 204   1          return 0;
 205   1      }
 206          
 207          
 208          
 209          /* [] END OF FILE */
C51 COMPILER V9.51   MAIN                                                                  02/16/2023 11:05:25 PAGE 5   

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION main (BEGIN)
                                           ; SOURCE LINE # 72
                                           ; SOURCE LINE # 73
                                           ; SOURCE LINE # 86
0000 120000      E     LCALL   EEPROM_Start
                                           ; SOURCE LINE # 87
0003 120000      E     LCALL   memRecall
                                           ; SOURCE LINE # 91
0006 E4                CLR     A
0007 7F64              MOV     R7,#064H
0009 FE                MOV     R6,A
000A FD                MOV     R5,A
000B FC                MOV     R4,A
000C 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 92
000F 7F01              MOV     R7,#01H
0011 120000      E     LCALL   _FTDI_ENABLE_REG_Write
                                           ; SOURCE LINE # 95
0014 7F01              MOV     R7,#01H
0016 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 97
0019 E4                CLR     A
001A FF                MOV     R7,A
001B 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 98
001E 120000      E     LCALL   LED_BLINK_Start
                                           ; SOURCE LINE # 99
0021 7F80              MOV     R7,#080H
0023 120000      E     LCALL   _LED_BLINK_WriteCompare
                                           ; SOURCE LINE # 103
0026 120000      E     LCALL   UART_RS485_Stop
                                           ; SOURCE LINE # 104
0029 120000      E     LCALL   UART_RS485_Start
                                           ; SOURCE LINE # 105
002C 120000      E     LCALL   UART_RS485_Init
                                           ; SOURCE LINE # 107
002F 120000      E     LCALL   UART_RS485_ClearRxBuffer
                                           ; SOURCE LINE # 108
0032 120000      E     LCALL   UART_RS485_ClearTxBuffer
                                           ; SOURCE LINE # 110
0035 7E00        E     MOV     R6,#HIGH ISR_RS485_RX_ExInterrupt
0037 7F00        E     MOV     R7,#LOW ISR_RS485_RX_ExInterrupt
0039 120000      E     LCALL   _ISR_RS485_RX_StartEx
                                           ; SOURCE LINE # 115
003C 120000      E     LCALL   ADC_Start
                                           ; SOURCE LINE # 116
003F 7F01              MOV     R7,#01H
0041 120000      E     LCALL   _ADC_SOC_Write
                                           ; SOURCE LINE # 119
0044 E4                CLR     A
0045 900000      E     MOV     DPTR,#?_DMA_DmaInitialize?BYTE+04H
0048 F0                MOVX    @DPTR,A
0049 A3                INC     DPTR
004A F0                MOVX    @DPTR,A
004B FB                MOV     R3,A
004C FA                MOV     R2,A
004D 7D01              MOV     R5,#01H
004F 7F02              MOV     R7,#02H
0051 120000      E     LCALL   _DMA_DmaInitialize
C51 COMPILER V9.51   MAIN                                                                  02/16/2023 11:05:25 PAGE 6   

0054 900000      R     MOV     DPTR,#DMA_Chan
0057 EF                MOV     A,R7
0058 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 120
0059 120000      E     LCALL   CyDmaTdAllocate
005C 900000      R     MOV     DPTR,#DMA_TD
005F EF                MOV     A,R7
0060 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 121
0061 E0                MOVX    A,@DPTR
0062 FB                MOV     R3,A
0063 FF                MOV     R7,A
0064 900000      E     MOV     DPTR,#?_CyDmaTdSetConfiguration?BYTE+04H
0067 7486              MOV     A,#086H
0069 F0                MOVX    @DPTR,A
006A 7D08              MOV     R5,#08H
006C 7C00              MOV     R4,#00H
006E 120000      E     LCALL   _CyDmaTdSetConfiguration
                                           ; SOURCE LINE # 122
0071 7B01              MOV     R3,#01H
0073 7A00        E     MOV     R2,#HIGH ADC_buf
0075 7900        E     MOV     R1,#LOW ADC_buf
0077 E9                MOV     A,R1
0078 EA                MOV     A,R2
0079 E4                CLR     A
007A AB01              MOV     R3,AR1
007C 900000      R     MOV     DPTR,#DMA_TD
007F E0                MOVX    A,@DPTR
0080 FF                MOV     R7,A
0081 7D10              MOV     R5,#010H
0083 7C4E              MOV     R4,#04EH
0085 120000      E     LCALL   _CyDmaTdSetAddress
                                           ; SOURCE LINE # 123
0088 900000      R     MOV     DPTR,#DMA_Chan
008B E0                MOVX    A,@DPTR
008C FF                MOV     R7,A
008D A3                INC     DPTR
008E E0                MOVX    A,@DPTR
008F FD                MOV     R5,A
0090 120000      E     LCALL   _CyDmaChSetInitialTd
                                           ; SOURCE LINE # 125
0093 900000      R     MOV     DPTR,#DMA_Chan
0096 E0                MOVX    A,@DPTR
0097 FF                MOV     R7,A
0098 7D01              MOV     R5,#01H
009A 120000      E     LCALL   _CyDmaChEnable
                                           ; SOURCE LINE # 127
009D E4                CLR     A
009E FF                MOV     R7,A
009F 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 131
00A2 120000      E     LCALL   MY_TIMER_Start
                                           ; SOURCE LINE # 132
00A5 120000      E     LCALL   PACER_TIMER_Start
                                           ; SOURCE LINE # 134
00A8 D2AF              SETB    EA
00AA 9044F4            MOV     DPTR,#044F4H
00AD 74FD              MOV     A,#0FDH
00AF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 139
00B0 900000      R     MOV     DPTR,#i
00B3 7402              MOV     A,#02H
C51 COMPILER V9.51   MAIN                                                                  02/16/2023 11:05:25 PAGE 7   

00B5 F0                MOVX    @DPTR,A
00B6         ?C0001:
00B6 900000      R     MOV     DPTR,#i
00B9 E0                MOVX    A,@DPTR
00BA FF                MOV     R7,A
00BB 14                DEC     A
00BC F0                MOVX    @DPTR,A
00BD EF                MOV     A,R7
00BE 6018              JZ      ?C0002
                                           ; SOURCE LINE # 140
00C0 E4                CLR     A
00C1 FF                MOV     R7,A
00C2 FE                MOV     R6,A
00C3 FD                MOV     R5,A
00C4 FC                MOV     R4,A
00C5 E0                MOVX    A,@DPTR
00C6 25E0              ADD     A,ACC
00C8 25E0              ADD     A,ACC
00CA 2400        E     ADD     A,#LOW g_ref
00CC F582              MOV     DPL,A
00CE E4                CLR     A
00CF 3400        E     ADDC    A,#HIGH g_ref
00D1 F583              MOV     DPH,A
00D3 120000      E     LCALL   ?C?LSTXDATA
00D6 80DE              SJMP    ?C0001
00D8         ?C0002:
                                           ; SOURCE LINE # 143
00D8 900000      R     MOV     DPTR,#i
00DB 7403              MOV     A,#03H
00DD F0                MOVX    @DPTR,A
00DE         ?C0003:
00DE 900000      R     MOV     DPTR,#i
00E1 E0                MOVX    A,@DPTR
00E2 FF                MOV     R7,A
00E3 14                DEC     A
00E4 F0                MOVX    @DPTR,A
00E5 EF                MOV     A,R7
00E6 6025              JZ      ?C0004
                                           ; SOURCE LINE # 144
00E8 E4                CLR     A
00E9 FF                MOV     R7,A
00EA FE                MOV     R6,A
00EB FD                MOV     R5,A
00EC FC                MOV     R4,A
00ED E0                MOVX    A,@DPTR
00EE FB                MOV     R3,A
00EF 25E0              ADD     A,ACC
00F1 25E0              ADD     A,ACC
00F3 2400        E     ADD     A,#LOW g_meas
00F5 F582              MOV     DPL,A
00F7 E4                CLR     A
00F8 3400        E     ADDC    A,#HIGH g_meas
00FA F583              MOV     DPH,A
00FC 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 145
00FF 7400        E     MOV     A,#LOW g_meas+0CH
0101 2B                ADD     A,R3
0102 F582              MOV     DPL,A
0104 E4                CLR     A
0105 3400        E     ADDC    A,#HIGH g_meas+0CH
0107 F583              MOV     DPH,A
0109 E4                CLR     A
C51 COMPILER V9.51   MAIN                                                                  02/16/2023 11:05:25 PAGE 8   

010A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 146
010B 80D1              SJMP    ?C0003
010D         ?C0004:
                                           ; SOURCE LINE # 148
010D 7800        E     MOV     R0,#LOW g_refNew
010F 7C00        E     MOV     R4,#HIGH g_refNew
0111 7D01              MOV     R5,#01H
0113 7B01              MOV     R3,#01H
0115 7A00        E     MOV     R2,#HIGH g_ref
0117 7900        E     MOV     R1,#LOW g_ref
0119 7E00              MOV     R6,#00H
011B 7F08              MOV     R7,#08H
011D 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 151
0120 900000      R     MOV     DPTR,#i
0123 7402              MOV     A,#02H
0125 F0                MOVX    @DPTR,A
0126         ?C0005:
0126 900000      R     MOV     DPTR,#i
0129 E0                MOVX    A,@DPTR
012A FF                MOV     R7,A
012B 14                DEC     A
012C F0                MOVX    @DPTR,A
012D EF                MOV     A,R7
012E 6018              JZ      ?C0006
                                           ; SOURCE LINE # 152
0130 E4                CLR     A
0131 FF                MOV     R7,A
0132 FE                MOV     R6,A
0133 FD                MOV     R5,A
0134 FC                MOV     R4,A
0135 E0                MOVX    A,@DPTR
0136 25E0              ADD     A,ACC
0138 25E0              ADD     A,ACC
013A 2400        E     ADD     A,#LOW imu_values
013C F582              MOV     DPL,A
013E E4                CLR     A
013F 3400        E     ADDC    A,#HIGH imu_values
0141 F583              MOV     DPH,A
0143 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 153
0146 80DE              SJMP    ?C0005
0148         ?C0006:
                                           ; SOURCE LINE # 156
0148 E4                CLR     A
0149 FF                MOV     R7,A
014A FE                MOV     R6,A
014B FD                MOV     R5,A
014C FC                MOV     R4,A
014D 900000      E     MOV     DPTR,#g_meas+0FH
0150 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 157
0153 E4                CLR     A
0154 FF                MOV     R7,A
0155 FE                MOV     R6,A
0156 FD                MOV     R5,A
0157 FC                MOV     R4,A
0158 900000      E     MOV     DPTR,#g_meas+013H
015B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 159
015E E4                CLR     A
C51 COMPILER V9.51   MAIN                                                                  02/16/2023 11:05:25 PAGE 9   

015F 7FE0              MOV     R7,#0E0H
0161 7E2E              MOV     R6,#02EH
0163 FD                MOV     R5,A
0164 FC                MOV     R4,A
0165 900000      E     MOV     DPTR,#pow_tension
0168 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 160
016B C200        E     CLR     tension_valid
                                           ; SOURCE LINE # 161
016D 900000      E     MOV     DPTR,#first_tension_valid
0170 7401              MOV     A,#01H
0172 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 163
0173 C200        E     CLR     reset_last_value_flag
                                           ; SOURCE LINE # 166
0175 E4                CLR     A
0176 900000      E     MOV     DPTR,#g_rx+080H
0179 F0                MOVX    @DPTR,A
017A A3                INC     DPTR
017B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 167
017C 900000      E     MOV     DPTR,#g_rx+084H
017F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 171
0180 900000      E     MOV     DPTR,#master_mode
0183 04                INC     A
0184 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 172
0185 E4                CLR     A
0186 FF                MOV     R7,A
0187 FE                MOV     R6,A
0188 FD                MOV     R5,A
0189 FC                MOV     R4,A
018A 900000      E     MOV     DPTR,#count_tension_valid
018D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 176
0190         ?C0007:
                                           ; SOURCE LINE # 177
                                           ; SOURCE LINE # 179
0190 E4                CLR     A
0191 FF                MOV     R7,A
0192 120000      E     LCALL   _RESET_FF_Write
                                           ; SOURCE LINE # 182
0195 120000      E     LCALL   function_scheduler
0198         ?C0009:
                                           ; SOURCE LINE # 185
0198 120000      E     LCALL   FF_STATUS_Read
019B EF                MOV     A,R7
019C 700A              JNZ     ?C0010
                                           ; SOURCE LINE # 187
019E 3000F7            JNB     interrupt_flag,?C0009
                                           ; SOURCE LINE # 189
01A1 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 191
01A3 120000      E     LCALL   interrupt_manager
                                           ; SOURCE LINE # 192
                                           ; SOURCE LINE # 193
01A6 80F0              SJMP    ?C0009
01A8         ?C0010:
                                           ; SOURCE LINE # 196
01A8 7F01              MOV     R7,#01H
01AA 120000      E     LCALL   _RESET_FF_Write
C51 COMPILER V9.51   MAIN                                                                  02/16/2023 11:05:25 PAGE 10  

01AD         ?C0012:
                                           ; SOURCE LINE # 199
01AD 120000      E     LCALL   FF_STATUS_Read
01B0 EF                MOV     A,R7
01B1 6401              XRL     A,#01H
01B3 60F8              JZ      ?C0012
01B5         ?C0013:
                                           ; SOURCE LINE # 201
01B5 120000      E     LCALL   UART_RS485_ReadRxStatus
01B8 EF                MOV     A,R7
01B9 30E7D4            JNB     ACC.7,?C0007
                                           ; SOURCE LINE # 202
01BC 120000      E     LCALL   UART_RS485_ClearRxBuffer
                                           ; SOURCE LINE # 203
01BF 80CF              SJMP    ?C0007
                                           ; SOURCE LINE # 204
                                           ; SOURCE LINE # 205
01C1         ?C0015:
01C1 22                RET     
             ; FUNCTION main (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    450    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----       3
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
