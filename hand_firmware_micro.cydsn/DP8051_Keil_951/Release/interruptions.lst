C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE INTERRUPTIONS
OBJECT MODULE PLACED IN .\DP8051_Keil_951\Release\interruptions.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\4.1\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -interruptions.c NOIV LARGE MODDP2 OMF2 VB(1) NOIP INCDIR(.,Generated_Source\PSoC3) FF(3) DB DF(NDEBUG) WL(2) PR(.\DP8051
                    -_Keil_951\Release/interruptions.lst) CD OT(8,SPEED) OJ(.\DP8051_Keil_951\Release\interruptions.obj)

line level    source

*** MESSAGE C286 IN LINE 0 OF (null): license limits optimization to level 5
   1          // ----------------------------------------------------------------------------
   2          // BSD 3-Clause License
   3          
   4          // Copyright (c) 2016, qbrobotics
   5          // Copyright (c) 2017, Centro "E.Piaggio"
   6          // All rights reserved.
   7          
   8          // Redistribution and use in source and binary forms, with or without
   9          // modification, are permitted provided that the following conditions are met:
  10          
  11          // * Redistributions of source code must retain the above copyright notice, this
  12          //   list of conditions and the following disclaimer.
  13          
  14          // * Redistributions in binary form must reproduce the above copyright notice,
  15          //   this list of conditions and the following disclaimer in the documentation
  16          //   and/or other materials provided with the distribution.
  17          
  18          // * Neither the name of the copyright holder nor the names of its
  19          //   contributors may be used to endorse or promote products derived from
  20          //   this software without specific prior written permission.
  21          
  22          // THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  23          // AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  24          // IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  25          // DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  26          // FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  27          // DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  28          // SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  29          // CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  30          // OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  31          // OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  32          // POSSIBILITY OF SUCH DAMAGE.
  33          // ----------------------------------------------------------------------------
  34          
  35          /**
  36          * \file         interruptions.c
  37          *
  38          * \brief        Interruption handling and firmware core functions
  39          * \date         October 01, 2017
  40          * \author       _Centro "E.Piaggio"_
  41          * \copyright    (C) 2012-2016 qbrobotics. All rights reserved.
  42          * \copyright    (C) 2017 Centro "E.Piaggio". All rights reserved.
  43          */
  44          
  45          
  46          //=================================================================     includes
  47          #include <interruptions.h>
  48          #include <command_processing.h>
  49          #include <globals.h>
  50          #include <utils.h>
  51          
  52          
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 2   

  53          //==============================================================================
  54          //                                                            RS485 RX INTERRUPT
  55          //==============================================================================
  56          // Processing RS-485 data frame:
  57          //
  58          // - 0:     Waits for beggining characters
  59          // - 1:     Waits for ID;
  60          // - 2:     Data length;
  61          // - 3:     Receive all bytes;
  62          // - 4:     Wait for another device end of transmission;
  63          //
  64          //==============================================================================
  65          
  66          // PWM values needed to obtain 11.5 V given a certain input tension
  67          // Numbers are sperimentally calculated //[index] (millivolts)
  68          static const uint8 pwm_preload_values[29] = {100,    //0 (11500)
  69                                                        83,
  70                                                        78,
  71                                                        76,
  72                                                        74,
  73                                                        72,    //5 (14000)
  74                                                        70,
  75                                                        68,
  76                                                        67,
  77                                                        65,
  78                                                        64,    //10 (16500)
  79                                                        63,
  80                                                        62,
  81                                                        61,
  82                                                        60,
  83                                                        59,    //15 (19000)
  84                                                        58,
  85                                                        57,
  86                                                        56,
  87                                                        56,
  88                                                        55,    //20 (21500)
  89                                                        54,
  90                                                        54,
  91                                                        53,
  92                                                        52,
  93                                                        52,    //25 (24000)
  94                                                        52,
  95                                                        51,
  96                                                        51};   //28 (25500)
  97          
  98          //==============================================================================
  99          //                                                            WATCHDOG INTERRUPT
 100          //==============================================================================
 101          
 102          CY_ISR(ISR_WATCHDOG_Handler){
 103   1      
 104   1          // Set WDT flag
 105   1          
 106   1          watchdog_flag = TRUE;
 107   1      
 108   1      }
 109          
 110          //==============================================================================
 111          //                                                            RS485 RX INTERRUPT
 112          //==============================================================================
 113          
 114          CY_ISR(ISR_RS485_RX_ExInterrupt) {
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 3   

 115   1      
 116   1          // Set RS485 flag
 117   1          
 118   1          interrupt_flag = TRUE;
 119   1           
 120   1      }
 121          
 122          //==============================================================================
 123          //                                                             INTERRUPT MANAGER
 124          //==============================================================================
 125          // Manage interrupt from RS485 
 126          //==============================================================================
 127          // Processing RS-485 data frame:
 128          //
 129          // - WAIT_START:    Waits for beginning characters;
 130          // - WAIT_ID:       Waits for ID;
 131          // - WAIT_LENGTH:   Data length;
 132          // - RECEIVE:       Receive all bytes;
 133          // - UNLOAD:        Wait for another device end of transmission;
 134          //
 135          //==============================================================================
 136          
 137          void interrupt_manager(){
 138   1      
 139   1          
 140   1          //===========================================     local variables definition
 141   1      
 142   1          static uint8 CYDATA state = WAIT_START;                      // state
 143   1          
 144   1          //------------------------------------------------- local data packet
 145   1          static uint8 CYDATA data_packet_index;
 146   1          static uint8 CYDATA data_packet_length;
 147   1          static uint8 data_packet_buffer[128];                     
 148   1          static uint8 CYDATA rx_queue[3];                    // last 2 bytes received
 149   1          //-------------------------------------------------
 150   1      
 151   1          uint8 CYDATA    rx_data;                            // RS485 UART rx data
 152   1          CYBIT           rx_data_type;                       // my id?
 153   1          uint8 CYDATA    package_count = 0;                     
 154   1      
 155   1          //======================================================     receive routine
 156   1          
 157   1          // Get data until buffer is not empty 
 158   1          
 159   1          while(UART_RS485_GetRxBufferSize() && (package_count < 6)){  
 160   2              // 6 - estimated maximum number of packets we can read without blocking firmware execution
 161   2              
 162   2              // Get next char
 163   2              rx_data = UART_RS485_GetChar();
 164   2              
 165   2              switch (state) {
 166   3                  //-----     wait for frame start     -------------------------------
 167   3                  case WAIT_START:
 168   3                  
 169   3                      rx_queue[0] = rx_queue[1];
 170   3                      rx_queue[1] = rx_queue[2];
 171   3                      rx_queue[2] = rx_data;
 172   3                      
 173   3                      // Check for header configuration package
 174   3                      if ((rx_queue[1] == 58) && (rx_queue[2] == 58)) {
 175   4                          rx_queue[0] = 0;
 176   4                          rx_queue[1] = 0;
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 4   

 177   4                          rx_queue[2] = 0;
 178   4                          state       = WAIT_ID;                    
 179   4                      }else
 180   3                          if ((rx_queue[0] == 63) &&      //ASCII - ?
 181   3                              (rx_queue[1] == 13) &&      //ASCII - CR
 182   3                              (rx_queue[2] == 10))        //ASCII - LF)
 183   3                              infoGet(INFO_ALL);
 184   3                      break;
 185   3      
 186   3                  //-----     wait for id     ----------------------------------------
 187   3                  case  WAIT_ID:
 188   3      
 189   3                      // packet is for my ID or is broadcast
 190   3                      if (rx_data == c_mem.id || rx_data == 0 || rx_data == c_mem.SH_ID)
 191   3                          rx_data_type = FALSE;
 192   3                      else                //packet is for others
 193   3                          rx_data_type = TRUE;
 194   3                      
 195   3                      data_packet_length = 0;
 196   3                      state = WAIT_LENGTH;
 197   3                      break;
 198   3      
 199   3                  //-----     wait for length     ------------------------------------
 200   3                  case  WAIT_LENGTH:
 201   3      
 202   3       
 203   3                      data_packet_length = rx_data;
 204   3                      // check validity of pack length
 205   3                      if (data_packet_length <= 1) {
 206   4                          data_packet_length = 0;
 207   4                          state = WAIT_START;
 208   4                      } else if (data_packet_length > 128) {
 209   4                          data_packet_length = 0;
 210   4                          state = WAIT_START;
 211   4                      } else {
 212   4                          data_packet_index = 0;
 213   4                          
 214   4                          if(rx_data_type == FALSE)
 215   4                              state = RECEIVE;          // packet for me or broadcast
 216   4                          else
 217   4                              state = UNLOAD;           // packet for others
 218   4                      }
 219   3                      break;
 220   3      
 221   3                  //-----     receiving     -------------------------------------------
 222   3                  case RECEIVE:
 223   3      
 224   3                      data_packet_buffer[data_packet_index] = rx_data;
 225   3                      data_packet_index++;
 226   3                      
 227   3                      // check end of transmission
 228   3                      if (data_packet_index >= data_packet_length) {
 229   4                          // verify if frame ID corresponded to the device ID
 230   4                          if (rx_data_type == FALSE) {
 231   5                              // copying data from buffer to global packet
 232   5                              memcpy(g_rx.buffer, data_packet_buffer, data_packet_length);
 233   5                              g_rx.length = data_packet_length;
 234   5                              g_rx.ready  = 1;
 235   5                      
 236   5                              commProcess();
 237   5                          }
 238   4                          
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 5   

 239   4                          data_packet_index  = 0;
 240   4                          data_packet_length = 0;
 241   4                          state = WAIT_START;
 242   4                          package_count++;
 243   4                      
 244   4                      }
 245   3                      break;
 246   3      
 247   3                  //-----     other device is receving     ---------------------------
 248   3                  case UNLOAD:
 249   3                      if (!(--data_packet_length)) {
 250   4                          data_packet_index  = 0;
 251   4                          data_packet_length = 0;
 252   4                          RS485_CTS_Write(1);
 253   4                          RS485_CTS_Write(0);
 254   4                          state              = WAIT_START;
 255   4                          package_count++;
 256   4                      }
 257   3                      break;
 258   3              }
 259   2          }
 260   1      }
 261          //==============================================================================
 262          //                                                            FUNCTION SCHEDULER
 263          //==============================================================================
 264          // Call all the function with the right frequency
 265          //==============================================================================
 266          // Base frequency 1000 Hz
 267          //==============================================================================
 268          
 269          void function_scheduler(void) {
 270   1       
 271   1          static uint16 counter_calibration = DIV_INIT_VALUE;
 272   1      
 273   1          timer_value0 = (uint32)MY_TIMER_ReadCounter();
 274   1      
 275   1          // Start ADC Conversion, SOC = 1
 276   1      
 277   1          ADC_SOC_Write(0x01); 
 278   1          
 279   1          // Check Interrupt 
 280   1      
 281   1          if (interrupt_flag){
 282   2              interrupt_flag = FALSE;
 283   2              interrupt_manager();
 284   2          }
 285   1        
 286   1          //---------------------------------- Get Encoders
 287   1      
 288   1          encoder_reading(0); 
 289   1          
 290   1          // Check Interrupt     
 291   1          
 292   1          if (interrupt_flag){
 293   2              interrupt_flag = FALSE;
 294   2              interrupt_manager();
 295   2          }   
 296   1          
 297   1          encoder_reading(1);
 298   1          
 299   1          // Check Interrupt 
 300   1          
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 6   

 301   1          if (interrupt_flag){
 302   2              interrupt_flag = FALSE;
 303   2              interrupt_manager();
 304   2          }
 305   1          
 306   1          encoder_reading(2);
 307   1          
 308   1          // Check Interrupt 
 309   1          
 310   1          if (interrupt_flag){
 311   2              interrupt_flag = FALSE;
 312   2              interrupt_manager();
 313   2          }
 314   1      
 315   1          //---------------------------------- Control Motor
 316   1         
 317   1          motor_control();
 318   1      
 319   1          // Check Interrupt 
 320   1      
 321   1          if (interrupt_flag){
 322   2              interrupt_flag = FALSE;
 323   2              interrupt_manager();
 324   2          }
 325   1      
 326   1          //---------------------------------- Read conversion buffer - LOCK function
 327   1      
 328   1          analog_read_end();
 329   1      
 330   1          if (interrupt_flag){
 331   2              interrupt_flag = FALSE;
 332   2              interrupt_manager();
 333   2          }
 334   1      
 335   1          //---------------------------------- Control Overcurrent
 336   1      
 337   1          overcurrent_control();
 338   1          
 339   1          // Check Interrupt 
 340   1          
 341   1          if (interrupt_flag){
 342   2              interrupt_flag = FALSE;
 343   2              interrupt_manager();
 344   2          }
 345   1          
 346   1          //---------------------------------- Master Mode
 347   1            
 348   1          if(master_mode){
 349   2              
 350   2              if (c_mem.is_force_fb_present){
 351   3                  drive_force_fb(); 
 352   3              }
 353   2              
 354   2              if (c_mem.is_proprio_fb_present){
 355   3                  drive_proprio_fb();
 356   3              }
 357   2              
 358   2              if (c_mem.is_myo2_master){
 359   3                  
 360   3                  // Rest position check (only if Master mode is enabled)
 361   3                  if (c_mem.rest_position_flag == TRUE){
 362   4                      if (counter_calibration == CALIBRATION_DIV) {
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 7   

 363   5                          
 364   5                              // Read Measure (valid since this routine is enabled only in Master mode)
 365   5                              curr_pos_res = (int32)commReadMeasFromSH();
 366   5      
 367   5                              check_rest_position();
 368   5                              counter_calibration = 0;
 369   5                      }
 370   4                      counter_calibration++;
 371   4      
 372   4                      // Check Interrupt     
 373   4                      if (interrupt_flag){
 374   5                          interrupt_flag = FALSE;
 375   5                          interrupt_manager();
 376   5                      }
 377   4                  }
 378   3                  
 379   3                  drive_SH();        
 380   3              }
 381   2          }
 382   1                  
 383   1          // Check Interrupt 
 384   1          
 385   1          if (interrupt_flag){
 386   2              interrupt_flag = FALSE;
 387   2              interrupt_manager();
 388   2          }
 389   1      
 390   1          //---------------------------------- Calibration 
 391   1      
 392   1          // Divider 10, freq = 500 Hz
 393   1          if (calib.enabled == TRUE) {
 394   2              if (counter_calibration == CALIBRATION_DIV) {
 395   3                  calibration();
 396   3                  counter_calibration = 0;
 397   3              }
 398   2              counter_calibration++;
 399   2          }
 400   1      
 401   1          // Check Interrupt 
 402   1          
 403   1          if (interrupt_flag){
 404   2              interrupt_flag = FALSE;
 405   2              interrupt_manager();
 406   2          }
 407   1          
 408   1          
 409   1          //---------------------------------- Update States
 410   1          
 411   1          // Load k-1 state
 412   1          memcpy( &g_measOld, &g_meas, sizeof(g_meas) );
 413   1          memcpy( &g_refOld, &g_ref, sizeof(g_ref) );
 414   1      
 415   1          // Load k+1 state
 416   1          memcpy( &g_ref, &g_refNew, sizeof(g_ref) );
 417   1      
 418   1          if (interrupt_flag){
 419   2              interrupt_flag = FALSE;
 420   2              interrupt_manager();
 421   2          }
 422   1      
 423   1          timer_value = (uint32)MY_TIMER_ReadCounter();
 424   1          MY_TIMER_WriteCounter(5000000);
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 8   

 425   1      
 426   1      }
 427          
 428          //==============================================================================
 429          //                                                                MOTORS CONTROL
 430          //==============================================================================
 431          
 432          void motor_control() {
 433   1      
 434   1          int32 CYDATA pwm_input = 0;
 435   1      
 436   1          int32 CYDATA pos_error;         // position error
 437   1          int32 CYDATA curr_error;        // current error
 438   1      
 439   1          int32 CYDATA i_ref;             // current reference
 440   1          int32 CYDATA handle_value;
 441   1      
 442   1          int32 CYDATA err_emg_1, err_emg_2;
 443   1      
 444   1          int32 CYDATA k_p = c_mem.k_p;  
 445   1          int32 CYDATA k_i = c_mem.k_i; 
 446   1          int32 CYDATA k_d = c_mem.k_d; 
 447   1      
 448   1          int32 CYDATA k_p_c = c_mem.k_p_c;  
 449   1          int32 CYDATA k_i_c = c_mem.k_i_c; 
 450   1          int32 CYDATA k_d_c = c_mem.k_d_c;   
 451   1      
 452   1          int32 CYDATA k_p_dl = c_mem.k_p_dl;  
 453   1          int32 CYDATA k_i_dl = c_mem.k_i_dl; 
 454   1          int32 CYDATA k_d_dl = c_mem.k_d_dl;
 455   1          
 456   1          int32 CYDATA k_p_c_dl = c_mem.k_p_c_dl;  
 457   1          int32 CYDATA k_i_c_dl = c_mem.k_i_c_dl; 
 458   1          int32 CYDATA k_d_c_dl = c_mem.k_d_c_dl;   
 459   1      
 460   1          // Static Variables
 461   1      
 462   1          static int32 pos_error_sum;     // position error sum for integral
 463   1          static int32 curr_error_sum;    // current error sum for integral
 464   1          
 465   1          static int32 prev_pos_err;      // previous position error for deriv. control
 466   1          static int32 prev_curr_err;     // previous current error for deriv. control
 467   1      
 468   1          static CYBIT motor_dir = FALSE;
 469   1      
 470   1          static uint8 current_emg = 0;   // 0 NONE
 471   1                                          // 1 EMG 1
 472   1                                          // 2 EMG 2
 473   1                                          // wait for both to get down
 474   1      
 475   1          err_emg_1 = g_meas.emg[0] - c_mem.emg_threshold[0];
 476   1          err_emg_2 = g_meas.emg[1] - c_mem.emg_threshold[1];
 477   1      
 478   1          // =========================== POSITION INPUT ==============================
 479   1          switch(c_mem.input_mode) {
 480   2      
 481   2              case INPUT_MODE_ENCODER3:
 482   2      
 483   2                  if (master_mode) {
 484   3                      // The only attached encoder is the handle lever
 485   3                      handle_value = g_meas.pos[0] * c_mem.motor_handle_ratio;
 486   3                  }
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 9   

 487   2                  else {
 488   3                      // Like other firmwares working
 489   3                      // Calculate handle value based on position of handle in the
 490   3                      // sensor chain and multiplication factor between handle and motor position
 491   3                      if (c_mem.double_encoder_on_off) 
 492   3                          handle_value = g_meas.pos[2] * c_mem.motor_handle_ratio;
 493   3                      else
 494   3                          handle_value = g_meas.pos[1] * c_mem.motor_handle_ratio;
 495   3                  }
 496   2      
 497   2                  // Read handle and use it as reference for the motor
 498   2                  if (((handle_value - g_ref.pos[0]) > c_mem.max_step_pos) && (c_mem.max_step_pos != 0))
 499   2                      g_ref.pos[0] += c_mem.max_step_pos;
 500   2                  else {
 501   3                      if (((handle_value - g_ref.pos[0]) < c_mem.max_step_neg) && (c_mem.max_step_neg != 0))
 502   3                          g_ref.pos[0] += c_mem.max_step_neg;
 503   3                      else
 504   3                          g_ref.pos[0] = handle_value;
 505   3                  }
 506   2                  break;
 507   2      
 508   2              case INPUT_MODE_EMG_PROPORTIONAL:
 509   2                  if (err_emg_1 > 0)
 510   2                      g_ref.pos[0] = (err_emg_1 * g_mem.pos_lim_sup[0]) / (1024 - c_mem.emg_threshold[0]);
 511   2                  else
 512   2                      g_ref.pos[0] = 0;
 513   2                  break;
 514   2      
 515   2              case INPUT_MODE_EMG_INTEGRAL:
 516   2                  g_ref.pos[0] = g_refOld.pos[0];
 517   2                  if (err_emg_1 > 0) {
 518   3                      g_ref.pos[0] = g_refOld.pos[0] + (err_emg_1 * (int)g_mem.emg_speed * 2) / (1024 - c_mem.em
             -g_threshold[0]);
 519   3                  }
 520   2                  if (err_emg_2 > 0) {
 521   3                      g_ref.pos[0] = g_refOld.pos[0] - (err_emg_2 * (int)g_mem.emg_speed * 2) / (1024 - c_mem.em
             -g_threshold[1]);
 522   3                  }
 523   2                  break;
 524   2      
 525   2              case INPUT_MODE_EMG_FCFS:
 526   2                  g_ref.pos[0] = g_refOld.pos[0];
 527   2                  switch (current_emg) {
 528   3                      case 0:
 529   3                          // Look for the first EMG passing the threshold
 530   3                          if (err_emg_1 > 0) {
 531   4                              current_emg = 1;
 532   4                              break;
 533   4                          }
 534   3                          if (err_emg_2 > 0) {
 535   4                              current_emg = 2;
 536   4                              break;
 537   4                          }
 538   3                          break;
 539   3      
 540   3                      case 1:
 541   3                          // EMG 1 is first
 542   3                          if (err_emg_1 < 0) {
 543   4                              current_emg = 0;
 544   4                              break;
 545   4                          }
 546   3                          g_ref.pos[0] = g_refOld.pos[0] + (err_emg_1 * g_mem.emg_speed * 2) / (1024 - c_mem.emg
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 10  

             -_threshold[0]);
 547   3                          break;
 548   3      
 549   3                      case 2:
 550   3                          // EMG 2 is first
 551   3                          if (err_emg_2 < 0) {
 552   4                              current_emg = 0;
 553   4                              break;
 554   4                          }
 555   3                          g_ref.pos[0] = g_refOld.pos[0] - (err_emg_2 * g_mem.emg_speed * 2) / (1024 - c_mem.emg
             -_threshold[1]);
 556   3                          break;
 557   3      
 558   3                      default:
 559   3                          break;
 560   3                  }
 561   2      
 562   2                  break;
 563   2      
 564   2              case INPUT_MODE_EMG_FCFS_ADV:
 565   2                  g_ref.pos[0] = g_refOld.pos[0];
 566   2                  switch (current_emg) {
 567   3                      // Look for the first EMG passing the threshold
 568   3                      case 0:
 569   3                          if (err_emg_1 > 0) {
 570   4                              current_emg = 1;
 571   4                              break;
 572   4                          }
 573   3                          if (err_emg_2 > 0) {
 574   4                              current_emg = 2;
 575   4                              break;
 576   4                          }
 577   3                          break;
 578   3      
 579   3                      // EMG 1 is first
 580   3                      case 1:
 581   3                          // If both signals are under threshold go back to status 0
 582   3                          if ((err_emg_1 < 0) && (err_emg_2 < 0)) {
 583   4                              current_emg = 0;
 584   4                              break;
 585   4                          }
 586   3                          // but if the current signal come back over threshold, continue using it
 587   3                          if (err_emg_1 > 0) 
 588   3                              g_ref.pos[0] = g_refOld.pos[0] + (err_emg_1 * g_mem.emg_speed << 2) / (1024 - c_me
             -m.emg_threshold[0]);
 589   3                          
 590   3                          break;
 591   3      
 592   3                      // EMG 2 is first
 593   3                      case 2:
 594   3                          // If both signals are under threshold go back to status 0
 595   3                          if ((err_emg_1 < 0) && (err_emg_2 < 0)) {
 596   4                              current_emg = 0;
 597   4                              break;
 598   4                          }
 599   3                          // but if the current signal come back over threshold, continue using it
 600   3                          if (err_emg_2 > 0) {
 601   4                              g_ref.pos[0] = g_refOld.pos[0] - (err_emg_2 * c_mem.emg_speed << 2) / (1024 - c_me
             -m.emg_threshold[1]);
 602   4                          }
 603   3                          break;
 604   3      
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 11  

 605   3                      default:
 606   3                          break;
 607   3                  }
 608   2      
 609   2              default:
 610   2                  break;
 611   2          }
 612   1      
 613   1          // Position limit saturation
 614   1          if (c_mem.pos_lim_flag) {
 615   2              if (g_ref.pos[0] < c_mem.pos_lim_inf[0]) 
 616   2                  g_ref.pos[0] = c_mem.pos_lim_inf[0];
 617   2              if (g_ref.pos[0] > c_mem.pos_lim_sup[0]) 
 618   2                  g_ref.pos[0] = c_mem.pos_lim_sup[0];
 619   2          }
 620   1      
 621   1          if (c_mem.rest_position_flag == TRUE) {
 622   2              if (rest_enabled == 1){
 623   3                  // Change position reference to drive motor to rest position smoothly
 624   3                  g_ref.pos[0] = rest_pos_curr_ref;
 625   3              }
 626   2              
 627   2              if (forced_open == 1) {
 628   3                  // Open the SoftHand as EMG PROPORTIONAL input mode 
 629   3                  if (err_emg_2 > 0)
 630   3                      g_ref.pos[0] = g_mem.rest_pos - (err_emg_2 * g_mem.rest_pos) / (1024 - c_mem.emg_threshold
             -[1]);
 631   3                  else {
 632   4                      g_ref.pos[0] = g_mem.rest_pos;
 633   4                      forced_open = 0;
 634   4                  }
 635   3              }
 636   2          }
 637   1          
 638   1          switch(c_mem.control_mode) {
 639   2              // ======================= CURRENT AND POSITION CONTROL =======================
 640   2              case CURR_AND_POS_CONTROL:
 641   2                  pos_error = g_ref.pos[0] - g_meas.pos[0];
 642   2      
 643   2                  pos_error_sum += pos_error;
 644   2      
 645   2                  // error_sum saturation
 646   2                  if (pos_error_sum > POS_INTEGRAL_SAT_LIMIT)
 647   2                      pos_error_sum = POS_INTEGRAL_SAT_LIMIT;
 648   2                  else {
 649   3                      if (pos_error_sum < -POS_INTEGRAL_SAT_LIMIT) 
 650   3                          pos_error_sum = -POS_INTEGRAL_SAT_LIMIT;
 651   3                  }
 652   2                  
 653   2                  // ------ position PID control ------
 654   2      
 655   2                  i_ref = 0;
 656   2                  
 657   2                  // Proportional
 658   2                  if (k_p_dl != 0)
 659   2                      i_ref += (int32)(k_p_dl * pos_error) >> 16;
 660   2      
 661   2                  // Integral
 662   2                  if (k_i_dl != 0)
 663   2                      i_ref += (int32)(k_i_dl * pos_error_sum) >> 16;
 664   2      
 665   2                  // Derivative
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 12  

 666   2                  if (k_d_dl != 0)
 667   2                      i_ref += (int32)(k_d_dl * (pos_error - prev_pos_err)) >> 16;
 668   2                              
 669   2                  // Update previous position
 670   2                  prev_pos_err = pos_error;
 671   2      
 672   2                  // motor direction depends on i_ref
 673   2                  if (i_ref >= 0)
 674   2                      motor_dir = TRUE;
 675   2                  else
 676   2                      motor_dir = FALSE;
 677   2      
 678   2                  // saturate max current
 679   2                  if (i_ref > c_mem.current_limit)
 680   2                      i_ref = c_mem.current_limit;
 681   2                  else 
 682   2                      if (i_ref < -c_mem.current_limit)
 683   2                          i_ref = -c_mem.current_limit;
 684   2           
 685   2                  // current error and curr error sum
 686   2                  curr_error = i_ref - g_meas.curr[0];
 687   2                  curr_error_sum += curr_error;
 688   2                  
 689   2                  if (curr_error_sum > CURR_INTEGRAL_SAT_LIMIT)
 690   2                      curr_error_sum = CURR_INTEGRAL_SAT_LIMIT;
 691   2                  else {
 692   3                      if (curr_error_sum < -CURR_INTEGRAL_SAT_LIMIT)
 693   3                          curr_error_sum = -CURR_INTEGRAL_SAT_LIMIT;
 694   3                  }
 695   2      
 696   2                  // ----- current PID control -----
 697   2      
 698   2                  pwm_input = 0;
 699   2      
 700   2                  // Proportional
 701   2                  if (k_p_c_dl != 0)
 702   2                      pwm_input += (int32)(k_p_c_dl * curr_error) >> 16;
 703   2      
 704   2                  // Integral
 705   2                  if (k_i_c_dl != 0)
 706   2                      pwm_input += (int32)(k_i_c_dl * curr_error_sum) >> 16;
 707   2      
 708   2                  // Derivative
 709   2                  if (k_d_c_dl != 0)
 710   2                      pwm_input += (int32)(k_d_c_dl * (curr_error - prev_curr_err)) >> 16;
 711   2      
 712   2                  // pwm_input saturation
 713   2                  if (pwm_input < -PWM_MAX_VALUE) 
 714   2                      pwm_input = -PWM_MAX_VALUE;
 715   2                  else {
 716   3                      if (pwm_input > PWM_MAX_VALUE)
 717   3                          pwm_input = PWM_MAX_VALUE;
 718   3                  }
 719   2      
 720   2                  // Update previous current
 721   2                  prev_curr_err = curr_error;
 722   2      
 723   2              break;
 724   2      
 725   2              // ============================== POSITION CONTROL =====================
 726   2              case CONTROL_ANGLE:
 727   2                  pos_error = g_ref.pos[0] - g_meas.pos[0];
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 13  

 728   2      
 729   2                  pos_error_sum += pos_error;
 730   2      
 731   2                  // anti-windup (for integral control)
 732   2                  if (pos_error_sum > ANTI_WINDUP) {
 733   3                      pos_error_sum = ANTI_WINDUP;
 734   3                  } else if (pos_error_sum < -ANTI_WINDUP) {
 735   3                      pos_error_sum = -ANTI_WINDUP;
 736   3                  }
 737   2      
 738   2                  // Proportional
 739   2                  if (k_p != 0) 
 740   2                      pwm_input = (int32)(k_p * pos_error) >> 16;
 741   2                  
 742   2      
 743   2                  // Integral
 744   2                  if (k_i != 0) 
 745   2                      pwm_input += (int32)(k_i * pos_error_sum) >> 16;
 746   2                  
 747   2      
 748   2                  // Derivative
 749   2                  if (k_d != 0) 
 750   2                      pwm_input += (int32)(k_d * (pos_error - prev_pos_err)) >> 16;
 751   2                  
 752   2      
 753   2                  // Update measure
 754   2                  prev_pos_err = pos_error;
 755   2      
 756   2                  if (pwm_input > 0)
 757   2                      motor_dir = TRUE;
 758   2                  else
 759   2                      motor_dir = FALSE;
 760   2      
 761   2              break;
 762   2      
 763   2              // ========================== CURRENT CONTROL ==========================
 764   2              case CONTROL_CURRENT:
 765   2                  if(g_ref.onoff && tension_valid) {
 766   3                      
 767   3                      i_ref = g_ref.curr[0];
 768   3      
 769   3                      if (i_ref > c_mem.current_limit) 
 770   3                          i_ref = c_mem.current_limit;
 771   3                      else {
 772   4                          if (i_ref < -c_mem.current_limit)
 773   4                              i_ref = -c_mem.current_limit;
 774   4                      }
 775   3                      
 776   3                      // current error
 777   3                      curr_error = i_ref - g_meas.curr[0];            
 778   3                      curr_error_sum += curr_error;
 779   3                      
 780   3                      if (curr_error_sum > CURR_INTEGRAL_SAT_LIMIT)
 781   3                          curr_error_sum = CURR_INTEGRAL_SAT_LIMIT;
 782   3                      else {
 783   4                          if (curr_error_sum < -CURR_INTEGRAL_SAT_LIMIT) 
 784   4                              curr_error_sum = -CURR_INTEGRAL_SAT_LIMIT;
 785   4                      }
 786   3      
 787   3                      pwm_input = 0;
 788   3      
 789   3                      // Proportional
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 14  

 790   3                      if (k_p_c != 0)
 791   3                          pwm_input += (int32)(k_p_c * curr_error) >> 16;
 792   3      
 793   3                      // Integral
 794   3                      if (k_i_c != 0)
 795   3                          pwm_input += (int32)(k_i_c * curr_error_sum) >> 16;
 796   3      
 797   3                      // Derivative
 798   3                      if (k_d_c != 0)
 799   3                          pwm_input += (int32)(k_d_c * (curr_error - prev_curr_err)) >> 16;
 800   3                      
 801   3                      prev_curr_err = curr_error;
 802   3                      
 803   3                      if (pwm_input >= 0) 
 804   3                          motor_dir = TRUE;
 805   3                      else
 806   3                          motor_dir = FALSE;
 807   3                  }
 808   2              break;
 809   2              
 810   2              // ================= DIRECT PWM CONTROL ================================
 811   2              case CONTROL_PWM:
 812   2      
 813   2                  pwm_input = g_ref.pwm[0];
 814   2      
 815   2                  if (pwm_input > 0) 
 816   2                      motor_dir = TRUE;
 817   2                  else 
 818   2                      motor_dir = FALSE;
 819   2                  
 820   2      
 821   2                  // pwm_input saturation
 822   2                  if (pwm_input < -PWM_MAX_VALUE) 
 823   2                      pwm_input = -PWM_MAX_VALUE;
 824   2                   else if (pwm_input > PWM_MAX_VALUE) 
 825   2                      pwm_input = PWM_MAX_VALUE;
 826   2                  
 827   2      
 828   2              break;
 829   2      
 830   2          }
 831   1      
 832   1          ////////////////////////////////////////////////////////////////////////////
 833   1      
 834   1          if(pwm_input >  PWM_MAX_VALUE) 
 835   1              pwm_input =  PWM_MAX_VALUE;
 836   1          if(pwm_input < -PWM_MAX_VALUE) 
 837   1              pwm_input = -PWM_MAX_VALUE;
 838   1      
 839   1      
 840   1          if (c_mem.control_mode != CONTROL_PWM) 
 841   1              pwm_input = (((pwm_input << 10) / PWM_MAX_VALUE) * dev_pwm_limit) >> 10;
 842   1          
 843   1      
 844   1          pwm_sign = SIGN(pwm_input);
 845   1      
 846   1          if (motor_dir)
 847   1              MOTOR_DIR_Write(0x01);
 848   1          else
 849   1              MOTOR_DIR_Write(0x00);
 850   1      
 851   1          PWM_MOTORS_WriteCompare1(abs(pwm_input));
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 15  

 852   1      }
 853          
 854          //==============================================================================
 855          //                                                                   ENCODER READING
 856          //==============================================================================
 857          
 858          void encoder_reading(const uint8 idx) {
 859   1      
 860   1          uint8 CYDATA index = idx;
 861   1          
 862   1          uint8 jj;
 863   1          
 864   1          uint32 data_encoder;
 865   1          int32 value_encoder;
 866   1          int32 speed_encoder;
 867   1          int32 accel_encoder;
 868   1          int32 aux;
 869   1      
 870   1          static int32 last_value_encoder[NUM_OF_SENSORS];
 871   1      
 872   1          static uint8 error[NUM_OF_SENSORS];
 873   1          
 874   1          static CYBIT only_first_time = TRUE;
 875   1      
 876   1          static uint8 one_time_execute = 0;
 877   1          static CYBIT pos_reconstruct = FALSE;
 878   1      
 879   1          static int32 v_value[NUM_OF_SENSORS];   //last value for velocity
 880   1          static int32 vv_value[NUM_OF_SENSORS];  //last last value for velocity
 881   1          static int32 vvv_value[NUM_OF_SENSORS];  //last last last value for velocity
 882   1          
 883   1          static int32 a_value[NUM_OF_SENSORS];   //last value for acceleration
 884   1          static int32 aa_value[NUM_OF_SENSORS];  //last last value for acceleration
 885   1          static int32 aaa_value[NUM_OF_SENSORS];  //last last last value for acceleration
 886   1      
 887   1          if (index >= NUM_OF_SENSORS)
 888   1              return;
 889   1          
 890   1          if (reset_last_value_flag) {
 891   2              for (jj = NUM_OF_SENSORS; jj--;) 
 892   2                  last_value_encoder[jj] = 0;
 893   2              
 894   2              reset_last_value_flag = 0;
 895   2          }
 896   1      
 897   1          //======================================================     reading sensors
 898   1              // Shift 1 right to erase Dummy bit of chain
 899   1          if (index == 0)
 900   1                  data_encoder = (SHIFTREG_ENC_1_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 901   1          else {
 902   2              if (index == 1)
 903   2                  data_encoder = (SHIFTREG_ENC_2_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 904   2              else // index == 2
 905   2                  data_encoder = (SHIFTREG_ENC_3_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 906   2          }
 907   1             
 908   1      
 909   1          if (check_enc_data(&data_encoder)) {
 910   2      
 911   2              value_encoder = (int16) (((data_encoder & 0x3FFC0) - 0x20000) >> 2 ) + g_mem.m_off[index];
 912   2                                                          // reset last 6 bit 
 913   2                                                          // -> |:|:|id|dim|CMD|CHK|(data---
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 16  

 914   2                                                          // subtract half of max value
 915   2                                                          // and shift to have 16 bit val
 916   2      
 917   2              // Initialize last_value_encoder
 918   2              if (only_first_time) {
 919   3                  last_value_encoder[index] = value_encoder;
 920   3                  if (index == 2)
 921   3                      only_first_time = 0;
 922   3              }
 923   2      
 924   2              // Take care of rotations
 925   2              aux = value_encoder - last_value_encoder[index];
 926   2      
 927   2              // ====================== 1 TURN ======================
 928   2              // -32768                    0                    32767 -32768                   0                
             -     32767
 929   2              // |-------------------------|-------------------------|-------------------------|----------------
             ----------|
 930   2              //              |                         |      |           |      |                         |
 931   2              //           -16384                     16383    |           |   -16384                     16383
 932   2              //                                               |           |
 933   2              //                                           24575           -24576
 934   2              //                                               |___________|
 935   2              //                                                   49152
 936   2      
 937   2              // if we are in the right interval, take care of rotation
 938   2              // and update the variable only if the difference between
 939   2              // one measure and another is less than 1/4 of turn
 940   2      
 941   2              // Considering we are sampling at 1kHz, this means that our shaft needs
 942   2              // to go slower than 1/4 turn every ms -> 1 turn every 4ms
 943   2              // equal to 250 turn/s -> 15000 RPM
 944   2      
 945   2              if (aux > 49152)
 946   2                  g_meas.rot[index]--;
 947   2              else{ 
 948   3                  if (aux < -49152)
 949   3                      g_meas.rot[index]++;
 950   3                  else{
 951   4                      if (abs(aux) > 16384) { // if two measure are too far
 952   5                          error[index]++;
 953   5                          if (error[index] < 10)
 954   5                              // Discard
 955   5                              return;
 956   5                      }
 957   4                  }
 958   3              }
 959   2      
 960   2              error[index] = 0;
 961   2      
 962   2              last_value_encoder[index] = value_encoder;
 963   2      
 964   2              value_encoder += (int32)g_meas.rot[index] << 16;
 965   2      
 966   2              if (c_mem.m_mult[index] != 1.0) {
 967   3                  value_encoder *= c_mem.m_mult[index];
 968   3              }
 969   2      
 970   2              g_meas.pos[index] = value_encoder;
 971   2          }
 972   1          
 973   1          switch(index) {
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 17  

 974   2              case 0: {
 975   3                  speed_encoder = (int16)filter_vel_1((3*value_encoder + v_value[0] - vv_value[0] - 3*vvv_value[
             -0])*10);
 976   3                  break;
 977   3              }
 978   2              case 1: {
 979   3                  speed_encoder = (int16)filter_vel_2((3*value_encoder + v_value[1] - vv_value[1] - 3*vvv_value[
             -1])*10);
 980   3                  break;
 981   3              }
 982   2              case 2: {
 983   3                  speed_encoder = (int16)filter_vel_3((3*value_encoder + v_value[2] - vv_value[2] - 3*vvv_value[
             -2])*10);
 984   3                  break;
 985   3              }
 986   2          }
 987   1          //Update current speed
 988   1          g_meas.vel[index] = speed_encoder;
 989   1          
 990   1          //Encoder rotational acceleration calculation
 991   1          switch(index) {
 992   2              case 0:
 993   2                  accel_encoder = (int16)filter_acc_1((3*speed_encoder + a_value[0] - aa_value[0] - 3*aaa_value[
             -0])*10);
 994   2                  break;
 995   2              
 996   2              case 1:
 997   2                  accel_encoder = (int16)filter_acc_2((3*speed_encoder + a_value[1] - aa_value[1] - 3*aaa_value[
             -1])*10);
 998   2                  break;
 999   2              
1000   2              case 2:
1001   2                  accel_encoder = (int16)filter_acc_3((3*speed_encoder + a_value[2] - aa_value[2] - 3*aaa_value[
             -2])*10);
1002   2                  break;
1003   2          }
1004   1          //Update current acceleration
1005   1          g_meas.acc[index] = accel_encoder;
1006   1      
1007   1          // update old velocity and acceleration values
1008   1          vvv_value[index] = vv_value[index];
1009   1          vv_value[index] = v_value[index];
1010   1          v_value[index] = value_encoder;
1011   1      
1012   1          aaa_value[index] = aa_value[index];
1013   1          aa_value[index] = a_value[index];
1014   1          a_value[index] = speed_encoder;
1015   1      
1016   1      
1017   1          // wait at least 3 * max_num_of_error (10) + 5 = 35 cycles to reconstruct the right turn
1018   1          if (pos_reconstruct == FALSE){
1019   2              if (one_time_execute < 34) 
1020   2                  one_time_execute++;
1021   2              else {
1022   3                  //Double encoder translation
1023   3                  if (c_mem.double_encoder_on_off)
1024   3                      g_meas.rot[0] = calc_turns_fcn(g_meas.pos[0], g_meas.pos[1]);
1025   3      
1026   3                  g_meas.pos[0] += (int32) g_meas.rot[0] << 16;
1027   3      
1028   3                  // If necessary activate motors
1029   3                  g_refNew.pos[0] = g_meas.pos[0];
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 18  

1030   3      
1031   3                  MOTOR_ON_OFF_Write(g_ref.onoff);
1032   3                  
1033   3                  pos_reconstruct = TRUE;
1034   3              }
1035   2          }
1036   1      }
1037          
1038          //==============================================================================
1039          //                                                           ANALOG MEASUREMENTS
1040          //==============================================================================
1041          
1042          void analog_read_end() {
1043   1      
1044   1          /* =========================================================================
1045   1          /   Ideal formulation to calculate tension and current
1046   1          /
1047   1          /   tension = ((read_value_mV - offset) * 101) / gain -> [mV]
1048   1          /   current = ((read_value_mV - offset) * 375) / (gain * resistor) -> [mA]
1049   1          /
1050   1          /   Definition:
1051   1          /   read_value_mV = counts_read / 0.819 -> conversion from counts to mV
1052   1          /   offset = 2000 -> hardware amplifier bias in mV
1053   1          /   gain = 8.086 -> amplifier gain
1054   1          /   resistor = 18 -> resistor of voltage divider in KOhm 
1055   1          /
1056   1          /   Real formulation: tradeoff in good performance and accurancy, ADC_buf[] 
1057   1          /   and offset unit of measurment is counts, instead dev_tension and
1058   1          /   g_meas.curr[] are converted in properly unit.
1059   1          /  =========================================================================
1060   1          */
1061   1      
1062   1          int32 CYDATA i_aux;
1063   1      
1064   1          static emg_status CYDATA emg_1_status = RESET; 
1065   1          static emg_status CYDATA emg_2_status = RESET;                                             
1066   1          
1067   1          static uint16 emg_counter_1 = 0;
1068   1          static uint16 emg_counter_2 = 0;
1069   1          static uint8 count = 0;
1070   1          static uint32 count2 = 0;
1071   1          
1072   1        //  static uint8 first_tension_valid = TRUE;
1073   1      
1074   1          // Wait for conversion end
1075   1          
1076   1          while(!ADC_STATUS_Read()){
1077   2              if (interrupt_flag){
1078   3                  interrupt_flag = FALSE;
1079   3                  interrupt_manager();
1080   3              }
1081   2          }
1082   1          
1083   1          // Convert tension read
1084   1          dev_tension = ((int32)(ADC_buf[0] - 1638) * 1952) >> 7;
1085   1          
1086   1          if (interrupt_flag){
1087   2              interrupt_flag = FALSE;
1088   2              interrupt_manager();
1089   2          }
1090   1              
1091   1          if (first_tension_valid && tension_valid) {
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 19  

1092   2              count = count + 1;
1093   2              
1094   2              if (count == 1000){
1095   3                  if (dev_tension < 9000) {   // 8 V case
1096   4                      pow_tension = 8000;
1097   4                  }
1098   3                  else {      // 12 V - 24 V cases
1099   4                      if (dev_tension < 13000) {
1100   5                          pow_tension = 12000;
1101   5                      }
1102   4                      else
1103   4                          pow_tension = 24000;
1104   4                  }
1105   3      
1106   3                  first_tension_valid = FALSE;
1107   3              }
1108   2          }
1109   1      
1110   1          // Until there is no valid input tension repeat this measurement
1111   1          
1112   1          if (dev_tension > 7000) {       //at least > 7.36 V (92% of 8 V) that is minimum charge of smallest ba
             -ttery
1113   2              // Set tension valid bit to TRUE
1114   2      
1115   2              if (count2 == 1000){
1116   3                  tension_valid = TRUE;   
1117   3              }
1118   2              else {                      // wait for battery voltage stabilization
1119   3                  count2 = count2 + 1;
1120   3                  dev_tension_f = filter_voltage(dev_tension);
1121   3              }
1122   2      
1123   2              if(g_mem.activate_pwm_rescaling)        //pwm rescaling is activated
1124   2                  pwm_limit_search();                 //only for 12V motors
1125   2      
1126   2              // Filter and Set currents
1127   2              g_meas.curr[0] = filter_i1((int16) (((int32)(ADC_buf[1] - 1638) * 25771) >> 13) * pwm_sign);
1128   2              
1129   2              // Check Interrupt 
1130   2          
1131   2              if (interrupt_flag){
1132   3                  interrupt_flag = FALSE;
1133   3                  interrupt_manager();
1134   3              }
1135   2      
1136   2              // if calibration is not needed go to "normal execution"
1137   2              if (!g_mem.emg_calibration_flag){
1138   3                  emg_1_status = NORMAL; // normal execution
1139   3                  emg_2_status = NORMAL; // normal execution
1140   3              }
1141   2      
1142   2              // EMG 1 calibration state machine
1143   2              
1144   2              // Calibration state machine
1145   2              switch(emg_1_status) {
1146   3                  case NORMAL: // normal execution
1147   3                      i_aux = (int32)ADC_buf[2];
1148   3                      if (i_aux < 0) 
1149   3                          i_aux = 0;
1150   3                      i_aux = filter_ch1(i_aux);
1151   3                      i_aux = (i_aux << 10) / g_mem.emg_max_value[0];
1152   3          
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 20  

1153   3                      if (interrupt_flag){
1154   4                          interrupt_flag = FALSE;
1155   4                          interrupt_manager();
1156   4                      }
1157   3                      //Saturation
1158   3                      if (i_aux < 0)
1159   3                          i_aux = 0;
1160   3                      else
1161   3                          if (i_aux > 1024) 
1162   3                              i_aux = 1024;
1163   3                      
1164   3                      g_meas.emg[0] = i_aux;
1165   3          
1166   3                      if (interrupt_flag){
1167   4                          interrupt_flag = FALSE;
1168   4                          interrupt_manager();
1169   4                      }
1170   3                      
1171   3                      break;
1172   3      
1173   3                  case RESET: // reset variables
1174   3                      emg_counter_1 = 0;
1175   3                      g_mem.emg_max_value[0] = 0;
1176   3                      emg_1_status = DISCARD; // goto next status
1177   3                      
1178   3                      break;
1179   3      
1180   3                  case DISCARD: // discard first EMG_SAMPLE_TO_DISCARD samples
1181   3                      emg_counter_1++;
1182   3                      if (emg_counter_1 == EMG_SAMPLE_TO_DISCARD) {
1183   4                          emg_counter_1 = 0;          // reset counter
1184   4                          
1185   4                          LED_CTRL_Write(1);
1186   4                          LED_BLINK_EN_Write(0);
1187   4                              
1188   4                          if (interrupt_flag){
1189   5                              interrupt_flag = FALSE;
1190   5                              interrupt_manager();
1191   5                          }
1192   4                          
1193   4                          emg_1_status = SUM_AND_MEAN;           // sum and mean status
1194   4                      }
1195   3                      break;
1196   3      
1197   3                  case SUM_AND_MEAN: // sum first SAMPLES_FOR_EMG_MEAN samples
1198   3                      // NOTE max(value)*SAMPLES_FOR_EMG_MEAN must fit in 32bit
1199   3                      emg_counter_1++;
1200   3                      if (ADC_buf[2] < 0) 
1201   3                          ADC_buf[2] = 0;
1202   3                      g_mem.emg_max_value[0] += filter_ch1((int32)ADC_buf[2]);
1203   3                      
1204   3                      if (interrupt_flag){
1205   4                          interrupt_flag = FALSE;
1206   4                          interrupt_manager();
1207   4                      }
1208   3                      
1209   3                      if (emg_counter_1 == SAMPLES_FOR_EMG_MEAN) {
1210   4                          g_mem.emg_max_value[0] = g_mem.emg_max_value[0] / SAMPLES_FOR_EMG_MEAN; // calc mean
1211   4          
1212   4                          if (interrupt_flag){
1213   5                              interrupt_flag = FALSE;
1214   5                              interrupt_manager();
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 21  

1215   5                          }                    
1216   4                          
1217   4                          LED_CTRL_Write(0);
1218   4                          LED_BLINK_EN_Write(0);
1219   4                          
1220   4                          emg_counter_1 = 0;          // reset counter
1221   4      
1222   4                          emg_1_status = NORMAL;           // goto normal execution
1223   4                      }
1224   3                      break;
1225   3      
1226   3                  default:
1227   3                      break;
1228   3              }
1229   2          
1230   2              if (interrupt_flag){
1231   3                  interrupt_flag = FALSE;
1232   3                  interrupt_manager();
1233   3              }
1234   2               // EMG 2 calibration state machine
1235   2              switch(emg_2_status) {
1236   3                  case NORMAL: // normal execution
1237   3                      i_aux = (int32)ADC_buf[3];
1238   3                      if (i_aux < 0)
1239   3                          i_aux = 0;
1240   3                      i_aux = filter_ch2(i_aux);
1241   3                      i_aux = (i_aux << 10) / g_mem.emg_max_value[1];
1242   3          
1243   3                      if (interrupt_flag){
1244   4                          interrupt_flag = FALSE;
1245   4                          interrupt_manager();
1246   4                      }
1247   3                      
1248   3                      if (i_aux < 0) 
1249   3                          i_aux = 0;
1250   3                      else
1251   3                          if (i_aux > 1024)
1252   3                              i_aux = 1024;
1253   3                      
1254   3                      g_meas.emg[1] = i_aux;
1255   3      
1256   3                      break;
1257   3      
1258   3                  case RESET: // reset variables
1259   3                      emg_counter_2 = 0;
1260   3                      g_mem.emg_max_value[1] = 0;
1261   3          
1262   3                      if (interrupt_flag){
1263   4                          interrupt_flag = FALSE;
1264   4                          interrupt_manager();
1265   4                      }
1266   3                      
1267   3                      emg_2_status = WAIT; // wait for EMG 1 calibration
1268   3                      break;
1269   3      
1270   3                  case DISCARD: // discard first EMG_SAMPLE_TO_DISCARD samples
1271   3                      emg_counter_2++;
1272   3                      if (emg_counter_2 == EMG_SAMPLE_TO_DISCARD) {
1273   4                          emg_counter_2 = 0;          // reset counter
1274   4                          
1275   4                          LED_CTRL_Write(1);
1276   4                          LED_BLINK_EN_Write(0);
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 22  

1277   4          
1278   4                          if (interrupt_flag){
1279   5                              interrupt_flag = FALSE;
1280   5                              interrupt_manager();
1281   5                          }
1282   4                          
1283   4                          emg_2_status = SUM_AND_MEAN;           // sum and mean status
1284   4                      }
1285   3                      break;
1286   3      
1287   3                  case SUM_AND_MEAN: // sum first SAMPLES_FOR_EMG_MEAN samples
1288   3                      // NOTE max(value)*SAMPLES_FOR_EMG_MEAN must fit in 32bit
1289   3                      emg_counter_2++;
1290   3                      if (ADC_buf[3] < 0)
1291   3                          ADC_buf[3] = 0;
1292   3                      g_mem.emg_max_value[1] += filter_ch2((int32)ADC_buf[3]);
1293   3          
1294   3                      if (interrupt_flag){
1295   4                          interrupt_flag = FALSE;
1296   4                          interrupt_manager();
1297   4                      }
1298   3                      
1299   3                      if (emg_counter_2 == SAMPLES_FOR_EMG_MEAN) {
1300   4                          g_mem.emg_max_value[1] = g_mem.emg_max_value[1] / SAMPLES_FOR_EMG_MEAN; // calc mean
1301   4                          
1302   4                          LED_CTRL_Write(0);
1303   4                          LED_BLINK_EN_Write(0);
1304   4                          
1305   4                          emg_counter_2 = 0;          // reset counter
1306   4                      
1307   4                          if (interrupt_flag){
1308   5                              interrupt_flag = FALSE;
1309   5                              interrupt_manager();
1310   5                          }
1311   4                          
1312   4                          emg_2_status = WAIT_EoC;           // goto end of calibration wait
1313   4                      }
1314   3                      break;
1315   3      
1316   3                  case WAIT: // wait for EMG calibration to be done
1317   3                      if (emg_1_status == NORMAL)
1318   3                          emg_2_status = DISCARD;           // goto discard sample
1319   3                      break;
1320   3      
1321   3                  case WAIT_EoC:  // wait for end of calibration procedure (only for LED visibility reasons)
1322   3                      emg_counter_2++;
1323   3                      if (emg_counter_2 == EMG_SAMPLE_TO_DISCARD) {
1324   4                          emg_counter_2 = 0;          // reset counter
1325   4      
1326   4                          if (interrupt_flag){
1327   5                              interrupt_flag = FALSE;
1328   5                              interrupt_manager();
1329   5                          }
1330   4                          
1331   4                          // if EMG control mode active, activate motors accordingly with startup value
1332   4                          if ((c_mem.input_mode == INPUT_MODE_EMG_PROPORTIONAL) ||
1333   4                              (c_mem.input_mode == INPUT_MODE_EMG_INTEGRAL) ||
1334   4                              (c_mem.input_mode == INPUT_MODE_EMG_FCFS) ||
1335   4                              (c_mem.input_mode == INPUT_MODE_EMG_FCFS_ADV)) {
1336   5                              if (c_mem.control_mode == CONTROL_ANGLE) {
1337   6                                  g_ref.pos[0] = g_meas.pos[0];
1338   6                                  g_ref.pos[1] = g_meas.pos[1];
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 23  

1339   6                              }
1340   5                              g_ref.onoff = c_mem.activ;
1341   5                              MOTOR_ON_OFF_Write(g_ref.onoff);
1342   5                          }
1343   4                              
1344   4                          emg_2_status = NORMAL;           // goto normal execution
1345   4                      }
1346   3                      break;
1347   3                      
1348   3                  default:
1349   3                      break;
1350   3              }
1351   2                  
1352   2              if (interrupt_flag){
1353   3                  interrupt_flag = FALSE;
1354   3                  interrupt_manager();
1355   3              }
1356   2          }
1357   1          else {
1358   2      
1359   2              emg_1_status = RESET; 
1360   2              emg_2_status = RESET;
1361   2      
1362   2              tension_valid = FALSE;
1363   2              
1364   2              //fixed
1365   2              LED_CTRL_Write(1);
1366   2              //PWM Blink Enable
1367   2              LED_BLINK_EN_Write(0);
1368   2                  
1369   2              if (interrupt_flag){
1370   3                  interrupt_flag = FALSE;
1371   3                  interrupt_manager();
1372   3              }
1373   2              
1374   2              if (c_mem.emg_calibration_flag) {
1375   3                  if ((c_mem.input_mode == INPUT_MODE_EMG_PROPORTIONAL) ||
1376   3                      (c_mem.input_mode == INPUT_MODE_EMG_INTEGRAL) ||
1377   3                      (c_mem.input_mode == INPUT_MODE_EMG_FCFS) ||
1378   3                      (c_mem.input_mode == INPUT_MODE_EMG_FCFS_ADV)) {
1379   4                      g_ref.onoff = 0x00;
1380   4                      MOTOR_ON_OFF_Write(g_ref.onoff);
1381   4                  }
1382   3              }
1383   2      
1384   2              // Reset current
1385   2              g_meas.curr[0] = 0;
1386   2      
1387   2              // Reset emg
1388   2              g_meas.emg[0] = 0;
1389   2              g_meas.emg[1] = 0;
1390   2      
1391   2          }
1392   1          
1393   1          // The board LED blinks if attached battery is not fully charged
1394   1          if (!first_tension_valid && tension_valid == TRUE && emg_1_status == NORMAL && emg_2_status == NORMAL)
             -{
1395   2              dev_tension_f = filter_voltage(dev_tension);
1396   2              if (dev_tension_f > 0.92 * pow_tension){
1397   3                  //fixed
1398   3                  LED_CTRL_Write(1);
1399   3                  
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 24  

1400   3                  //PWM Blink Enable
1401   3                  LED_BLINK_EN_Write(0);
1402   3              }
1403   2              else {
1404   3                  // blink
1405   3                  LED_CTRL_Write(0);
1406   3                  
1407   3                  //PWM Blink Enable
1408   3                  LED_BLINK_EN_Write(1);
1409   3                  
1410   3                  // Disable slave or motors because of not fully charged battery
1411   3                  if (master_mode) {
1412   4                      deactivate_slaves();
1413   4                      
1414   4                      // Check Interrupt 
1415   4                      if (interrupt_flag){
1416   5                          interrupt_flag = FALSE;
1417   5                          interrupt_manager();
1418   5                      }
1419   4                      
1420   4                      master_mode = 0;        // exit from master mode
1421   4                  }
1422   3                  else {
1423   4                      g_refNew.onoff = 0x00;
1424   4                      MOTOR_ON_OFF_Write(g_refNew.onoff); // Deactivate motors
1425   4                  }
1426   3              }
1427   2          }
1428   1              
1429   1          if (interrupt_flag){
1430   2              interrupt_flag = FALSE;
1431   2              interrupt_manager();
1432   2          }
1433   1      }
1434          
1435          //==============================================================================
1436          //                                                           OVERCURRENT CONTROL
1437          //==============================================================================
1438          
1439          void overcurrent_control() {
1440   1          if (c_mem.current_limit != 0) {
1441   2              // if the current is over the limit
1442   2              if (g_meas.curr[0] > c_mem.current_limit) {
1443   3                  //decrese pwm_limit
1444   3                  dev_pwm_limit--;
1445   3              // if the current is in the safe zone
1446   3              } else if (g_meas.curr[0] < (c_mem.current_limit - CURRENT_HYSTERESIS)) {
1447   3                  //increase pwm_limit
1448   3                  dev_pwm_limit++;
1449   3              }
1450   2      
1451   2              // Bound pwm_limit
1452   2              if (dev_pwm_limit < 0) 
1453   2                  dev_pwm_limit = 0;
1454   2              else 
1455   2                  if (dev_pwm_limit > 100) 
1456   2                      dev_pwm_limit = 100;
1457   2          }
1458   1      }
1459          
1460          //==============================================================================
1461          //                                                              PWM_LIMIT_SEARCH
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 25  

1462          //==============================================================================
1463          
1464          void pwm_limit_search() {
1465   1      
1466   1          uint8 CYDATA index;
1467   1      
1468   1          if (dev_tension > 25500) {
1469   2              dev_pwm_limit = 0;
1470   2          } else if (dev_tension < 11500) {
1471   2              dev_pwm_limit = 100;
1472   2          } else {
1473   2              index = (uint8)((dev_tension - 11500) >> 9);
1474   2              dev_pwm_limit = pwm_preload_values[index];
1475   2          }
1476   1      }
1477          
1478          /* [] END OF FILE */
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 26  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION ISR_WATCHDOG_Handler (BEGIN)
                                           ; SOURCE LINE # 102
                                           ; SOURCE LINE # 106
0000 D200        E     SETB    watchdog_flag
                                           ; SOURCE LINE # 108
0002 32                RETI    
             ; FUNCTION ISR_WATCHDOG_Handler (END)

             ; FUNCTION ISR_RS485_RX_ExInterrupt (BEGIN)
                                           ; SOURCE LINE # 114
                                           ; SOURCE LINE # 118
0000 D200        E     SETB    interrupt_flag
                                           ; SOURCE LINE # 120
0002 32                RETI    
             ; FUNCTION ISR_RS485_RX_ExInterrupt (END)

             ; FUNCTION interrupt_manager (BEGIN)
                                           ; SOURCE LINE # 137
                                           ; SOURCE LINE # 153
0000 E4                CLR     A
0001 F500        R     MOV     package_count,A
0003         ?C0003:
                                           ; SOURCE LINE # 159
0003 120000      E     LCALL   UART_RS485_GetRxBufferSize
0006 EF                MOV     A,R7
0007 7003              JNZ     $ + 5H
0009 020000      R     LJMP    ?C0026
000C E500        R     MOV     A,package_count
000E C3                CLR     C
000F 9406              SUBB    A,#06H
0011 4003              JC      $ + 5H
0013 020000      R     LJMP    ?C0026
                                           ; SOURCE LINE # 163
0016 120000      E     LCALL   UART_RS485_GetChar
0019 8F00        R     MOV     rx_data,R7
                                           ; SOURCE LINE # 165
001B E500        R     MOV     A,state
001D 14                DEC     A
001E 6049              JZ      ?C0010
0020 14                DEC     A
0021 6068              JZ      ?C0014
0023 14                DEC     A
0024 7003              JNZ     $ + 5H
0026 020000      R     LJMP    ?C0021
0029 14                DEC     A
002A 7003              JNZ     $ + 5H
002C 020000      R     LJMP    ?C0024
002F 2404              ADD     A,#04H
0031 70D0              JNZ     ?C0003
                                           ; SOURCE LINE # 167
0033         ?C0006:
                                           ; SOURCE LINE # 169
0033 850000      R     MOV     rx_queue,rx_queue+01H
                                           ; SOURCE LINE # 170
0036 850000      R     MOV     rx_queue+01H,rx_queue+02H
                                           ; SOURCE LINE # 171
0039 850000      R     MOV     rx_queue+02H,rx_data
                                           ; SOURCE LINE # 174
003C E500        R     MOV     A,rx_queue+01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 27  

003E B43A11            CJNE    A,#03AH,?C0007
0041 E500        R     MOV     A,rx_queue+02H
0043 B43A0C            CJNE    A,#03AH,?C0007
                                           ; SOURCE LINE # 175
0046 E4                CLR     A
0047 F500        R     MOV     rx_queue,A
                                           ; SOURCE LINE # 176
0049 F500        R     MOV     rx_queue+01H,A
                                           ; SOURCE LINE # 177
004B F500        R     MOV     rx_queue+02H,A
                                           ; SOURCE LINE # 178
004D 750001      R     MOV     state,#01H
                                           ; SOURCE LINE # 179
0050 80B1              SJMP    ?C0003
0052         ?C0007:
                                           ; SOURCE LINE # 180
0052 E500        R     MOV     A,rx_queue
0054 B43FAC            CJNE    A,#03FH,?C0003
0057 E500        R     MOV     A,rx_queue+01H
0059 B40DA7            CJNE    A,#0DH,?C0003
005C E500        R     MOV     A,rx_queue+02H
005E 640A              XRL     A,#0AH
0060 70A1              JNZ     ?C0003
                                           ; SOURCE LINE # 183
0062 FF                MOV     R7,A
0063 FE                MOV     R6,A
0064 120000      E     LCALL   _infoGet
                                           ; SOURCE LINE # 184
0067 809A              SJMP    ?C0003
                                           ; SOURCE LINE # 187
0069         ?C0010:
                                           ; SOURCE LINE # 190
0069 900000      E     MOV     DPTR,#c_mem+01H
006C E0                MOVX    A,@DPTR
006D 6500        R     XRL     A,rx_data
006F 600B              JZ      ?C0012
0071 E500        R     MOV     A,rx_data
0073 6007              JZ      ?C0012
0075 900000      E     MOV     DPTR,#c_mem+0BAH
0078 E0                MOVX    A,@DPTR
0079 B50004            CJNE    A,rx_data,?C0011
007C         ?C0012:
                                           ; SOURCE LINE # 191
007C C200        R     CLR     rx_data_type
007E 8002              SJMP    ?C0013
0080         ?C0011:
                                           ; SOURCE LINE # 193
0080 D200        R     SETB    rx_data_type
0082         ?C0013:
                                           ; SOURCE LINE # 195
0082 E4                CLR     A
0083 F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 196
0085 750002      R     MOV     state,#02H
                                           ; SOURCE LINE # 197
0088 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 200
008B         ?C0014:
                                           ; SOURCE LINE # 203
008B 850000      R     MOV     data_packet_length,rx_data
                                           ; SOURCE LINE # 205
008E E500        R     MOV     A,data_packet_length
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 28  

0090 D3                SETB    C
0091 9401              SUBB    A,#01H
0093 5008              JNC     ?C0015
                                           ; SOURCE LINE # 206
0095 E4                CLR     A
0096 F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 207
0098 F500        R     MOV     state,A
                                           ; SOURCE LINE # 208
009A 020000      R     LJMP    ?C0003
009D         ?C0015:
009D E500        R     MOV     A,data_packet_length
009F D3                SETB    C
00A0 9480              SUBB    A,#080H
00A2 4008              JC      ?C0017
                                           ; SOURCE LINE # 209
00A4 E4                CLR     A
00A5 F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 210
00A7 F500        R     MOV     state,A
                                           ; SOURCE LINE # 211
00A9 020000      R     LJMP    ?C0003
00AC         ?C0017:
                                           ; SOURCE LINE # 212
00AC E4                CLR     A
00AD F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 214
00AF 200006            JB      rx_data_type,?C0019
                                           ; SOURCE LINE # 215
00B2 750003      R     MOV     state,#03H
00B5 020000      R     LJMP    ?C0003
00B8         ?C0019:
                                           ; SOURCE LINE # 217
00B8 750004      R     MOV     state,#04H
                                           ; SOURCE LINE # 218
                                           ; SOURCE LINE # 219
00BB 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 222
00BE         ?C0021:
                                           ; SOURCE LINE # 224
00BE 7400        R     MOV     A,#LOW data_packet_buffer
00C0 2500        R     ADD     A,data_packet_index
00C2 F582              MOV     DPL,A
00C4 E4                CLR     A
00C5 3400        R     ADDC    A,#HIGH data_packet_buffer
00C7 F583              MOV     DPH,A
00C9 E500        R     MOV     A,rx_data
00CB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 225
00CC 0500        R     INC     data_packet_index
                                           ; SOURCE LINE # 228
00CE E500        R     MOV     A,data_packet_index
00D0 C3                CLR     C
00D1 9500        R     SUBB    A,data_packet_length
00D3 5003              JNC     $ + 5H
00D5 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 230
00D8 200025            JB      rx_data_type,?C0023
                                           ; SOURCE LINE # 232
00DB AF00        R     MOV     R7,data_packet_length
00DD 7E00              MOV     R6,#00H
00DF 7800        E     MOV     R0,#LOW g_rx
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 29  

00E1 7C00        E     MOV     R4,#HIGH g_rx
00E3 7D01              MOV     R5,#01H
00E5 7B01              MOV     R3,#01H
00E7 7A00        R     MOV     R2,#HIGH data_packet_buffer
00E9 7900        R     MOV     R1,#LOW data_packet_buffer
00EB 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 233
00EE 900000      E     MOV     DPTR,#g_rx+080H
00F1 E4                CLR     A
00F2 F0                MOVX    @DPTR,A
00F3 A3                INC     DPTR
00F4 E500        R     MOV     A,data_packet_length
00F6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 234
00F7 900000      E     MOV     DPTR,#g_rx+084H
00FA 7401              MOV     A,#01H
00FC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 236
00FD 120000      E     LCALL   commProcess
                                           ; SOURCE LINE # 237
0100         ?C0023:
                                           ; SOURCE LINE # 239
0100 E4                CLR     A
0101 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 240
0103 F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 241
0105 F500        R     MOV     state,A
                                           ; SOURCE LINE # 242
0107 0500        R     INC     package_count
                                           ; SOURCE LINE # 244
                                           ; SOURCE LINE # 245
0109 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 248
010C         ?C0024:
                                           ; SOURCE LINE # 249
010C 1500        R     DEC     data_packet_length
010E E500        R     MOV     A,data_packet_length
0110 6003              JZ      $ + 5H
0112 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 250
0115 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 251
0117 F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 252
0119 7F01              MOV     R7,#01H
011B 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 253
011E E4                CLR     A
011F FF                MOV     R7,A
0120 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 254
0123 E4                CLR     A
0124 F500        R     MOV     state,A
                                           ; SOURCE LINE # 255
0126 0500        R     INC     package_count
                                           ; SOURCE LINE # 256
                                           ; SOURCE LINE # 257
0128 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 258
                                           ; SOURCE LINE # 259
012B 020000      R     LJMP    ?C0003
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 30  

                                           ; SOURCE LINE # 260
012E         ?C0026:
012E 22                RET     
             ; FUNCTION interrupt_manager (END)

             ; FUNCTION function_scheduler (BEGIN)
                                           ; SOURCE LINE # 269
                                           ; SOURCE LINE # 273
0000 120000      E     LCALL   MY_TIMER_ReadCounter
0003 900000      E     MOV     DPTR,#timer_value0
0006 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 277
0009 7F01              MOV     R7,#01H
000B 120000      E     LCALL   _ADC_SOC_Write
                                           ; SOURCE LINE # 281
000E 300005            JNB     interrupt_flag,?C0027
                                           ; SOURCE LINE # 282
0011 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 283
0013 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 284
0016         ?C0027:
                                           ; SOURCE LINE # 288
0016 E4                CLR     A
0017 FF                MOV     R7,A
0018 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 292
001B 300005            JNB     interrupt_flag,?C0028
                                           ; SOURCE LINE # 293
001E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 294
0020 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 295
0023         ?C0028:
                                           ; SOURCE LINE # 297
0023 7F01              MOV     R7,#01H
0025 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 301
0028 300005            JNB     interrupt_flag,?C0029
                                           ; SOURCE LINE # 302
002B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 303
002D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 304
0030         ?C0029:
                                           ; SOURCE LINE # 306
0030 7F02              MOV     R7,#02H
0032 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 310
0035 300005            JNB     interrupt_flag,?C0030
                                           ; SOURCE LINE # 311
0038 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 312
003A 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 313
003D         ?C0030:
                                           ; SOURCE LINE # 317
003D 120000      R     LCALL   motor_control
                                           ; SOURCE LINE # 321
0040 300005            JNB     interrupt_flag,?C0031
                                           ; SOURCE LINE # 322
0043 C200        E     CLR     interrupt_flag
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 31  

                                           ; SOURCE LINE # 323
0045 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 324
0048         ?C0031:
                                           ; SOURCE LINE # 328
0048 120000      R     LCALL   analog_read_end
                                           ; SOURCE LINE # 330
004B 300005            JNB     interrupt_flag,?C0032
                                           ; SOURCE LINE # 331
004E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 332
0050 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 333
0053         ?C0032:
                                           ; SOURCE LINE # 337
0053 120000      R     LCALL   overcurrent_control
                                           ; SOURCE LINE # 341
0056 300005            JNB     interrupt_flag,?C0033
                                           ; SOURCE LINE # 342
0059 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 343
005B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 344
005E         ?C0033:
                                           ; SOURCE LINE # 348
005E 900000      E     MOV     DPTR,#master_mode
0061 E0                MOVX    A,@DPTR
0062 6057              JZ      ?C0034
                                           ; SOURCE LINE # 350
0064 900000      E     MOV     DPTR,#c_mem+0A7H
0067 E0                MOVX    A,@DPTR
0068 6003              JZ      ?C0035
                                           ; SOURCE LINE # 351
006A 120000      E     LCALL   drive_force_fb
                                           ; SOURCE LINE # 352
006D         ?C0035:
                                           ; SOURCE LINE # 354
006D 900000      E     MOV     DPTR,#c_mem+0A8H
0070 E0                MOVX    A,@DPTR
0071 6003              JZ      ?C0036
                                           ; SOURCE LINE # 355
0073 120000      E     LCALL   drive_proprio_fb
                                           ; SOURCE LINE # 356
0076         ?C0036:
                                           ; SOURCE LINE # 358
0076 900000      E     MOV     DPTR,#c_mem+0A9H
0079 E0                MOVX    A,@DPTR
007A 603F              JZ      ?C0034
                                           ; SOURCE LINE # 361
007C 900000      E     MOV     DPTR,#c_mem+096H
007F E0                MOVX    A,@DPTR
0080 B40135            CJNE    A,#01H,?C0038
                                           ; SOURCE LINE # 362
0083 900000      R     MOV     DPTR,#counter_calibration
0086 E0                MOVX    A,@DPTR
0087 7004              JNZ     ?C0271
0089 A3                INC     DPTR
008A E0                MOVX    A,@DPTR
008B 640A              XRL     A,#0AH
008D         ?C0271:
008D 7013              JNZ     ?C0039
                                           ; SOURCE LINE # 365
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 32  

008F 120000      E     LCALL   commReadMeasFromSH
0092 900000      E     MOV     DPTR,#curr_pos_res
0095 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 367
0098 120000      E     LCALL   check_rest_position
                                           ; SOURCE LINE # 368
009B E4                CLR     A
009C 900000      R     MOV     DPTR,#counter_calibration
009F F0                MOVX    @DPTR,A
00A0 A3                INC     DPTR
00A1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 369
00A2         ?C0039:
                                           ; SOURCE LINE # 370
00A2 900000      R     MOV     DPTR,#counter_calibration+01H
00A5 E0                MOVX    A,@DPTR
00A6 04                INC     A
00A7 F0                MOVX    @DPTR,A
00A8 7006              JNZ     ?C0272
00AA 900000      R     MOV     DPTR,#counter_calibration
00AD E0                MOVX    A,@DPTR
00AE 04                INC     A
00AF F0                MOVX    @DPTR,A
00B0         ?C0272:
                                           ; SOURCE LINE # 373
00B0 300005            JNB     interrupt_flag,?C0038
                                           ; SOURCE LINE # 374
00B3 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 375
00B5 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 376
                                           ; SOURCE LINE # 377
00B8         ?C0038:
                                           ; SOURCE LINE # 379
00B8 120000      E     LCALL   drive_SH
                                           ; SOURCE LINE # 380
                                           ; SOURCE LINE # 381
00BB         ?C0034:
                                           ; SOURCE LINE # 385
00BB 300005            JNB     interrupt_flag,?C0041
                                           ; SOURCE LINE # 386
00BE C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 387
00C0 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 388
00C3         ?C0041:
                                           ; SOURCE LINE # 393
00C3 900000      E     MOV     DPTR,#calib
00C6 E0                MOVX    A,@DPTR
00C7 B40124            CJNE    A,#01H,?C0042
                                           ; SOURCE LINE # 394
00CA 900000      R     MOV     DPTR,#counter_calibration
00CD E0                MOVX    A,@DPTR
00CE 7004              JNZ     ?C0273
00D0 A3                INC     DPTR
00D1 E0                MOVX    A,@DPTR
00D2 640A              XRL     A,#0AH
00D4         ?C0273:
00D4 700A              JNZ     ?C0043
                                           ; SOURCE LINE # 395
00D6 120000      E     LCALL   calibration
                                           ; SOURCE LINE # 396
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 33  

00D9 E4                CLR     A
00DA 900000      R     MOV     DPTR,#counter_calibration
00DD F0                MOVX    @DPTR,A
00DE A3                INC     DPTR
00DF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 397
00E0         ?C0043:
                                           ; SOURCE LINE # 398
00E0 900000      R     MOV     DPTR,#counter_calibration+01H
00E3 E0                MOVX    A,@DPTR
00E4 04                INC     A
00E5 F0                MOVX    @DPTR,A
00E6 7006              JNZ     ?C0274
00E8 900000      R     MOV     DPTR,#counter_calibration
00EB E0                MOVX    A,@DPTR
00EC 04                INC     A
00ED F0                MOVX    @DPTR,A
00EE         ?C0274:
                                           ; SOURCE LINE # 399
00EE         ?C0042:
                                           ; SOURCE LINE # 403
00EE 300005            JNB     interrupt_flag,?C0044
                                           ; SOURCE LINE # 404
00F1 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 405
00F3 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 406
00F6         ?C0044:
                                           ; SOURCE LINE # 412
00F6 7800        E     MOV     R0,#LOW g_measOld
00F8 7C00        E     MOV     R4,#HIGH g_measOld
00FA 7D01              MOV     R5,#01H
00FC 7B01              MOV     R3,#01H
00FE 7A00        E     MOV     R2,#HIGH g_meas
0100 7900        E     MOV     R1,#LOW g_meas
0102 7E00              MOV     R6,#00H
0104 7F37              MOV     R7,#037H
0106 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 413
0109 7800        E     MOV     R0,#LOW g_refOld
010B 7C00        E     MOV     R4,#HIGH g_refOld
010D 7D01              MOV     R5,#01H
010F 7B01              MOV     R3,#01H
0111 7A00        E     MOV     R2,#HIGH g_ref
0113 7900        E     MOV     R1,#LOW g_ref
0115 7E00              MOV     R6,#00H
0117 7F19              MOV     R7,#019H
0119 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 416
011C 7800        E     MOV     R0,#LOW g_ref
011E 7C00        E     MOV     R4,#HIGH g_ref
0120 7D01              MOV     R5,#01H
0122 7B01              MOV     R3,#01H
0124 7A00        E     MOV     R2,#HIGH g_refNew
0126 7900        E     MOV     R1,#LOW g_refNew
0128 7E00              MOV     R6,#00H
012A 7F19              MOV     R7,#019H
012C 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 418
012F 300005            JNB     interrupt_flag,?C0045
                                           ; SOURCE LINE # 419
0132 C200        E     CLR     interrupt_flag
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 34  

                                           ; SOURCE LINE # 420
0134 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 421
0137         ?C0045:
                                           ; SOURCE LINE # 423
0137 120000      E     LCALL   MY_TIMER_ReadCounter
013A 900000      E     MOV     DPTR,#timer_value
013D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 424
0140 7F40              MOV     R7,#040H
0142 7E4B              MOV     R6,#04BH
0144 7D4C              MOV     R5,#04CH
0146 7C00              MOV     R4,#00H
0148 120000      E     LCALL   _MY_TIMER_WriteCounter
                                           ; SOURCE LINE # 426
014B 22                RET     
             ; FUNCTION function_scheduler (END)

             ; FUNCTION motor_control (BEGIN)
                                           ; SOURCE LINE # 432
                                           ; SOURCE LINE # 434
0000 E4                CLR     A
0001 F500        R     MOV     pwm_input+03H,A
0003 F500        R     MOV     pwm_input+02H,A
0005 F500        R     MOV     pwm_input+01H,A
0007 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 444
0009 900000      E     MOV     DPTR,#c_mem+02H
000C E0                MOVX    A,@DPTR
000D FC                MOV     R4,A
000E A3                INC     DPTR
000F E0                MOVX    A,@DPTR
0010 FD                MOV     R5,A
0011 A3                INC     DPTR
0012 E0                MOVX    A,@DPTR
0013 FE                MOV     R6,A
0014 A3                INC     DPTR
0015 E0                MOVX    A,@DPTR
0016 F500        R     MOV     k_p+03H,A
0018 8E00        R     MOV     k_p+02H,R6
001A 8D00        R     MOV     k_p+01H,R5
001C 8C00        R     MOV     k_p,R4
                                           ; SOURCE LINE # 445
001E A3                INC     DPTR
001F E0                MOVX    A,@DPTR
0020 FC                MOV     R4,A
0021 A3                INC     DPTR
0022 E0                MOVX    A,@DPTR
0023 FD                MOV     R5,A
0024 A3                INC     DPTR
0025 E0                MOVX    A,@DPTR
0026 FE                MOV     R6,A
0027 A3                INC     DPTR
0028 E0                MOVX    A,@DPTR
0029 F500        R     MOV     k_i+03H,A
002B 8E00        R     MOV     k_i+02H,R6
002D 8D00        R     MOV     k_i+01H,R5
002F 8C00        R     MOV     k_i,R4
                                           ; SOURCE LINE # 446
0031 A3                INC     DPTR
0032 E0                MOVX    A,@DPTR
0033 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 35  

0034 A3                INC     DPTR
0035 E0                MOVX    A,@DPTR
0036 FD                MOV     R5,A
0037 A3                INC     DPTR
0038 E0                MOVX    A,@DPTR
0039 FE                MOV     R6,A
003A A3                INC     DPTR
003B E0                MOVX    A,@DPTR
003C F500        R     MOV     k_d+03H,A
003E 8E00        R     MOV     k_d+02H,R6
0040 8D00        R     MOV     k_d+01H,R5
0042 8C00        R     MOV     k_d,R4
                                           ; SOURCE LINE # 448
0044 A3                INC     DPTR
0045 E0                MOVX    A,@DPTR
0046 FC                MOV     R4,A
0047 A3                INC     DPTR
0048 E0                MOVX    A,@DPTR
0049 FD                MOV     R5,A
004A A3                INC     DPTR
004B E0                MOVX    A,@DPTR
004C FE                MOV     R6,A
004D A3                INC     DPTR
004E E0                MOVX    A,@DPTR
004F F500        R     MOV     k_p_c+03H,A
0051 8E00        R     MOV     k_p_c+02H,R6
0053 8D00        R     MOV     k_p_c+01H,R5
0055 8C00        R     MOV     k_p_c,R4
                                           ; SOURCE LINE # 449
0057 A3                INC     DPTR
0058 E0                MOVX    A,@DPTR
0059 FC                MOV     R4,A
005A A3                INC     DPTR
005B E0                MOVX    A,@DPTR
005C FD                MOV     R5,A
005D A3                INC     DPTR
005E E0                MOVX    A,@DPTR
005F FE                MOV     R6,A
0060 A3                INC     DPTR
0061 E0                MOVX    A,@DPTR
0062 F500        R     MOV     k_i_c+03H,A
0064 8E00        R     MOV     k_i_c+02H,R6
0066 8D00        R     MOV     k_i_c+01H,R5
0068 8C00        R     MOV     k_i_c,R4
                                           ; SOURCE LINE # 450
006A A3                INC     DPTR
006B E0                MOVX    A,@DPTR
006C FC                MOV     R4,A
006D A3                INC     DPTR
006E E0                MOVX    A,@DPTR
006F FD                MOV     R5,A
0070 A3                INC     DPTR
0071 E0                MOVX    A,@DPTR
0072 FE                MOV     R6,A
0073 A3                INC     DPTR
0074 E0                MOVX    A,@DPTR
0075 F500        R     MOV     k_d_c+03H,A
0077 8E00        R     MOV     k_d_c+02H,R6
0079 8D00        R     MOV     k_d_c+01H,R5
007B 8C00        R     MOV     k_d_c,R4
                                           ; SOURCE LINE # 452
007D A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 36  

007E E0                MOVX    A,@DPTR
007F FC                MOV     R4,A
0080 A3                INC     DPTR
0081 E0                MOVX    A,@DPTR
0082 FD                MOV     R5,A
0083 A3                INC     DPTR
0084 E0                MOVX    A,@DPTR
0085 FE                MOV     R6,A
0086 A3                INC     DPTR
0087 E0                MOVX    A,@DPTR
0088 F500        R     MOV     k_p_dl+03H,A
008A 8E00        R     MOV     k_p_dl+02H,R6
008C 8D00        R     MOV     k_p_dl+01H,R5
008E 8C00        R     MOV     k_p_dl,R4
                                           ; SOURCE LINE # 453
0090 A3                INC     DPTR
0091 E0                MOVX    A,@DPTR
0092 FC                MOV     R4,A
0093 A3                INC     DPTR
0094 E0                MOVX    A,@DPTR
0095 FD                MOV     R5,A
0096 A3                INC     DPTR
0097 E0                MOVX    A,@DPTR
0098 FE                MOV     R6,A
0099 A3                INC     DPTR
009A E0                MOVX    A,@DPTR
009B F500        R     MOV     k_i_dl+03H,A
009D 8E00        R     MOV     k_i_dl+02H,R6
009F 8D00        R     MOV     k_i_dl+01H,R5
00A1 8C00        R     MOV     k_i_dl,R4
                                           ; SOURCE LINE # 454
00A3 A3                INC     DPTR
00A4 E0                MOVX    A,@DPTR
00A5 FC                MOV     R4,A
00A6 A3                INC     DPTR
00A7 E0                MOVX    A,@DPTR
00A8 FD                MOV     R5,A
00A9 A3                INC     DPTR
00AA E0                MOVX    A,@DPTR
00AB FE                MOV     R6,A
00AC A3                INC     DPTR
00AD E0                MOVX    A,@DPTR
00AE F500        R     MOV     k_d_dl+03H,A
00B0 8E00        R     MOV     k_d_dl+02H,R6
00B2 8D00        R     MOV     k_d_dl+01H,R5
00B4 8C00        R     MOV     k_d_dl,R4
                                           ; SOURCE LINE # 456
00B6 A3                INC     DPTR
00B7 E0                MOVX    A,@DPTR
00B8 FC                MOV     R4,A
00B9 A3                INC     DPTR
00BA E0                MOVX    A,@DPTR
00BB FD                MOV     R5,A
00BC A3                INC     DPTR
00BD E0                MOVX    A,@DPTR
00BE FE                MOV     R6,A
00BF A3                INC     DPTR
00C0 E0                MOVX    A,@DPTR
00C1 F500        R     MOV     k_p_c_dl+03H,A
00C3 8E00        R     MOV     k_p_c_dl+02H,R6
00C5 8D00        R     MOV     k_p_c_dl+01H,R5
00C7 8C00        R     MOV     k_p_c_dl,R4
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 37  

                                           ; SOURCE LINE # 457
00C9 A3                INC     DPTR
00CA E0                MOVX    A,@DPTR
00CB FC                MOV     R4,A
00CC A3                INC     DPTR
00CD E0                MOVX    A,@DPTR
00CE FD                MOV     R5,A
00CF A3                INC     DPTR
00D0 E0                MOVX    A,@DPTR
00D1 FE                MOV     R6,A
00D2 A3                INC     DPTR
00D3 E0                MOVX    A,@DPTR
00D4 F500        R     MOV     k_i_c_dl+03H,A
00D6 8E00        R     MOV     k_i_c_dl+02H,R6
00D8 8D00        R     MOV     k_i_c_dl+01H,R5
00DA 8C00        R     MOV     k_i_c_dl,R4
                                           ; SOURCE LINE # 458
00DC A3                INC     DPTR
00DD E0                MOVX    A,@DPTR
00DE FC                MOV     R4,A
00DF A3                INC     DPTR
00E0 E0                MOVX    A,@DPTR
00E1 FD                MOV     R5,A
00E2 A3                INC     DPTR
00E3 E0                MOVX    A,@DPTR
00E4 FE                MOV     R6,A
00E5 A3                INC     DPTR
00E6 E0                MOVX    A,@DPTR
00E7 F500        R     MOV     k_d_c_dl+03H,A
00E9 8E00        R     MOV     k_d_c_dl+02H,R6
00EB 8D00        R     MOV     k_d_c_dl+01H,R5
00ED 8C00        R     MOV     k_d_c_dl,R4
                                           ; SOURCE LINE # 475
00EF 900000      E     MOV     DPTR,#c_mem+06BH
00F2 E0                MOVX    A,@DPTR
00F3 FE                MOV     R6,A
00F4 A3                INC     DPTR
00F5 E0                MOVX    A,@DPTR
00F6 FF                MOV     R7,A
00F7 FB                MOV     R3,A
00F8 AA06              MOV     R2,AR6
00FA E4                CLR     A
00FB 900000      E     MOV     DPTR,#g_meas+017H
00FE E0                MOVX    A,@DPTR
00FF FC                MOV     R4,A
0100 A3                INC     DPTR
0101 E0                MOVX    A,@DPTR
0102 FD                MOV     R5,A
0103 A3                INC     DPTR
0104 E0                MOVX    A,@DPTR
0105 FE                MOV     R6,A
0106 A3                INC     DPTR
0107 E0                MOVX    A,@DPTR
0108 C3                CLR     C
0109 9B                SUBB    A,R3
010A F500        R     MOV     err_emg_1+03H,A
010C EE                MOV     A,R6
010D 9A                SUBB    A,R2
010E F500        R     MOV     err_emg_1+02H,A
0110 ED                MOV     A,R5
0111 9400              SUBB    A,#00H
0113 F500        R     MOV     err_emg_1+01H,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 38  

0115 EC                MOV     A,R4
0116 9400              SUBB    A,#00H
0118 F500        R     MOV     err_emg_1,A
                                           ; SOURCE LINE # 476
011A 900000      E     MOV     DPTR,#c_mem+06DH
011D E0                MOVX    A,@DPTR
011E FE                MOV     R6,A
011F A3                INC     DPTR
0120 E0                MOVX    A,@DPTR
0121 FF                MOV     R7,A
0122 FB                MOV     R3,A
0123 AA06              MOV     R2,AR6
0125 E4                CLR     A
0126 900000      E     MOV     DPTR,#g_meas+01BH
0129 E0                MOVX    A,@DPTR
012A FC                MOV     R4,A
012B A3                INC     DPTR
012C E0                MOVX    A,@DPTR
012D FD                MOV     R5,A
012E A3                INC     DPTR
012F E0                MOVX    A,@DPTR
0130 FE                MOV     R6,A
0131 A3                INC     DPTR
0132 E0                MOVX    A,@DPTR
0133 C3                CLR     C
0134 9B                SUBB    A,R3
0135 F500        R     MOV     err_emg_2+03H,A
0137 EE                MOV     A,R6
0138 9A                SUBB    A,R2
0139 F500        R     MOV     err_emg_2+02H,A
013B ED                MOV     A,R5
013C 9400              SUBB    A,#00H
013E F500        R     MOV     err_emg_2+01H,A
0140 EC                MOV     A,R4
0141 9400              SUBB    A,#00H
0143 F500        R     MOV     err_emg_2,A
                                           ; SOURCE LINE # 479
0145 900000      E     MOV     DPTR,#c_mem+033H
0148 E0                MOVX    A,@DPTR
0149 24FE              ADD     A,#0FEH
014B 7003              JNZ     $ + 5H
014D 020000      R     LJMP    ?C0057
0150 14                DEC     A
0151 7003              JNZ     $ + 5H
0153 020000      R     LJMP    ?C0060
0156 14                DEC     A
0157 7003              JNZ     $ + 5H
0159 020000      R     LJMP    ?C0063
015C 14                DEC     A
015D 7003              JNZ     $ + 5H
015F 020000      R     LJMP    ?C0073
0162 2404              ADD     A,#04H
0164 6003              JZ      $ + 5H
0166 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 481
0169         ?C0048:
                                           ; SOURCE LINE # 483
0169 900000      E     MOV     DPTR,#master_mode
016C E0                MOVX    A,@DPTR
016D 6026              JZ      ?C0049
                                           ; SOURCE LINE # 485
016F 900000      E     MOV     DPTR,#c_mem+07AH
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 39  

0172 E0                MOVX    A,@DPTR
0173 FF                MOV     R7,A
0174 33                RLC     A
0175 95E0              SUBB    A,ACC
0177 FE                MOV     R6,A
0178 FD                MOV     R5,A
0179 FC                MOV     R4,A
017A 900000      E     MOV     DPTR,#g_meas
017D E0                MOVX    A,@DPTR
017E F8                MOV     R0,A
017F A3                INC     DPTR
0180 E0                MOVX    A,@DPTR
0181 F9                MOV     R1,A
0182 A3                INC     DPTR
0183 E0                MOVX    A,@DPTR
0184 FA                MOV     R2,A
0185 A3                INC     DPTR
0186 E0                MOVX    A,@DPTR
0187 FB                MOV     R3,A
0188 120000      E     LCALL   ?C?LMUL
018B 8F00        R     MOV     handle_value+03H,R7
018D 8E00        R     MOV     handle_value+02H,R6
018F 8D00        R     MOV     handle_value+01H,R5
0191 8C00        R     MOV     handle_value,R4
                                           ; SOURCE LINE # 486
0193 804E              SJMP    ?C0050
0195         ?C0049:
                                           ; SOURCE LINE # 487
                                           ; SOURCE LINE # 491
0195 900000      E     MOV     DPTR,#c_mem+079H
0198 E0                MOVX    A,@DPTR
0199 6024              JZ      ?C0051
                                           ; SOURCE LINE # 492
019B A3                INC     DPTR
019C E0                MOVX    A,@DPTR
019D FF                MOV     R7,A
019E 33                RLC     A
019F 95E0              SUBB    A,ACC
01A1 FE                MOV     R6,A
01A2 FD                MOV     R5,A
01A3 FC                MOV     R4,A
01A4 900000      E     MOV     DPTR,#g_meas+08H
01A7 E0                MOVX    A,@DPTR
01A8 F8                MOV     R0,A
01A9 A3                INC     DPTR
01AA E0                MOVX    A,@DPTR
01AB F9                MOV     R1,A
01AC A3                INC     DPTR
01AD E0                MOVX    A,@DPTR
01AE FA                MOV     R2,A
01AF A3                INC     DPTR
01B0 E0                MOVX    A,@DPTR
01B1 FB                MOV     R3,A
01B2 120000      E     LCALL   ?C?LMUL
01B5 8F00        R     MOV     handle_value+03H,R7
01B7 8E00        R     MOV     handle_value+02H,R6
01B9 8D00        R     MOV     handle_value+01H,R5
01BB 8C00        R     MOV     handle_value,R4
01BD 8024              SJMP    ?C0050
01BF         ?C0051:
                                           ; SOURCE LINE # 494
01BF 900000      E     MOV     DPTR,#c_mem+07AH
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 40  

01C2 E0                MOVX    A,@DPTR
01C3 FF                MOV     R7,A
01C4 33                RLC     A
01C5 95E0              SUBB    A,ACC
01C7 FE                MOV     R6,A
01C8 FD                MOV     R5,A
01C9 FC                MOV     R4,A
01CA 900000      E     MOV     DPTR,#g_meas+04H
01CD E0                MOVX    A,@DPTR
01CE F8                MOV     R0,A
01CF A3                INC     DPTR
01D0 E0                MOVX    A,@DPTR
01D1 F9                MOV     R1,A
01D2 A3                INC     DPTR
01D3 E0                MOVX    A,@DPTR
01D4 FA                MOV     R2,A
01D5 A3                INC     DPTR
01D6 E0                MOVX    A,@DPTR
01D7 FB                MOV     R3,A
01D8 120000      E     LCALL   ?C?LMUL
01DB 8F00        R     MOV     handle_value+03H,R7
01DD 8E00        R     MOV     handle_value+02H,R6
01DF 8D00        R     MOV     handle_value+01H,R5
01E1 8C00        R     MOV     handle_value,R4
                                           ; SOURCE LINE # 495
01E3         ?C0050:
                                           ; SOURCE LINE # 498
01E3 900000      E     MOV     DPTR,#g_ref
01E6 E0                MOVX    A,@DPTR
01E7 F8                MOV     R0,A
01E8 A3                INC     DPTR
01E9 E0                MOVX    A,@DPTR
01EA F9                MOV     R1,A
01EB A3                INC     DPTR
01EC E0                MOVX    A,@DPTR
01ED FA                MOV     R2,A
01EE A3                INC     DPTR
01EF E0                MOVX    A,@DPTR
01F0 FB                MOV     R3,A
01F1 C3                CLR     C
01F2 E500        R     MOV     A,handle_value+03H
01F4 9B                SUBB    A,R3
01F5 FF                MOV     R7,A
01F6 E500        R     MOV     A,handle_value+02H
01F8 9A                SUBB    A,R2
01F9 FE                MOV     R6,A
01FA E500        R     MOV     A,handle_value+01H
01FC 99                SUBB    A,R1
01FD FD                MOV     R5,A
01FE E500        R     MOV     A,handle_value
0200 98                SUBB    A,R0
0201 FC                MOV     R4,A
0202 900000      E     MOV     DPTR,#c_mem+061H
0205 E0                MOVX    A,@DPTR
0206 F8                MOV     R0,A
0207 A3                INC     DPTR
0208 E0                MOVX    A,@DPTR
0209 F9                MOV     R1,A
020A A3                INC     DPTR
020B E0                MOVX    A,@DPTR
020C FA                MOV     R2,A
020D A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 41  

020E E0                MOVX    A,@DPTR
020F FB                MOV     R3,A
0210 C3                CLR     C
0211 120000      E     LCALL   ?C?SLCMP
0214 5044              JNC     ?C0053
0216 E4                CLR     A
0217 FF                MOV     R7,A
0218 FE                MOV     R6,A
0219 FD                MOV     R5,A
021A FC                MOV     R4,A
021B 900000      E     MOV     DPTR,#c_mem+061H
021E E0                MOVX    A,@DPTR
021F F8                MOV     R0,A
0220 A3                INC     DPTR
0221 E0                MOVX    A,@DPTR
0222 A3                INC     DPTR
0223 E0                MOVX    A,@DPTR
0224 A3                INC     DPTR
0225 E0                MOVX    A,@DPTR
0226 C3                CLR     C
0227 120000      E     LCALL   ?C?SLCMP
022A 602E              JZ      ?C0053
                                           ; SOURCE LINE # 499
022C 900000      E     MOV     DPTR,#g_ref
022F E0                MOVX    A,@DPTR
0230 FC                MOV     R4,A
0231 A3                INC     DPTR
0232 E0                MOVX    A,@DPTR
0233 FD                MOV     R5,A
0234 A3                INC     DPTR
0235 E0                MOVX    A,@DPTR
0236 FE                MOV     R6,A
0237 A3                INC     DPTR
0238 E0                MOVX    A,@DPTR
0239 FF                MOV     R7,A
023A 900000      E     MOV     DPTR,#c_mem+061H
023D E0                MOVX    A,@DPTR
023E F8                MOV     R0,A
023F A3                INC     DPTR
0240 E0                MOVX    A,@DPTR
0241 A3                INC     DPTR
0242 E0                MOVX    A,@DPTR
0243 A3                INC     DPTR
0244 E0                MOVX    A,@DPTR
0245 EF                MOV     A,R7
0246 2B                ADD     A,R3
0247 FF                MOV     R7,A
0248 EE                MOV     A,R6
0249 3A                ADDC    A,R2
024A FE                MOV     R6,A
024B ED                MOV     A,R5
024C 39                ADDC    A,R1
024D FD                MOV     R5,A
024E EC                MOV     A,R4
024F 38                ADDC    A,R0
0250 FC                MOV     R4,A
0251 900000      E     MOV     DPTR,#g_ref
0254 120000      E     LCALL   ?C?LSTXDATA
0257 020000      R     LJMP    ?C0047
025A         ?C0053:
                                           ; SOURCE LINE # 500
                                           ; SOURCE LINE # 501
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 42  

025A 900000      E     MOV     DPTR,#g_ref
025D E0                MOVX    A,@DPTR
025E F8                MOV     R0,A
025F A3                INC     DPTR
0260 E0                MOVX    A,@DPTR
0261 F9                MOV     R1,A
0262 A3                INC     DPTR
0263 E0                MOVX    A,@DPTR
0264 FA                MOV     R2,A
0265 A3                INC     DPTR
0266 E0                MOVX    A,@DPTR
0267 FB                MOV     R3,A
0268 C3                CLR     C
0269 E500        R     MOV     A,handle_value+03H
026B 9B                SUBB    A,R3
026C FF                MOV     R7,A
026D E500        R     MOV     A,handle_value+02H
026F 9A                SUBB    A,R2
0270 FE                MOV     R6,A
0271 E500        R     MOV     A,handle_value+01H
0273 99                SUBB    A,R1
0274 FD                MOV     R5,A
0275 E500        R     MOV     A,handle_value
0277 98                SUBB    A,R0
0278 FC                MOV     R4,A
0279 900000      E     MOV     DPTR,#c_mem+065H
027C E0                MOVX    A,@DPTR
027D F8                MOV     R0,A
027E A3                INC     DPTR
027F E0                MOVX    A,@DPTR
0280 F9                MOV     R1,A
0281 A3                INC     DPTR
0282 E0                MOVX    A,@DPTR
0283 FA                MOV     R2,A
0284 A3                INC     DPTR
0285 E0                MOVX    A,@DPTR
0286 FB                MOV     R3,A
0287 D3                SETB    C
0288 120000      E     LCALL   ?C?SLCMP
028B 4043              JC      ?C0055
028D E4                CLR     A
028E FF                MOV     R7,A
028F FE                MOV     R6,A
0290 FD                MOV     R5,A
0291 FC                MOV     R4,A
0292 900000      E     MOV     DPTR,#c_mem+065H
0295 E0                MOVX    A,@DPTR
0296 F8                MOV     R0,A
0297 A3                INC     DPTR
0298 E0                MOVX    A,@DPTR
0299 A3                INC     DPTR
029A E0                MOVX    A,@DPTR
029B A3                INC     DPTR
029C E0                MOVX    A,@DPTR
029D 120000      E     LCALL   ?C?SLCMP
02A0 602E              JZ      ?C0055
                                           ; SOURCE LINE # 502
02A2 900000      E     MOV     DPTR,#g_ref
02A5 E0                MOVX    A,@DPTR
02A6 FC                MOV     R4,A
02A7 A3                INC     DPTR
02A8 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 43  

02A9 FD                MOV     R5,A
02AA A3                INC     DPTR
02AB E0                MOVX    A,@DPTR
02AC FE                MOV     R6,A
02AD A3                INC     DPTR
02AE E0                MOVX    A,@DPTR
02AF FF                MOV     R7,A
02B0 900000      E     MOV     DPTR,#c_mem+065H
02B3 E0                MOVX    A,@DPTR
02B4 F8                MOV     R0,A
02B5 A3                INC     DPTR
02B6 E0                MOVX    A,@DPTR
02B7 A3                INC     DPTR
02B8 E0                MOVX    A,@DPTR
02B9 A3                INC     DPTR
02BA E0                MOVX    A,@DPTR
02BB EF                MOV     A,R7
02BC 2B                ADD     A,R3
02BD FF                MOV     R7,A
02BE EE                MOV     A,R6
02BF 3A                ADDC    A,R2
02C0 FE                MOV     R6,A
02C1 ED                MOV     A,R5
02C2 39                ADDC    A,R1
02C3 FD                MOV     R5,A
02C4 EC                MOV     A,R4
02C5 38                ADDC    A,R0
02C6 FC                MOV     R4,A
02C7 900000      E     MOV     DPTR,#g_ref
02CA 120000      E     LCALL   ?C?LSTXDATA
02CD 020000      R     LJMP    ?C0047
02D0         ?C0055:
                                           ; SOURCE LINE # 504
02D0 AF00        R     MOV     R7,handle_value+03H
02D2 AE00        R     MOV     R6,handle_value+02H
02D4 AD00        R     MOV     R5,handle_value+01H
02D6 AC00        R     MOV     R4,handle_value
02D8 900000      E     MOV     DPTR,#g_ref
02DB 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 505
                                           ; SOURCE LINE # 506
02DE 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 508
02E1         ?C0057:
                                           ; SOURCE LINE # 509
02E1 E4                CLR     A
02E2 FF                MOV     R7,A
02E3 FE                MOV     R6,A
02E4 FD                MOV     R5,A
02E5 FC                MOV     R4,A
02E6 AB00        R     MOV     R3,err_emg_1+03H
02E8 AA00        R     MOV     R2,err_emg_1+02H
02EA A900        R     MOV     R1,err_emg_1+01H
02EC A800        R     MOV     R0,err_emg_1
02EE D3                SETB    C
02EF 120000      E     LCALL   ?C?SLCMP
02F2 403D              JC      ?C0058
                                           ; SOURCE LINE # 510
02F4 900000      E     MOV     DPTR,#g_mem+059H
02F7 E0                MOVX    A,@DPTR
02F8 FC                MOV     R4,A
02F9 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 44  

02FA E0                MOVX    A,@DPTR
02FB FD                MOV     R5,A
02FC A3                INC     DPTR
02FD E0                MOVX    A,@DPTR
02FE FE                MOV     R6,A
02FF A3                INC     DPTR
0300 E0                MOVX    A,@DPTR
0301 FF                MOV     R7,A
0302 A800        R     MOV     R0,err_emg_1
0304 120000      E     LCALL   ?C?LMUL
0307 C006              PUSH    AR6
0309 C007              PUSH    AR7
030B 900000      E     MOV     DPTR,#c_mem+06BH
030E E0                MOVX    A,@DPTR
030F FE                MOV     R6,A
0310 A3                INC     DPTR
0311 E0                MOVX    A,@DPTR
0312 FF                MOV     R7,A
0313 C3                CLR     C
0314 E4                CLR     A
0315 9F                SUBB    A,R7
0316 FF                MOV     R7,A
0317 7404              MOV     A,#04H
0319 9E                SUBB    A,R6
031A FE                MOV     R6,A
031B AB07              MOV     R3,AR7
031D FA                MOV     R2,A
031E E4                CLR     A
031F F9                MOV     R1,A
0320 F8                MOV     R0,A
0321 D007              POP     AR7
0323 D006              POP     AR6
0325 120000      E     LCALL   ?C?SLDIV
0328 900000      E     MOV     DPTR,#g_ref
032B 120000      E     LCALL   ?C?LSTXDATA
032E 020000      R     LJMP    ?C0047
0331         ?C0058:
                                           ; SOURCE LINE # 512
0331 E4                CLR     A
0332 FF                MOV     R7,A
0333 FE                MOV     R6,A
0334 FD                MOV     R5,A
0335 FC                MOV     R4,A
0336 900000      E     MOV     DPTR,#g_ref
0339 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 513
033C 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 515
033F         ?C0060:
                                           ; SOURCE LINE # 516
033F 900000      E     MOV     DPTR,#g_refOld
0342 E0                MOVX    A,@DPTR
0343 FC                MOV     R4,A
0344 A3                INC     DPTR
0345 E0                MOVX    A,@DPTR
0346 FD                MOV     R5,A
0347 A3                INC     DPTR
0348 E0                MOVX    A,@DPTR
0349 FE                MOV     R6,A
034A A3                INC     DPTR
034B E0                MOVX    A,@DPTR
034C FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 45  

034D 900000      E     MOV     DPTR,#g_ref
0350 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 517
0353 E4                CLR     A
0354 FF                MOV     R7,A
0355 FE                MOV     R6,A
0356 FD                MOV     R5,A
0357 FC                MOV     R4,A
0358 AB00        R     MOV     R3,err_emg_1+03H
035A AA00        R     MOV     R2,err_emg_1+02H
035C A900        R     MOV     R1,err_emg_1+01H
035E A800        R     MOV     R0,err_emg_1
0360 D3                SETB    C
0361 120000      E     LCALL   ?C?SLCMP
0364 4056              JC      ?C0061
                                           ; SOURCE LINE # 518
0366 900000      E     MOV     DPTR,#g_mem+078H
0369 E0                MOVX    A,@DPTR
036A FF                MOV     R7,A
036B E4                CLR     A
036C FC                MOV     R4,A
036D FD                MOV     R5,A
036E FE                MOV     R6,A
036F A800        R     MOV     R0,err_emg_1
0371 120000      E     LCALL   ?C?LMUL
0374 E4                CLR     A
0375 7B02              MOV     R3,#02H
0377 FA                MOV     R2,A
0378 F9                MOV     R1,A
0379 F8                MOV     R0,A
037A 120000      E     LCALL   ?C?LMUL
037D C006              PUSH    AR6
037F C007              PUSH    AR7
0381 900000      E     MOV     DPTR,#c_mem+06BH
0384 E0                MOVX    A,@DPTR
0385 FE                MOV     R6,A
0386 A3                INC     DPTR
0387 E0                MOVX    A,@DPTR
0388 FF                MOV     R7,A
0389 C3                CLR     C
038A E4                CLR     A
038B 9F                SUBB    A,R7
038C FF                MOV     R7,A
038D 7404              MOV     A,#04H
038F 9E                SUBB    A,R6
0390 FE                MOV     R6,A
0391 AB07              MOV     R3,AR7
0393 FA                MOV     R2,A
0394 E4                CLR     A
0395 F9                MOV     R1,A
0396 F8                MOV     R0,A
0397 D007              POP     AR7
0399 D006              POP     AR6
039B 120000      E     LCALL   ?C?SLDIV
039E 900000      E     MOV     DPTR,#g_refOld
03A1 E0                MOVX    A,@DPTR
03A2 F8                MOV     R0,A
03A3 A3                INC     DPTR
03A4 E0                MOVX    A,@DPTR
03A5 F9                MOV     R1,A
03A6 A3                INC     DPTR
03A7 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 46  

03A8 FA                MOV     R2,A
03A9 A3                INC     DPTR
03AA E0                MOVX    A,@DPTR
03AB 2F                ADD     A,R7
03AC FF                MOV     R7,A
03AD EA                MOV     A,R2
03AE 3E                ADDC    A,R6
03AF FE                MOV     R6,A
03B0 E9                MOV     A,R1
03B1 3D                ADDC    A,R5
03B2 FD                MOV     R5,A
03B3 E8                MOV     A,R0
03B4 3C                ADDC    A,R4
03B5 FC                MOV     R4,A
03B6 900000      E     MOV     DPTR,#g_ref
03B9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 519
03BC         ?C0061:
                                           ; SOURCE LINE # 520
03BC E4                CLR     A
03BD FF                MOV     R7,A
03BE FE                MOV     R6,A
03BF FD                MOV     R5,A
03C0 FC                MOV     R4,A
03C1 AB00        R     MOV     R3,err_emg_2+03H
03C3 AA00        R     MOV     R2,err_emg_2+02H
03C5 A900        R     MOV     R1,err_emg_2+01H
03C7 A800        R     MOV     R0,err_emg_2
03C9 D3                SETB    C
03CA 120000      E     LCALL   ?C?SLCMP
03CD 5003              JNC     $ + 5H
03CF 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 521
03D2 900000      E     MOV     DPTR,#g_mem+078H
03D5 E0                MOVX    A,@DPTR
03D6 FF                MOV     R7,A
03D7 E4                CLR     A
03D8 FC                MOV     R4,A
03D9 FD                MOV     R5,A
03DA FE                MOV     R6,A
03DB A800        R     MOV     R0,err_emg_2
03DD 120000      E     LCALL   ?C?LMUL
03E0 E4                CLR     A
03E1 7B02              MOV     R3,#02H
03E3 FA                MOV     R2,A
03E4 F9                MOV     R1,A
03E5 F8                MOV     R0,A
03E6 120000      E     LCALL   ?C?LMUL
03E9 C006              PUSH    AR6
03EB C007              PUSH    AR7
03ED 900000      E     MOV     DPTR,#c_mem+06DH
03F0 E0                MOVX    A,@DPTR
03F1 FE                MOV     R6,A
03F2 A3                INC     DPTR
03F3 E0                MOVX    A,@DPTR
03F4 FF                MOV     R7,A
03F5 C3                CLR     C
03F6 E4                CLR     A
03F7 9F                SUBB    A,R7
03F8 FF                MOV     R7,A
03F9 7404              MOV     A,#04H
03FB 9E                SUBB    A,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 47  

03FC FE                MOV     R6,A
03FD AB07              MOV     R3,AR7
03FF FA                MOV     R2,A
0400 E4                CLR     A
0401 F9                MOV     R1,A
0402 F8                MOV     R0,A
0403 D007              POP     AR7
0405 D006              POP     AR6
0407 120000      E     LCALL   ?C?SLDIV
040A A804              MOV     R0,AR4
040C A905              MOV     R1,AR5
040E AA06              MOV     R2,AR6
0410 AB07              MOV     R3,AR7
0412 900000      E     MOV     DPTR,#g_refOld
0415 E0                MOVX    A,@DPTR
0416 FC                MOV     R4,A
0417 A3                INC     DPTR
0418 E0                MOVX    A,@DPTR
0419 FD                MOV     R5,A
041A A3                INC     DPTR
041B E0                MOVX    A,@DPTR
041C FE                MOV     R6,A
041D A3                INC     DPTR
041E E0                MOVX    A,@DPTR
041F C3                CLR     C
0420 9B                SUBB    A,R3
0421 FF                MOV     R7,A
0422 EE                MOV     A,R6
0423 9A                SUBB    A,R2
0424 FE                MOV     R6,A
0425 ED                MOV     A,R5
0426 99                SUBB    A,R1
0427 FD                MOV     R5,A
0428 EC                MOV     A,R4
0429 98                SUBB    A,R0
042A FC                MOV     R4,A
042B 900000      E     MOV     DPTR,#g_ref
042E 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 522
                                           ; SOURCE LINE # 523
0431 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 525
0434         ?C0063:
                                           ; SOURCE LINE # 526
0434 900000      E     MOV     DPTR,#g_refOld
0437 E0                MOVX    A,@DPTR
0438 FC                MOV     R4,A
0439 A3                INC     DPTR
043A E0                MOVX    A,@DPTR
043B FD                MOV     R5,A
043C A3                INC     DPTR
043D E0                MOVX    A,@DPTR
043E FE                MOV     R6,A
043F A3                INC     DPTR
0440 E0                MOVX    A,@DPTR
0441 FF                MOV     R7,A
0442 900000      E     MOV     DPTR,#g_ref
0445 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 527
0448 900000      R     MOV     DPTR,#current_emg
044B E0                MOVX    A,@DPTR
044C 14                DEC     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 48  

044D 6048              JZ      ?C0068
044F 14                DEC     A
0450 7003              JNZ     $ + 5H
0452 020000      R     LJMP    ?C0070
0455 2402              ADD     A,#02H
0457 6003              JZ      $ + 5H
0459 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 528
045C         ?C0065:
                                           ; SOURCE LINE # 530
045C E4                CLR     A
045D FF                MOV     R7,A
045E FE                MOV     R6,A
045F FD                MOV     R5,A
0460 FC                MOV     R4,A
0461 AB00        R     MOV     R3,err_emg_1+03H
0463 AA00        R     MOV     R2,err_emg_1+02H
0465 A900        R     MOV     R1,err_emg_1+01H
0467 A800        R     MOV     R0,err_emg_1
0469 D3                SETB    C
046A 120000      E     LCALL   ?C?SLCMP
046D 4009              JC      ?C0066
                                           ; SOURCE LINE # 531
046F 900000      R     MOV     DPTR,#current_emg
0472 7401              MOV     A,#01H
0474 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 532
0475 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 533
0478         ?C0066:
                                           ; SOURCE LINE # 534
0478 E4                CLR     A
0479 FF                MOV     R7,A
047A FE                MOV     R6,A
047B FD                MOV     R5,A
047C FC                MOV     R4,A
047D AB00        R     MOV     R3,err_emg_2+03H
047F AA00        R     MOV     R2,err_emg_2+02H
0481 A900        R     MOV     R1,err_emg_2+01H
0483 A800        R     MOV     R0,err_emg_2
0485 D3                SETB    C
0486 120000      E     LCALL   ?C?SLCMP
0489 5003              JNC     $ + 5H
048B 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 535
048E 900000      R     MOV     DPTR,#current_emg
0491 7402              MOV     A,#02H
0493 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 536
0494 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 537
                                           ; SOURCE LINE # 538
                                           ; SOURCE LINE # 540
0497         ?C0068:
                                           ; SOURCE LINE # 542
0497 E4                CLR     A
0498 FF                MOV     R7,A
0499 FE                MOV     R6,A
049A FD                MOV     R5,A
049B FC                MOV     R4,A
049C AB00        R     MOV     R3,err_emg_1+03H
049E AA00        R     MOV     R2,err_emg_1+02H
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 49  

04A0 A900        R     MOV     R1,err_emg_1+01H
04A2 A800        R     MOV     R0,err_emg_1
04A4 C3                CLR     C
04A5 120000      E     LCALL   ?C?SLCMP
04A8 5008              JNC     ?C0069
                                           ; SOURCE LINE # 543
04AA E4                CLR     A
04AB 900000      R     MOV     DPTR,#current_emg
04AE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 544
04AF 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 545
04B2         ?C0069:
                                           ; SOURCE LINE # 546
04B2 900000      E     MOV     DPTR,#g_mem+078H
04B5 E0                MOVX    A,@DPTR
04B6 FF                MOV     R7,A
04B7 E4                CLR     A
04B8 FC                MOV     R4,A
04B9 FD                MOV     R5,A
04BA FE                MOV     R6,A
04BB AB00        R     MOV     R3,err_emg_1+03H
04BD AA00        R     MOV     R2,err_emg_1+02H
04BF A900        R     MOV     R1,err_emg_1+01H
04C1 A800        R     MOV     R0,err_emg_1
04C3 120000      E     LCALL   ?C?LMUL
04C6 E4                CLR     A
04C7 7B02              MOV     R3,#02H
04C9 FA                MOV     R2,A
04CA F9                MOV     R1,A
04CB F8                MOV     R0,A
04CC 120000      E     LCALL   ?C?LMUL
04CF C006              PUSH    AR6
04D1 C007              PUSH    AR7
04D3 900000      E     MOV     DPTR,#c_mem+06BH
04D6 E0                MOVX    A,@DPTR
04D7 FE                MOV     R6,A
04D8 A3                INC     DPTR
04D9 E0                MOVX    A,@DPTR
04DA FF                MOV     R7,A
04DB C3                CLR     C
04DC E4                CLR     A
04DD 9F                SUBB    A,R7
04DE FF                MOV     R7,A
04DF 7404              MOV     A,#04H
04E1 9E                SUBB    A,R6
04E2 FE                MOV     R6,A
04E3 AB07              MOV     R3,AR7
04E5 FA                MOV     R2,A
04E6 E4                CLR     A
04E7 F9                MOV     R1,A
04E8 F8                MOV     R0,A
04E9 D007              POP     AR7
04EB D006              POP     AR6
04ED 120000      E     LCALL   ?C?SLDIV
04F0 900000      E     MOV     DPTR,#g_refOld
04F3 E0                MOVX    A,@DPTR
04F4 F8                MOV     R0,A
04F5 A3                INC     DPTR
04F6 E0                MOVX    A,@DPTR
04F7 F9                MOV     R1,A
04F8 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 50  

04F9 E0                MOVX    A,@DPTR
04FA FA                MOV     R2,A
04FB A3                INC     DPTR
04FC E0                MOVX    A,@DPTR
04FD 2F                ADD     A,R7
04FE FF                MOV     R7,A
04FF EA                MOV     A,R2
0500 3E                ADDC    A,R6
0501 FE                MOV     R6,A
0502 E9                MOV     A,R1
0503 3D                ADDC    A,R5
0504 FD                MOV     R5,A
0505 E8                MOV     A,R0
0506 3C                ADDC    A,R4
0507 FC                MOV     R4,A
0508 900000      E     MOV     DPTR,#g_ref
050B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 547
050E 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 549
0511         ?C0070:
                                           ; SOURCE LINE # 551
0511 E4                CLR     A
0512 FF                MOV     R7,A
0513 FE                MOV     R6,A
0514 FD                MOV     R5,A
0515 FC                MOV     R4,A
0516 AB00        R     MOV     R3,err_emg_2+03H
0518 AA00        R     MOV     R2,err_emg_2+02H
051A A900        R     MOV     R1,err_emg_2+01H
051C A800        R     MOV     R0,err_emg_2
051E C3                CLR     C
051F 120000      E     LCALL   ?C?SLCMP
0522 5008              JNC     ?C0071
                                           ; SOURCE LINE # 552
0524 E4                CLR     A
0525 900000      R     MOV     DPTR,#current_emg
0528 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 553
0529 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 554
052C         ?C0071:
                                           ; SOURCE LINE # 555
052C 900000      E     MOV     DPTR,#g_mem+078H
052F E0                MOVX    A,@DPTR
0530 FF                MOV     R7,A
0531 E4                CLR     A
0532 FC                MOV     R4,A
0533 FD                MOV     R5,A
0534 FE                MOV     R6,A
0535 AB00        R     MOV     R3,err_emg_2+03H
0537 AA00        R     MOV     R2,err_emg_2+02H
0539 A900        R     MOV     R1,err_emg_2+01H
053B A800        R     MOV     R0,err_emg_2
053D 120000      E     LCALL   ?C?LMUL
0540 E4                CLR     A
0541 7B02              MOV     R3,#02H
0543 FA                MOV     R2,A
0544 F9                MOV     R1,A
0545 F8                MOV     R0,A
0546 120000      E     LCALL   ?C?LMUL
0549 C006              PUSH    AR6
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 51  

054B C007              PUSH    AR7
054D 900000      E     MOV     DPTR,#c_mem+06DH
0550 E0                MOVX    A,@DPTR
0551 FE                MOV     R6,A
0552 A3                INC     DPTR
0553 E0                MOVX    A,@DPTR
0554 FF                MOV     R7,A
0555 C3                CLR     C
0556 E4                CLR     A
0557 9F                SUBB    A,R7
0558 FF                MOV     R7,A
0559 7404              MOV     A,#04H
055B 9E                SUBB    A,R6
055C FE                MOV     R6,A
055D AB07              MOV     R3,AR7
055F FA                MOV     R2,A
0560 E4                CLR     A
0561 F9                MOV     R1,A
0562 F8                MOV     R0,A
0563 D007              POP     AR7
0565 D006              POP     AR6
0567 120000      E     LCALL   ?C?SLDIV
056A A804              MOV     R0,AR4
056C A905              MOV     R1,AR5
056E AA06              MOV     R2,AR6
0570 AB07              MOV     R3,AR7
0572 900000      E     MOV     DPTR,#g_refOld
0575 E0                MOVX    A,@DPTR
0576 FC                MOV     R4,A
0577 A3                INC     DPTR
0578 E0                MOVX    A,@DPTR
0579 FD                MOV     R5,A
057A A3                INC     DPTR
057B E0                MOVX    A,@DPTR
057C FE                MOV     R6,A
057D A3                INC     DPTR
057E E0                MOVX    A,@DPTR
057F C3                CLR     C
0580 9B                SUBB    A,R3
0581 FF                MOV     R7,A
0582 EE                MOV     A,R6
0583 9A                SUBB    A,R2
0584 FE                MOV     R6,A
0585 ED                MOV     A,R5
0586 99                SUBB    A,R1
0587 FD                MOV     R5,A
0588 EC                MOV     A,R4
0589 98                SUBB    A,R0
058A FC                MOV     R4,A
058B 900000      E     MOV     DPTR,#g_ref
058E 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 556
0591 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 558
                                           ; SOURCE LINE # 559
                                           ; SOURCE LINE # 560
                                           ; SOURCE LINE # 562
0594 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 564
0597         ?C0073:
                                           ; SOURCE LINE # 565
0597 900000      E     MOV     DPTR,#g_refOld
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 52  

059A E0                MOVX    A,@DPTR
059B FC                MOV     R4,A
059C A3                INC     DPTR
059D E0                MOVX    A,@DPTR
059E FD                MOV     R5,A
059F A3                INC     DPTR
05A0 E0                MOVX    A,@DPTR
05A1 FE                MOV     R6,A
05A2 A3                INC     DPTR
05A3 E0                MOVX    A,@DPTR
05A4 FF                MOV     R7,A
05A5 900000      E     MOV     DPTR,#g_ref
05A8 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 566
05AB 900000      R     MOV     DPTR,#current_emg
05AE E0                MOVX    A,@DPTR
05AF 14                DEC     A
05B0 6048              JZ      ?C0078
05B2 14                DEC     A
05B3 7003              JNZ     $ + 5H
05B5 020000      R     LJMP    ?C0081
05B8 2402              ADD     A,#02H
05BA 6003              JZ      $ + 5H
05BC 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 568
05BF         ?C0075:
                                           ; SOURCE LINE # 569
05BF E4                CLR     A
05C0 FF                MOV     R7,A
05C1 FE                MOV     R6,A
05C2 FD                MOV     R5,A
05C3 FC                MOV     R4,A
05C4 AB00        R     MOV     R3,err_emg_1+03H
05C6 AA00        R     MOV     R2,err_emg_1+02H
05C8 A900        R     MOV     R1,err_emg_1+01H
05CA A800        R     MOV     R0,err_emg_1
05CC D3                SETB    C
05CD 120000      E     LCALL   ?C?SLCMP
05D0 4009              JC      ?C0076
                                           ; SOURCE LINE # 570
05D2 900000      R     MOV     DPTR,#current_emg
05D5 7401              MOV     A,#01H
05D7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 571
05D8 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 572
05DB         ?C0076:
                                           ; SOURCE LINE # 573
05DB E4                CLR     A
05DC FF                MOV     R7,A
05DD FE                MOV     R6,A
05DE FD                MOV     R5,A
05DF FC                MOV     R4,A
05E0 AB00        R     MOV     R3,err_emg_2+03H
05E2 AA00        R     MOV     R2,err_emg_2+02H
05E4 A900        R     MOV     R1,err_emg_2+01H
05E6 A800        R     MOV     R0,err_emg_2
05E8 D3                SETB    C
05E9 120000      E     LCALL   ?C?SLCMP
05EC 5003              JNC     $ + 5H
05EE 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 574
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 53  

05F1 900000      R     MOV     DPTR,#current_emg
05F4 7402              MOV     A,#02H
05F6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 575
05F7 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 576
                                           ; SOURCE LINE # 577
                                           ; SOURCE LINE # 580
05FA         ?C0078:
                                           ; SOURCE LINE # 582
05FA E4                CLR     A
05FB FF                MOV     R7,A
05FC FE                MOV     R6,A
05FD FD                MOV     R5,A
05FE FC                MOV     R4,A
05FF AB00        R     MOV     R3,err_emg_1+03H
0601 AA00        R     MOV     R2,err_emg_1+02H
0603 A900        R     MOV     R1,err_emg_1+01H
0605 A800        R     MOV     R0,err_emg_1
0607 C3                CLR     C
0608 120000      E     LCALL   ?C?SLCMP
060B 501B              JNC     ?C0079
060D E4                CLR     A
060E FF                MOV     R7,A
060F FE                MOV     R6,A
0610 FD                MOV     R5,A
0611 FC                MOV     R4,A
0612 AB00        R     MOV     R3,err_emg_2+03H
0614 AA00        R     MOV     R2,err_emg_2+02H
0616 A900        R     MOV     R1,err_emg_2+01H
0618 A800        R     MOV     R0,err_emg_2
061A C3                CLR     C
061B 120000      E     LCALL   ?C?SLCMP
061E 5008              JNC     ?C0079
                                           ; SOURCE LINE # 583
0620 E4                CLR     A
0621 900000      R     MOV     DPTR,#current_emg
0624 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 584
0625 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 585
0628         ?C0079:
                                           ; SOURCE LINE # 587
0628 E4                CLR     A
0629 FF                MOV     R7,A
062A FE                MOV     R6,A
062B FD                MOV     R5,A
062C FC                MOV     R4,A
062D AB00        R     MOV     R3,err_emg_1+03H
062F AA00        R     MOV     R2,err_emg_1+02H
0631 A900        R     MOV     R1,err_emg_1+01H
0633 A800        R     MOV     R0,err_emg_1
0635 D3                SETB    C
0636 120000      E     LCALL   ?C?SLCMP
0639 5003              JNC     $ + 5H
063B 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 588
063E 900000      E     MOV     DPTR,#g_mem+078H
0641 E0                MOVX    A,@DPTR
0642 FF                MOV     R7,A
0643 E4                CLR     A
0644 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 54  

0645 FD                MOV     R5,A
0646 FE                MOV     R6,A
0647 A800        R     MOV     R0,err_emg_1
0649 120000      E     LCALL   ?C?LMUL
064C 7802              MOV     R0,#02H
064E 120000      E     LCALL   ?C?LSHL
0651 C006              PUSH    AR6
0653 C007              PUSH    AR7
0655 900000      E     MOV     DPTR,#c_mem+06BH
0658 E0                MOVX    A,@DPTR
0659 FE                MOV     R6,A
065A A3                INC     DPTR
065B E0                MOVX    A,@DPTR
065C FF                MOV     R7,A
065D C3                CLR     C
065E E4                CLR     A
065F 9F                SUBB    A,R7
0660 FF                MOV     R7,A
0661 7404              MOV     A,#04H
0663 9E                SUBB    A,R6
0664 FE                MOV     R6,A
0665 AB07              MOV     R3,AR7
0667 FA                MOV     R2,A
0668 E4                CLR     A
0669 F9                MOV     R1,A
066A F8                MOV     R0,A
066B D007              POP     AR7
066D D006              POP     AR6
066F 120000      E     LCALL   ?C?SLDIV
0672 900000      E     MOV     DPTR,#g_refOld
0675 E0                MOVX    A,@DPTR
0676 F8                MOV     R0,A
0677 A3                INC     DPTR
0678 E0                MOVX    A,@DPTR
0679 F9                MOV     R1,A
067A A3                INC     DPTR
067B E0                MOVX    A,@DPTR
067C FA                MOV     R2,A
067D A3                INC     DPTR
067E E0                MOVX    A,@DPTR
067F 2F                ADD     A,R7
0680 FF                MOV     R7,A
0681 EA                MOV     A,R2
0682 3E                ADDC    A,R6
0683 FE                MOV     R6,A
0684 E9                MOV     A,R1
0685 3D                ADDC    A,R5
0686 FD                MOV     R5,A
0687 E8                MOV     A,R0
0688 3C                ADDC    A,R4
0689 FC                MOV     R4,A
068A 900000      E     MOV     DPTR,#g_ref
068D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 590
0690 020000      R     LJMP    ?C0047
                                           ; SOURCE LINE # 593
0693         ?C0081:
                                           ; SOURCE LINE # 595
0693 E4                CLR     A
0694 FF                MOV     R7,A
0695 FE                MOV     R6,A
0696 FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 55  

0697 FC                MOV     R4,A
0698 AB00        R     MOV     R3,err_emg_1+03H
069A AA00        R     MOV     R2,err_emg_1+02H
069C A900        R     MOV     R1,err_emg_1+01H
069E A800        R     MOV     R0,err_emg_1
06A0 C3                CLR     C
06A1 120000      E     LCALL   ?C?SLCMP
06A4 501A              JNC     ?C0082
06A6 E4                CLR     A
06A7 FF                MOV     R7,A
06A8 FE                MOV     R6,A
06A9 FD                MOV     R5,A
06AA FC                MOV     R4,A
06AB AB00        R     MOV     R3,err_emg_2+03H
06AD AA00        R     MOV     R2,err_emg_2+02H
06AF A900        R     MOV     R1,err_emg_2+01H
06B1 A800        R     MOV     R0,err_emg_2
06B3 C3                CLR     C
06B4 120000      E     LCALL   ?C?SLCMP
06B7 5007              JNC     ?C0082
                                           ; SOURCE LINE # 596
06B9 E4                CLR     A
06BA 900000      R     MOV     DPTR,#current_emg
06BD F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 597
06BE 806E              SJMP    ?C0047
                                           ; SOURCE LINE # 598
06C0         ?C0082:
                                           ; SOURCE LINE # 600
06C0 E4                CLR     A
06C1 FF                MOV     R7,A
06C2 FE                MOV     R6,A
06C3 FD                MOV     R5,A
06C4 FC                MOV     R4,A
06C5 AB00        R     MOV     R3,err_emg_2+03H
06C7 AA00        R     MOV     R2,err_emg_2+02H
06C9 A900        R     MOV     R1,err_emg_2+01H
06CB A800        R     MOV     R0,err_emg_2
06CD D3                SETB    C
06CE 120000      E     LCALL   ?C?SLCMP
06D1 405B              JC      ?C0047
                                           ; SOURCE LINE # 601
06D3 900000      E     MOV     DPTR,#c_mem+078H
06D6 E0                MOVX    A,@DPTR
06D7 FF                MOV     R7,A
06D8 E4                CLR     A
06D9 FC                MOV     R4,A
06DA FD                MOV     R5,A
06DB FE                MOV     R6,A
06DC A800        R     MOV     R0,err_emg_2
06DE 120000      E     LCALL   ?C?LMUL
06E1 7802              MOV     R0,#02H
06E3 120000      E     LCALL   ?C?LSHL
06E6 C006              PUSH    AR6
06E8 C007              PUSH    AR7
06EA 900000      E     MOV     DPTR,#c_mem+06DH
06ED E0                MOVX    A,@DPTR
06EE FE                MOV     R6,A
06EF A3                INC     DPTR
06F0 E0                MOVX    A,@DPTR
06F1 FF                MOV     R7,A
06F2 C3                CLR     C
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 56  

06F3 E4                CLR     A
06F4 9F                SUBB    A,R7
06F5 FF                MOV     R7,A
06F6 7404              MOV     A,#04H
06F8 9E                SUBB    A,R6
06F9 FE                MOV     R6,A
06FA AB07              MOV     R3,AR7
06FC FA                MOV     R2,A
06FD E4                CLR     A
06FE F9                MOV     R1,A
06FF F8                MOV     R0,A
0700 D007              POP     AR7
0702 D006              POP     AR6
0704 120000      E     LCALL   ?C?SLDIV
0707 A804              MOV     R0,AR4
0709 A905              MOV     R1,AR5
070B AA06              MOV     R2,AR6
070D AB07              MOV     R3,AR7
070F 900000      E     MOV     DPTR,#g_refOld
0712 E0                MOVX    A,@DPTR
0713 FC                MOV     R4,A
0714 A3                INC     DPTR
0715 E0                MOVX    A,@DPTR
0716 FD                MOV     R5,A
0717 A3                INC     DPTR
0718 E0                MOVX    A,@DPTR
0719 FE                MOV     R6,A
071A A3                INC     DPTR
071B E0                MOVX    A,@DPTR
071C C3                CLR     C
071D 9B                SUBB    A,R3
071E FF                MOV     R7,A
071F EE                MOV     A,R6
0720 9A                SUBB    A,R2
0721 FE                MOV     R6,A
0722 ED                MOV     A,R5
0723 99                SUBB    A,R1
0724 FD                MOV     R5,A
0725 EC                MOV     A,R4
0726 98                SUBB    A,R0
0727 FC                MOV     R4,A
0728 900000      E     MOV     DPTR,#g_ref
072B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 602
                                           ; SOURCE LINE # 603
                                           ; SOURCE LINE # 605
                                           ; SOURCE LINE # 606
                                           ; SOURCE LINE # 607
                                           ; SOURCE LINE # 609
                                           ; SOURCE LINE # 610
                                           ; SOURCE LINE # 611
072E         ?C0047:
                                           ; SOURCE LINE # 614
072E 900000      E     MOV     DPTR,#c_mem+050H
0731 E0                MOVX    A,@DPTR
0732 606A              JZ      ?C0086
                                           ; SOURCE LINE # 615
0734 A3                INC     DPTR
0735 E0                MOVX    A,@DPTR
0736 FC                MOV     R4,A
0737 A3                INC     DPTR
0738 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 57  

0739 FD                MOV     R5,A
073A A3                INC     DPTR
073B E0                MOVX    A,@DPTR
073C FE                MOV     R6,A
073D A3                INC     DPTR
073E E0                MOVX    A,@DPTR
073F FF                MOV     R7,A
0740 900000      E     MOV     DPTR,#g_ref
0743 E0                MOVX    A,@DPTR
0744 F8                MOV     R0,A
0745 A3                INC     DPTR
0746 E0                MOVX    A,@DPTR
0747 F9                MOV     R1,A
0748 A3                INC     DPTR
0749 E0                MOVX    A,@DPTR
074A FA                MOV     R2,A
074B A3                INC     DPTR
074C E0                MOVX    A,@DPTR
074D FB                MOV     R3,A
074E C3                CLR     C
074F 120000      E     LCALL   ?C?SLCMP
0752 5014              JNC     ?C0087
                                           ; SOURCE LINE # 616
0754 900000      E     MOV     DPTR,#c_mem+051H
0757 E0                MOVX    A,@DPTR
0758 FC                MOV     R4,A
0759 A3                INC     DPTR
075A E0                MOVX    A,@DPTR
075B FD                MOV     R5,A
075C A3                INC     DPTR
075D E0                MOVX    A,@DPTR
075E FE                MOV     R6,A
075F A3                INC     DPTR
0760 E0                MOVX    A,@DPTR
0761 FF                MOV     R7,A
0762 900000      E     MOV     DPTR,#g_ref
0765 120000      E     LCALL   ?C?LSTXDATA
0768         ?C0087:
                                           ; SOURCE LINE # 617
0768 900000      E     MOV     DPTR,#c_mem+059H
076B E0                MOVX    A,@DPTR
076C FC                MOV     R4,A
076D A3                INC     DPTR
076E E0                MOVX    A,@DPTR
076F FD                MOV     R5,A
0770 A3                INC     DPTR
0771 E0                MOVX    A,@DPTR
0772 FE                MOV     R6,A
0773 A3                INC     DPTR
0774 E0                MOVX    A,@DPTR
0775 FF                MOV     R7,A
0776 900000      E     MOV     DPTR,#g_ref
0779 E0                MOVX    A,@DPTR
077A F8                MOV     R0,A
077B A3                INC     DPTR
077C E0                MOVX    A,@DPTR
077D F9                MOV     R1,A
077E A3                INC     DPTR
077F E0                MOVX    A,@DPTR
0780 FA                MOV     R2,A
0781 A3                INC     DPTR
0782 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 58  

0783 FB                MOV     R3,A
0784 D3                SETB    C
0785 120000      E     LCALL   ?C?SLCMP
0788 4014              JC      ?C0086
                                           ; SOURCE LINE # 618
078A 900000      E     MOV     DPTR,#c_mem+059H
078D E0                MOVX    A,@DPTR
078E FC                MOV     R4,A
078F A3                INC     DPTR
0790 E0                MOVX    A,@DPTR
0791 FD                MOV     R5,A
0792 A3                INC     DPTR
0793 E0                MOVX    A,@DPTR
0794 FE                MOV     R6,A
0795 A3                INC     DPTR
0796 E0                MOVX    A,@DPTR
0797 FF                MOV     R7,A
0798 900000      E     MOV     DPTR,#g_ref
079B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 619
079E         ?C0086:
                                           ; SOURCE LINE # 621
079E 900000      E     MOV     DPTR,#c_mem+096H
07A1 E0                MOVX    A,@DPTR
07A2 6401              XRL     A,#01H
07A4 6003              JZ      $ + 5H
07A6 020000      R     LJMP    ?C0089
                                           ; SOURCE LINE # 622
07A9 900000      E     MOV     DPTR,#rest_enabled
07AC E0                MOVX    A,@DPTR
07AD B40114            CJNE    A,#01H,?C0090
                                           ; SOURCE LINE # 624
07B0 900000      E     MOV     DPTR,#rest_pos_curr_ref
07B3 E0                MOVX    A,@DPTR
07B4 FC                MOV     R4,A
07B5 A3                INC     DPTR
07B6 E0                MOVX    A,@DPTR
07B7 FD                MOV     R5,A
07B8 A3                INC     DPTR
07B9 E0                MOVX    A,@DPTR
07BA FE                MOV     R6,A
07BB A3                INC     DPTR
07BC E0                MOVX    A,@DPTR
07BD FF                MOV     R7,A
07BE 900000      E     MOV     DPTR,#g_ref
07C1 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 625
07C4         ?C0090:
                                           ; SOURCE LINE # 627
07C4 900000      E     MOV     DPTR,#forced_open
07C7 E0                MOVX    A,@DPTR
07C8 6401              XRL     A,#01H
07CA 6003              JZ      $ + 5H
07CC 020000      R     LJMP    ?C0089
                                           ; SOURCE LINE # 629
07CF FF                MOV     R7,A
07D0 FE                MOV     R6,A
07D1 FD                MOV     R5,A
07D2 FC                MOV     R4,A
07D3 AB00        R     MOV     R3,err_emg_2+03H
07D5 AA00        R     MOV     R2,err_emg_2+02H
07D7 A900        R     MOV     R1,err_emg_2+01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 59  

07D9 A800        R     MOV     R0,err_emg_2
07DB D3                SETB    C
07DC 120000      E     LCALL   ?C?SLCMP
07DF 405D              JC      ?C0092
                                           ; SOURCE LINE # 630
07E1 900000      E     MOV     DPTR,#g_mem+097H
07E4 E0                MOVX    A,@DPTR
07E5 FC                MOV     R4,A
07E6 A3                INC     DPTR
07E7 E0                MOVX    A,@DPTR
07E8 FD                MOV     R5,A
07E9 A3                INC     DPTR
07EA E0                MOVX    A,@DPTR
07EB FE                MOV     R6,A
07EC A3                INC     DPTR
07ED E0                MOVX    A,@DPTR
07EE FF                MOV     R7,A
07EF A800        R     MOV     R0,err_emg_2
07F1 120000      E     LCALL   ?C?LMUL
07F4 C006              PUSH    AR6
07F6 C007              PUSH    AR7
07F8 900000      E     MOV     DPTR,#c_mem+06DH
07FB E0                MOVX    A,@DPTR
07FC FE                MOV     R6,A
07FD A3                INC     DPTR
07FE E0                MOVX    A,@DPTR
07FF FF                MOV     R7,A
0800 C3                CLR     C
0801 E4                CLR     A
0802 9F                SUBB    A,R7
0803 FF                MOV     R7,A
0804 7404              MOV     A,#04H
0806 9E                SUBB    A,R6
0807 FE                MOV     R6,A
0808 AB07              MOV     R3,AR7
080A FA                MOV     R2,A
080B E4                CLR     A
080C F9                MOV     R1,A
080D F8                MOV     R0,A
080E D007              POP     AR7
0810 D006              POP     AR6
0812 120000      E     LCALL   ?C?SLDIV
0815 A804              MOV     R0,AR4
0817 A905              MOV     R1,AR5
0819 AA06              MOV     R2,AR6
081B AB07              MOV     R3,AR7
081D 900000      E     MOV     DPTR,#g_mem+097H
0820 E0                MOVX    A,@DPTR
0821 FC                MOV     R4,A
0822 A3                INC     DPTR
0823 E0                MOVX    A,@DPTR
0824 FD                MOV     R5,A
0825 A3                INC     DPTR
0826 E0                MOVX    A,@DPTR
0827 FE                MOV     R6,A
0828 A3                INC     DPTR
0829 E0                MOVX    A,@DPTR
082A C3                CLR     C
082B 9B                SUBB    A,R3
082C FF                MOV     R7,A
082D EE                MOV     A,R6
082E 9A                SUBB    A,R2
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 60  

082F FE                MOV     R6,A
0830 ED                MOV     A,R5
0831 99                SUBB    A,R1
0832 FD                MOV     R5,A
0833 EC                MOV     A,R4
0834 98                SUBB    A,R0
0835 FC                MOV     R4,A
0836 900000      E     MOV     DPTR,#g_ref
0839 120000      E     LCALL   ?C?LSTXDATA
083C 8019              SJMP    ?C0089
083E         ?C0092:
                                           ; SOURCE LINE # 631
                                           ; SOURCE LINE # 632
083E 900000      E     MOV     DPTR,#g_mem+097H
0841 E0                MOVX    A,@DPTR
0842 FC                MOV     R4,A
0843 A3                INC     DPTR
0844 E0                MOVX    A,@DPTR
0845 FD                MOV     R5,A
0846 A3                INC     DPTR
0847 E0                MOVX    A,@DPTR
0848 FE                MOV     R6,A
0849 A3                INC     DPTR
084A E0                MOVX    A,@DPTR
084B FF                MOV     R7,A
084C 900000      E     MOV     DPTR,#g_ref
084F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 633
0852 E4                CLR     A
0853 900000      E     MOV     DPTR,#forced_open
0856 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 634
                                           ; SOURCE LINE # 635
                                           ; SOURCE LINE # 636
0857         ?C0089:
                                           ; SOURCE LINE # 638
0857 900000      E     MOV     DPTR,#c_mem+034H
085A E0                MOVX    A,@DPTR
085B 7003              JNZ     $ + 5H
085D 020000      R     LJMP    ?C0116
0860 14                DEC     A
0861 7003              JNZ     $ + 5H
0863 020000      R     LJMP    ?C0138
0866 14                DEC     A
0867 7003              JNZ     $ + 5H
0869 020000      R     LJMP    ?C0125
086C 14                DEC     A
086D 6003              JZ      $ + 5H
086F 020000      R     LJMP    ?C0094
                                           ; SOURCE LINE # 640
0872         ?C0095:
                                           ; SOURCE LINE # 641
0872 900000      E     MOV     DPTR,#g_meas
0875 E0                MOVX    A,@DPTR
0876 F8                MOV     R0,A
0877 A3                INC     DPTR
0878 E0                MOVX    A,@DPTR
0879 F9                MOV     R1,A
087A A3                INC     DPTR
087B E0                MOVX    A,@DPTR
087C FA                MOV     R2,A
087D A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 61  

087E E0                MOVX    A,@DPTR
087F FB                MOV     R3,A
0880 900000      E     MOV     DPTR,#g_ref
0883 E0                MOVX    A,@DPTR
0884 FC                MOV     R4,A
0885 A3                INC     DPTR
0886 E0                MOVX    A,@DPTR
0887 FD                MOV     R5,A
0888 A3                INC     DPTR
0889 E0                MOVX    A,@DPTR
088A FE                MOV     R6,A
088B A3                INC     DPTR
088C E0                MOVX    A,@DPTR
088D C3                CLR     C
088E 9B                SUBB    A,R3
088F F500        R     MOV     pos_error+03H,A
0891 EE                MOV     A,R6
0892 9A                SUBB    A,R2
0893 F500        R     MOV     pos_error+02H,A
0895 ED                MOV     A,R5
0896 99                SUBB    A,R1
0897 F500        R     MOV     pos_error+01H,A
0899 EC                MOV     A,R4
089A 98                SUBB    A,R0
089B F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 643
089D 900000      R     MOV     DPTR,#pos_error_sum
08A0 E0                MOVX    A,@DPTR
08A1 FC                MOV     R4,A
08A2 A3                INC     DPTR
08A3 E0                MOVX    A,@DPTR
08A4 FD                MOV     R5,A
08A5 A3                INC     DPTR
08A6 E0                MOVX    A,@DPTR
08A7 FE                MOV     R6,A
08A8 A3                INC     DPTR
08A9 E0                MOVX    A,@DPTR
08AA 2500        R     ADD     A,pos_error+03H
08AC FF                MOV     R7,A
08AD EE                MOV     A,R6
08AE 3500        R     ADDC    A,pos_error+02H
08B0 FE                MOV     R6,A
08B1 ED                MOV     A,R5
08B2 3500        R     ADDC    A,pos_error+01H
08B4 FD                MOV     R5,A
08B5 EC                MOV     A,R4
08B6 3500        R     ADDC    A,pos_error
08B8 FC                MOV     R4,A
08B9 900000      R     MOV     DPTR,#pos_error_sum
08BC 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 646
08BF 7F80              MOV     R7,#080H
08C1 7EF0              MOV     R6,#0F0H
08C3 7DFA              MOV     R5,#0FAH
08C5 7C02              MOV     R4,#02H
08C7 900000      R     MOV     DPTR,#pos_error_sum
08CA E0                MOVX    A,@DPTR
08CB F8                MOV     R0,A
08CC A3                INC     DPTR
08CD E0                MOVX    A,@DPTR
08CE F9                MOV     R1,A
08CF A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 62  

08D0 E0                MOVX    A,@DPTR
08D1 FA                MOV     R2,A
08D2 A3                INC     DPTR
08D3 E0                MOVX    A,@DPTR
08D4 FB                MOV     R3,A
08D5 D3                SETB    C
08D6 120000      E     LCALL   ?C?SLCMP
08D9 4010              JC      ?C0096
                                           ; SOURCE LINE # 647
08DB 7F80              MOV     R7,#080H
08DD 7EF0              MOV     R6,#0F0H
08DF 7DFA              MOV     R5,#0FAH
08E1 7C02              MOV     R4,#02H
08E3 900000      R     MOV     DPTR,#pos_error_sum
08E6 120000      E     LCALL   ?C?LSTXDATA
08E9 802A              SJMP    ?C0097
08EB         ?C0096:
                                           ; SOURCE LINE # 648
                                           ; SOURCE LINE # 649
08EB 7F80              MOV     R7,#080H
08ED 7E0F              MOV     R6,#0FH
08EF 7D05              MOV     R5,#05H
08F1 7CFD              MOV     R4,#0FDH
08F3 900000      R     MOV     DPTR,#pos_error_sum
08F6 E0                MOVX    A,@DPTR
08F7 F8                MOV     R0,A
08F8 A3                INC     DPTR
08F9 E0                MOVX    A,@DPTR
08FA F9                MOV     R1,A
08FB A3                INC     DPTR
08FC E0                MOVX    A,@DPTR
08FD FA                MOV     R2,A
08FE A3                INC     DPTR
08FF E0                MOVX    A,@DPTR
0900 FB                MOV     R3,A
0901 C3                CLR     C
0902 120000      E     LCALL   ?C?SLCMP
0905 500E              JNC     ?C0097
                                           ; SOURCE LINE # 650
0907 7F80              MOV     R7,#080H
0909 7E0F              MOV     R6,#0FH
090B 7D05              MOV     R5,#05H
090D 7CFD              MOV     R4,#0FDH
090F 900000      R     MOV     DPTR,#pos_error_sum
0912 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 651
0915         ?C0097:
                                           ; SOURCE LINE # 655
0915 E4                CLR     A
0916 F500        R     MOV     i_ref+03H,A
0918 F500        R     MOV     i_ref+02H,A
091A F500        R     MOV     i_ref+01H,A
091C F500        R     MOV     i_ref,A
                                           ; SOURCE LINE # 658
091E FF                MOV     R7,A
091F FE                MOV     R6,A
0920 FD                MOV     R5,A
0921 FC                MOV     R4,A
0922 AB00        R     MOV     R3,k_p_dl+03H
0924 AA00        R     MOV     R2,k_p_dl+02H
0926 A900        R     MOV     R1,k_p_dl+01H
0928 A800        R     MOV     R0,k_p_dl
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 63  

092A C3                CLR     C
092B 120000      E     LCALL   ?C?SLCMP
092E 6026              JZ      ?C0099
                                           ; SOURCE LINE # 659
0930 AF00        R     MOV     R7,pos_error+03H
0932 AE00        R     MOV     R6,pos_error+02H
0934 AD00        R     MOV     R5,pos_error+01H
0936 AC00        R     MOV     R4,pos_error
0938 A800        R     MOV     R0,k_p_dl
093A 120000      E     LCALL   ?C?LMUL
093D 7810              MOV     R0,#010H
093F 120000      E     LCALL   ?C?SLSHR
0942 E500        R     MOV     A,i_ref+03H
0944 2F                ADD     A,R7
0945 F500        R     MOV     i_ref+03H,A
0947 E500        R     MOV     A,i_ref+02H
0949 3E                ADDC    A,R6
094A F500        R     MOV     i_ref+02H,A
094C E500        R     MOV     A,i_ref+01H
094E 3D                ADDC    A,R5
094F F500        R     MOV     i_ref+01H,A
0951 E500        R     MOV     A,i_ref
0953 3C                ADDC    A,R4
0954 F500        R     MOV     i_ref,A
0956         ?C0099:
                                           ; SOURCE LINE # 662
0956 E4                CLR     A
0957 FF                MOV     R7,A
0958 FE                MOV     R6,A
0959 FD                MOV     R5,A
095A FC                MOV     R4,A
095B AB00        R     MOV     R3,k_i_dl+03H
095D AA00        R     MOV     R2,k_i_dl+02H
095F A900        R     MOV     R1,k_i_dl+01H
0961 A800        R     MOV     R0,k_i_dl
0963 C3                CLR     C
0964 120000      E     LCALL   ?C?SLCMP
0967 602C              JZ      ?C0100
                                           ; SOURCE LINE # 663
0969 900000      R     MOV     DPTR,#pos_error_sum
096C E0                MOVX    A,@DPTR
096D FC                MOV     R4,A
096E A3                INC     DPTR
096F E0                MOVX    A,@DPTR
0970 FD                MOV     R5,A
0971 A3                INC     DPTR
0972 E0                MOVX    A,@DPTR
0973 FE                MOV     R6,A
0974 A3                INC     DPTR
0975 E0                MOVX    A,@DPTR
0976 FF                MOV     R7,A
0977 A800        R     MOV     R0,k_i_dl
0979 120000      E     LCALL   ?C?LMUL
097C 7810              MOV     R0,#010H
097E 120000      E     LCALL   ?C?SLSHR
0981 E500        R     MOV     A,i_ref+03H
0983 2F                ADD     A,R7
0984 F500        R     MOV     i_ref+03H,A
0986 E500        R     MOV     A,i_ref+02H
0988 3E                ADDC    A,R6
0989 F500        R     MOV     i_ref+02H,A
098B E500        R     MOV     A,i_ref+01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 64  

098D 3D                ADDC    A,R5
098E F500        R     MOV     i_ref+01H,A
0990 E500        R     MOV     A,i_ref
0992 3C                ADDC    A,R4
0993 F500        R     MOV     i_ref,A
0995         ?C0100:
                                           ; SOURCE LINE # 666
0995 E4                CLR     A
0996 FF                MOV     R7,A
0997 FE                MOV     R6,A
0998 FD                MOV     R5,A
0999 FC                MOV     R4,A
099A AB00        R     MOV     R3,k_d_dl+03H
099C AA00        R     MOV     R2,k_d_dl+02H
099E A900        R     MOV     R1,k_d_dl+01H
09A0 A800        R     MOV     R0,k_d_dl
09A2 C3                CLR     C
09A3 120000      E     LCALL   ?C?SLCMP
09A6 6043              JZ      ?C0101
                                           ; SOURCE LINE # 667
09A8 900000      R     MOV     DPTR,#prev_pos_err
09AB E0                MOVX    A,@DPTR
09AC F8                MOV     R0,A
09AD A3                INC     DPTR
09AE E0                MOVX    A,@DPTR
09AF F9                MOV     R1,A
09B0 A3                INC     DPTR
09B1 E0                MOVX    A,@DPTR
09B2 FA                MOV     R2,A
09B3 A3                INC     DPTR
09B4 E0                MOVX    A,@DPTR
09B5 FB                MOV     R3,A
09B6 C3                CLR     C
09B7 E500        R     MOV     A,pos_error+03H
09B9 9B                SUBB    A,R3
09BA FF                MOV     R7,A
09BB E500        R     MOV     A,pos_error+02H
09BD 9A                SUBB    A,R2
09BE FE                MOV     R6,A
09BF E500        R     MOV     A,pos_error+01H
09C1 99                SUBB    A,R1
09C2 FD                MOV     R5,A
09C3 E500        R     MOV     A,pos_error
09C5 98                SUBB    A,R0
09C6 FC                MOV     R4,A
09C7 AB00        R     MOV     R3,k_d_dl+03H
09C9 AA00        R     MOV     R2,k_d_dl+02H
09CB A900        R     MOV     R1,k_d_dl+01H
09CD A800        R     MOV     R0,k_d_dl
09CF 120000      E     LCALL   ?C?LMUL
09D2 7810              MOV     R0,#010H
09D4 120000      E     LCALL   ?C?SLSHR
09D7 E500        R     MOV     A,i_ref+03H
09D9 2F                ADD     A,R7
09DA F500        R     MOV     i_ref+03H,A
09DC E500        R     MOV     A,i_ref+02H
09DE 3E                ADDC    A,R6
09DF F500        R     MOV     i_ref+02H,A
09E1 E500        R     MOV     A,i_ref+01H
09E3 3D                ADDC    A,R5
09E4 F500        R     MOV     i_ref+01H,A
09E6 E500        R     MOV     A,i_ref
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 65  

09E8 3C                ADDC    A,R4
09E9 F500        R     MOV     i_ref,A
09EB         ?C0101:
                                           ; SOURCE LINE # 670
09EB AF00        R     MOV     R7,pos_error+03H
09ED AE00        R     MOV     R6,pos_error+02H
09EF AD00        R     MOV     R5,pos_error+01H
09F1 AC00        R     MOV     R4,pos_error
09F3 900000      R     MOV     DPTR,#prev_pos_err
09F6 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 673
09F9 E4                CLR     A
09FA FF                MOV     R7,A
09FB FE                MOV     R6,A
09FC FD                MOV     R5,A
09FD FC                MOV     R4,A
09FE AB00        R     MOV     R3,i_ref+03H
0A00 AA00        R     MOV     R2,i_ref+02H
0A02 A900        R     MOV     R1,i_ref+01H
0A04 A800        R     MOV     R0,i_ref
0A06 C3                CLR     C
0A07 120000      E     LCALL   ?C?SLCMP
0A0A 4004              JC      ?C0102
                                           ; SOURCE LINE # 674
0A0C D200        R     SETB    motor_dir
0A0E 8002              SJMP    ?C0103
0A10         ?C0102:
                                           ; SOURCE LINE # 676
0A10 C200        R     CLR     motor_dir
0A12         ?C0103:
                                           ; SOURCE LINE # 679
0A12 900000      E     MOV     DPTR,#c_mem+069H
0A15 E0                MOVX    A,@DPTR
0A16 FE                MOV     R6,A
0A17 A3                INC     DPTR
0A18 E0                MOVX    A,@DPTR
0A19 FF                MOV     R7,A
0A1A EE                MOV     A,R6
0A1B 33                RLC     A
0A1C 95E0              SUBB    A,ACC
0A1E FD                MOV     R5,A
0A1F FC                MOV     R4,A
0A20 AB00        R     MOV     R3,i_ref+03H
0A22 AA00        R     MOV     R2,i_ref+02H
0A24 A900        R     MOV     R1,i_ref+01H
0A26 A800        R     MOV     R0,i_ref
0A28 D3                SETB    C
0A29 120000      E     LCALL   ?C?SLCMP
0A2C 4016              JC      ?C0104
                                           ; SOURCE LINE # 680
0A2E 900000      E     MOV     DPTR,#c_mem+069H
0A31 E0                MOVX    A,@DPTR
0A32 FE                MOV     R6,A
0A33 A3                INC     DPTR
0A34 E0                MOVX    A,@DPTR
0A35 FF                MOV     R7,A
0A36 EE                MOV     A,R6
0A37 33                RLC     A
0A38 95E0              SUBB    A,ACC
0A3A 8F00        R     MOV     i_ref+03H,R7
0A3C 8E00        R     MOV     i_ref+02H,R6
0A3E F500        R     MOV     i_ref+01H,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 66  

0A40 F500        R     MOV     i_ref,A
0A42 803C              SJMP    ?C0105
0A44         ?C0104:
                                           ; SOURCE LINE # 682
0A44 900000      E     MOV     DPTR,#c_mem+069H
0A47 E0                MOVX    A,@DPTR
0A48 FE                MOV     R6,A
0A49 A3                INC     DPTR
0A4A E0                MOVX    A,@DPTR
0A4B FF                MOV     R7,A
0A4C C3                CLR     C
0A4D E4                CLR     A
0A4E 9F                SUBB    A,R7
0A4F FF                MOV     R7,A
0A50 E4                CLR     A
0A51 9E                SUBB    A,R6
0A52 FE                MOV     R6,A
0A53 33                RLC     A
0A54 95E0              SUBB    A,ACC
0A56 FD                MOV     R5,A
0A57 FC                MOV     R4,A
0A58 AB00        R     MOV     R3,i_ref+03H
0A5A AA00        R     MOV     R2,i_ref+02H
0A5C A900        R     MOV     R1,i_ref+01H
0A5E A800        R     MOV     R0,i_ref
0A60 C3                CLR     C
0A61 120000      E     LCALL   ?C?SLCMP
0A64 501A              JNC     ?C0105
                                           ; SOURCE LINE # 683
0A66 900000      E     MOV     DPTR,#c_mem+069H
0A69 E0                MOVX    A,@DPTR
0A6A FE                MOV     R6,A
0A6B A3                INC     DPTR
0A6C E0                MOVX    A,@DPTR
0A6D FF                MOV     R7,A
0A6E C3                CLR     C
0A6F E4                CLR     A
0A70 9F                SUBB    A,R7
0A71 FF                MOV     R7,A
0A72 E4                CLR     A
0A73 9E                SUBB    A,R6
0A74 FE                MOV     R6,A
0A75 33                RLC     A
0A76 95E0              SUBB    A,ACC
0A78 8F00        R     MOV     i_ref+03H,R7
0A7A 8E00        R     MOV     i_ref+02H,R6
0A7C F500        R     MOV     i_ref+01H,A
0A7E F500        R     MOV     i_ref,A
0A80         ?C0105:
                                           ; SOURCE LINE # 686
0A80 900000      E     MOV     DPTR,#g_meas+0CH
0A83 E0                MOVX    A,@DPTR
0A84 F8                MOV     R0,A
0A85 A3                INC     DPTR
0A86 E0                MOVX    A,@DPTR
0A87 F9                MOV     R1,A
0A88 A3                INC     DPTR
0A89 E0                MOVX    A,@DPTR
0A8A FA                MOV     R2,A
0A8B A3                INC     DPTR
0A8C E0                MOVX    A,@DPTR
0A8D FB                MOV     R3,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 67  

0A8E C3                CLR     C
0A8F E500        R     MOV     A,i_ref+03H
0A91 9B                SUBB    A,R3
0A92 F500        R     MOV     curr_error+03H,A
0A94 E500        R     MOV     A,i_ref+02H
0A96 9A                SUBB    A,R2
0A97 F500        R     MOV     curr_error+02H,A
0A99 E500        R     MOV     A,i_ref+01H
0A9B 99                SUBB    A,R1
0A9C F500        R     MOV     curr_error+01H,A
0A9E E500        R     MOV     A,i_ref
0AA0 98                SUBB    A,R0
0AA1 F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 687
0AA3 900000      R     MOV     DPTR,#curr_error_sum
0AA6 E0                MOVX    A,@DPTR
0AA7 FC                MOV     R4,A
0AA8 A3                INC     DPTR
0AA9 E0                MOVX    A,@DPTR
0AAA FD                MOV     R5,A
0AAB A3                INC     DPTR
0AAC E0                MOVX    A,@DPTR
0AAD FE                MOV     R6,A
0AAE A3                INC     DPTR
0AAF E0                MOVX    A,@DPTR
0AB0 2500        R     ADD     A,curr_error+03H
0AB2 FF                MOV     R7,A
0AB3 EE                MOV     A,R6
0AB4 3500        R     ADDC    A,curr_error+02H
0AB6 FE                MOV     R6,A
0AB7 ED                MOV     A,R5
0AB8 3500        R     ADDC    A,curr_error+01H
0ABA FD                MOV     R5,A
0ABB EC                MOV     A,R4
0ABC 3500        R     ADDC    A,curr_error
0ABE FC                MOV     R4,A
0ABF 900000      R     MOV     DPTR,#curr_error_sum
0AC2 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 689
0AC5 7FA0              MOV     R7,#0A0H
0AC7 7E86              MOV     R6,#086H
0AC9 7D01              MOV     R5,#01H
0ACB 7C00              MOV     R4,#00H
0ACD 900000      R     MOV     DPTR,#curr_error_sum
0AD0 E0                MOVX    A,@DPTR
0AD1 F8                MOV     R0,A
0AD2 A3                INC     DPTR
0AD3 E0                MOVX    A,@DPTR
0AD4 F9                MOV     R1,A
0AD5 A3                INC     DPTR
0AD6 E0                MOVX    A,@DPTR
0AD7 FA                MOV     R2,A
0AD8 A3                INC     DPTR
0AD9 E0                MOVX    A,@DPTR
0ADA FB                MOV     R3,A
0ADB D3                SETB    C
0ADC 120000      E     LCALL   ?C?SLCMP
0ADF 4010              JC      ?C0107
                                           ; SOURCE LINE # 690
0AE1 7FA0              MOV     R7,#0A0H
0AE3 7E86              MOV     R6,#086H
0AE5 7D01              MOV     R5,#01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 68  

0AE7 7C00              MOV     R4,#00H
0AE9 900000      R     MOV     DPTR,#curr_error_sum
0AEC 120000      E     LCALL   ?C?LSTXDATA
0AEF 802A              SJMP    ?C0108
0AF1         ?C0107:
                                           ; SOURCE LINE # 691
                                           ; SOURCE LINE # 692
0AF1 7F60              MOV     R7,#060H
0AF3 7E79              MOV     R6,#079H
0AF5 7DFE              MOV     R5,#0FEH
0AF7 7CFF              MOV     R4,#0FFH
0AF9 900000      R     MOV     DPTR,#curr_error_sum
0AFC E0                MOVX    A,@DPTR
0AFD F8                MOV     R0,A
0AFE A3                INC     DPTR
0AFF E0                MOVX    A,@DPTR
0B00 F9                MOV     R1,A
0B01 A3                INC     DPTR
0B02 E0                MOVX    A,@DPTR
0B03 FA                MOV     R2,A
0B04 A3                INC     DPTR
0B05 E0                MOVX    A,@DPTR
0B06 FB                MOV     R3,A
0B07 C3                CLR     C
0B08 120000      E     LCALL   ?C?SLCMP
0B0B 500E              JNC     ?C0108
                                           ; SOURCE LINE # 693
0B0D 7F60              MOV     R7,#060H
0B0F 7E79              MOV     R6,#079H
0B11 7DFE              MOV     R5,#0FEH
0B13 7CFF              MOV     R4,#0FFH
0B15 900000      R     MOV     DPTR,#curr_error_sum
0B18 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 694
0B1B         ?C0108:
                                           ; SOURCE LINE # 698
0B1B E4                CLR     A
0B1C F500        R     MOV     pwm_input+03H,A
0B1E F500        R     MOV     pwm_input+02H,A
0B20 F500        R     MOV     pwm_input+01H,A
0B22 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 701
0B24 FF                MOV     R7,A
0B25 FE                MOV     R6,A
0B26 FD                MOV     R5,A
0B27 FC                MOV     R4,A
0B28 AB00        R     MOV     R3,k_p_c_dl+03H
0B2A AA00        R     MOV     R2,k_p_c_dl+02H
0B2C A900        R     MOV     R1,k_p_c_dl+01H
0B2E A800        R     MOV     R0,k_p_c_dl
0B30 C3                CLR     C
0B31 120000      E     LCALL   ?C?SLCMP
0B34 6026              JZ      ?C0110
                                           ; SOURCE LINE # 702
0B36 AF00        R     MOV     R7,curr_error+03H
0B38 AE00        R     MOV     R6,curr_error+02H
0B3A AD00        R     MOV     R5,curr_error+01H
0B3C AC00        R     MOV     R4,curr_error
0B3E A800        R     MOV     R0,k_p_c_dl
0B40 120000      E     LCALL   ?C?LMUL
0B43 7810              MOV     R0,#010H
0B45 120000      E     LCALL   ?C?SLSHR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 69  

0B48 E500        R     MOV     A,pwm_input+03H
0B4A 2F                ADD     A,R7
0B4B F500        R     MOV     pwm_input+03H,A
0B4D E500        R     MOV     A,pwm_input+02H
0B4F 3E                ADDC    A,R6
0B50 F500        R     MOV     pwm_input+02H,A
0B52 E500        R     MOV     A,pwm_input+01H
0B54 3D                ADDC    A,R5
0B55 F500        R     MOV     pwm_input+01H,A
0B57 E500        R     MOV     A,pwm_input
0B59 3C                ADDC    A,R4
0B5A F500        R     MOV     pwm_input,A
0B5C         ?C0110:
                                           ; SOURCE LINE # 705
0B5C E4                CLR     A
0B5D FF                MOV     R7,A
0B5E FE                MOV     R6,A
0B5F FD                MOV     R5,A
0B60 FC                MOV     R4,A
0B61 AB00        R     MOV     R3,k_i_c_dl+03H
0B63 AA00        R     MOV     R2,k_i_c_dl+02H
0B65 A900        R     MOV     R1,k_i_c_dl+01H
0B67 A800        R     MOV     R0,k_i_c_dl
0B69 C3                CLR     C
0B6A 120000      E     LCALL   ?C?SLCMP
0B6D 602C              JZ      ?C0111
                                           ; SOURCE LINE # 706
0B6F 900000      R     MOV     DPTR,#curr_error_sum
0B72 E0                MOVX    A,@DPTR
0B73 FC                MOV     R4,A
0B74 A3                INC     DPTR
0B75 E0                MOVX    A,@DPTR
0B76 FD                MOV     R5,A
0B77 A3                INC     DPTR
0B78 E0                MOVX    A,@DPTR
0B79 FE                MOV     R6,A
0B7A A3                INC     DPTR
0B7B E0                MOVX    A,@DPTR
0B7C FF                MOV     R7,A
0B7D A800        R     MOV     R0,k_i_c_dl
0B7F 120000      E     LCALL   ?C?LMUL
0B82 7810              MOV     R0,#010H
0B84 120000      E     LCALL   ?C?SLSHR
0B87 E500        R     MOV     A,pwm_input+03H
0B89 2F                ADD     A,R7
0B8A F500        R     MOV     pwm_input+03H,A
0B8C E500        R     MOV     A,pwm_input+02H
0B8E 3E                ADDC    A,R6
0B8F F500        R     MOV     pwm_input+02H,A
0B91 E500        R     MOV     A,pwm_input+01H
0B93 3D                ADDC    A,R5
0B94 F500        R     MOV     pwm_input+01H,A
0B96 E500        R     MOV     A,pwm_input
0B98 3C                ADDC    A,R4
0B99 F500        R     MOV     pwm_input,A
0B9B         ?C0111:
                                           ; SOURCE LINE # 709
0B9B E4                CLR     A
0B9C FF                MOV     R7,A
0B9D FE                MOV     R6,A
0B9E FD                MOV     R5,A
0B9F FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 70  

0BA0 AB00        R     MOV     R3,k_d_c_dl+03H
0BA2 AA00        R     MOV     R2,k_d_c_dl+02H
0BA4 A900        R     MOV     R1,k_d_c_dl+01H
0BA6 A800        R     MOV     R0,k_d_c_dl
0BA8 C3                CLR     C
0BA9 120000      E     LCALL   ?C?SLCMP
0BAC 6043              JZ      ?C0112
                                           ; SOURCE LINE # 710
0BAE 900000      R     MOV     DPTR,#prev_curr_err
0BB1 E0                MOVX    A,@DPTR
0BB2 F8                MOV     R0,A
0BB3 A3                INC     DPTR
0BB4 E0                MOVX    A,@DPTR
0BB5 F9                MOV     R1,A
0BB6 A3                INC     DPTR
0BB7 E0                MOVX    A,@DPTR
0BB8 FA                MOV     R2,A
0BB9 A3                INC     DPTR
0BBA E0                MOVX    A,@DPTR
0BBB FB                MOV     R3,A
0BBC C3                CLR     C
0BBD E500        R     MOV     A,curr_error+03H
0BBF 9B                SUBB    A,R3
0BC0 FF                MOV     R7,A
0BC1 E500        R     MOV     A,curr_error+02H
0BC3 9A                SUBB    A,R2
0BC4 FE                MOV     R6,A
0BC5 E500        R     MOV     A,curr_error+01H
0BC7 99                SUBB    A,R1
0BC8 FD                MOV     R5,A
0BC9 E500        R     MOV     A,curr_error
0BCB 98                SUBB    A,R0
0BCC FC                MOV     R4,A
0BCD AB00        R     MOV     R3,k_d_c_dl+03H
0BCF AA00        R     MOV     R2,k_d_c_dl+02H
0BD1 A900        R     MOV     R1,k_d_c_dl+01H
0BD3 A800        R     MOV     R0,k_d_c_dl
0BD5 120000      E     LCALL   ?C?LMUL
0BD8 7810              MOV     R0,#010H
0BDA 120000      E     LCALL   ?C?SLSHR
0BDD E500        R     MOV     A,pwm_input+03H
0BDF 2F                ADD     A,R7
0BE0 F500        R     MOV     pwm_input+03H,A
0BE2 E500        R     MOV     A,pwm_input+02H
0BE4 3E                ADDC    A,R6
0BE5 F500        R     MOV     pwm_input+02H,A
0BE7 E500        R     MOV     A,pwm_input+01H
0BE9 3D                ADDC    A,R5
0BEA F500        R     MOV     pwm_input+01H,A
0BEC E500        R     MOV     A,pwm_input
0BEE 3C                ADDC    A,R4
0BEF F500        R     MOV     pwm_input,A
0BF1         ?C0112:
                                           ; SOURCE LINE # 713
0BF1 74FF              MOV     A,#0FFH
0BF3 7F9C              MOV     R7,#09CH
0BF5 FE                MOV     R6,A
0BF6 FD                MOV     R5,A
0BF7 FC                MOV     R4,A
0BF8 AB00        R     MOV     R3,pwm_input+03H
0BFA AA00        R     MOV     R2,pwm_input+02H
0BFC A900        R     MOV     R1,pwm_input+01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 71  

0BFE A800        R     MOV     R0,pwm_input
0C00 C3                CLR     C
0C01 120000      E     LCALL   ?C?SLCMP
0C04 500D              JNC     ?C0113
                                           ; SOURCE LINE # 714
0C06 74FF              MOV     A,#0FFH
0C08 75009C      R     MOV     pwm_input+03H,#09CH
0C0B F500        R     MOV     pwm_input+02H,A
0C0D F500        R     MOV     pwm_input+01H,A
0C0F F500        R     MOV     pwm_input,A
0C11 801E              SJMP    ?C0114
0C13         ?C0113:
                                           ; SOURCE LINE # 715
                                           ; SOURCE LINE # 716
0C13 E4                CLR     A
0C14 7F64              MOV     R7,#064H
0C16 FE                MOV     R6,A
0C17 FD                MOV     R5,A
0C18 FC                MOV     R4,A
0C19 AB00        R     MOV     R3,pwm_input+03H
0C1B AA00        R     MOV     R2,pwm_input+02H
0C1D A900        R     MOV     R1,pwm_input+01H
0C1F A800        R     MOV     R0,pwm_input
0C21 D3                SETB    C
0C22 120000      E     LCALL   ?C?SLCMP
0C25 400A              JC      ?C0114
                                           ; SOURCE LINE # 717
0C27 E4                CLR     A
0C28 750064      R     MOV     pwm_input+03H,#064H
0C2B F500        R     MOV     pwm_input+02H,A
0C2D F500        R     MOV     pwm_input+01H,A
0C2F F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 718
0C31         ?C0114:
                                           ; SOURCE LINE # 721
0C31 AF00        R     MOV     R7,curr_error+03H
0C33 AE00        R     MOV     R6,curr_error+02H
0C35 AD00        R     MOV     R5,curr_error+01H
0C37 AC00        R     MOV     R4,curr_error
0C39 900000      R     MOV     DPTR,#prev_curr_err
0C3C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 723
0C3F 020000      R     LJMP    ?C0094
                                           ; SOURCE LINE # 726
0C42         ?C0116:
                                           ; SOURCE LINE # 727
0C42 900000      E     MOV     DPTR,#g_meas
0C45 E0                MOVX    A,@DPTR
0C46 F8                MOV     R0,A
0C47 A3                INC     DPTR
0C48 E0                MOVX    A,@DPTR
0C49 F9                MOV     R1,A
0C4A A3                INC     DPTR
0C4B E0                MOVX    A,@DPTR
0C4C FA                MOV     R2,A
0C4D A3                INC     DPTR
0C4E E0                MOVX    A,@DPTR
0C4F FB                MOV     R3,A
0C50 900000      E     MOV     DPTR,#g_ref
0C53 E0                MOVX    A,@DPTR
0C54 FC                MOV     R4,A
0C55 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 72  

0C56 E0                MOVX    A,@DPTR
0C57 FD                MOV     R5,A
0C58 A3                INC     DPTR
0C59 E0                MOVX    A,@DPTR
0C5A FE                MOV     R6,A
0C5B A3                INC     DPTR
0C5C E0                MOVX    A,@DPTR
0C5D C3                CLR     C
0C5E 9B                SUBB    A,R3
0C5F F500        R     MOV     pos_error+03H,A
0C61 EE                MOV     A,R6
0C62 9A                SUBB    A,R2
0C63 F500        R     MOV     pos_error+02H,A
0C65 ED                MOV     A,R5
0C66 99                SUBB    A,R1
0C67 F500        R     MOV     pos_error+01H,A
0C69 EC                MOV     A,R4
0C6A 98                SUBB    A,R0
0C6B F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 729
0C6D 900000      R     MOV     DPTR,#pos_error_sum
0C70 E0                MOVX    A,@DPTR
0C71 FC                MOV     R4,A
0C72 A3                INC     DPTR
0C73 E0                MOVX    A,@DPTR
0C74 FD                MOV     R5,A
0C75 A3                INC     DPTR
0C76 E0                MOVX    A,@DPTR
0C77 FE                MOV     R6,A
0C78 A3                INC     DPTR
0C79 E0                MOVX    A,@DPTR
0C7A 2500        R     ADD     A,pos_error+03H
0C7C FF                MOV     R7,A
0C7D EE                MOV     A,R6
0C7E 3500        R     ADDC    A,pos_error+02H
0C80 FE                MOV     R6,A
0C81 ED                MOV     A,R5
0C82 3500        R     ADDC    A,pos_error+01H
0C84 FD                MOV     R5,A
0C85 EC                MOV     A,R4
0C86 3500        R     ADDC    A,pos_error
0C88 FC                MOV     R4,A
0C89 900000      R     MOV     DPTR,#pos_error_sum
0C8C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 732
0C8F E4                CLR     A
0C90 7FE8              MOV     R7,#0E8H
0C92 7E03              MOV     R6,#03H
0C94 FD                MOV     R5,A
0C95 FC                MOV     R4,A
0C96 900000      R     MOV     DPTR,#pos_error_sum
0C99 E0                MOVX    A,@DPTR
0C9A F8                MOV     R0,A
0C9B A3                INC     DPTR
0C9C E0                MOVX    A,@DPTR
0C9D F9                MOV     R1,A
0C9E A3                INC     DPTR
0C9F E0                MOVX    A,@DPTR
0CA0 FA                MOV     R2,A
0CA1 A3                INC     DPTR
0CA2 E0                MOVX    A,@DPTR
0CA3 FB                MOV     R3,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 73  

0CA4 D3                SETB    C
0CA5 120000      E     LCALL   ?C?SLCMP
0CA8 400F              JC      ?C0117
                                           ; SOURCE LINE # 733
0CAA E4                CLR     A
0CAB 7FE8              MOV     R7,#0E8H
0CAD 7E03              MOV     R6,#03H
0CAF FD                MOV     R5,A
0CB0 FC                MOV     R4,A
0CB1 900000      R     MOV     DPTR,#pos_error_sum
0CB4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 734
0CB7 802A              SJMP    ?C0118
0CB9         ?C0117:
0CB9 7F18              MOV     R7,#018H
0CBB 7EFC              MOV     R6,#0FCH
0CBD 7DFF              MOV     R5,#0FFH
0CBF 7CFF              MOV     R4,#0FFH
0CC1 900000      R     MOV     DPTR,#pos_error_sum
0CC4 E0                MOVX    A,@DPTR
0CC5 F8                MOV     R0,A
0CC6 A3                INC     DPTR
0CC7 E0                MOVX    A,@DPTR
0CC8 F9                MOV     R1,A
0CC9 A3                INC     DPTR
0CCA E0                MOVX    A,@DPTR
0CCB FA                MOV     R2,A
0CCC A3                INC     DPTR
0CCD E0                MOVX    A,@DPTR
0CCE FB                MOV     R3,A
0CCF C3                CLR     C
0CD0 120000      E     LCALL   ?C?SLCMP
0CD3 500E              JNC     ?C0118
                                           ; SOURCE LINE # 735
0CD5 7F18              MOV     R7,#018H
0CD7 7EFC              MOV     R6,#0FCH
0CD9 7DFF              MOV     R5,#0FFH
0CDB 7CFF              MOV     R4,#0FFH
0CDD 900000      R     MOV     DPTR,#pos_error_sum
0CE0 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 736
0CE3         ?C0118:
                                           ; SOURCE LINE # 739
0CE3 E4                CLR     A
0CE4 FF                MOV     R7,A
0CE5 FE                MOV     R6,A
0CE6 FD                MOV     R5,A
0CE7 FC                MOV     R4,A
0CE8 AB00        R     MOV     R3,k_p+03H
0CEA AA00        R     MOV     R2,k_p+02H
0CEC A900        R     MOV     R1,k_p+01H
0CEE A800        R     MOV     R0,k_p
0CF0 C3                CLR     C
0CF1 120000      E     LCALL   ?C?SLCMP
0CF4 601A              JZ      ?C0120
                                           ; SOURCE LINE # 740
0CF6 AF00        R     MOV     R7,pos_error+03H
0CF8 AE00        R     MOV     R6,pos_error+02H
0CFA AD00        R     MOV     R5,pos_error+01H
0CFC AC00        R     MOV     R4,pos_error
0CFE A800        R     MOV     R0,k_p
0D00 120000      E     LCALL   ?C?LMUL
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 74  

0D03 7810              MOV     R0,#010H
0D05 120000      E     LCALL   ?C?SLSHR
0D08 8F00        R     MOV     pwm_input+03H,R7
0D0A 8E00        R     MOV     pwm_input+02H,R6
0D0C 8D00        R     MOV     pwm_input+01H,R5
0D0E 8C00        R     MOV     pwm_input,R4
0D10         ?C0120:
                                           ; SOURCE LINE # 744
0D10 E4                CLR     A
0D11 FF                MOV     R7,A
0D12 FE                MOV     R6,A
0D13 FD                MOV     R5,A
0D14 FC                MOV     R4,A
0D15 AB00        R     MOV     R3,k_i+03H
0D17 AA00        R     MOV     R2,k_i+02H
0D19 A900        R     MOV     R1,k_i+01H
0D1B A800        R     MOV     R0,k_i
0D1D C3                CLR     C
0D1E 120000      E     LCALL   ?C?SLCMP
0D21 602C              JZ      ?C0121
                                           ; SOURCE LINE # 745
0D23 900000      R     MOV     DPTR,#pos_error_sum
0D26 E0                MOVX    A,@DPTR
0D27 FC                MOV     R4,A
0D28 A3                INC     DPTR
0D29 E0                MOVX    A,@DPTR
0D2A FD                MOV     R5,A
0D2B A3                INC     DPTR
0D2C E0                MOVX    A,@DPTR
0D2D FE                MOV     R6,A
0D2E A3                INC     DPTR
0D2F E0                MOVX    A,@DPTR
0D30 FF                MOV     R7,A
0D31 A800        R     MOV     R0,k_i
0D33 120000      E     LCALL   ?C?LMUL
0D36 7810              MOV     R0,#010H
0D38 120000      E     LCALL   ?C?SLSHR
0D3B E500        R     MOV     A,pwm_input+03H
0D3D 2F                ADD     A,R7
0D3E F500        R     MOV     pwm_input+03H,A
0D40 E500        R     MOV     A,pwm_input+02H
0D42 3E                ADDC    A,R6
0D43 F500        R     MOV     pwm_input+02H,A
0D45 E500        R     MOV     A,pwm_input+01H
0D47 3D                ADDC    A,R5
0D48 F500        R     MOV     pwm_input+01H,A
0D4A E500        R     MOV     A,pwm_input
0D4C 3C                ADDC    A,R4
0D4D F500        R     MOV     pwm_input,A
0D4F         ?C0121:
                                           ; SOURCE LINE # 749
0D4F E4                CLR     A
0D50 FF                MOV     R7,A
0D51 FE                MOV     R6,A
0D52 FD                MOV     R5,A
0D53 FC                MOV     R4,A
0D54 AB00        R     MOV     R3,k_d+03H
0D56 AA00        R     MOV     R2,k_d+02H
0D58 A900        R     MOV     R1,k_d+01H
0D5A A800        R     MOV     R0,k_d
0D5C C3                CLR     C
0D5D 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 75  

0D60 6043              JZ      ?C0122
                                           ; SOURCE LINE # 750
0D62 900000      R     MOV     DPTR,#prev_pos_err
0D65 E0                MOVX    A,@DPTR
0D66 F8                MOV     R0,A
0D67 A3                INC     DPTR
0D68 E0                MOVX    A,@DPTR
0D69 F9                MOV     R1,A
0D6A A3                INC     DPTR
0D6B E0                MOVX    A,@DPTR
0D6C FA                MOV     R2,A
0D6D A3                INC     DPTR
0D6E E0                MOVX    A,@DPTR
0D6F FB                MOV     R3,A
0D70 C3                CLR     C
0D71 E500        R     MOV     A,pos_error+03H
0D73 9B                SUBB    A,R3
0D74 FF                MOV     R7,A
0D75 E500        R     MOV     A,pos_error+02H
0D77 9A                SUBB    A,R2
0D78 FE                MOV     R6,A
0D79 E500        R     MOV     A,pos_error+01H
0D7B 99                SUBB    A,R1
0D7C FD                MOV     R5,A
0D7D E500        R     MOV     A,pos_error
0D7F 98                SUBB    A,R0
0D80 FC                MOV     R4,A
0D81 AB00        R     MOV     R3,k_d+03H
0D83 AA00        R     MOV     R2,k_d+02H
0D85 A900        R     MOV     R1,k_d+01H
0D87 A800        R     MOV     R0,k_d
0D89 120000      E     LCALL   ?C?LMUL
0D8C 7810              MOV     R0,#010H
0D8E 120000      E     LCALL   ?C?SLSHR
0D91 E500        R     MOV     A,pwm_input+03H
0D93 2F                ADD     A,R7
0D94 F500        R     MOV     pwm_input+03H,A
0D96 E500        R     MOV     A,pwm_input+02H
0D98 3E                ADDC    A,R6
0D99 F500        R     MOV     pwm_input+02H,A
0D9B E500        R     MOV     A,pwm_input+01H
0D9D 3D                ADDC    A,R5
0D9E F500        R     MOV     pwm_input+01H,A
0DA0 E500        R     MOV     A,pwm_input
0DA2 3C                ADDC    A,R4
0DA3 F500        R     MOV     pwm_input,A
0DA5         ?C0122:
                                           ; SOURCE LINE # 754
0DA5 AF00        R     MOV     R7,pos_error+03H
0DA7 AE00        R     MOV     R6,pos_error+02H
0DA9 AD00        R     MOV     R5,pos_error+01H
0DAB AC00        R     MOV     R4,pos_error
0DAD 900000      R     MOV     DPTR,#prev_pos_err
0DB0 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 756
0DB3 E4                CLR     A
0DB4 FF                MOV     R7,A
0DB5 FE                MOV     R6,A
0DB6 FD                MOV     R5,A
0DB7 FC                MOV     R4,A
0DB8 AB00        R     MOV     R3,pwm_input+03H
0DBA AA00        R     MOV     R2,pwm_input+02H
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 76  

0DBC A900        R     MOV     R1,pwm_input+01H
0DBE A800        R     MOV     R0,pwm_input
0DC0 D3                SETB    C
0DC1 120000      E     LCALL   ?C?SLCMP
0DC4 4005              JC      ?C0123
                                           ; SOURCE LINE # 757
0DC6 D200        R     SETB    motor_dir
0DC8 020000      R     LJMP    ?C0094
0DCB         ?C0123:
                                           ; SOURCE LINE # 759
0DCB C200        R     CLR     motor_dir
                                           ; SOURCE LINE # 761
0DCD 020000      R     LJMP    ?C0094
                                           ; SOURCE LINE # 764
0DD0         ?C0125:
                                           ; SOURCE LINE # 765
0DD0 900000      E     MOV     DPTR,#g_ref+018H
0DD3 E0                MOVX    A,@DPTR
0DD4 7003              JNZ     $ + 5H
0DD6 020000      R     LJMP    ?C0094
0DD9 200003      E     JB      tension_valid,$ + 6H
0DDC 020000      R     LJMP    ?C0094
                                           ; SOURCE LINE # 767
0DDF 900000      E     MOV     DPTR,#g_ref+08H
0DE2 E0                MOVX    A,@DPTR
0DE3 FC                MOV     R4,A
0DE4 A3                INC     DPTR
0DE5 E0                MOVX    A,@DPTR
0DE6 FD                MOV     R5,A
0DE7 A3                INC     DPTR
0DE8 E0                MOVX    A,@DPTR
0DE9 FE                MOV     R6,A
0DEA A3                INC     DPTR
0DEB E0                MOVX    A,@DPTR
0DEC F500        R     MOV     i_ref+03H,A
0DEE 8E00        R     MOV     i_ref+02H,R6
0DF0 8D00        R     MOV     i_ref+01H,R5
0DF2 8C00        R     MOV     i_ref,R4
                                           ; SOURCE LINE # 769
0DF4 900000      E     MOV     DPTR,#c_mem+069H
0DF7 E0                MOVX    A,@DPTR
0DF8 FE                MOV     R6,A
0DF9 A3                INC     DPTR
0DFA E0                MOVX    A,@DPTR
0DFB FF                MOV     R7,A
0DFC EE                MOV     A,R6
0DFD 33                RLC     A
0DFE 95E0              SUBB    A,ACC
0E00 FD                MOV     R5,A
0E01 FC                MOV     R4,A
0E02 AB00        R     MOV     R3,i_ref+03H
0E04 AA00        R     MOV     R2,i_ref+02H
0E06 A900        R     MOV     R1,i_ref+01H
0E08 A800        R     MOV     R0,i_ref
0E0A D3                SETB    C
0E0B 120000      E     LCALL   ?C?SLCMP
0E0E 4016              JC      ?C0127
                                           ; SOURCE LINE # 770
0E10 900000      E     MOV     DPTR,#c_mem+069H
0E13 E0                MOVX    A,@DPTR
0E14 FE                MOV     R6,A
0E15 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 77  

0E16 E0                MOVX    A,@DPTR
0E17 FF                MOV     R7,A
0E18 EE                MOV     A,R6
0E19 33                RLC     A
0E1A 95E0              SUBB    A,ACC
0E1C 8F00        R     MOV     i_ref+03H,R7
0E1E 8E00        R     MOV     i_ref+02H,R6
0E20 F500        R     MOV     i_ref+01H,A
0E22 F500        R     MOV     i_ref,A
0E24 803C              SJMP    ?C0128
0E26         ?C0127:
                                           ; SOURCE LINE # 771
                                           ; SOURCE LINE # 772
0E26 900000      E     MOV     DPTR,#c_mem+069H
0E29 E0                MOVX    A,@DPTR
0E2A FE                MOV     R6,A
0E2B A3                INC     DPTR
0E2C E0                MOVX    A,@DPTR
0E2D FF                MOV     R7,A
0E2E C3                CLR     C
0E2F E4                CLR     A
0E30 9F                SUBB    A,R7
0E31 FF                MOV     R7,A
0E32 E4                CLR     A
0E33 9E                SUBB    A,R6
0E34 FE                MOV     R6,A
0E35 33                RLC     A
0E36 95E0              SUBB    A,ACC
0E38 FD                MOV     R5,A
0E39 FC                MOV     R4,A
0E3A AB00        R     MOV     R3,i_ref+03H
0E3C AA00        R     MOV     R2,i_ref+02H
0E3E A900        R     MOV     R1,i_ref+01H
0E40 A800        R     MOV     R0,i_ref
0E42 C3                CLR     C
0E43 120000      E     LCALL   ?C?SLCMP
0E46 501A              JNC     ?C0128
                                           ; SOURCE LINE # 773
0E48 900000      E     MOV     DPTR,#c_mem+069H
0E4B E0                MOVX    A,@DPTR
0E4C FE                MOV     R6,A
0E4D A3                INC     DPTR
0E4E E0                MOVX    A,@DPTR
0E4F FF                MOV     R7,A
0E50 C3                CLR     C
0E51 E4                CLR     A
0E52 9F                SUBB    A,R7
0E53 FF                MOV     R7,A
0E54 E4                CLR     A
0E55 9E                SUBB    A,R6
0E56 FE                MOV     R6,A
0E57 33                RLC     A
0E58 95E0              SUBB    A,ACC
0E5A 8F00        R     MOV     i_ref+03H,R7
0E5C 8E00        R     MOV     i_ref+02H,R6
0E5E F500        R     MOV     i_ref+01H,A
0E60 F500        R     MOV     i_ref,A
                                           ; SOURCE LINE # 774
0E62         ?C0128:
                                           ; SOURCE LINE # 777
0E62 900000      E     MOV     DPTR,#g_meas+0CH
0E65 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 78  

0E66 F8                MOV     R0,A
0E67 A3                INC     DPTR
0E68 E0                MOVX    A,@DPTR
0E69 F9                MOV     R1,A
0E6A A3                INC     DPTR
0E6B E0                MOVX    A,@DPTR
0E6C FA                MOV     R2,A
0E6D A3                INC     DPTR
0E6E E0                MOVX    A,@DPTR
0E6F FB                MOV     R3,A
0E70 C3                CLR     C
0E71 E500        R     MOV     A,i_ref+03H
0E73 9B                SUBB    A,R3
0E74 F500        R     MOV     curr_error+03H,A
0E76 E500        R     MOV     A,i_ref+02H
0E78 9A                SUBB    A,R2
0E79 F500        R     MOV     curr_error+02H,A
0E7B E500        R     MOV     A,i_ref+01H
0E7D 99                SUBB    A,R1
0E7E F500        R     MOV     curr_error+01H,A
0E80 E500        R     MOV     A,i_ref
0E82 98                SUBB    A,R0
0E83 F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 778
0E85 900000      R     MOV     DPTR,#curr_error_sum
0E88 E0                MOVX    A,@DPTR
0E89 FC                MOV     R4,A
0E8A A3                INC     DPTR
0E8B E0                MOVX    A,@DPTR
0E8C FD                MOV     R5,A
0E8D A3                INC     DPTR
0E8E E0                MOVX    A,@DPTR
0E8F FE                MOV     R6,A
0E90 A3                INC     DPTR
0E91 E0                MOVX    A,@DPTR
0E92 2500        R     ADD     A,curr_error+03H
0E94 FF                MOV     R7,A
0E95 EE                MOV     A,R6
0E96 3500        R     ADDC    A,curr_error+02H
0E98 FE                MOV     R6,A
0E99 ED                MOV     A,R5
0E9A 3500        R     ADDC    A,curr_error+01H
0E9C FD                MOV     R5,A
0E9D EC                MOV     A,R4
0E9E 3500        R     ADDC    A,curr_error
0EA0 FC                MOV     R4,A
0EA1 900000      R     MOV     DPTR,#curr_error_sum
0EA4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 780
0EA7 7FA0              MOV     R7,#0A0H
0EA9 7E86              MOV     R6,#086H
0EAB 7D01              MOV     R5,#01H
0EAD 7C00              MOV     R4,#00H
0EAF 900000      R     MOV     DPTR,#curr_error_sum
0EB2 E0                MOVX    A,@DPTR
0EB3 F8                MOV     R0,A
0EB4 A3                INC     DPTR
0EB5 E0                MOVX    A,@DPTR
0EB6 F9                MOV     R1,A
0EB7 A3                INC     DPTR
0EB8 E0                MOVX    A,@DPTR
0EB9 FA                MOV     R2,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 79  

0EBA A3                INC     DPTR
0EBB E0                MOVX    A,@DPTR
0EBC FB                MOV     R3,A
0EBD D3                SETB    C
0EBE 120000      E     LCALL   ?C?SLCMP
0EC1 4010              JC      ?C0130
                                           ; SOURCE LINE # 781
0EC3 7FA0              MOV     R7,#0A0H
0EC5 7E86              MOV     R6,#086H
0EC7 7D01              MOV     R5,#01H
0EC9 7C00              MOV     R4,#00H
0ECB 900000      R     MOV     DPTR,#curr_error_sum
0ECE 120000      E     LCALL   ?C?LSTXDATA
0ED1 802A              SJMP    ?C0131
0ED3         ?C0130:
                                           ; SOURCE LINE # 782
                                           ; SOURCE LINE # 783
0ED3 7F60              MOV     R7,#060H
0ED5 7E79              MOV     R6,#079H
0ED7 7DFE              MOV     R5,#0FEH
0ED9 7CFF              MOV     R4,#0FFH
0EDB 900000      R     MOV     DPTR,#curr_error_sum
0EDE E0                MOVX    A,@DPTR
0EDF F8                MOV     R0,A
0EE0 A3                INC     DPTR
0EE1 E0                MOVX    A,@DPTR
0EE2 F9                MOV     R1,A
0EE3 A3                INC     DPTR
0EE4 E0                MOVX    A,@DPTR
0EE5 FA                MOV     R2,A
0EE6 A3                INC     DPTR
0EE7 E0                MOVX    A,@DPTR
0EE8 FB                MOV     R3,A
0EE9 C3                CLR     C
0EEA 120000      E     LCALL   ?C?SLCMP
0EED 500E              JNC     ?C0131
                                           ; SOURCE LINE # 784
0EEF 7F60              MOV     R7,#060H
0EF1 7E79              MOV     R6,#079H
0EF3 7DFE              MOV     R5,#0FEH
0EF5 7CFF              MOV     R4,#0FFH
0EF7 900000      R     MOV     DPTR,#curr_error_sum
0EFA 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 785
0EFD         ?C0131:
                                           ; SOURCE LINE # 787
0EFD E4                CLR     A
0EFE F500        R     MOV     pwm_input+03H,A
0F00 F500        R     MOV     pwm_input+02H,A
0F02 F500        R     MOV     pwm_input+01H,A
0F04 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 790
0F06 FF                MOV     R7,A
0F07 FE                MOV     R6,A
0F08 FD                MOV     R5,A
0F09 FC                MOV     R4,A
0F0A AB00        R     MOV     R3,k_p_c+03H
0F0C AA00        R     MOV     R2,k_p_c+02H
0F0E A900        R     MOV     R1,k_p_c+01H
0F10 A800        R     MOV     R0,k_p_c
0F12 C3                CLR     C
0F13 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 80  

0F16 6026              JZ      ?C0133
                                           ; SOURCE LINE # 791
0F18 AF00        R     MOV     R7,curr_error+03H
0F1A AE00        R     MOV     R6,curr_error+02H
0F1C AD00        R     MOV     R5,curr_error+01H
0F1E AC00        R     MOV     R4,curr_error
0F20 A800        R     MOV     R0,k_p_c
0F22 120000      E     LCALL   ?C?LMUL
0F25 7810              MOV     R0,#010H
0F27 120000      E     LCALL   ?C?SLSHR
0F2A E500        R     MOV     A,pwm_input+03H
0F2C 2F                ADD     A,R7
0F2D F500        R     MOV     pwm_input+03H,A
0F2F E500        R     MOV     A,pwm_input+02H
0F31 3E                ADDC    A,R6
0F32 F500        R     MOV     pwm_input+02H,A
0F34 E500        R     MOV     A,pwm_input+01H
0F36 3D                ADDC    A,R5
0F37 F500        R     MOV     pwm_input+01H,A
0F39 E500        R     MOV     A,pwm_input
0F3B 3C                ADDC    A,R4
0F3C F500        R     MOV     pwm_input,A
0F3E         ?C0133:
                                           ; SOURCE LINE # 794
0F3E E4                CLR     A
0F3F FF                MOV     R7,A
0F40 FE                MOV     R6,A
0F41 FD                MOV     R5,A
0F42 FC                MOV     R4,A
0F43 AB00        R     MOV     R3,k_i_c+03H
0F45 AA00        R     MOV     R2,k_i_c+02H
0F47 A900        R     MOV     R1,k_i_c+01H
0F49 A800        R     MOV     R0,k_i_c
0F4B C3                CLR     C
0F4C 120000      E     LCALL   ?C?SLCMP
0F4F 602C              JZ      ?C0134
                                           ; SOURCE LINE # 795
0F51 900000      R     MOV     DPTR,#curr_error_sum
0F54 E0                MOVX    A,@DPTR
0F55 FC                MOV     R4,A
0F56 A3                INC     DPTR
0F57 E0                MOVX    A,@DPTR
0F58 FD                MOV     R5,A
0F59 A3                INC     DPTR
0F5A E0                MOVX    A,@DPTR
0F5B FE                MOV     R6,A
0F5C A3                INC     DPTR
0F5D E0                MOVX    A,@DPTR
0F5E FF                MOV     R7,A
0F5F A800        R     MOV     R0,k_i_c
0F61 120000      E     LCALL   ?C?LMUL
0F64 7810              MOV     R0,#010H
0F66 120000      E     LCALL   ?C?SLSHR
0F69 E500        R     MOV     A,pwm_input+03H
0F6B 2F                ADD     A,R7
0F6C F500        R     MOV     pwm_input+03H,A
0F6E E500        R     MOV     A,pwm_input+02H
0F70 3E                ADDC    A,R6
0F71 F500        R     MOV     pwm_input+02H,A
0F73 E500        R     MOV     A,pwm_input+01H
0F75 3D                ADDC    A,R5
0F76 F500        R     MOV     pwm_input+01H,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 81  

0F78 E500        R     MOV     A,pwm_input
0F7A 3C                ADDC    A,R4
0F7B F500        R     MOV     pwm_input,A
0F7D         ?C0134:
                                           ; SOURCE LINE # 798
0F7D E4                CLR     A
0F7E FF                MOV     R7,A
0F7F FE                MOV     R6,A
0F80 FD                MOV     R5,A
0F81 FC                MOV     R4,A
0F82 AB00        R     MOV     R3,k_d_c+03H
0F84 AA00        R     MOV     R2,k_d_c+02H
0F86 A900        R     MOV     R1,k_d_c+01H
0F88 A800        R     MOV     R0,k_d_c
0F8A C3                CLR     C
0F8B 120000      E     LCALL   ?C?SLCMP
0F8E 6043              JZ      ?C0135
                                           ; SOURCE LINE # 799
0F90 900000      R     MOV     DPTR,#prev_curr_err
0F93 E0                MOVX    A,@DPTR
0F94 F8                MOV     R0,A
0F95 A3                INC     DPTR
0F96 E0                MOVX    A,@DPTR
0F97 F9                MOV     R1,A
0F98 A3                INC     DPTR
0F99 E0                MOVX    A,@DPTR
0F9A FA                MOV     R2,A
0F9B A3                INC     DPTR
0F9C E0                MOVX    A,@DPTR
0F9D FB                MOV     R3,A
0F9E C3                CLR     C
0F9F E500        R     MOV     A,curr_error+03H
0FA1 9B                SUBB    A,R3
0FA2 FF                MOV     R7,A
0FA3 E500        R     MOV     A,curr_error+02H
0FA5 9A                SUBB    A,R2
0FA6 FE                MOV     R6,A
0FA7 E500        R     MOV     A,curr_error+01H
0FA9 99                SUBB    A,R1
0FAA FD                MOV     R5,A
0FAB E500        R     MOV     A,curr_error
0FAD 98                SUBB    A,R0
0FAE FC                MOV     R4,A
0FAF AB00        R     MOV     R3,k_d_c+03H
0FB1 AA00        R     MOV     R2,k_d_c+02H
0FB3 A900        R     MOV     R1,k_d_c+01H
0FB5 A800        R     MOV     R0,k_d_c
0FB7 120000      E     LCALL   ?C?LMUL
0FBA 7810              MOV     R0,#010H
0FBC 120000      E     LCALL   ?C?SLSHR
0FBF E500        R     MOV     A,pwm_input+03H
0FC1 2F                ADD     A,R7
0FC2 F500        R     MOV     pwm_input+03H,A
0FC4 E500        R     MOV     A,pwm_input+02H
0FC6 3E                ADDC    A,R6
0FC7 F500        R     MOV     pwm_input+02H,A
0FC9 E500        R     MOV     A,pwm_input+01H
0FCB 3D                ADDC    A,R5
0FCC F500        R     MOV     pwm_input+01H,A
0FCE E500        R     MOV     A,pwm_input
0FD0 3C                ADDC    A,R4
0FD1 F500        R     MOV     pwm_input,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 82  

0FD3         ?C0135:
                                           ; SOURCE LINE # 801
0FD3 AF00        R     MOV     R7,curr_error+03H
0FD5 AE00        R     MOV     R6,curr_error+02H
0FD7 AD00        R     MOV     R5,curr_error+01H
0FD9 AC00        R     MOV     R4,curr_error
0FDB 900000      R     MOV     DPTR,#prev_curr_err
0FDE 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 803
0FE1 E4                CLR     A
0FE2 FF                MOV     R7,A
0FE3 FE                MOV     R6,A
0FE4 FD                MOV     R5,A
0FE5 FC                MOV     R4,A
0FE6 AB00        R     MOV     R3,pwm_input+03H
0FE8 AA00        R     MOV     R2,pwm_input+02H
0FEA A900        R     MOV     R1,pwm_input+01H
0FEC A800        R     MOV     R0,pwm_input
0FEE C3                CLR     C
0FEF 120000      E     LCALL   ?C?SLCMP
0FF2 4004              JC      ?C0136
                                           ; SOURCE LINE # 804
0FF4 D200        R     SETB    motor_dir
0FF6 8072              SJMP    ?C0094
0FF8         ?C0136:
                                           ; SOURCE LINE # 806
0FF8 C200        R     CLR     motor_dir
                                           ; SOURCE LINE # 807
                                           ; SOURCE LINE # 808
0FFA 806E              SJMP    ?C0094
                                           ; SOURCE LINE # 811
0FFC         ?C0138:
                                           ; SOURCE LINE # 813
0FFC 900000      E     MOV     DPTR,#g_ref+010H
0FFF E0                MOVX    A,@DPTR
1000 FC                MOV     R4,A
1001 A3                INC     DPTR
1002 E0                MOVX    A,@DPTR
1003 FD                MOV     R5,A
1004 A3                INC     DPTR
1005 E0                MOVX    A,@DPTR
1006 FE                MOV     R6,A
1007 A3                INC     DPTR
1008 E0                MOVX    A,@DPTR
1009 F500        R     MOV     pwm_input+03H,A
100B 8E00        R     MOV     pwm_input+02H,R6
100D 8D00        R     MOV     pwm_input+01H,R5
100F 8C00        R     MOV     pwm_input,R4
                                           ; SOURCE LINE # 815
1011 E4                CLR     A
1012 FF                MOV     R7,A
1013 FE                MOV     R6,A
1014 FD                MOV     R5,A
1015 FC                MOV     R4,A
1016 AB00        R     MOV     R3,pwm_input+03H
1018 AA00        R     MOV     R2,pwm_input+02H
101A A900        R     MOV     R1,pwm_input+01H
101C A800        R     MOV     R0,pwm_input
101E D3                SETB    C
101F 120000      E     LCALL   ?C?SLCMP
1022 4004              JC      ?C0139
                                           ; SOURCE LINE # 816
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 83  

1024 D200        R     SETB    motor_dir
1026 8002              SJMP    ?C0140
1028         ?C0139:
                                           ; SOURCE LINE # 818
1028 C200        R     CLR     motor_dir
102A         ?C0140:
                                           ; SOURCE LINE # 822
102A 74FF              MOV     A,#0FFH
102C 7F9C              MOV     R7,#09CH
102E FE                MOV     R6,A
102F FD                MOV     R5,A
1030 FC                MOV     R4,A
1031 AB00        R     MOV     R3,pwm_input+03H
1033 AA00        R     MOV     R2,pwm_input+02H
1035 A900        R     MOV     R1,pwm_input+01H
1037 A800        R     MOV     R0,pwm_input
1039 C3                CLR     C
103A 120000      E     LCALL   ?C?SLCMP
103D 500D              JNC     ?C0141
                                           ; SOURCE LINE # 823
103F 74FF              MOV     A,#0FFH
1041 75009C      R     MOV     pwm_input+03H,#09CH
1044 F500        R     MOV     pwm_input+02H,A
1046 F500        R     MOV     pwm_input+01H,A
1048 F500        R     MOV     pwm_input,A
104A 801E              SJMP    ?C0094
104C         ?C0141:
                                           ; SOURCE LINE # 824
104C E4                CLR     A
104D 7F64              MOV     R7,#064H
104F FE                MOV     R6,A
1050 FD                MOV     R5,A
1051 FC                MOV     R4,A
1052 AB00        R     MOV     R3,pwm_input+03H
1054 AA00        R     MOV     R2,pwm_input+02H
1056 A900        R     MOV     R1,pwm_input+01H
1058 A800        R     MOV     R0,pwm_input
105A D3                SETB    C
105B 120000      E     LCALL   ?C?SLCMP
105E 400A              JC      ?C0094
                                           ; SOURCE LINE # 825
1060 E4                CLR     A
1061 750064      R     MOV     pwm_input+03H,#064H
1064 F500        R     MOV     pwm_input+02H,A
1066 F500        R     MOV     pwm_input+01H,A
1068 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 828
                                           ; SOURCE LINE # 830
106A         ?C0094:
                                           ; SOURCE LINE # 834
106A E4                CLR     A
106B 7F64              MOV     R7,#064H
106D FE                MOV     R6,A
106E FD                MOV     R5,A
106F FC                MOV     R4,A
1070 AB00        R     MOV     R3,pwm_input+03H
1072 AA00        R     MOV     R2,pwm_input+02H
1074 A900        R     MOV     R1,pwm_input+01H
1076 A800        R     MOV     R0,pwm_input
1078 D3                SETB    C
1079 120000      E     LCALL   ?C?SLCMP
107C 400A              JC      ?C0144
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 84  

                                           ; SOURCE LINE # 835
107E E4                CLR     A
107F 750064      R     MOV     pwm_input+03H,#064H
1082 F500        R     MOV     pwm_input+02H,A
1084 F500        R     MOV     pwm_input+01H,A
1086 F500        R     MOV     pwm_input,A
1088         ?C0144:
                                           ; SOURCE LINE # 836
1088 74FF              MOV     A,#0FFH
108A 7F9C              MOV     R7,#09CH
108C FE                MOV     R6,A
108D FD                MOV     R5,A
108E FC                MOV     R4,A
108F AB00        R     MOV     R3,pwm_input+03H
1091 AA00        R     MOV     R2,pwm_input+02H
1093 A900        R     MOV     R1,pwm_input+01H
1095 A800        R     MOV     R0,pwm_input
1097 C3                CLR     C
1098 120000      E     LCALL   ?C?SLCMP
109B 500B              JNC     ?C0145
                                           ; SOURCE LINE # 837
109D 74FF              MOV     A,#0FFH
109F 75009C      R     MOV     pwm_input+03H,#09CH
10A2 F500        R     MOV     pwm_input+02H,A
10A4 F500        R     MOV     pwm_input+01H,A
10A6 F500        R     MOV     pwm_input,A
10A8         ?C0145:
                                           ; SOURCE LINE # 840
10A8 900000      E     MOV     DPTR,#c_mem+034H
10AB E0                MOVX    A,@DPTR
10AC 6401              XRL     A,#01H
10AE 6037              JZ      ?C0146
                                           ; SOURCE LINE # 841
10B0 AF00        R     MOV     R7,pwm_input+03H
10B2 AE00        R     MOV     R6,pwm_input+02H
10B4 AD00        R     MOV     R5,pwm_input+01H
10B6 AC00        R     MOV     R4,pwm_input
10B8 780A              MOV     R0,#0AH
10BA 120000      E     LCALL   ?C?LSHL
10BD E4                CLR     A
10BE 7B64              MOV     R3,#064H
10C0 FA                MOV     R2,A
10C1 F9                MOV     R1,A
10C2 F8                MOV     R0,A
10C3 120000      E     LCALL   ?C?SLDIV
10C6 A804              MOV     R0,AR4
10C8 A905              MOV     R1,AR5
10CA AA06              MOV     R2,AR6
10CC AB07              MOV     R3,AR7
10CE 900000      E     MOV     DPTR,#dev_pwm_limit
10D1 E0                MOVX    A,@DPTR
10D2 FF                MOV     R7,A
10D3 E4                CLR     A
10D4 FC                MOV     R4,A
10D5 FD                MOV     R5,A
10D6 FE                MOV     R6,A
10D7 120000      E     LCALL   ?C?LMUL
10DA 780A              MOV     R0,#0AH
10DC 120000      E     LCALL   ?C?SLSHR
10DF 8F00        R     MOV     pwm_input+03H,R7
10E1 8E00        R     MOV     pwm_input+02H,R6
10E3 8D00        R     MOV     pwm_input+01H,R5
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 85  

10E5 8C00        R     MOV     pwm_input,R4
10E7         ?C0146:
                                           ; SOURCE LINE # 844
10E7 E4                CLR     A
10E8 FF                MOV     R7,A
10E9 FE                MOV     R6,A
10EA FD                MOV     R5,A
10EB FC                MOV     R4,A
10EC AB00        R     MOV     R3,pwm_input+03H
10EE AA00        R     MOV     R2,pwm_input+02H
10F0 A900        R     MOV     R1,pwm_input+01H
10F2 A800        R     MOV     R0,pwm_input
10F4 C3                CLR     C
10F5 120000      E     LCALL   ?C?SLCMP
10F8 4004              JC      ?C0147
10FA 7F01              MOV     R7,#01H
10FC 8002              SJMP    ?C0148
10FE         ?C0147:
10FE 7FFF              MOV     R7,#0FFH
1100         ?C0148:
1100 900000      E     MOV     DPTR,#pwm_sign
1103 EF                MOV     A,R7
1104 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 846
1105 300007            JNB     motor_dir,?C0149
                                           ; SOURCE LINE # 847
1108 7F01              MOV     R7,#01H
110A 120000      E     LCALL   _MOTOR_DIR_Write
110D 8005              SJMP    ?C0150
110F         ?C0149:
                                           ; SOURCE LINE # 849
110F E4                CLR     A
1110 FF                MOV     R7,A
1111 120000      E     LCALL   _MOTOR_DIR_Write
1114         ?C0150:
                                           ; SOURCE LINE # 851
1114 AE00        R     MOV     R6,pwm_input+02H
1116 AF00        R     MOV     R7,pwm_input+03H
1118 120000      E     LCALL   _abs
111B 120000      E     LCALL   _PWM_MOTORS_WriteCompare1
                                           ; SOURCE LINE # 852
111E 22                RET     
             ; FUNCTION motor_control (END)

             ; FUNCTION _encoder_reading (BEGIN)
                                           ; SOURCE LINE # 858
;---- Variable 'idx' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 860
0000 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 887
0002 E500        R     MOV     A,index
0004 C3                CLR     C
0005 9403              SUBB    A,#03H
0007 4003              JC      $ + 5H
0009 020000      R     LJMP    ?C0153
000C         ?C0152:
                                           ; SOURCE LINE # 890
000C 300022            JNB     reset_last_value_flag,?C0154
                                           ; SOURCE LINE # 891
;---- Variable 'jj' assigned to Register 'R3' ----
000F 7B03              MOV     R3,#03H
0011         ?C0155:
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 86  

0011 AF03              MOV     R7,AR3
0013 1B                DEC     R3
0014 EF                MOV     A,R7
0015 6018              JZ      ?C0156
                                           ; SOURCE LINE # 892
0017 E4                CLR     A
0018 FF                MOV     R7,A
0019 FE                MOV     R6,A
001A FD                MOV     R5,A
001B FC                MOV     R4,A
001C EB                MOV     A,R3
001D 25E0              ADD     A,ACC
001F 25E0              ADD     A,ACC
0021 2400        R     ADD     A,#LOW last_value_encoder
0023 F582              MOV     DPL,A
0025 E4                CLR     A
0026 3400        R     ADDC    A,#HIGH last_value_encoder
0028 F583              MOV     DPH,A
002A 120000      E     LCALL   ?C?LSTXDATA
002D 80E2              SJMP    ?C0155
002F         ?C0156:
                                           ; SOURCE LINE # 894
002F C200        E     CLR     reset_last_value_flag
                                           ; SOURCE LINE # 895
0031         ?C0154:
                                           ; SOURCE LINE # 899
0031 E500        R     MOV     A,index
0033 7018              JNZ     ?C0157
                                           ; SOURCE LINE # 900
0035 120000      E     LCALL   SHIFTREG_ENC_1_ReadData
0038 7801              MOV     R0,#01H
003A 120000      E     LCALL   ?C?ULSHR
003D EF                MOV     A,R7
003E EE                MOV     A,R6
003F ED                MOV     A,R5
0040 5403              ANL     A,#03H
0042 FD                MOV     R5,A
0043 E4                CLR     A
0044 FC                MOV     R4,A
0045 900000      R     MOV     DPTR,#data_encoder
0048 120000      E     LCALL   ?C?LSTXDATA
004B 8033              SJMP    ?C0158
004D         ?C0157:
                                           ; SOURCE LINE # 901
                                           ; SOURCE LINE # 902
004D E500        R     MOV     A,index
004F B40118            CJNE    A,#01H,?C0159
                                           ; SOURCE LINE # 903
0052 120000      E     LCALL   SHIFTREG_ENC_2_ReadData
0055 7801              MOV     R0,#01H
0057 120000      E     LCALL   ?C?ULSHR
005A EF                MOV     A,R7
005B EE                MOV     A,R6
005C ED                MOV     A,R5
005D 5403              ANL     A,#03H
005F FD                MOV     R5,A
0060 E4                CLR     A
0061 FC                MOV     R4,A
0062 900000      R     MOV     DPTR,#data_encoder
0065 120000      E     LCALL   ?C?LSTXDATA
0068 8016              SJMP    ?C0158
006A         ?C0159:
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 87  

                                           ; SOURCE LINE # 905
006A 120000      E     LCALL   SHIFTREG_ENC_3_ReadData
006D 7801              MOV     R0,#01H
006F 120000      E     LCALL   ?C?ULSHR
0072 EF                MOV     A,R7
0073 EE                MOV     A,R6
0074 ED                MOV     A,R5
0075 5403              ANL     A,#03H
0077 FD                MOV     R5,A
0078 E4                CLR     A
0079 FC                MOV     R4,A
007A 900000      R     MOV     DPTR,#data_encoder
007D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 906
0080         ?C0158:
                                           ; SOURCE LINE # 909
0080 7B01              MOV     R3,#01H
0082 7A00        R     MOV     R2,#HIGH data_encoder
0084 7900        R     MOV     R1,#LOW data_encoder
0086 120000      E     LCALL   _check_enc_data
0089 4003              JC      $ + 5H
008B 020000      R     LJMP    ?C0161
                                           ; SOURCE LINE # 911
008E 900000      R     MOV     DPTR,#data_encoder
0091 E0                MOVX    A,@DPTR
0092 FC                MOV     R4,A
0093 A3                INC     DPTR
0094 E0                MOVX    A,@DPTR
0095 FD                MOV     R5,A
0096 A3                INC     DPTR
0097 E0                MOVX    A,@DPTR
0098 FE                MOV     R6,A
0099 A3                INC     DPTR
009A E0                MOVX    A,@DPTR
009B 54C0              ANL     A,#0C0H
009D FF                MOV     R7,A
009E EE                MOV     A,R6
009F ED                MOV     A,R5
00A0 5403              ANL     A,#03H
00A2 FD                MOV     R5,A
00A3 E4                CLR     A
00A4 2F                ADD     A,R7
00A5 FF                MOV     R7,A
00A6 E4                CLR     A
00A7 3E                ADDC    A,R6
00A8 FE                MOV     R6,A
00A9 ED                MOV     A,R5
00AA 34FE              ADDC    A,#0FEH
00AC FD                MOV     R5,A
00AD E4                CLR     A
00AE 34FF              ADDC    A,#0FFH
00B0 FC                MOV     R4,A
00B1 7802              MOV     R0,#02H
00B3 120000      E     LCALL   ?C?ULSHR
00B6 EE                MOV     A,R6
00B7 33                RLC     A
00B8 95E0              SUBB    A,ACC
00BA FD                MOV     R5,A
00BB FC                MOV     R4,A
00BC E500        R     MOV     A,index
00BE 25E0              ADD     A,ACC
00C0 25E0              ADD     A,ACC
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 88  

00C2 2400        E     ADD     A,#LOW g_mem+038H
00C4 F582              MOV     DPL,A
00C6 E4                CLR     A
00C7 3400        E     ADDC    A,#HIGH g_mem+038H
00C9 F583              MOV     DPH,A
00CB E0                MOVX    A,@DPTR
00CC F8                MOV     R0,A
00CD A3                INC     DPTR
00CE E0                MOVX    A,@DPTR
00CF F9                MOV     R1,A
00D0 A3                INC     DPTR
00D1 E0                MOVX    A,@DPTR
00D2 FA                MOV     R2,A
00D3 A3                INC     DPTR
00D4 E0                MOVX    A,@DPTR
00D5 2F                ADD     A,R7
00D6 FF                MOV     R7,A
00D7 EA                MOV     A,R2
00D8 3E                ADDC    A,R6
00D9 FE                MOV     R6,A
00DA E9                MOV     A,R1
00DB 3D                ADDC    A,R5
00DC FD                MOV     R5,A
00DD E8                MOV     A,R0
00DE 3C                ADDC    A,R4
00DF FC                MOV     R4,A
00E0 900000      R     MOV     DPTR,#value_encoder
00E3 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 918
00E6 300027            JNB     only_first_time,?C0162
                                           ; SOURCE LINE # 919
00E9 900000      R     MOV     DPTR,#value_encoder
00EC E0                MOVX    A,@DPTR
00ED FC                MOV     R4,A
00EE A3                INC     DPTR
00EF E0                MOVX    A,@DPTR
00F0 FD                MOV     R5,A
00F1 A3                INC     DPTR
00F2 E0                MOVX    A,@DPTR
00F3 FE                MOV     R6,A
00F4 A3                INC     DPTR
00F5 E0                MOVX    A,@DPTR
00F6 FF                MOV     R7,A
00F7 E500        R     MOV     A,index
00F9 25E0              ADD     A,ACC
00FB 25E0              ADD     A,ACC
00FD 2400        R     ADD     A,#LOW last_value_encoder
00FF F582              MOV     DPL,A
0101 E4                CLR     A
0102 3400        R     ADDC    A,#HIGH last_value_encoder
0104 F583              MOV     DPH,A
0106 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 920
0109 E500        R     MOV     A,index
010B B40202            CJNE    A,#02H,?C0162
                                           ; SOURCE LINE # 921
010E C200        R     CLR     only_first_time
                                           ; SOURCE LINE # 922
0110         ?C0162:
                                           ; SOURCE LINE # 925
0110 E500        R     MOV     A,index
0112 25E0              ADD     A,ACC
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 89  

0114 25E0              ADD     A,ACC
0116 2400        R     ADD     A,#LOW last_value_encoder
0118 F582              MOV     DPL,A
011A E4                CLR     A
011B 3400        R     ADDC    A,#HIGH last_value_encoder
011D F583              MOV     DPH,A
011F E0                MOVX    A,@DPTR
0120 F8                MOV     R0,A
0121 A3                INC     DPTR
0122 E0                MOVX    A,@DPTR
0123 F9                MOV     R1,A
0124 A3                INC     DPTR
0125 E0                MOVX    A,@DPTR
0126 FA                MOV     R2,A
0127 A3                INC     DPTR
0128 E0                MOVX    A,@DPTR
0129 FB                MOV     R3,A
012A 900000      R     MOV     DPTR,#value_encoder
012D E0                MOVX    A,@DPTR
012E FC                MOV     R4,A
012F A3                INC     DPTR
0130 E0                MOVX    A,@DPTR
0131 FD                MOV     R5,A
0132 A3                INC     DPTR
0133 E0                MOVX    A,@DPTR
0134 FE                MOV     R6,A
0135 A3                INC     DPTR
0136 E0                MOVX    A,@DPTR
0137 C3                CLR     C
0138 9B                SUBB    A,R3
0139 FF                MOV     R7,A
013A EE                MOV     A,R6
013B 9A                SUBB    A,R2
013C FE                MOV     R6,A
013D ED                MOV     A,R5
013E 99                SUBB    A,R1
013F FD                MOV     R5,A
0140 EC                MOV     A,R4
0141 98                SUBB    A,R0
0142 FC                MOV     R4,A
0143 900000      R     MOV     DPTR,#aux
0146 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 945
0149 E4                CLR     A
014A FF                MOV     R7,A
014B 7EC0              MOV     R6,#0C0H
014D FD                MOV     R5,A
014E FC                MOV     R4,A
014F 900000      R     MOV     DPTR,#aux
0152 E0                MOVX    A,@DPTR
0153 F8                MOV     R0,A
0154 A3                INC     DPTR
0155 E0                MOVX    A,@DPTR
0156 F9                MOV     R1,A
0157 A3                INC     DPTR
0158 E0                MOVX    A,@DPTR
0159 FA                MOV     R2,A
015A A3                INC     DPTR
015B E0                MOVX    A,@DPTR
015C FB                MOV     R3,A
015D D3                SETB    C
015E 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 90  

0161 4010              JC      ?C0164
                                           ; SOURCE LINE # 946
0163 7400        E     MOV     A,#LOW g_meas+014H
0165 2500        R     ADD     A,index
0167 F582              MOV     DPL,A
0169 E4                CLR     A
016A 3400        E     ADDC    A,#HIGH g_meas+014H
016C F583              MOV     DPH,A
016E E0                MOVX    A,@DPTR
016F 14                DEC     A
0170 F0                MOVX    @DPTR,A
0171 8068              SJMP    ?C0165
0173         ?C0164:
                                           ; SOURCE LINE # 947
                                           ; SOURCE LINE # 948
0173 7F00              MOV     R7,#00H
0175 7E40              MOV     R6,#040H
0177 7DFF              MOV     R5,#0FFH
0179 7CFF              MOV     R4,#0FFH
017B 900000      R     MOV     DPTR,#aux
017E E0                MOVX    A,@DPTR
017F F8                MOV     R0,A
0180 A3                INC     DPTR
0181 E0                MOVX    A,@DPTR
0182 F9                MOV     R1,A
0183 A3                INC     DPTR
0184 E0                MOVX    A,@DPTR
0185 FA                MOV     R2,A
0186 A3                INC     DPTR
0187 E0                MOVX    A,@DPTR
0188 FB                MOV     R3,A
0189 C3                CLR     C
018A 120000      E     LCALL   ?C?SLCMP
018D 5010              JNC     ?C0166
                                           ; SOURCE LINE # 949
018F 7400        E     MOV     A,#LOW g_meas+014H
0191 2500        R     ADD     A,index
0193 F582              MOV     DPL,A
0195 E4                CLR     A
0196 3400        E     ADDC    A,#HIGH g_meas+014H
0198 F583              MOV     DPH,A
019A E0                MOVX    A,@DPTR
019B 04                INC     A
019C F0                MOVX    @DPTR,A
019D 803C              SJMP    ?C0165
019F         ?C0166:
                                           ; SOURCE LINE # 950
                                           ; SOURCE LINE # 951
019F 900000      R     MOV     DPTR,#aux
01A2 E0                MOVX    A,@DPTR
01A3 A3                INC     DPTR
01A4 E0                MOVX    A,@DPTR
01A5 A3                INC     DPTR
01A6 E0                MOVX    A,@DPTR
01A7 FE                MOV     R6,A
01A8 A3                INC     DPTR
01A9 E0                MOVX    A,@DPTR
01AA FF                MOV     R7,A
01AB 120000      E     LCALL   _abs
01AE D3                SETB    C
01AF EF                MOV     A,R7
01B0 9400              SUBB    A,#00H
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 91  

01B2 EE                MOV     A,R6
01B3 6480              XRL     A,#080H
01B5 94C0              SUBB    A,#0C0H
01B7 4022              JC      ?C0165
                                           ; SOURCE LINE # 952
01B9 7400        R     MOV     A,#LOW error
01BB 2500        R     ADD     A,index
01BD F582              MOV     DPL,A
01BF E4                CLR     A
01C0 3400        R     ADDC    A,#HIGH error
01C2 F583              MOV     DPH,A
01C4 E0                MOVX    A,@DPTR
01C5 04                INC     A
01C6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 953
01C7 7400        R     MOV     A,#LOW error
01C9 2500        R     ADD     A,index
01CB F582              MOV     DPL,A
01CD E4                CLR     A
01CE 3400        R     ADDC    A,#HIGH error
01D0 F583              MOV     DPH,A
01D2 E0                MOVX    A,@DPTR
01D3 C3                CLR     C
01D4 940A              SUBB    A,#0AH
01D6 5003              JNC     $ + 5H
01D8 020000      R     LJMP    ?C0153
01DB         ?C0169:
                                           ; SOURCE LINE # 956
                                           ; SOURCE LINE # 957
                                           ; SOURCE LINE # 958
01DB         ?C0165:
                                           ; SOURCE LINE # 960
01DB 7400        R     MOV     A,#LOW error
01DD 2500        R     ADD     A,index
01DF F582              MOV     DPL,A
01E1 E4                CLR     A
01E2 3400        R     ADDC    A,#HIGH error
01E4 F583              MOV     DPH,A
01E6 E4                CLR     A
01E7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 962
01E8 900000      R     MOV     DPTR,#value_encoder
01EB E0                MOVX    A,@DPTR
01EC FC                MOV     R4,A
01ED A3                INC     DPTR
01EE E0                MOVX    A,@DPTR
01EF FD                MOV     R5,A
01F0 A3                INC     DPTR
01F1 E0                MOVX    A,@DPTR
01F2 FE                MOV     R6,A
01F3 A3                INC     DPTR
01F4 E0                MOVX    A,@DPTR
01F5 FF                MOV     R7,A
01F6 E500        R     MOV     A,index
01F8 25E0              ADD     A,ACC
01FA 25E0              ADD     A,ACC
01FC 2400        R     ADD     A,#LOW last_value_encoder
01FE F582              MOV     DPL,A
0200 E4                CLR     A
0201 3400        R     ADDC    A,#HIGH last_value_encoder
0203 F583              MOV     DPH,A
0205 120000      E     LCALL   ?C?LSTXDATA
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 92  

                                           ; SOURCE LINE # 964
0208 900000      R     MOV     DPTR,#value_encoder
020B E0                MOVX    A,@DPTR
020C F8                MOV     R0,A
020D A3                INC     DPTR
020E E0                MOVX    A,@DPTR
020F F9                MOV     R1,A
0210 A3                INC     DPTR
0211 E0                MOVX    A,@DPTR
0212 FA                MOV     R2,A
0213 A3                INC     DPTR
0214 E0                MOVX    A,@DPTR
0215 FB                MOV     R3,A
0216 C000              PUSH    AR0
0218 7400        E     MOV     A,#LOW g_meas+014H
021A 2500        R     ADD     A,index
021C F582              MOV     DPL,A
021E E4                CLR     A
021F 3400        E     ADDC    A,#HIGH g_meas+014H
0221 F583              MOV     DPH,A
0223 E0                MOVX    A,@DPTR
0224 FF                MOV     R7,A
0225 33                RLC     A
0226 95E0              SUBB    A,ACC
0228 FE                MOV     R6,A
0229 FD                MOV     R5,A
022A FC                MOV     R4,A
022B 7810              MOV     R0,#010H
022D 120000      E     LCALL   ?C?LSHL
0230 D000              POP     AR0
0232 EB                MOV     A,R3
0233 2F                ADD     A,R7
0234 FF                MOV     R7,A
0235 EA                MOV     A,R2
0236 3E                ADDC    A,R6
0237 FE                MOV     R6,A
0238 E9                MOV     A,R1
0239 3D                ADDC    A,R5
023A FD                MOV     R5,A
023B E8                MOV     A,R0
023C 3C                ADDC    A,R4
023D FC                MOV     R4,A
023E 900000      R     MOV     DPTR,#value_encoder
0241 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 966
0244 E500        R     MOV     A,index
0246 25E0              ADD     A,ACC
0248 25E0              ADD     A,ACC
024A 2400        E     ADD     A,#LOW c_mem+044H
024C F582              MOV     DPL,A
024E E4                CLR     A
024F 3400        E     ADDC    A,#HIGH c_mem+044H
0251 F583              MOV     DPH,A
0253 E0                MOVX    A,@DPTR
0254 FC                MOV     R4,A
0255 A3                INC     DPTR
0256 E0                MOVX    A,@DPTR
0257 FD                MOV     R5,A
0258 A3                INC     DPTR
0259 E0                MOVX    A,@DPTR
025A FE                MOV     R6,A
025B A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 93  

025C E0                MOVX    A,@DPTR
025D FF                MOV     R7,A
025E E4                CLR     A
025F FB                MOV     R3,A
0260 FA                MOV     R2,A
0261 7980              MOV     R1,#080H
0263 783F              MOV     R0,#03FH
0265 120000      E     LCALL   ?C?FPCMP3
0268 6038              JZ      ?C0170
                                           ; SOURCE LINE # 967
026A 900000      R     MOV     DPTR,#value_encoder
026D E0                MOVX    A,@DPTR
026E FC                MOV     R4,A
026F A3                INC     DPTR
0270 E0                MOVX    A,@DPTR
0271 FD                MOV     R5,A
0272 A3                INC     DPTR
0273 E0                MOVX    A,@DPTR
0274 FE                MOV     R6,A
0275 A3                INC     DPTR
0276 E0                MOVX    A,@DPTR
0277 FF                MOV     R7,A
0278 EC                MOV     A,R4
0279 120000      E     LCALL   ?C?FCASTL
027C E500        R     MOV     A,index
027E 25E0              ADD     A,ACC
0280 25E0              ADD     A,ACC
0282 2400        E     ADD     A,#LOW c_mem+044H
0284 F582              MOV     DPL,A
0286 E4                CLR     A
0287 3400        E     ADDC    A,#HIGH c_mem+044H
0289 F583              MOV     DPH,A
028B E0                MOVX    A,@DPTR
028C F8                MOV     R0,A
028D A3                INC     DPTR
028E E0                MOVX    A,@DPTR
028F F9                MOV     R1,A
0290 A3                INC     DPTR
0291 E0                MOVX    A,@DPTR
0292 FA                MOV     R2,A
0293 A3                INC     DPTR
0294 E0                MOVX    A,@DPTR
0295 FB                MOV     R3,A
0296 120000      E     LCALL   ?C?FPMUL
0299 120000      E     LCALL   ?C?CASTF
029C 900000      R     MOV     DPTR,#value_encoder
029F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 968
02A2         ?C0170:
                                           ; SOURCE LINE # 970
02A2 900000      R     MOV     DPTR,#value_encoder
02A5 E0                MOVX    A,@DPTR
02A6 FC                MOV     R4,A
02A7 A3                INC     DPTR
02A8 E0                MOVX    A,@DPTR
02A9 FD                MOV     R5,A
02AA A3                INC     DPTR
02AB E0                MOVX    A,@DPTR
02AC FE                MOV     R6,A
02AD A3                INC     DPTR
02AE E0                MOVX    A,@DPTR
02AF FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 94  

02B0 E500        R     MOV     A,index
02B2 25E0              ADD     A,ACC
02B4 25E0              ADD     A,ACC
02B6 2400        E     ADD     A,#LOW g_meas
02B8 F582              MOV     DPL,A
02BA E4                CLR     A
02BB 3400        E     ADDC    A,#HIGH g_meas
02BD F583              MOV     DPH,A
02BF 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 971
02C2         ?C0161:
                                           ; SOURCE LINE # 973
02C2 E500        R     MOV     A,index
02C4 14                DEC     A
02C5 7003              JNZ     $ + 5H
02C7 020000      R     LJMP    ?C0173
02CA 14                DEC     A
02CB 7003              JNZ     $ + 5H
02CD 020000      R     LJMP    ?C0174
02D0 2402              ADD     A,#02H
02D2 6003              JZ      $ + 5H
02D4 020000      R     LJMP    ?C0171
                                           ; SOURCE LINE # 974
02D7         ?C0172:
                                           ; SOURCE LINE # 975
02D7 E4                CLR     A
02D8 7F03              MOV     R7,#03H
02DA FE                MOV     R6,A
02DB FD                MOV     R5,A
02DC FC                MOV     R4,A
02DD 900000      R     MOV     DPTR,#value_encoder
02E0 E0                MOVX    A,@DPTR
02E1 F8                MOV     R0,A
02E2 A3                INC     DPTR
02E3 E0                MOVX    A,@DPTR
02E4 F9                MOV     R1,A
02E5 A3                INC     DPTR
02E6 E0                MOVX    A,@DPTR
02E7 FA                MOV     R2,A
02E8 A3                INC     DPTR
02E9 E0                MOVX    A,@DPTR
02EA FB                MOV     R3,A
02EB 120000      E     LCALL   ?C?LMUL
02EE 900000      R     MOV     DPTR,#v_value
02F1 E0                MOVX    A,@DPTR
02F2 F8                MOV     R0,A
02F3 A3                INC     DPTR
02F4 E0                MOVX    A,@DPTR
02F5 F9                MOV     R1,A
02F6 A3                INC     DPTR
02F7 E0                MOVX    A,@DPTR
02F8 FA                MOV     R2,A
02F9 A3                INC     DPTR
02FA E0                MOVX    A,@DPTR
02FB 2F                ADD     A,R7
02FC FF                MOV     R7,A
02FD EA                MOV     A,R2
02FE 3E                ADDC    A,R6
02FF FE                MOV     R6,A
0300 E9                MOV     A,R1
0301 3D                ADDC    A,R5
0302 FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 95  

0303 E8                MOV     A,R0
0304 3C                ADDC    A,R4
0305 FC                MOV     R4,A
0306 900000      R     MOV     DPTR,#vv_value
0309 E0                MOVX    A,@DPTR
030A F8                MOV     R0,A
030B A3                INC     DPTR
030C E0                MOVX    A,@DPTR
030D F9                MOV     R1,A
030E A3                INC     DPTR
030F E0                MOVX    A,@DPTR
0310 FA                MOV     R2,A
0311 A3                INC     DPTR
0312 E0                MOVX    A,@DPTR
0313 FB                MOV     R3,A
0314 C3                CLR     C
0315 EF                MOV     A,R7
0316 9B                SUBB    A,R3
0317 FF                MOV     R7,A
0318 EE                MOV     A,R6
0319 9A                SUBB    A,R2
031A FE                MOV     R6,A
031B ED                MOV     A,R5
031C 99                SUBB    A,R1
031D FD                MOV     R5,A
031E EC                MOV     A,R4
031F 98                SUBB    A,R0
0320 FC                MOV     R4,A
0321 C004              PUSH    AR4
0323 C005              PUSH    AR5
0325 C006              PUSH    AR6
0327 C007              PUSH    AR7
0329 E4                CLR     A
032A 7F03              MOV     R7,#03H
032C FE                MOV     R6,A
032D FD                MOV     R5,A
032E FC                MOV     R4,A
032F 900000      R     MOV     DPTR,#vvv_value
0332 E0                MOVX    A,@DPTR
0333 F8                MOV     R0,A
0334 A3                INC     DPTR
0335 E0                MOVX    A,@DPTR
0336 F9                MOV     R1,A
0337 A3                INC     DPTR
0338 E0                MOVX    A,@DPTR
0339 FA                MOV     R2,A
033A A3                INC     DPTR
033B E0                MOVX    A,@DPTR
033C FB                MOV     R3,A
033D 120000      E     LCALL   ?C?LMUL
0340 A804              MOV     R0,AR4
0342 A905              MOV     R1,AR5
0344 AA06              MOV     R2,AR6
0346 AB07              MOV     R3,AR7
0348 D007              POP     AR7
034A D006              POP     AR6
034C D005              POP     AR5
034E D004              POP     AR4
0350 C3                CLR     C
0351 EF                MOV     A,R7
0352 9B                SUBB    A,R3
0353 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 96  

0354 EE                MOV     A,R6
0355 9A                SUBB    A,R2
0356 FE                MOV     R6,A
0357 ED                MOV     A,R5
0358 99                SUBB    A,R1
0359 FD                MOV     R5,A
035A EC                MOV     A,R4
035B 98                SUBB    A,R0
035C FC                MOV     R4,A
035D E4                CLR     A
035E 7B0A              MOV     R3,#0AH
0360 FA                MOV     R2,A
0361 F9                MOV     R1,A
0362 F8                MOV     R0,A
0363 120000      E     LCALL   ?C?LMUL
0366 120000      E     LCALL   _filter_vel_1
0369 EE                MOV     A,R6
036A 33                RLC     A
036B 95E0              SUBB    A,ACC
036D FD                MOV     R5,A
036E FC                MOV     R4,A
036F 900000      R     MOV     DPTR,#speed_encoder
0372 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 976
0375 020000      R     LJMP    ?C0171
                                           ; SOURCE LINE # 977
                                           ; SOURCE LINE # 978
0378         ?C0173:
                                           ; SOURCE LINE # 979
0378 E4                CLR     A
0379 7F03              MOV     R7,#03H
037B FE                MOV     R6,A
037C FD                MOV     R5,A
037D FC                MOV     R4,A
037E 900000      R     MOV     DPTR,#value_encoder
0381 E0                MOVX    A,@DPTR
0382 F8                MOV     R0,A
0383 A3                INC     DPTR
0384 E0                MOVX    A,@DPTR
0385 F9                MOV     R1,A
0386 A3                INC     DPTR
0387 E0                MOVX    A,@DPTR
0388 FA                MOV     R2,A
0389 A3                INC     DPTR
038A E0                MOVX    A,@DPTR
038B FB                MOV     R3,A
038C 120000      E     LCALL   ?C?LMUL
038F 900000      R     MOV     DPTR,#v_value+04H
0392 E0                MOVX    A,@DPTR
0393 F8                MOV     R0,A
0394 A3                INC     DPTR
0395 E0                MOVX    A,@DPTR
0396 F9                MOV     R1,A
0397 A3                INC     DPTR
0398 E0                MOVX    A,@DPTR
0399 FA                MOV     R2,A
039A A3                INC     DPTR
039B E0                MOVX    A,@DPTR
039C 2F                ADD     A,R7
039D FF                MOV     R7,A
039E EA                MOV     A,R2
039F 3E                ADDC    A,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 97  

03A0 FE                MOV     R6,A
03A1 E9                MOV     A,R1
03A2 3D                ADDC    A,R5
03A3 FD                MOV     R5,A
03A4 E8                MOV     A,R0
03A5 3C                ADDC    A,R4
03A6 FC                MOV     R4,A
03A7 900000      R     MOV     DPTR,#vv_value+04H
03AA E0                MOVX    A,@DPTR
03AB F8                MOV     R0,A
03AC A3                INC     DPTR
03AD E0                MOVX    A,@DPTR
03AE F9                MOV     R1,A
03AF A3                INC     DPTR
03B0 E0                MOVX    A,@DPTR
03B1 FA                MOV     R2,A
03B2 A3                INC     DPTR
03B3 E0                MOVX    A,@DPTR
03B4 FB                MOV     R3,A
03B5 C3                CLR     C
03B6 EF                MOV     A,R7
03B7 9B                SUBB    A,R3
03B8 FF                MOV     R7,A
03B9 EE                MOV     A,R6
03BA 9A                SUBB    A,R2
03BB FE                MOV     R6,A
03BC ED                MOV     A,R5
03BD 99                SUBB    A,R1
03BE FD                MOV     R5,A
03BF EC                MOV     A,R4
03C0 98                SUBB    A,R0
03C1 FC                MOV     R4,A
03C2 C004              PUSH    AR4
03C4 C005              PUSH    AR5
03C6 C006              PUSH    AR6
03C8 C007              PUSH    AR7
03CA E4                CLR     A
03CB 7F03              MOV     R7,#03H
03CD FE                MOV     R6,A
03CE FD                MOV     R5,A
03CF FC                MOV     R4,A
03D0 900000      R     MOV     DPTR,#vvv_value+04H
03D3 E0                MOVX    A,@DPTR
03D4 F8                MOV     R0,A
03D5 A3                INC     DPTR
03D6 E0                MOVX    A,@DPTR
03D7 F9                MOV     R1,A
03D8 A3                INC     DPTR
03D9 E0                MOVX    A,@DPTR
03DA FA                MOV     R2,A
03DB A3                INC     DPTR
03DC E0                MOVX    A,@DPTR
03DD FB                MOV     R3,A
03DE 120000      E     LCALL   ?C?LMUL
03E1 A804              MOV     R0,AR4
03E3 A905              MOV     R1,AR5
03E5 AA06              MOV     R2,AR6
03E7 AB07              MOV     R3,AR7
03E9 D007              POP     AR7
03EB D006              POP     AR6
03ED D005              POP     AR5
03EF D004              POP     AR4
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 98  

03F1 C3                CLR     C
03F2 EF                MOV     A,R7
03F3 9B                SUBB    A,R3
03F4 FF                MOV     R7,A
03F5 EE                MOV     A,R6
03F6 9A                SUBB    A,R2
03F7 FE                MOV     R6,A
03F8 ED                MOV     A,R5
03F9 99                SUBB    A,R1
03FA FD                MOV     R5,A
03FB EC                MOV     A,R4
03FC 98                SUBB    A,R0
03FD FC                MOV     R4,A
03FE E4                CLR     A
03FF 7B0A              MOV     R3,#0AH
0401 FA                MOV     R2,A
0402 F9                MOV     R1,A
0403 F8                MOV     R0,A
0404 120000      E     LCALL   ?C?LMUL
0407 120000      E     LCALL   _filter_vel_2
040A EE                MOV     A,R6
040B 33                RLC     A
040C 95E0              SUBB    A,ACC
040E FD                MOV     R5,A
040F FC                MOV     R4,A
0410 900000      R     MOV     DPTR,#speed_encoder
0413 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 980
0416 020000      R     LJMP    ?C0171
                                           ; SOURCE LINE # 981
                                           ; SOURCE LINE # 982
0419         ?C0174:
                                           ; SOURCE LINE # 983
0419 E4                CLR     A
041A 7F03              MOV     R7,#03H
041C FE                MOV     R6,A
041D FD                MOV     R5,A
041E FC                MOV     R4,A
041F 900000      R     MOV     DPTR,#value_encoder
0422 E0                MOVX    A,@DPTR
0423 F8                MOV     R0,A
0424 A3                INC     DPTR
0425 E0                MOVX    A,@DPTR
0426 F9                MOV     R1,A
0427 A3                INC     DPTR
0428 E0                MOVX    A,@DPTR
0429 FA                MOV     R2,A
042A A3                INC     DPTR
042B E0                MOVX    A,@DPTR
042C FB                MOV     R3,A
042D 120000      E     LCALL   ?C?LMUL
0430 900000      R     MOV     DPTR,#v_value+08H
0433 E0                MOVX    A,@DPTR
0434 F8                MOV     R0,A
0435 A3                INC     DPTR
0436 E0                MOVX    A,@DPTR
0437 F9                MOV     R1,A
0438 A3                INC     DPTR
0439 E0                MOVX    A,@DPTR
043A FA                MOV     R2,A
043B A3                INC     DPTR
043C E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 99  

043D 2F                ADD     A,R7
043E FF                MOV     R7,A
043F EA                MOV     A,R2
0440 3E                ADDC    A,R6
0441 FE                MOV     R6,A
0442 E9                MOV     A,R1
0443 3D                ADDC    A,R5
0444 FD                MOV     R5,A
0445 E8                MOV     A,R0
0446 3C                ADDC    A,R4
0447 FC                MOV     R4,A
0448 900000      R     MOV     DPTR,#vv_value+08H
044B E0                MOVX    A,@DPTR
044C F8                MOV     R0,A
044D A3                INC     DPTR
044E E0                MOVX    A,@DPTR
044F F9                MOV     R1,A
0450 A3                INC     DPTR
0451 E0                MOVX    A,@DPTR
0452 FA                MOV     R2,A
0453 A3                INC     DPTR
0454 E0                MOVX    A,@DPTR
0455 FB                MOV     R3,A
0456 C3                CLR     C
0457 EF                MOV     A,R7
0458 9B                SUBB    A,R3
0459 FF                MOV     R7,A
045A EE                MOV     A,R6
045B 9A                SUBB    A,R2
045C FE                MOV     R6,A
045D ED                MOV     A,R5
045E 99                SUBB    A,R1
045F FD                MOV     R5,A
0460 EC                MOV     A,R4
0461 98                SUBB    A,R0
0462 FC                MOV     R4,A
0463 C004              PUSH    AR4
0465 C005              PUSH    AR5
0467 C006              PUSH    AR6
0469 C007              PUSH    AR7
046B E4                CLR     A
046C 7F03              MOV     R7,#03H
046E FE                MOV     R6,A
046F FD                MOV     R5,A
0470 FC                MOV     R4,A
0471 900000      R     MOV     DPTR,#vvv_value+08H
0474 E0                MOVX    A,@DPTR
0475 F8                MOV     R0,A
0476 A3                INC     DPTR
0477 E0                MOVX    A,@DPTR
0478 F9                MOV     R1,A
0479 A3                INC     DPTR
047A E0                MOVX    A,@DPTR
047B FA                MOV     R2,A
047C A3                INC     DPTR
047D E0                MOVX    A,@DPTR
047E FB                MOV     R3,A
047F 120000      E     LCALL   ?C?LMUL
0482 A804              MOV     R0,AR4
0484 A905              MOV     R1,AR5
0486 AA06              MOV     R2,AR6
0488 AB07              MOV     R3,AR7
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 100 

048A D007              POP     AR7
048C D006              POP     AR6
048E D005              POP     AR5
0490 D004              POP     AR4
0492 C3                CLR     C
0493 EF                MOV     A,R7
0494 9B                SUBB    A,R3
0495 FF                MOV     R7,A
0496 EE                MOV     A,R6
0497 9A                SUBB    A,R2
0498 FE                MOV     R6,A
0499 ED                MOV     A,R5
049A 99                SUBB    A,R1
049B FD                MOV     R5,A
049C EC                MOV     A,R4
049D 98                SUBB    A,R0
049E FC                MOV     R4,A
049F E4                CLR     A
04A0 7B0A              MOV     R3,#0AH
04A2 FA                MOV     R2,A
04A3 F9                MOV     R1,A
04A4 F8                MOV     R0,A
04A5 120000      E     LCALL   ?C?LMUL
04A8 120000      E     LCALL   _filter_vel_3
04AB EE                MOV     A,R6
04AC 33                RLC     A
04AD 95E0              SUBB    A,ACC
04AF FD                MOV     R5,A
04B0 FC                MOV     R4,A
04B1 900000      R     MOV     DPTR,#speed_encoder
04B4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 984
                                           ; SOURCE LINE # 985
                                           ; SOURCE LINE # 986
04B7         ?C0171:
                                           ; SOURCE LINE # 988
04B7 900000      R     MOV     DPTR,#speed_encoder
04BA E0                MOVX    A,@DPTR
04BB FC                MOV     R4,A
04BC A3                INC     DPTR
04BD E0                MOVX    A,@DPTR
04BE FD                MOV     R5,A
04BF A3                INC     DPTR
04C0 E0                MOVX    A,@DPTR
04C1 FE                MOV     R6,A
04C2 A3                INC     DPTR
04C3 E0                MOVX    A,@DPTR
04C4 FF                MOV     R7,A
04C5 E500        R     MOV     A,index
04C7 25E0              ADD     A,ACC
04C9 25E0              ADD     A,ACC
04CB 2400        E     ADD     A,#LOW g_meas+01FH
04CD F582              MOV     DPL,A
04CF E4                CLR     A
04D0 3400        E     ADDC    A,#HIGH g_meas+01FH
04D2 F583              MOV     DPH,A
04D4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 991
04D7 E500        R     MOV     A,index
04D9 14                DEC     A
04DA 7003              JNZ     $ + 5H
04DC 020000      R     LJMP    ?C0177
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 101 

04DF 14                DEC     A
04E0 7003              JNZ     $ + 5H
04E2 020000      R     LJMP    ?C0178
04E5 2402              ADD     A,#02H
04E7 6003              JZ      $ + 5H
04E9 020000      R     LJMP    ?C0175
                                           ; SOURCE LINE # 992
04EC         ?C0176:
                                           ; SOURCE LINE # 993
04EC E4                CLR     A
04ED 7F03              MOV     R7,#03H
04EF FE                MOV     R6,A
04F0 FD                MOV     R5,A
04F1 FC                MOV     R4,A
04F2 900000      R     MOV     DPTR,#speed_encoder
04F5 E0                MOVX    A,@DPTR
04F6 F8                MOV     R0,A
04F7 A3                INC     DPTR
04F8 E0                MOVX    A,@DPTR
04F9 F9                MOV     R1,A
04FA A3                INC     DPTR
04FB E0                MOVX    A,@DPTR
04FC FA                MOV     R2,A
04FD A3                INC     DPTR
04FE E0                MOVX    A,@DPTR
04FF FB                MOV     R3,A
0500 120000      E     LCALL   ?C?LMUL
0503 900000      R     MOV     DPTR,#a_value
0506 E0                MOVX    A,@DPTR
0507 F8                MOV     R0,A
0508 A3                INC     DPTR
0509 E0                MOVX    A,@DPTR
050A F9                MOV     R1,A
050B A3                INC     DPTR
050C E0                MOVX    A,@DPTR
050D FA                MOV     R2,A
050E A3                INC     DPTR
050F E0                MOVX    A,@DPTR
0510 2F                ADD     A,R7
0511 FF                MOV     R7,A
0512 EA                MOV     A,R2
0513 3E                ADDC    A,R6
0514 FE                MOV     R6,A
0515 E9                MOV     A,R1
0516 3D                ADDC    A,R5
0517 FD                MOV     R5,A
0518 E8                MOV     A,R0
0519 3C                ADDC    A,R4
051A FC                MOV     R4,A
051B 900000      R     MOV     DPTR,#aa_value
051E E0                MOVX    A,@DPTR
051F F8                MOV     R0,A
0520 A3                INC     DPTR
0521 E0                MOVX    A,@DPTR
0522 F9                MOV     R1,A
0523 A3                INC     DPTR
0524 E0                MOVX    A,@DPTR
0525 FA                MOV     R2,A
0526 A3                INC     DPTR
0527 E0                MOVX    A,@DPTR
0528 FB                MOV     R3,A
0529 C3                CLR     C
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 102 

052A EF                MOV     A,R7
052B 9B                SUBB    A,R3
052C FF                MOV     R7,A
052D EE                MOV     A,R6
052E 9A                SUBB    A,R2
052F FE                MOV     R6,A
0530 ED                MOV     A,R5
0531 99                SUBB    A,R1
0532 FD                MOV     R5,A
0533 EC                MOV     A,R4
0534 98                SUBB    A,R0
0535 FC                MOV     R4,A
0536 C004              PUSH    AR4
0538 C005              PUSH    AR5
053A C006              PUSH    AR6
053C C007              PUSH    AR7
053E E4                CLR     A
053F 7F03              MOV     R7,#03H
0541 FE                MOV     R6,A
0542 FD                MOV     R5,A
0543 FC                MOV     R4,A
0544 900000      R     MOV     DPTR,#aaa_value
0547 E0                MOVX    A,@DPTR
0548 F8                MOV     R0,A
0549 A3                INC     DPTR
054A E0                MOVX    A,@DPTR
054B F9                MOV     R1,A
054C A3                INC     DPTR
054D E0                MOVX    A,@DPTR
054E FA                MOV     R2,A
054F A3                INC     DPTR
0550 E0                MOVX    A,@DPTR
0551 FB                MOV     R3,A
0552 120000      E     LCALL   ?C?LMUL
0555 A804              MOV     R0,AR4
0557 A905              MOV     R1,AR5
0559 AA06              MOV     R2,AR6
055B AB07              MOV     R3,AR7
055D D007              POP     AR7
055F D006              POP     AR6
0561 D005              POP     AR5
0563 D004              POP     AR4
0565 C3                CLR     C
0566 EF                MOV     A,R7
0567 9B                SUBB    A,R3
0568 FF                MOV     R7,A
0569 EE                MOV     A,R6
056A 9A                SUBB    A,R2
056B FE                MOV     R6,A
056C ED                MOV     A,R5
056D 99                SUBB    A,R1
056E FD                MOV     R5,A
056F EC                MOV     A,R4
0570 98                SUBB    A,R0
0571 FC                MOV     R4,A
0572 E4                CLR     A
0573 7B0A              MOV     R3,#0AH
0575 FA                MOV     R2,A
0576 F9                MOV     R1,A
0577 F8                MOV     R0,A
0578 120000      E     LCALL   ?C?LMUL
057B 120000      E     LCALL   _filter_acc_1
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 103 

057E EE                MOV     A,R6
057F 33                RLC     A
0580 95E0              SUBB    A,ACC
0582 FD                MOV     R5,A
0583 FC                MOV     R4,A
0584 900000      R     MOV     DPTR,#accel_encoder
0587 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 994
058A 020000      R     LJMP    ?C0175
                                           ; SOURCE LINE # 996
058D         ?C0177:
                                           ; SOURCE LINE # 997
058D E4                CLR     A
058E 7F03              MOV     R7,#03H
0590 FE                MOV     R6,A
0591 FD                MOV     R5,A
0592 FC                MOV     R4,A
0593 900000      R     MOV     DPTR,#speed_encoder
0596 E0                MOVX    A,@DPTR
0597 F8                MOV     R0,A
0598 A3                INC     DPTR
0599 E0                MOVX    A,@DPTR
059A F9                MOV     R1,A
059B A3                INC     DPTR
059C E0                MOVX    A,@DPTR
059D FA                MOV     R2,A
059E A3                INC     DPTR
059F E0                MOVX    A,@DPTR
05A0 FB                MOV     R3,A
05A1 120000      E     LCALL   ?C?LMUL
05A4 900000      R     MOV     DPTR,#a_value+04H
05A7 E0                MOVX    A,@DPTR
05A8 F8                MOV     R0,A
05A9 A3                INC     DPTR
05AA E0                MOVX    A,@DPTR
05AB F9                MOV     R1,A
05AC A3                INC     DPTR
05AD E0                MOVX    A,@DPTR
05AE FA                MOV     R2,A
05AF A3                INC     DPTR
05B0 E0                MOVX    A,@DPTR
05B1 2F                ADD     A,R7
05B2 FF                MOV     R7,A
05B3 EA                MOV     A,R2
05B4 3E                ADDC    A,R6
05B5 FE                MOV     R6,A
05B6 E9                MOV     A,R1
05B7 3D                ADDC    A,R5
05B8 FD                MOV     R5,A
05B9 E8                MOV     A,R0
05BA 3C                ADDC    A,R4
05BB FC                MOV     R4,A
05BC 900000      R     MOV     DPTR,#aa_value+04H
05BF E0                MOVX    A,@DPTR
05C0 F8                MOV     R0,A
05C1 A3                INC     DPTR
05C2 E0                MOVX    A,@DPTR
05C3 F9                MOV     R1,A
05C4 A3                INC     DPTR
05C5 E0                MOVX    A,@DPTR
05C6 FA                MOV     R2,A
05C7 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 104 

05C8 E0                MOVX    A,@DPTR
05C9 FB                MOV     R3,A
05CA C3                CLR     C
05CB EF                MOV     A,R7
05CC 9B                SUBB    A,R3
05CD FF                MOV     R7,A
05CE EE                MOV     A,R6
05CF 9A                SUBB    A,R2
05D0 FE                MOV     R6,A
05D1 ED                MOV     A,R5
05D2 99                SUBB    A,R1
05D3 FD                MOV     R5,A
05D4 EC                MOV     A,R4
05D5 98                SUBB    A,R0
05D6 FC                MOV     R4,A
05D7 C004              PUSH    AR4
05D9 C005              PUSH    AR5
05DB C006              PUSH    AR6
05DD C007              PUSH    AR7
05DF E4                CLR     A
05E0 7F03              MOV     R7,#03H
05E2 FE                MOV     R6,A
05E3 FD                MOV     R5,A
05E4 FC                MOV     R4,A
05E5 900000      R     MOV     DPTR,#aaa_value+04H
05E8 E0                MOVX    A,@DPTR
05E9 F8                MOV     R0,A
05EA A3                INC     DPTR
05EB E0                MOVX    A,@DPTR
05EC F9                MOV     R1,A
05ED A3                INC     DPTR
05EE E0                MOVX    A,@DPTR
05EF FA                MOV     R2,A
05F0 A3                INC     DPTR
05F1 E0                MOVX    A,@DPTR
05F2 FB                MOV     R3,A
05F3 120000      E     LCALL   ?C?LMUL
05F6 A804              MOV     R0,AR4
05F8 A905              MOV     R1,AR5
05FA AA06              MOV     R2,AR6
05FC AB07              MOV     R3,AR7
05FE D007              POP     AR7
0600 D006              POP     AR6
0602 D005              POP     AR5
0604 D004              POP     AR4
0606 C3                CLR     C
0607 EF                MOV     A,R7
0608 9B                SUBB    A,R3
0609 FF                MOV     R7,A
060A EE                MOV     A,R6
060B 9A                SUBB    A,R2
060C FE                MOV     R6,A
060D ED                MOV     A,R5
060E 99                SUBB    A,R1
060F FD                MOV     R5,A
0610 EC                MOV     A,R4
0611 98                SUBB    A,R0
0612 FC                MOV     R4,A
0613 E4                CLR     A
0614 7B0A              MOV     R3,#0AH
0616 FA                MOV     R2,A
0617 F9                MOV     R1,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 105 

0618 F8                MOV     R0,A
0619 120000      E     LCALL   ?C?LMUL
061C 120000      E     LCALL   _filter_acc_2
061F EE                MOV     A,R6
0620 33                RLC     A
0621 95E0              SUBB    A,ACC
0623 FD                MOV     R5,A
0624 FC                MOV     R4,A
0625 900000      R     MOV     DPTR,#accel_encoder
0628 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 998
062B 020000      R     LJMP    ?C0175
                                           ; SOURCE LINE # 1000
062E         ?C0178:
                                           ; SOURCE LINE # 1001
062E E4                CLR     A
062F 7F03              MOV     R7,#03H
0631 FE                MOV     R6,A
0632 FD                MOV     R5,A
0633 FC                MOV     R4,A
0634 900000      R     MOV     DPTR,#speed_encoder
0637 E0                MOVX    A,@DPTR
0638 F8                MOV     R0,A
0639 A3                INC     DPTR
063A E0                MOVX    A,@DPTR
063B F9                MOV     R1,A
063C A3                INC     DPTR
063D E0                MOVX    A,@DPTR
063E FA                MOV     R2,A
063F A3                INC     DPTR
0640 E0                MOVX    A,@DPTR
0641 FB                MOV     R3,A
0642 120000      E     LCALL   ?C?LMUL
0645 900000      R     MOV     DPTR,#a_value+08H
0648 E0                MOVX    A,@DPTR
0649 F8                MOV     R0,A
064A A3                INC     DPTR
064B E0                MOVX    A,@DPTR
064C F9                MOV     R1,A
064D A3                INC     DPTR
064E E0                MOVX    A,@DPTR
064F FA                MOV     R2,A
0650 A3                INC     DPTR
0651 E0                MOVX    A,@DPTR
0652 2F                ADD     A,R7
0653 FF                MOV     R7,A
0654 EA                MOV     A,R2
0655 3E                ADDC    A,R6
0656 FE                MOV     R6,A
0657 E9                MOV     A,R1
0658 3D                ADDC    A,R5
0659 FD                MOV     R5,A
065A E8                MOV     A,R0
065B 3C                ADDC    A,R4
065C FC                MOV     R4,A
065D 900000      R     MOV     DPTR,#aa_value+08H
0660 E0                MOVX    A,@DPTR
0661 F8                MOV     R0,A
0662 A3                INC     DPTR
0663 E0                MOVX    A,@DPTR
0664 F9                MOV     R1,A
0665 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 106 

0666 E0                MOVX    A,@DPTR
0667 FA                MOV     R2,A
0668 A3                INC     DPTR
0669 E0                MOVX    A,@DPTR
066A FB                MOV     R3,A
066B C3                CLR     C
066C EF                MOV     A,R7
066D 9B                SUBB    A,R3
066E FF                MOV     R7,A
066F EE                MOV     A,R6
0670 9A                SUBB    A,R2
0671 FE                MOV     R6,A
0672 ED                MOV     A,R5
0673 99                SUBB    A,R1
0674 FD                MOV     R5,A
0675 EC                MOV     A,R4
0676 98                SUBB    A,R0
0677 FC                MOV     R4,A
0678 C004              PUSH    AR4
067A C005              PUSH    AR5
067C C006              PUSH    AR6
067E C007              PUSH    AR7
0680 E4                CLR     A
0681 7F03              MOV     R7,#03H
0683 FE                MOV     R6,A
0684 FD                MOV     R5,A
0685 FC                MOV     R4,A
0686 900000      R     MOV     DPTR,#aaa_value+08H
0689 E0                MOVX    A,@DPTR
068A F8                MOV     R0,A
068B A3                INC     DPTR
068C E0                MOVX    A,@DPTR
068D F9                MOV     R1,A
068E A3                INC     DPTR
068F E0                MOVX    A,@DPTR
0690 FA                MOV     R2,A
0691 A3                INC     DPTR
0692 E0                MOVX    A,@DPTR
0693 FB                MOV     R3,A
0694 120000      E     LCALL   ?C?LMUL
0697 A804              MOV     R0,AR4
0699 A905              MOV     R1,AR5
069B AA06              MOV     R2,AR6
069D AB07              MOV     R3,AR7
069F D007              POP     AR7
06A1 D006              POP     AR6
06A3 D005              POP     AR5
06A5 D004              POP     AR4
06A7 C3                CLR     C
06A8 EF                MOV     A,R7
06A9 9B                SUBB    A,R3
06AA FF                MOV     R7,A
06AB EE                MOV     A,R6
06AC 9A                SUBB    A,R2
06AD FE                MOV     R6,A
06AE ED                MOV     A,R5
06AF 99                SUBB    A,R1
06B0 FD                MOV     R5,A
06B1 EC                MOV     A,R4
06B2 98                SUBB    A,R0
06B3 FC                MOV     R4,A
06B4 E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 107 

06B5 7B0A              MOV     R3,#0AH
06B7 FA                MOV     R2,A
06B8 F9                MOV     R1,A
06B9 F8                MOV     R0,A
06BA 120000      E     LCALL   ?C?LMUL
06BD 120000      E     LCALL   _filter_acc_3
06C0 EE                MOV     A,R6
06C1 33                RLC     A
06C2 95E0              SUBB    A,ACC
06C4 FD                MOV     R5,A
06C5 FC                MOV     R4,A
06C6 900000      R     MOV     DPTR,#accel_encoder
06C9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1002
                                           ; SOURCE LINE # 1003
06CC         ?C0175:
                                           ; SOURCE LINE # 1005
06CC 900000      R     MOV     DPTR,#accel_encoder
06CF E0                MOVX    A,@DPTR
06D0 FC                MOV     R4,A
06D1 A3                INC     DPTR
06D2 E0                MOVX    A,@DPTR
06D3 FD                MOV     R5,A
06D4 A3                INC     DPTR
06D5 E0                MOVX    A,@DPTR
06D6 FE                MOV     R6,A
06D7 A3                INC     DPTR
06D8 E0                MOVX    A,@DPTR
06D9 FF                MOV     R7,A
06DA E500        R     MOV     A,index
06DC 25E0              ADD     A,ACC
06DE 25E0              ADD     A,ACC
06E0 2400        E     ADD     A,#LOW g_meas+02BH
06E2 F582              MOV     DPL,A
06E4 E4                CLR     A
06E5 3400        E     ADDC    A,#HIGH g_meas+02BH
06E7 F583              MOV     DPH,A
06E9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1008
06EC E500        R     MOV     A,index
06EE 25E0              ADD     A,ACC
06F0 25E0              ADD     A,ACC
06F2 2400        R     ADD     A,#LOW vv_value
06F4 F582              MOV     DPL,A
06F6 E4                CLR     A
06F7 3400        R     ADDC    A,#HIGH vv_value
06F9 F583              MOV     DPH,A
06FB E0                MOVX    A,@DPTR
06FC FC                MOV     R4,A
06FD A3                INC     DPTR
06FE E0                MOVX    A,@DPTR
06FF FD                MOV     R5,A
0700 A3                INC     DPTR
0701 E0                MOVX    A,@DPTR
0702 FE                MOV     R6,A
0703 A3                INC     DPTR
0704 E0                MOVX    A,@DPTR
0705 FF                MOV     R7,A
0706 E500        R     MOV     A,index
0708 25E0              ADD     A,ACC
070A 25E0              ADD     A,ACC
070C 2400        R     ADD     A,#LOW vvv_value
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 108 

070E F582              MOV     DPL,A
0710 E4                CLR     A
0711 3400        R     ADDC    A,#HIGH vvv_value
0713 F583              MOV     DPH,A
0715 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1009
0718 E500        R     MOV     A,index
071A 25E0              ADD     A,ACC
071C 25E0              ADD     A,ACC
071E 2400        R     ADD     A,#LOW v_value
0720 F582              MOV     DPL,A
0722 E4                CLR     A
0723 3400        R     ADDC    A,#HIGH v_value
0725 F583              MOV     DPH,A
0727 E0                MOVX    A,@DPTR
0728 FC                MOV     R4,A
0729 A3                INC     DPTR
072A E0                MOVX    A,@DPTR
072B FD                MOV     R5,A
072C A3                INC     DPTR
072D E0                MOVX    A,@DPTR
072E FE                MOV     R6,A
072F A3                INC     DPTR
0730 E0                MOVX    A,@DPTR
0731 FF                MOV     R7,A
0732 E500        R     MOV     A,index
0734 25E0              ADD     A,ACC
0736 25E0              ADD     A,ACC
0738 2400        R     ADD     A,#LOW vv_value
073A F582              MOV     DPL,A
073C E4                CLR     A
073D 3400        R     ADDC    A,#HIGH vv_value
073F F583              MOV     DPH,A
0741 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1010
0744 900000      R     MOV     DPTR,#value_encoder
0747 E0                MOVX    A,@DPTR
0748 FC                MOV     R4,A
0749 A3                INC     DPTR
074A E0                MOVX    A,@DPTR
074B FD                MOV     R5,A
074C A3                INC     DPTR
074D E0                MOVX    A,@DPTR
074E FE                MOV     R6,A
074F A3                INC     DPTR
0750 E0                MOVX    A,@DPTR
0751 FF                MOV     R7,A
0752 E500        R     MOV     A,index
0754 25E0              ADD     A,ACC
0756 25E0              ADD     A,ACC
0758 2400        R     ADD     A,#LOW v_value
075A F582              MOV     DPL,A
075C E4                CLR     A
075D 3400        R     ADDC    A,#HIGH v_value
075F F583              MOV     DPH,A
0761 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1012
0764 E500        R     MOV     A,index
0766 25E0              ADD     A,ACC
0768 25E0              ADD     A,ACC
076A 2400        R     ADD     A,#LOW aa_value
076C F582              MOV     DPL,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 109 

076E E4                CLR     A
076F 3400        R     ADDC    A,#HIGH aa_value
0771 F583              MOV     DPH,A
0773 E0                MOVX    A,@DPTR
0774 FC                MOV     R4,A
0775 A3                INC     DPTR
0776 E0                MOVX    A,@DPTR
0777 FD                MOV     R5,A
0778 A3                INC     DPTR
0779 E0                MOVX    A,@DPTR
077A FE                MOV     R6,A
077B A3                INC     DPTR
077C E0                MOVX    A,@DPTR
077D FF                MOV     R7,A
077E E500        R     MOV     A,index
0780 25E0              ADD     A,ACC
0782 25E0              ADD     A,ACC
0784 2400        R     ADD     A,#LOW aaa_value
0786 F582              MOV     DPL,A
0788 E4                CLR     A
0789 3400        R     ADDC    A,#HIGH aaa_value
078B F583              MOV     DPH,A
078D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1013
0790 E500        R     MOV     A,index
0792 25E0              ADD     A,ACC
0794 25E0              ADD     A,ACC
0796 2400        R     ADD     A,#LOW a_value
0798 F582              MOV     DPL,A
079A E4                CLR     A
079B 3400        R     ADDC    A,#HIGH a_value
079D F583              MOV     DPH,A
079F E0                MOVX    A,@DPTR
07A0 FC                MOV     R4,A
07A1 A3                INC     DPTR
07A2 E0                MOVX    A,@DPTR
07A3 FD                MOV     R5,A
07A4 A3                INC     DPTR
07A5 E0                MOVX    A,@DPTR
07A6 FE                MOV     R6,A
07A7 A3                INC     DPTR
07A8 E0                MOVX    A,@DPTR
07A9 FF                MOV     R7,A
07AA E500        R     MOV     A,index
07AC 25E0              ADD     A,ACC
07AE 25E0              ADD     A,ACC
07B0 2400        R     ADD     A,#LOW aa_value
07B2 F582              MOV     DPL,A
07B4 E4                CLR     A
07B5 3400        R     ADDC    A,#HIGH aa_value
07B7 F583              MOV     DPH,A
07B9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1014
07BC 900000      R     MOV     DPTR,#speed_encoder
07BF E0                MOVX    A,@DPTR
07C0 FC                MOV     R4,A
07C1 A3                INC     DPTR
07C2 E0                MOVX    A,@DPTR
07C3 FD                MOV     R5,A
07C4 A3                INC     DPTR
07C5 E0                MOVX    A,@DPTR
07C6 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 110 

07C7 A3                INC     DPTR
07C8 E0                MOVX    A,@DPTR
07C9 FF                MOV     R7,A
07CA E500        R     MOV     A,index
07CC 25E0              ADD     A,ACC
07CE 25E0              ADD     A,ACC
07D0 2400        R     ADD     A,#LOW a_value
07D2 F582              MOV     DPL,A
07D4 E4                CLR     A
07D5 3400        R     ADDC    A,#HIGH a_value
07D7 F583              MOV     DPH,A
07D9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1018
07DC 300003      R     JNB     pos_reconstruct,$ + 6H
07DF 020000      R     LJMP    ?C0153
                                           ; SOURCE LINE # 1019
07E2 900000      R     MOV     DPTR,#one_time_execute
07E5 E0                MOVX    A,@DPTR
07E6 C3                CLR     C
07E7 9422              SUBB    A,#022H
07E9 5004              JNC     ?C0180
                                           ; SOURCE LINE # 1020
07EB E0                MOVX    A,@DPTR
07EC 04                INC     A
07ED F0                MOVX    @DPTR,A
07EE 22                RET     
07EF         ?C0180:
                                           ; SOURCE LINE # 1021
                                           ; SOURCE LINE # 1023
07EF 900000      E     MOV     DPTR,#c_mem+079H
07F2 E0                MOVX    A,@DPTR
07F3 602A              JZ      ?C0182
                                           ; SOURCE LINE # 1024
07F5 900000      E     MOV     DPTR,#g_meas+04H
07F8 E0                MOVX    A,@DPTR
07F9 FC                MOV     R4,A
07FA A3                INC     DPTR
07FB E0                MOVX    A,@DPTR
07FC FD                MOV     R5,A
07FD A3                INC     DPTR
07FE E0                MOVX    A,@DPTR
07FF FE                MOV     R6,A
0800 A3                INC     DPTR
0801 E0                MOVX    A,@DPTR
0802 FF                MOV     R7,A
0803 900000      E     MOV     DPTR,#?_calc_turns_fcn?BYTE+04H
0806 120000      E     LCALL   ?C?LSTXDATA
0809 900000      E     MOV     DPTR,#g_meas
080C E0                MOVX    A,@DPTR
080D FC                MOV     R4,A
080E A3                INC     DPTR
080F E0                MOVX    A,@DPTR
0810 FD                MOV     R5,A
0811 A3                INC     DPTR
0812 E0                MOVX    A,@DPTR
0813 FE                MOV     R6,A
0814 A3                INC     DPTR
0815 E0                MOVX    A,@DPTR
0816 FF                MOV     R7,A
0817 120000      E     LCALL   _calc_turns_fcn
081A 900000      E     MOV     DPTR,#g_meas+014H
081D EF                MOV     A,R7
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 111 

081E F0                MOVX    @DPTR,A
081F         ?C0182:
                                           ; SOURCE LINE # 1026
081F 900000      E     MOV     DPTR,#g_meas
0822 E0                MOVX    A,@DPTR
0823 F8                MOV     R0,A
0824 A3                INC     DPTR
0825 E0                MOVX    A,@DPTR
0826 F9                MOV     R1,A
0827 A3                INC     DPTR
0828 E0                MOVX    A,@DPTR
0829 FA                MOV     R2,A
082A A3                INC     DPTR
082B E0                MOVX    A,@DPTR
082C FB                MOV     R3,A
082D C000              PUSH    AR0
082F 900000      E     MOV     DPTR,#g_meas+014H
0832 E0                MOVX    A,@DPTR
0833 FF                MOV     R7,A
0834 33                RLC     A
0835 95E0              SUBB    A,ACC
0837 FE                MOV     R6,A
0838 FD                MOV     R5,A
0839 FC                MOV     R4,A
083A 7810              MOV     R0,#010H
083C 120000      E     LCALL   ?C?LSHL
083F D000              POP     AR0
0841 EB                MOV     A,R3
0842 2F                ADD     A,R7
0843 FF                MOV     R7,A
0844 EA                MOV     A,R2
0845 3E                ADDC    A,R6
0846 FE                MOV     R6,A
0847 E9                MOV     A,R1
0848 3D                ADDC    A,R5
0849 FD                MOV     R5,A
084A E8                MOV     A,R0
084B 3C                ADDC    A,R4
084C FC                MOV     R4,A
084D 900000      E     MOV     DPTR,#g_meas
0850 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1029
0853 900000      E     MOV     DPTR,#g_meas
0856 E0                MOVX    A,@DPTR
0857 FC                MOV     R4,A
0858 A3                INC     DPTR
0859 E0                MOVX    A,@DPTR
085A FD                MOV     R5,A
085B A3                INC     DPTR
085C E0                MOVX    A,@DPTR
085D FE                MOV     R6,A
085E A3                INC     DPTR
085F E0                MOVX    A,@DPTR
0860 FF                MOV     R7,A
0861 900000      E     MOV     DPTR,#g_refNew
0864 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1031
0867 900000      E     MOV     DPTR,#g_ref+018H
086A E0                MOVX    A,@DPTR
086B FF                MOV     R7,A
086C 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1033
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 112 

086F D200        R     SETB    pos_reconstruct
                                           ; SOURCE LINE # 1034
                                           ; SOURCE LINE # 1035
                                           ; SOURCE LINE # 1036
0871         ?C0153:
0871 22                RET     
             ; FUNCTION _encoder_reading (END)

             ; FUNCTION analog_read_end (BEGIN)
                                           ; SOURCE LINE # 1042
0000         ?C0183:
                                           ; SOURCE LINE # 1076
0000 120000      E     LCALL   ADC_STATUS_Read
0003 EF                MOV     A,R7
0004 700A              JNZ     ?C0184
                                           ; SOURCE LINE # 1077
0006 3000F7            JNB     interrupt_flag,?C0183
                                           ; SOURCE LINE # 1078
0009 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1079
000B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1080
                                           ; SOURCE LINE # 1081
000E 80F0              SJMP    ?C0183
0010         ?C0184:
                                           ; SOURCE LINE # 1084
0010 900000      E     MOV     DPTR,#ADC_buf+01H
0013 E0                MOVX    A,@DPTR
0014 249A              ADD     A,#09AH
0016 FF                MOV     R7,A
0017 900000      E     MOV     DPTR,#ADC_buf
001A E0                MOVX    A,@DPTR
001B 34F9              ADDC    A,#0F9H
001D FE                MOV     R6,A
001E 33                RLC     A
001F 95E0              SUBB    A,ACC
0021 FD                MOV     R5,A
0022 FC                MOV     R4,A
0023 E4                CLR     A
0024 7BA0              MOV     R3,#0A0H
0026 7A07              MOV     R2,#07H
0028 F9                MOV     R1,A
0029 F8                MOV     R0,A
002A 120000      E     LCALL   ?C?LMUL
002D 7807              MOV     R0,#07H
002F 120000      E     LCALL   ?C?SLSHR
0032 900000      E     MOV     DPTR,#dev_tension
0035 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1086
0038 300005            JNB     interrupt_flag,?C0186
                                           ; SOURCE LINE # 1087
003B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1088
003D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1089
0040         ?C0186:
                                           ; SOURCE LINE # 1091
0040 900000      E     MOV     DPTR,#first_tension_valid
0043 E0                MOVX    A,@DPTR
0044 6077              JZ      ?C0187
0046 300074            JNB     tension_valid,?C0187
                                           ; SOURCE LINE # 1092
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 113 

0049 900000      R     MOV     DPTR,#count
004C E0                MOVX    A,@DPTR
004D 04                INC     A
004E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1094
004F E0                MOVX    A,@DPTR
0050 64E8              XRL     A,#0E8H
0052 7002              JNZ     ?C0275
0054 7403              MOV     A,#03H
0056         ?C0275:
0056 7065              JNZ     ?C0187
                                           ; SOURCE LINE # 1095
0058 7F28              MOV     R7,#028H
005A 7E23              MOV     R6,#023H
005C FD                MOV     R5,A
005D FC                MOV     R4,A
005E 900000      E     MOV     DPTR,#dev_tension
0061 E0                MOVX    A,@DPTR
0062 F8                MOV     R0,A
0063 A3                INC     DPTR
0064 E0                MOVX    A,@DPTR
0065 F9                MOV     R1,A
0066 A3                INC     DPTR
0067 E0                MOVX    A,@DPTR
0068 FA                MOV     R2,A
0069 A3                INC     DPTR
006A E0                MOVX    A,@DPTR
006B FB                MOV     R3,A
006C C3                CLR     C
006D 120000      E     LCALL   ?C?SLCMP
0070 500F              JNC     ?C0189
                                           ; SOURCE LINE # 1096
0072 E4                CLR     A
0073 7F40              MOV     R7,#040H
0075 7E1F              MOV     R6,#01FH
0077 FD                MOV     R5,A
0078 FC                MOV     R4,A
0079 900000      E     MOV     DPTR,#pow_tension
007C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1097
007F 8037              SJMP    ?C0190
0081         ?C0189:
                                           ; SOURCE LINE # 1098
                                           ; SOURCE LINE # 1099
0081 E4                CLR     A
0082 7FC8              MOV     R7,#0C8H
0084 7E32              MOV     R6,#032H
0086 FD                MOV     R5,A
0087 FC                MOV     R4,A
0088 900000      E     MOV     DPTR,#dev_tension
008B E0                MOVX    A,@DPTR
008C F8                MOV     R0,A
008D A3                INC     DPTR
008E E0                MOVX    A,@DPTR
008F F9                MOV     R1,A
0090 A3                INC     DPTR
0091 E0                MOVX    A,@DPTR
0092 FA                MOV     R2,A
0093 A3                INC     DPTR
0094 E0                MOVX    A,@DPTR
0095 FB                MOV     R3,A
0096 C3                CLR     C
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 114 

0097 120000      E     LCALL   ?C?SLCMP
009A 500F              JNC     ?C0191
                                           ; SOURCE LINE # 1100
009C E4                CLR     A
009D 7FE0              MOV     R7,#0E0H
009F 7E2E              MOV     R6,#02EH
00A1 FD                MOV     R5,A
00A2 FC                MOV     R4,A
00A3 900000      E     MOV     DPTR,#pow_tension
00A6 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1101
00A9 800D              SJMP    ?C0190
00AB         ?C0191:
                                           ; SOURCE LINE # 1103
00AB E4                CLR     A
00AC 7FC0              MOV     R7,#0C0H
00AE 7E5D              MOV     R6,#05DH
00B0 FD                MOV     R5,A
00B1 FC                MOV     R4,A
00B2 900000      E     MOV     DPTR,#pow_tension
00B5 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1104
00B8         ?C0190:
                                           ; SOURCE LINE # 1106
00B8 E4                CLR     A
00B9 900000      E     MOV     DPTR,#first_tension_valid
00BC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1107
                                           ; SOURCE LINE # 1108
00BD         ?C0187:
                                           ; SOURCE LINE # 1112
00BD E4                CLR     A
00BE 7F58              MOV     R7,#058H
00C0 7E1B              MOV     R6,#01BH
00C2 FD                MOV     R5,A
00C3 FC                MOV     R4,A
00C4 900000      E     MOV     DPTR,#dev_tension
00C7 E0                MOVX    A,@DPTR
00C8 F8                MOV     R0,A
00C9 A3                INC     DPTR
00CA E0                MOVX    A,@DPTR
00CB F9                MOV     R1,A
00CC A3                INC     DPTR
00CD E0                MOVX    A,@DPTR
00CE FA                MOV     R2,A
00CF A3                INC     DPTR
00D0 E0                MOVX    A,@DPTR
00D1 FB                MOV     R3,A
00D2 D3                SETB    C
00D3 120000      E     LCALL   ?C?SLCMP
00D6 5003              JNC     $ + 5H
00D8 020000      R     LJMP    ?C0193
                                           ; SOURCE LINE # 1115
00DB E4                CLR     A
00DC 7FE8              MOV     R7,#0E8H
00DE 7E03              MOV     R6,#03H
00E0 FD                MOV     R5,A
00E1 FC                MOV     R4,A
00E2 900000      R     MOV     DPTR,#count2
00E5 E0                MOVX    A,@DPTR
00E6 F8                MOV     R0,A
00E7 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 115 

00E8 E0                MOVX    A,@DPTR
00E9 F9                MOV     R1,A
00EA A3                INC     DPTR
00EB E0                MOVX    A,@DPTR
00EC FA                MOV     R2,A
00ED A3                INC     DPTR
00EE E0                MOVX    A,@DPTR
00EF FB                MOV     R3,A
00F0 120000      E     LCALL   ?C?ULCMP
00F3 7004              JNZ     ?C0194
                                           ; SOURCE LINE # 1116
00F5 D200        E     SETB    tension_valid
                                           ; SOURCE LINE # 1117
00F7 8036              SJMP    ?C0195
00F9         ?C0194:
                                           ; SOURCE LINE # 1118
                                           ; SOURCE LINE # 1119
00F9 900000      R     MOV     DPTR,#count2
00FC E0                MOVX    A,@DPTR
00FD FC                MOV     R4,A
00FE A3                INC     DPTR
00FF E0                MOVX    A,@DPTR
0100 FD                MOV     R5,A
0101 A3                INC     DPTR
0102 E0                MOVX    A,@DPTR
0103 FE                MOV     R6,A
0104 A3                INC     DPTR
0105 E0                MOVX    A,@DPTR
0106 2401              ADD     A,#01H
0108 FF                MOV     R7,A
0109 E4                CLR     A
010A 3E                ADDC    A,R6
010B FE                MOV     R6,A
010C E4                CLR     A
010D 3D                ADDC    A,R5
010E FD                MOV     R5,A
010F E4                CLR     A
0110 3C                ADDC    A,R4
0111 FC                MOV     R4,A
0112 900000      R     MOV     DPTR,#count2
0115 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1120
0118 900000      E     MOV     DPTR,#dev_tension
011B E0                MOVX    A,@DPTR
011C FC                MOV     R4,A
011D A3                INC     DPTR
011E E0                MOVX    A,@DPTR
011F FD                MOV     R5,A
0120 A3                INC     DPTR
0121 E0                MOVX    A,@DPTR
0122 FE                MOV     R6,A
0123 A3                INC     DPTR
0124 E0                MOVX    A,@DPTR
0125 FF                MOV     R7,A
0126 120000      E     LCALL   _filter_voltage
0129 900000      E     MOV     DPTR,#dev_tension_f
012C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1121
012F         ?C0195:
                                           ; SOURCE LINE # 1123
012F 900000      E     MOV     DPTR,#g_mem+07BH
0132 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 116 

0133 6003              JZ      ?C0196
                                           ; SOURCE LINE # 1124
0135 120000      R     LCALL   pwm_limit_search
0138         ?C0196:
                                           ; SOURCE LINE # 1127
0138 900000      E     MOV     DPTR,#ADC_buf+03H
013B E0                MOVX    A,@DPTR
013C 249A              ADD     A,#09AH
013E FF                MOV     R7,A
013F 900000      E     MOV     DPTR,#ADC_buf+02H
0142 E0                MOVX    A,@DPTR
0143 34F9              ADDC    A,#0F9H
0145 FE                MOV     R6,A
0146 33                RLC     A
0147 95E0              SUBB    A,ACC
0149 FD                MOV     R5,A
014A FC                MOV     R4,A
014B E4                CLR     A
014C 7BAB              MOV     R3,#0ABH
014E 7A64              MOV     R2,#064H
0150 F9                MOV     R1,A
0151 F8                MOV     R0,A
0152 120000      E     LCALL   ?C?LMUL
0155 780D              MOV     R0,#0DH
0157 120000      E     LCALL   ?C?SLSHR
015A 900000      E     MOV     DPTR,#pwm_sign
015D E0                MOVX    A,@DPTR
015E FD                MOV     R5,A
015F 33                RLC     A
0160 95E0              SUBB    A,ACC
0162 FC                MOV     R4,A
0163 120000      E     LCALL   ?C?IMUL
0166 EE                MOV     A,R6
0167 33                RLC     A
0168 95E0              SUBB    A,ACC
016A FD                MOV     R5,A
016B FC                MOV     R4,A
016C 120000      E     LCALL   _filter_i1
016F 900000      E     MOV     DPTR,#g_meas+0CH
0172 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1131
0175 300005            JNB     interrupt_flag,?C0197
                                           ; SOURCE LINE # 1132
0178 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1133
017A 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1134
017D         ?C0197:
                                           ; SOURCE LINE # 1137
017D 900000      E     MOV     DPTR,#g_mem+06FH
0180 E0                MOVX    A,@DPTR
0181 7004              JNZ     ?C0198
                                           ; SOURCE LINE # 1138
0183 F500        R     MOV     emg_1_status,A
                                           ; SOURCE LINE # 1139
0185 F500        R     MOV     emg_2_status,A
                                           ; SOURCE LINE # 1140
0187         ?C0198:
                                           ; SOURCE LINE # 1145
0187 E500        R     MOV     A,emg_1_status
0189 14                DEC     A
018A 7003              JNZ     $ + 5H
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 117 

018C 020000      R     LJMP    ?C0207
018F 14                DEC     A
0190 7003              JNZ     $ + 5H
0192 020000      R     LJMP    ?C0208
0195 14                DEC     A
0196 7003              JNZ     $ + 5H
0198 020000      R     LJMP    ?C0211
019B 2403              ADD     A,#03H
019D 6003              JZ      $ + 5H
019F 020000      R     LJMP    ?C0199
                                           ; SOURCE LINE # 1146
01A2         ?C0200:
                                           ; SOURCE LINE # 1147
01A2 900000      E     MOV     DPTR,#ADC_buf+04H
01A5 E0                MOVX    A,@DPTR
01A6 FE                MOV     R6,A
01A7 A3                INC     DPTR
01A8 E0                MOVX    A,@DPTR
01A9 FF                MOV     R7,A
01AA EE                MOV     A,R6
01AB 33                RLC     A
01AC 95E0              SUBB    A,ACC
01AE 8F00        R     MOV     i_aux+03H,R7
01B0 8E00        R     MOV     i_aux+02H,R6
01B2 F500        R     MOV     i_aux+01H,A
01B4 F500        R     MOV     i_aux,A
                                           ; SOURCE LINE # 1148
01B6 E4                CLR     A
01B7 FF                MOV     R7,A
01B8 FE                MOV     R6,A
01B9 FD                MOV     R5,A
01BA FC                MOV     R4,A
01BB AB00        R     MOV     R3,i_aux+03H
01BD AA00        R     MOV     R2,i_aux+02H
01BF A900        R     MOV     R1,i_aux+01H
01C1 A800        R     MOV     R0,i_aux
01C3 C3                CLR     C
01C4 120000      E     LCALL   ?C?SLCMP
01C7 5009              JNC     ?C0201
                                           ; SOURCE LINE # 1149
01C9 E4                CLR     A
01CA F500        R     MOV     i_aux+03H,A
01CC F500        R     MOV     i_aux+02H,A
01CE F500        R     MOV     i_aux+01H,A
01D0 F500        R     MOV     i_aux,A
01D2         ?C0201:
                                           ; SOURCE LINE # 1150
01D2 AF00        R     MOV     R7,i_aux+03H
01D4 AE00        R     MOV     R6,i_aux+02H
01D6 AD00        R     MOV     R5,i_aux+01H
01D8 AC00        R     MOV     R4,i_aux
01DA 120000      E     LCALL   _filter_ch1
01DD 8F00        R     MOV     i_aux+03H,R7
01DF 8E00        R     MOV     i_aux+02H,R6
01E1 8D00        R     MOV     i_aux+01H,R5
01E3 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1151
01E5 780A              MOV     R0,#0AH
01E7 120000      E     LCALL   ?C?LSHL
01EA 900000      E     MOV     DPTR,#g_mem+070H
01ED E0                MOVX    A,@DPTR
01EE F8                MOV     R0,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 118 

01EF A3                INC     DPTR
01F0 E0                MOVX    A,@DPTR
01F1 F9                MOV     R1,A
01F2 A3                INC     DPTR
01F3 E0                MOVX    A,@DPTR
01F4 FA                MOV     R2,A
01F5 A3                INC     DPTR
01F6 E0                MOVX    A,@DPTR
01F7 FB                MOV     R3,A
01F8 120000      E     LCALL   ?C?ULDIV
01FB 8F00        R     MOV     i_aux+03H,R7
01FD 8E00        R     MOV     i_aux+02H,R6
01FF 8D00        R     MOV     i_aux+01H,R5
0201 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1153
0203 300005            JNB     interrupt_flag,?C0202
                                           ; SOURCE LINE # 1154
0206 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1155
0208 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1156
020B         ?C0202:
                                           ; SOURCE LINE # 1158
020B E4                CLR     A
020C FF                MOV     R7,A
020D FE                MOV     R6,A
020E FD                MOV     R5,A
020F FC                MOV     R4,A
0210 AB00        R     MOV     R3,i_aux+03H
0212 AA00        R     MOV     R2,i_aux+02H
0214 A900        R     MOV     R1,i_aux+01H
0216 A800        R     MOV     R0,i_aux
0218 C3                CLR     C
0219 120000      E     LCALL   ?C?SLCMP
021C 500B              JNC     ?C0203
                                           ; SOURCE LINE # 1159
021E E4                CLR     A
021F F500        R     MOV     i_aux+03H,A
0221 F500        R     MOV     i_aux+02H,A
0223 F500        R     MOV     i_aux+01H,A
0225 F500        R     MOV     i_aux,A
0227 801E              SJMP    ?C0204
0229         ?C0203:
                                           ; SOURCE LINE # 1161
0229 E4                CLR     A
022A FF                MOV     R7,A
022B 7E04              MOV     R6,#04H
022D FD                MOV     R5,A
022E FC                MOV     R4,A
022F AB00        R     MOV     R3,i_aux+03H
0231 AA00        R     MOV     R2,i_aux+02H
0233 A900        R     MOV     R1,i_aux+01H
0235 A800        R     MOV     R0,i_aux
0237 D3                SETB    C
0238 120000      E     LCALL   ?C?SLCMP
023B 400A              JC      ?C0204
                                           ; SOURCE LINE # 1162
023D E4                CLR     A
023E F500        R     MOV     i_aux+03H,A
0240 750004      R     MOV     i_aux+02H,#04H
0243 F500        R     MOV     i_aux+01H,A
0245 F500        R     MOV     i_aux,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 119 

0247         ?C0204:
                                           ; SOURCE LINE # 1164
0247 AF00        R     MOV     R7,i_aux+03H
0249 AE00        R     MOV     R6,i_aux+02H
024B AD00        R     MOV     R5,i_aux+01H
024D AC00        R     MOV     R4,i_aux
024F 900000      E     MOV     DPTR,#g_meas+017H
0252 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1166
0255 200003      E     JB      interrupt_flag,$ + 6H
0258 020000      R     LJMP    ?C0199
                                           ; SOURCE LINE # 1167
025B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1168
025D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1169
                                           ; SOURCE LINE # 1171
0260 020000      R     LJMP    ?C0199
                                           ; SOURCE LINE # 1173
0263         ?C0207:
                                           ; SOURCE LINE # 1174
0263 E4                CLR     A
0264 900000      R     MOV     DPTR,#emg_counter_1
0267 F0                MOVX    @DPTR,A
0268 A3                INC     DPTR
0269 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1175
026A FF                MOV     R7,A
026B FE                MOV     R6,A
026C FD                MOV     R5,A
026D FC                MOV     R4,A
026E 900000      E     MOV     DPTR,#g_mem+070H
0271 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1176
0274 750002      R     MOV     emg_1_status,#02H
                                           ; SOURCE LINE # 1178
0277 020000      R     LJMP    ?C0199
                                           ; SOURCE LINE # 1180
027A         ?C0208:
                                           ; SOURCE LINE # 1181
027A 900000      R     MOV     DPTR,#emg_counter_1+01H
027D E0                MOVX    A,@DPTR
027E 04                INC     A
027F F0                MOVX    @DPTR,A
0280 7006              JNZ     ?C0276
0282 900000      R     MOV     DPTR,#emg_counter_1
0285 E0                MOVX    A,@DPTR
0286 04                INC     A
0287 F0                MOVX    @DPTR,A
0288         ?C0276:
                                           ; SOURCE LINE # 1182
0288 900000      R     MOV     DPTR,#emg_counter_1
028B E0                MOVX    A,@DPTR
028C 6401              XRL     A,#01H
028E 7004              JNZ     ?C0277
0290 A3                INC     DPTR
0291 E0                MOVX    A,@DPTR
0292 64F4              XRL     A,#0F4H
0294         ?C0277:
0294 6003              JZ      $ + 5H
0296 020000      R     LJMP    ?C0199
                                           ; SOURCE LINE # 1183
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 120 

0299 900000      R     MOV     DPTR,#emg_counter_1
029C F0                MOVX    @DPTR,A
029D A3                INC     DPTR
029E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1185
029F 7F01              MOV     R7,#01H
02A1 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1186
02A4 E4                CLR     A
02A5 FF                MOV     R7,A
02A6 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1188
02A9 300005            JNB     interrupt_flag,?C0210
                                           ; SOURCE LINE # 1189
02AC C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1190
02AE 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1191
02B1         ?C0210:
                                           ; SOURCE LINE # 1193
02B1 750003      R     MOV     emg_1_status,#03H
                                           ; SOURCE LINE # 1194
                                           ; SOURCE LINE # 1195
02B4 020000      R     LJMP    ?C0199
                                           ; SOURCE LINE # 1197
02B7         ?C0211:
                                           ; SOURCE LINE # 1199
02B7 900000      R     MOV     DPTR,#emg_counter_1+01H
02BA E0                MOVX    A,@DPTR
02BB 04                INC     A
02BC F0                MOVX    @DPTR,A
02BD 7006              JNZ     ?C0278
02BF 900000      R     MOV     DPTR,#emg_counter_1
02C2 E0                MOVX    A,@DPTR
02C3 04                INC     A
02C4 F0                MOVX    @DPTR,A
02C5         ?C0278:
                                           ; SOURCE LINE # 1200
02C5 C3                CLR     C
02C6 900000      E     MOV     DPTR,#ADC_buf+04H
02C9 E0                MOVX    A,@DPTR
02CA 6480              XRL     A,#080H
02CC 9480              SUBB    A,#080H
02CE 5004              JNC     ?C0212
                                           ; SOURCE LINE # 1201
02D0 E4                CLR     A
02D1 F0                MOVX    @DPTR,A
02D2 A3                INC     DPTR
02D3 F0                MOVX    @DPTR,A
02D4         ?C0212:
                                           ; SOURCE LINE # 1202
02D4 900000      E     MOV     DPTR,#g_mem+070H
02D7 E0                MOVX    A,@DPTR
02D8 F8                MOV     R0,A
02D9 A3                INC     DPTR
02DA E0                MOVX    A,@DPTR
02DB F9                MOV     R1,A
02DC A3                INC     DPTR
02DD E0                MOVX    A,@DPTR
02DE FA                MOV     R2,A
02DF A3                INC     DPTR
02E0 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 121 

02E1 FB                MOV     R3,A
02E2 C000              PUSH    AR0
02E4 C001              PUSH    AR1
02E6 C002              PUSH    AR2
02E8 C003              PUSH    AR3
02EA 900000      E     MOV     DPTR,#ADC_buf+04H
02ED E0                MOVX    A,@DPTR
02EE FE                MOV     R6,A
02EF A3                INC     DPTR
02F0 E0                MOVX    A,@DPTR
02F1 FF                MOV     R7,A
02F2 EE                MOV     A,R6
02F3 33                RLC     A
02F4 95E0              SUBB    A,ACC
02F6 FD                MOV     R5,A
02F7 FC                MOV     R4,A
02F8 120000      E     LCALL   _filter_ch1
02FB D003              POP     AR3
02FD D002              POP     AR2
02FF D001              POP     AR1
0301 D000              POP     AR0
0303 EB                MOV     A,R3
0304 2F                ADD     A,R7
0305 FF                MOV     R7,A
0306 EA                MOV     A,R2
0307 3E                ADDC    A,R6
0308 FE                MOV     R6,A
0309 E9                MOV     A,R1
030A 3D                ADDC    A,R5
030B FD                MOV     R5,A
030C E8                MOV     A,R0
030D 3C                ADDC    A,R4
030E FC                MOV     R4,A
030F 900000      E     MOV     DPTR,#g_mem+070H
0312 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1204
0315 300005            JNB     interrupt_flag,?C0213
                                           ; SOURCE LINE # 1205
0318 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1206
031A 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1207
031D         ?C0213:
                                           ; SOURCE LINE # 1209
031D 900000      R     MOV     DPTR,#emg_counter_1
0320 E0                MOVX    A,@DPTR
0321 6403              XRL     A,#03H
0323 7004              JNZ     ?C0279
0325 A3                INC     DPTR
0326 E0                MOVX    A,@DPTR
0327 64E8              XRL     A,#0E8H
0329         ?C0279:
0329 7039              JNZ     ?C0199
                                           ; SOURCE LINE # 1210
032B 900000      E     MOV     DPTR,#g_mem+070H
032E E0                MOVX    A,@DPTR
032F FC                MOV     R4,A
0330 A3                INC     DPTR
0331 E0                MOVX    A,@DPTR
0332 FD                MOV     R5,A
0333 A3                INC     DPTR
0334 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 122 

0335 FE                MOV     R6,A
0336 A3                INC     DPTR
0337 E0                MOVX    A,@DPTR
0338 FF                MOV     R7,A
0339 E4                CLR     A
033A 7BE8              MOV     R3,#0E8H
033C 7A03              MOV     R2,#03H
033E F9                MOV     R1,A
033F F8                MOV     R0,A
0340 120000      E     LCALL   ?C?ULDIV
0343 900000      E     MOV     DPTR,#g_mem+070H
0346 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1212
0349 300005            JNB     interrupt_flag,?C0215
                                           ; SOURCE LINE # 1213
034C C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1214
034E 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1215
0351         ?C0215:
                                           ; SOURCE LINE # 1217
0351 E4                CLR     A
0352 FF                MOV     R7,A
0353 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1218
0356 E4                CLR     A
0357 FF                MOV     R7,A
0358 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1220
035B E4                CLR     A
035C 900000      R     MOV     DPTR,#emg_counter_1
035F F0                MOVX    @DPTR,A
0360 A3                INC     DPTR
0361 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1222
0362 F500        R     MOV     emg_1_status,A
                                           ; SOURCE LINE # 1223
                                           ; SOURCE LINE # 1224
                                           ; SOURCE LINE # 1226
                                           ; SOURCE LINE # 1227
                                           ; SOURCE LINE # 1228
0364         ?C0199:
                                           ; SOURCE LINE # 1230
0364 300005            JNB     interrupt_flag,?C0217
                                           ; SOURCE LINE # 1231
0367 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1232
0369 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1233
036C         ?C0217:
                                           ; SOURCE LINE # 1235
036C E500        R     MOV     A,emg_2_status
036E 14                DEC     A
036F 7003              JNZ     $ + 5H
0371 020000      R     LJMP    ?C0225
0374 14                DEC     A
0375 7003              JNZ     $ + 5H
0377 020000      R     LJMP    ?C0227
037A 14                DEC     A
037B 7003              JNZ     $ + 5H
037D 020000      R     LJMP    ?C0230
0380 14                DEC     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 123 

0381 7003              JNZ     $ + 5H
0383 020000      R     LJMP    ?C0235
0386 14                DEC     A
0387 7003              JNZ     $ + 5H
0389 020000      R     LJMP    ?C0237
038C 2405              ADD     A,#05H
038E 6003              JZ      $ + 5H
0390 020000      R     LJMP    ?C0218
                                           ; SOURCE LINE # 1236
0393         ?C0219:
                                           ; SOURCE LINE # 1237
0393 900000      E     MOV     DPTR,#ADC_buf+06H
0396 E0                MOVX    A,@DPTR
0397 FE                MOV     R6,A
0398 A3                INC     DPTR
0399 E0                MOVX    A,@DPTR
039A FF                MOV     R7,A
039B EE                MOV     A,R6
039C 33                RLC     A
039D 95E0              SUBB    A,ACC
039F 8F00        R     MOV     i_aux+03H,R7
03A1 8E00        R     MOV     i_aux+02H,R6
03A3 F500        R     MOV     i_aux+01H,A
03A5 F500        R     MOV     i_aux,A
                                           ; SOURCE LINE # 1238
03A7 E4                CLR     A
03A8 FF                MOV     R7,A
03A9 FE                MOV     R6,A
03AA FD                MOV     R5,A
03AB FC                MOV     R4,A
03AC AB00        R     MOV     R3,i_aux+03H
03AE AA00        R     MOV     R2,i_aux+02H
03B0 A900        R     MOV     R1,i_aux+01H
03B2 A800        R     MOV     R0,i_aux
03B4 C3                CLR     C
03B5 120000      E     LCALL   ?C?SLCMP
03B8 5009              JNC     ?C0220
                                           ; SOURCE LINE # 1239
03BA E4                CLR     A
03BB F500        R     MOV     i_aux+03H,A
03BD F500        R     MOV     i_aux+02H,A
03BF F500        R     MOV     i_aux+01H,A
03C1 F500        R     MOV     i_aux,A
03C3         ?C0220:
                                           ; SOURCE LINE # 1240
03C3 AF00        R     MOV     R7,i_aux+03H
03C5 AE00        R     MOV     R6,i_aux+02H
03C7 AD00        R     MOV     R5,i_aux+01H
03C9 AC00        R     MOV     R4,i_aux
03CB 120000      E     LCALL   _filter_ch2
03CE 8F00        R     MOV     i_aux+03H,R7
03D0 8E00        R     MOV     i_aux+02H,R6
03D2 8D00        R     MOV     i_aux+01H,R5
03D4 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1241
03D6 780A              MOV     R0,#0AH
03D8 120000      E     LCALL   ?C?LSHL
03DB 900000      E     MOV     DPTR,#g_mem+074H
03DE E0                MOVX    A,@DPTR
03DF F8                MOV     R0,A
03E0 A3                INC     DPTR
03E1 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 124 

03E2 F9                MOV     R1,A
03E3 A3                INC     DPTR
03E4 E0                MOVX    A,@DPTR
03E5 FA                MOV     R2,A
03E6 A3                INC     DPTR
03E7 E0                MOVX    A,@DPTR
03E8 FB                MOV     R3,A
03E9 120000      E     LCALL   ?C?ULDIV
03EC 8F00        R     MOV     i_aux+03H,R7
03EE 8E00        R     MOV     i_aux+02H,R6
03F0 8D00        R     MOV     i_aux+01H,R5
03F2 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1243
03F4 300005            JNB     interrupt_flag,?C0221
                                           ; SOURCE LINE # 1244
03F7 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1245
03F9 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1246
03FC         ?C0221:
                                           ; SOURCE LINE # 1248
03FC E4                CLR     A
03FD FF                MOV     R7,A
03FE FE                MOV     R6,A
03FF FD                MOV     R5,A
0400 FC                MOV     R4,A
0401 AB00        R     MOV     R3,i_aux+03H
0403 AA00        R     MOV     R2,i_aux+02H
0405 A900        R     MOV     R1,i_aux+01H
0407 A800        R     MOV     R0,i_aux
0409 C3                CLR     C
040A 120000      E     LCALL   ?C?SLCMP
040D 500B              JNC     ?C0222
                                           ; SOURCE LINE # 1249
040F E4                CLR     A
0410 F500        R     MOV     i_aux+03H,A
0412 F500        R     MOV     i_aux+02H,A
0414 F500        R     MOV     i_aux+01H,A
0416 F500        R     MOV     i_aux,A
0418 801E              SJMP    ?C0223
041A         ?C0222:
                                           ; SOURCE LINE # 1251
041A E4                CLR     A
041B FF                MOV     R7,A
041C 7E04              MOV     R6,#04H
041E FD                MOV     R5,A
041F FC                MOV     R4,A
0420 AB00        R     MOV     R3,i_aux+03H
0422 AA00        R     MOV     R2,i_aux+02H
0424 A900        R     MOV     R1,i_aux+01H
0426 A800        R     MOV     R0,i_aux
0428 D3                SETB    C
0429 120000      E     LCALL   ?C?SLCMP
042C 400A              JC      ?C0223
                                           ; SOURCE LINE # 1252
042E E4                CLR     A
042F F500        R     MOV     i_aux+03H,A
0431 750004      R     MOV     i_aux+02H,#04H
0434 F500        R     MOV     i_aux+01H,A
0436 F500        R     MOV     i_aux,A
0438         ?C0223:
                                           ; SOURCE LINE # 1254
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 125 

0438 AF00        R     MOV     R7,i_aux+03H
043A AE00        R     MOV     R6,i_aux+02H
043C AD00        R     MOV     R5,i_aux+01H
043E AC00        R     MOV     R4,i_aux
0440 900000      E     MOV     DPTR,#g_meas+01BH
0443 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1256
0446 020000      R     LJMP    ?C0218
                                           ; SOURCE LINE # 1258
0449         ?C0225:
                                           ; SOURCE LINE # 1259
0449 E4                CLR     A
044A 900000      R     MOV     DPTR,#emg_counter_2
044D F0                MOVX    @DPTR,A
044E A3                INC     DPTR
044F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1260
0450 FF                MOV     R7,A
0451 FE                MOV     R6,A
0452 FD                MOV     R5,A
0453 FC                MOV     R4,A
0454 900000      E     MOV     DPTR,#g_mem+074H
0457 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1262
045A 300005            JNB     interrupt_flag,?C0226
                                           ; SOURCE LINE # 1263
045D C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1264
045F 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1265
0462         ?C0226:
                                           ; SOURCE LINE # 1267
0462 750004      R     MOV     emg_2_status,#04H
                                           ; SOURCE LINE # 1268
0465 020000      R     LJMP    ?C0218
                                           ; SOURCE LINE # 1270
0468         ?C0227:
                                           ; SOURCE LINE # 1271
0468 900000      R     MOV     DPTR,#emg_counter_2+01H
046B E0                MOVX    A,@DPTR
046C 04                INC     A
046D F0                MOVX    @DPTR,A
046E 7006              JNZ     ?C0280
0470 900000      R     MOV     DPTR,#emg_counter_2
0473 E0                MOVX    A,@DPTR
0474 04                INC     A
0475 F0                MOVX    @DPTR,A
0476         ?C0280:
                                           ; SOURCE LINE # 1272
0476 900000      R     MOV     DPTR,#emg_counter_2
0479 E0                MOVX    A,@DPTR
047A 6401              XRL     A,#01H
047C 7004              JNZ     ?C0281
047E A3                INC     DPTR
047F E0                MOVX    A,@DPTR
0480 64F4              XRL     A,#0F4H
0482         ?C0281:
0482 6003              JZ      $ + 5H
0484 020000      R     LJMP    ?C0218
                                           ; SOURCE LINE # 1273
0487 900000      R     MOV     DPTR,#emg_counter_2
048A F0                MOVX    @DPTR,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 126 

048B A3                INC     DPTR
048C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1275
048D 7F01              MOV     R7,#01H
048F 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1276
0492 E4                CLR     A
0493 FF                MOV     R7,A
0494 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1278
0497 300005            JNB     interrupt_flag,?C0229
                                           ; SOURCE LINE # 1279
049A C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1280
049C 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1281
049F         ?C0229:
                                           ; SOURCE LINE # 1283
049F 750003      R     MOV     emg_2_status,#03H
                                           ; SOURCE LINE # 1284
                                           ; SOURCE LINE # 1285
04A2 020000      R     LJMP    ?C0218
                                           ; SOURCE LINE # 1287
04A5         ?C0230:
                                           ; SOURCE LINE # 1289
04A5 900000      R     MOV     DPTR,#emg_counter_2+01H
04A8 E0                MOVX    A,@DPTR
04A9 04                INC     A
04AA F0                MOVX    @DPTR,A
04AB 7006              JNZ     ?C0282
04AD 900000      R     MOV     DPTR,#emg_counter_2
04B0 E0                MOVX    A,@DPTR
04B1 04                INC     A
04B2 F0                MOVX    @DPTR,A
04B3         ?C0282:
                                           ; SOURCE LINE # 1290
04B3 C3                CLR     C
04B4 900000      E     MOV     DPTR,#ADC_buf+06H
04B7 E0                MOVX    A,@DPTR
04B8 6480              XRL     A,#080H
04BA 9480              SUBB    A,#080H
04BC 5004              JNC     ?C0231
                                           ; SOURCE LINE # 1291
04BE E4                CLR     A
04BF F0                MOVX    @DPTR,A
04C0 A3                INC     DPTR
04C1 F0                MOVX    @DPTR,A
04C2         ?C0231:
                                           ; SOURCE LINE # 1292
04C2 900000      E     MOV     DPTR,#g_mem+074H
04C5 E0                MOVX    A,@DPTR
04C6 F8                MOV     R0,A
04C7 A3                INC     DPTR
04C8 E0                MOVX    A,@DPTR
04C9 F9                MOV     R1,A
04CA A3                INC     DPTR
04CB E0                MOVX    A,@DPTR
04CC FA                MOV     R2,A
04CD A3                INC     DPTR
04CE E0                MOVX    A,@DPTR
04CF FB                MOV     R3,A
04D0 C000              PUSH    AR0
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 127 

04D2 C001              PUSH    AR1
04D4 C002              PUSH    AR2
04D6 C003              PUSH    AR3
04D8 900000      E     MOV     DPTR,#ADC_buf+06H
04DB E0                MOVX    A,@DPTR
04DC FE                MOV     R6,A
04DD A3                INC     DPTR
04DE E0                MOVX    A,@DPTR
04DF FF                MOV     R7,A
04E0 EE                MOV     A,R6
04E1 33                RLC     A
04E2 95E0              SUBB    A,ACC
04E4 FD                MOV     R5,A
04E5 FC                MOV     R4,A
04E6 120000      E     LCALL   _filter_ch2
04E9 D003              POP     AR3
04EB D002              POP     AR2
04ED D001              POP     AR1
04EF D000              POP     AR0
04F1 EB                MOV     A,R3
04F2 2F                ADD     A,R7
04F3 FF                MOV     R7,A
04F4 EA                MOV     A,R2
04F5 3E                ADDC    A,R6
04F6 FE                MOV     R6,A
04F7 E9                MOV     A,R1
04F8 3D                ADDC    A,R5
04F9 FD                MOV     R5,A
04FA E8                MOV     A,R0
04FB 3C                ADDC    A,R4
04FC FC                MOV     R4,A
04FD 900000      E     MOV     DPTR,#g_mem+074H
0500 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1294
0503 300005            JNB     interrupt_flag,?C0232
                                           ; SOURCE LINE # 1295
0506 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1296
0508 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1297
050B         ?C0232:
                                           ; SOURCE LINE # 1299
050B 900000      R     MOV     DPTR,#emg_counter_2
050E E0                MOVX    A,@DPTR
050F 6403              XRL     A,#03H
0511 7004              JNZ     ?C0283
0513 A3                INC     DPTR
0514 E0                MOVX    A,@DPTR
0515 64E8              XRL     A,#0E8H
0517         ?C0283:
0517 6003              JZ      $ + 5H
0519 020000      R     LJMP    ?C0218
                                           ; SOURCE LINE # 1300
051C 900000      E     MOV     DPTR,#g_mem+074H
051F E0                MOVX    A,@DPTR
0520 FC                MOV     R4,A
0521 A3                INC     DPTR
0522 E0                MOVX    A,@DPTR
0523 FD                MOV     R5,A
0524 A3                INC     DPTR
0525 E0                MOVX    A,@DPTR
0526 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 128 

0527 A3                INC     DPTR
0528 E0                MOVX    A,@DPTR
0529 FF                MOV     R7,A
052A E4                CLR     A
052B 7BE8              MOV     R3,#0E8H
052D 7A03              MOV     R2,#03H
052F F9                MOV     R1,A
0530 F8                MOV     R0,A
0531 120000      E     LCALL   ?C?ULDIV
0534 900000      E     MOV     DPTR,#g_mem+074H
0537 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1302
053A E4                CLR     A
053B FF                MOV     R7,A
053C 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1303
053F E4                CLR     A
0540 FF                MOV     R7,A
0541 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1305
0544 E4                CLR     A
0545 900000      R     MOV     DPTR,#emg_counter_2
0548 F0                MOVX    @DPTR,A
0549 A3                INC     DPTR
054A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1307
054B 300005            JNB     interrupt_flag,?C0234
                                           ; SOURCE LINE # 1308
054E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1309
0550 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1310
0553         ?C0234:
                                           ; SOURCE LINE # 1312
0553 750005      R     MOV     emg_2_status,#05H
                                           ; SOURCE LINE # 1313
                                           ; SOURCE LINE # 1314
0556 020000      R     LJMP    ?C0218
                                           ; SOURCE LINE # 1316
0559         ?C0235:
                                           ; SOURCE LINE # 1317
0559 E500        R     MOV     A,emg_1_status
055B 6003              JZ      $ + 5H
055D 020000      R     LJMP    ?C0218
                                           ; SOURCE LINE # 1318
0560 750002      R     MOV     emg_2_status,#02H
                                           ; SOURCE LINE # 1319
0563 807E              SJMP    ?C0218
                                           ; SOURCE LINE # 1321
0565         ?C0237:
                                           ; SOURCE LINE # 1322
0565 900000      R     MOV     DPTR,#emg_counter_2+01H
0568 E0                MOVX    A,@DPTR
0569 04                INC     A
056A F0                MOVX    @DPTR,A
056B 7006              JNZ     ?C0284
056D 900000      R     MOV     DPTR,#emg_counter_2
0570 E0                MOVX    A,@DPTR
0571 04                INC     A
0572 F0                MOVX    @DPTR,A
0573         ?C0284:
                                           ; SOURCE LINE # 1323
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 129 

0573 900000      R     MOV     DPTR,#emg_counter_2
0576 E0                MOVX    A,@DPTR
0577 6401              XRL     A,#01H
0579 7004              JNZ     ?C0285
057B A3                INC     DPTR
057C E0                MOVX    A,@DPTR
057D 64F4              XRL     A,#0F4H
057F         ?C0285:
057F 7062              JNZ     ?C0218
                                           ; SOURCE LINE # 1324
0581 900000      R     MOV     DPTR,#emg_counter_2
0584 F0                MOVX    @DPTR,A
0585 A3                INC     DPTR
0586 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1326
0587 300005            JNB     interrupt_flag,?C0239
                                           ; SOURCE LINE # 1327
058A C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1328
058C 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1329
058F         ?C0239:
                                           ; SOURCE LINE # 1332
058F 900000      E     MOV     DPTR,#c_mem+033H
0592 E0                MOVX    A,@DPTR
0593 FF                MOV     R7,A
0594 6402              XRL     A,#02H
0596 600E              JZ      ?C0241
0598 EF                MOV     A,R7
0599 6403              XRL     A,#03H
059B 6009              JZ      ?C0241
059D EF                MOV     A,R7
059E 6404              XRL     A,#04H
05A0 6004              JZ      ?C0241
05A2 EF                MOV     A,R7
05A3 B4053A            CJNE    A,#05H,?C0240
05A6         ?C0241:
                                           ; SOURCE LINE # 1335
                                           ; SOURCE LINE # 1336
05A6 900000      E     MOV     DPTR,#c_mem+034H
05A9 E0                MOVX    A,@DPTR
05AA 7028              JNZ     ?C0242
                                           ; SOURCE LINE # 1337
05AC 900000      E     MOV     DPTR,#g_meas
05AF E0                MOVX    A,@DPTR
05B0 FC                MOV     R4,A
05B1 A3                INC     DPTR
05B2 E0                MOVX    A,@DPTR
05B3 FD                MOV     R5,A
05B4 A3                INC     DPTR
05B5 E0                MOVX    A,@DPTR
05B6 FE                MOV     R6,A
05B7 A3                INC     DPTR
05B8 E0                MOVX    A,@DPTR
05B9 FF                MOV     R7,A
05BA 900000      E     MOV     DPTR,#g_ref
05BD 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1338
05C0 900000      E     MOV     DPTR,#g_meas+04H
05C3 E0                MOVX    A,@DPTR
05C4 FC                MOV     R4,A
05C5 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 130 

05C6 E0                MOVX    A,@DPTR
05C7 FD                MOV     R5,A
05C8 A3                INC     DPTR
05C9 E0                MOVX    A,@DPTR
05CA FE                MOV     R6,A
05CB A3                INC     DPTR
05CC E0                MOVX    A,@DPTR
05CD FF                MOV     R7,A
05CE 900000      E     MOV     DPTR,#g_ref+04H
05D1 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1339
05D4         ?C0242:
                                           ; SOURCE LINE # 1340
05D4 900000      E     MOV     DPTR,#c_mem+032H
05D7 E0                MOVX    A,@DPTR
05D8 FF                MOV     R7,A
05D9 900000      E     MOV     DPTR,#g_ref+018H
05DC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1341
05DD 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1342
05E0         ?C0240:
                                           ; SOURCE LINE # 1344
05E0 E4                CLR     A
05E1 F500        R     MOV     emg_2_status,A
                                           ; SOURCE LINE # 1345
                                           ; SOURCE LINE # 1346
                                           ; SOURCE LINE # 1348
                                           ; SOURCE LINE # 1349
                                           ; SOURCE LINE # 1350
05E3         ?C0218:
                                           ; SOURCE LINE # 1352
05E3 300068            JNB     interrupt_flag,?C0245
                                           ; SOURCE LINE # 1353
05E6 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1354
05E8 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1355
                                           ; SOURCE LINE # 1356
05EB 8061              SJMP    ?C0245
05ED         ?C0193:
                                           ; SOURCE LINE # 1357
                                           ; SOURCE LINE # 1359
05ED 750001      R     MOV     emg_1_status,#01H
                                           ; SOURCE LINE # 1360
05F0 750001      R     MOV     emg_2_status,#01H
                                           ; SOURCE LINE # 1362
05F3 C200        E     CLR     tension_valid
                                           ; SOURCE LINE # 1365
05F5 7F01              MOV     R7,#01H
05F7 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1367
05FA E4                CLR     A
05FB FF                MOV     R7,A
05FC 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1369
05FF 300005            JNB     interrupt_flag,?C0246
                                           ; SOURCE LINE # 1370
0602 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1371
0604 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1372
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 131 

0607         ?C0246:
                                           ; SOURCE LINE # 1374
0607 900000      E     MOV     DPTR,#c_mem+06FH
060A E0                MOVX    A,@DPTR
060B 6020              JZ      ?C0247
                                           ; SOURCE LINE # 1375
060D 900000      E     MOV     DPTR,#c_mem+033H
0610 E0                MOVX    A,@DPTR
0611 FF                MOV     R7,A
0612 6402              XRL     A,#02H
0614 600E              JZ      ?C0249
0616 EF                MOV     A,R7
0617 6403              XRL     A,#03H
0619 6009              JZ      ?C0249
061B EF                MOV     A,R7
061C 6404              XRL     A,#04H
061E 6004              JZ      ?C0249
0620 EF                MOV     A,R7
0621 B40509            CJNE    A,#05H,?C0247
0624         ?C0249:
                                           ; SOURCE LINE # 1378
                                           ; SOURCE LINE # 1379
0624 E4                CLR     A
0625 900000      E     MOV     DPTR,#g_ref+018H
0628 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1380
0629 FF                MOV     R7,A
062A 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1381
                                           ; SOURCE LINE # 1382
062D         ?C0247:
                                           ; SOURCE LINE # 1385
062D E4                CLR     A
062E FF                MOV     R7,A
062F FE                MOV     R6,A
0630 FD                MOV     R5,A
0631 FC                MOV     R4,A
0632 900000      E     MOV     DPTR,#g_meas+0CH
0635 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1388
0638 E4                CLR     A
0639 FF                MOV     R7,A
063A FE                MOV     R6,A
063B FD                MOV     R5,A
063C FC                MOV     R4,A
063D 900000      E     MOV     DPTR,#g_meas+017H
0640 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1389
0643 E4                CLR     A
0644 FF                MOV     R7,A
0645 FE                MOV     R6,A
0646 FD                MOV     R5,A
0647 FC                MOV     R4,A
0648 900000      E     MOV     DPTR,#g_meas+01BH
064B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1391
064E         ?C0245:
                                           ; SOURCE LINE # 1394
064E 900000      E     MOV     DPTR,#first_tension_valid
0651 E0                MOVX    A,@DPTR
0652 6003              JZ      $ + 5H
0654 020000      R     LJMP    ?C0250
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 132 

0657 200003      E     JB      tension_valid,$ + 6H
065A 020000      R     LJMP    ?C0250
065D E500        R     MOV     A,emg_1_status
065F 6003              JZ      $ + 5H
0661 020000      R     LJMP    ?C0250
0664 E500        R     MOV     A,emg_2_status
0666 6003              JZ      $ + 5H
0668 020000      R     LJMP    ?C0250
                                           ; SOURCE LINE # 1395
066B 900000      E     MOV     DPTR,#dev_tension
066E E0                MOVX    A,@DPTR
066F FC                MOV     R4,A
0670 A3                INC     DPTR
0671 E0                MOVX    A,@DPTR
0672 FD                MOV     R5,A
0673 A3                INC     DPTR
0674 E0                MOVX    A,@DPTR
0675 FE                MOV     R6,A
0676 A3                INC     DPTR
0677 E0                MOVX    A,@DPTR
0678 FF                MOV     R7,A
0679 120000      E     LCALL   _filter_voltage
067C 900000      E     MOV     DPTR,#dev_tension_f
067F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1396
0682 900000      E     MOV     DPTR,#pow_tension
0685 E0                MOVX    A,@DPTR
0686 FC                MOV     R4,A
0687 A3                INC     DPTR
0688 E0                MOVX    A,@DPTR
0689 FD                MOV     R5,A
068A A3                INC     DPTR
068B E0                MOVX    A,@DPTR
068C FE                MOV     R6,A
068D A3                INC     DPTR
068E E0                MOVX    A,@DPTR
068F FF                MOV     R7,A
0690 EC                MOV     A,R4
0691 120000      E     LCALL   ?C?FCASTL
0694 7B1F              MOV     R3,#01FH
0696 7A85              MOV     R2,#085H
0698 796B              MOV     R1,#06BH
069A 783F              MOV     R0,#03FH
069C 120000      E     LCALL   ?C?FPMUL
069F C004              PUSH    AR4
06A1 C005              PUSH    AR5
06A3 C006              PUSH    AR6
06A5 C007              PUSH    AR7
06A7 900000      E     MOV     DPTR,#dev_tension_f
06AA E0                MOVX    A,@DPTR
06AB FC                MOV     R4,A
06AC A3                INC     DPTR
06AD E0                MOVX    A,@DPTR
06AE FD                MOV     R5,A
06AF A3                INC     DPTR
06B0 E0                MOVX    A,@DPTR
06B1 FE                MOV     R6,A
06B2 A3                INC     DPTR
06B3 E0                MOVX    A,@DPTR
06B4 FF                MOV     R7,A
06B5 EC                MOV     A,R4
06B6 120000      E     LCALL   ?C?FCASTL
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 133 

06B9 A804              MOV     R0,AR4
06BB A905              MOV     R1,AR5
06BD AA06              MOV     R2,AR6
06BF AB07              MOV     R3,AR7
06C1 D007              POP     AR7
06C3 D006              POP     AR6
06C5 D005              POP     AR5
06C7 D004              POP     AR4
06C9 120000      E     LCALL   ?C?FPCMP3
06CC 600E              JZ      ?C0251
06CE 400C              JC      ?C0251
                                           ; SOURCE LINE # 1398
06D0 7F01              MOV     R7,#01H
06D2 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1401
06D5 E4                CLR     A
06D6 FF                MOV     R7,A
06D7 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1402
06DA 802B              SJMP    ?C0250
06DC         ?C0251:
                                           ; SOURCE LINE # 1403
                                           ; SOURCE LINE # 1405
06DC E4                CLR     A
06DD FF                MOV     R7,A
06DE 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1408
06E1 7F01              MOV     R7,#01H
06E3 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1411
06E6 900000      E     MOV     DPTR,#master_mode
06E9 E0                MOVX    A,@DPTR
06EA 6012              JZ      ?C0253
                                           ; SOURCE LINE # 1412
06EC 120000      E     LCALL   deactivate_slaves
                                           ; SOURCE LINE # 1415
06EF 300005            JNB     interrupt_flag,?C0254
                                           ; SOURCE LINE # 1416
06F2 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1417
06F4 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1418
06F7         ?C0254:
                                           ; SOURCE LINE # 1420
06F7 E4                CLR     A
06F8 900000      E     MOV     DPTR,#master_mode
06FB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1421
06FC 8009              SJMP    ?C0250
06FE         ?C0253:
                                           ; SOURCE LINE # 1422
                                           ; SOURCE LINE # 1423
06FE E4                CLR     A
06FF 900000      E     MOV     DPTR,#g_refNew+018H
0702 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1424
0703 FF                MOV     R7,A
0704 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1425
                                           ; SOURCE LINE # 1426
                                           ; SOURCE LINE # 1427
0707         ?C0250:
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 134 

                                           ; SOURCE LINE # 1429
0707 300005            JNB     interrupt_flag,?C0257
                                           ; SOURCE LINE # 1430
070A C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1431
070C 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1432
                                           ; SOURCE LINE # 1433
070F         ?C0257:
070F 22                RET     
             ; FUNCTION analog_read_end (END)

             ; FUNCTION overcurrent_control (BEGIN)
                                           ; SOURCE LINE # 1439
                                           ; SOURCE LINE # 1440
0000 900000      E     MOV     DPTR,#c_mem+069H
0003 E0                MOVX    A,@DPTR
0004 FE                MOV     R6,A
0005 A3                INC     DPTR
0006 E0                MOVX    A,@DPTR
0007 FF                MOV     R7,A
0008 4E                ORL     A,R6
0009 6068              JZ      ?C0265
                                           ; SOURCE LINE # 1442
000B EE                MOV     A,R6
000C 33                RLC     A
000D 95E0              SUBB    A,ACC
000F FD                MOV     R5,A
0010 FC                MOV     R4,A
0011 900000      E     MOV     DPTR,#g_meas+0CH
0014 E0                MOVX    A,@DPTR
0015 F8                MOV     R0,A
0016 A3                INC     DPTR
0017 E0                MOVX    A,@DPTR
0018 F9                MOV     R1,A
0019 A3                INC     DPTR
001A E0                MOVX    A,@DPTR
001B FA                MOV     R2,A
001C A3                INC     DPTR
001D E0                MOVX    A,@DPTR
001E FB                MOV     R3,A
001F D3                SETB    C
0020 120000      E     LCALL   ?C?SLCMP
0023 4008              JC      ?C0259
                                           ; SOURCE LINE # 1444
0025 900000      E     MOV     DPTR,#dev_pwm_limit
0028 E0                MOVX    A,@DPTR
0029 14                DEC     A
002A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1446
002B 802D              SJMP    ?C0260
002D         ?C0259:
002D 900000      E     MOV     DPTR,#c_mem+06AH
0030 E0                MOVX    A,@DPTR
0031 24F6              ADD     A,#0F6H
0033 FF                MOV     R7,A
0034 900000      E     MOV     DPTR,#c_mem+069H
0037 E0                MOVX    A,@DPTR
0038 34FF              ADDC    A,#0FFH
003A FE                MOV     R6,A
003B 33                RLC     A
003C 95E0              SUBB    A,ACC
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 135 

003E FD                MOV     R5,A
003F FC                MOV     R4,A
0040 900000      E     MOV     DPTR,#g_meas+0CH
0043 E0                MOVX    A,@DPTR
0044 F8                MOV     R0,A
0045 A3                INC     DPTR
0046 E0                MOVX    A,@DPTR
0047 F9                MOV     R1,A
0048 A3                INC     DPTR
0049 E0                MOVX    A,@DPTR
004A FA                MOV     R2,A
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
004D FB                MOV     R3,A
004E C3                CLR     C
004F 120000      E     LCALL   ?C?SLCMP
0052 5006              JNC     ?C0260
                                           ; SOURCE LINE # 1448
0054 900000      E     MOV     DPTR,#dev_pwm_limit
0057 E0                MOVX    A,@DPTR
0058 04                INC     A
0059 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1449
005A         ?C0260:
                                           ; SOURCE LINE # 1452
005A 900000      E     MOV     DPTR,#dev_pwm_limit
005D E0                MOVX    A,@DPTR
005E FF                MOV     R7,A
005F C3                CLR     C
0060 9400              SUBB    A,#00H
0062 5003              JNC     ?C0262
                                           ; SOURCE LINE # 1453
0064 E4                CLR     A
0065 F0                MOVX    @DPTR,A
0066 22                RET     
0067         ?C0262:
                                           ; SOURCE LINE # 1455
0067 EF                MOV     A,R7
0068 D3                SETB    C
0069 9464              SUBB    A,#064H
006B 4006              JC      ?C0265
                                           ; SOURCE LINE # 1456
006D 900000      E     MOV     DPTR,#dev_pwm_limit
0070 7464              MOV     A,#064H
0072 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1457
                                           ; SOURCE LINE # 1458
0073         ?C0265:
0073 22                RET     
             ; FUNCTION overcurrent_control (END)

             ; FUNCTION pwm_limit_search (BEGIN)
                                           ; SOURCE LINE # 1464
                                           ; SOURCE LINE # 1468
0000 E4                CLR     A
0001 7F9C              MOV     R7,#09CH
0003 7E63              MOV     R6,#063H
0005 FD                MOV     R5,A
0006 FC                MOV     R4,A
0007 900000      E     MOV     DPTR,#dev_tension
000A E0                MOVX    A,@DPTR
000B F8                MOV     R0,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 136 

000C A3                INC     DPTR
000D E0                MOVX    A,@DPTR
000E F9                MOV     R1,A
000F A3                INC     DPTR
0010 E0                MOVX    A,@DPTR
0011 FA                MOV     R2,A
0012 A3                INC     DPTR
0013 E0                MOVX    A,@DPTR
0014 FB                MOV     R3,A
0015 D3                SETB    C
0016 120000      E     LCALL   ?C?SLCMP
0019 4006              JC      ?C0266
                                           ; SOURCE LINE # 1469
001B E4                CLR     A
001C 900000      E     MOV     DPTR,#dev_pwm_limit
001F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1470
0020 22                RET     
0021         ?C0266:
0021 E4                CLR     A
0022 7FEC              MOV     R7,#0ECH
0024 7E2C              MOV     R6,#02CH
0026 FD                MOV     R5,A
0027 FC                MOV     R4,A
0028 900000      E     MOV     DPTR,#dev_tension
002B E0                MOVX    A,@DPTR
002C F8                MOV     R0,A
002D A3                INC     DPTR
002E E0                MOVX    A,@DPTR
002F F9                MOV     R1,A
0030 A3                INC     DPTR
0031 E0                MOVX    A,@DPTR
0032 FA                MOV     R2,A
0033 A3                INC     DPTR
0034 E0                MOVX    A,@DPTR
0035 FB                MOV     R3,A
0036 C3                CLR     C
0037 120000      E     LCALL   ?C?SLCMP
003A 5007              JNC     ?C0268
                                           ; SOURCE LINE # 1471
003C 900000      E     MOV     DPTR,#dev_pwm_limit
003F 7464              MOV     A,#064H
0041 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1472
0042 22                RET     
0043         ?C0268:
                                           ; SOURCE LINE # 1473
0043 900000      E     MOV     DPTR,#dev_tension
0046 E0                MOVX    A,@DPTR
0047 FC                MOV     R4,A
0048 A3                INC     DPTR
0049 E0                MOVX    A,@DPTR
004A FD                MOV     R5,A
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
004D FE                MOV     R6,A
004E A3                INC     DPTR
004F E0                MOVX    A,@DPTR
0050 2414              ADD     A,#014H
0052 FF                MOV     R7,A
0053 EE                MOV     A,R6
0054 34D3              ADDC    A,#0D3H
C51 COMPILER V9.51   INTERRUPTIONS                                                         04/04/2018 11:01:37 PAGE 137 

0056 FE                MOV     R6,A
0057 ED                MOV     A,R5
0058 34FF              ADDC    A,#0FFH
005A FD                MOV     R5,A
005B EC                MOV     A,R4
005C 34FF              ADDC    A,#0FFH
005E FC                MOV     R4,A
005F 7809              MOV     R0,#09H
0061 120000      E     LCALL   ?C?SLSHR
0064 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 1474
0066 7400        R     MOV     A,#LOW pwm_preload_values
0068 2F                ADD     A,R7
0069 F582              MOV     DPL,A
006B E4                CLR     A
006C 3400        R     ADDC    A,#HIGH pwm_preload_values
006E F583              MOV     DPH,A
0070 E0                MOVX    A,@DPTR
0071 900000      E     MOV     DPTR,#dev_pwm_limit
0074 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1475
                                           ; SOURCE LINE # 1476
0075         ?C0270:
0075 22                RET     
             ; FUNCTION pwm_limit_search (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   9228    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =    273      20
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8      84
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3       1
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
