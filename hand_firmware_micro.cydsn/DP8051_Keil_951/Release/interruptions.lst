C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE INTERRUPTIONS
OBJECT MODULE PLACED IN .\DP8051_Keil_951\Release\interruptions.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\3.3\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -.\interruptions.c NOIV LARGE MODDP2 OMF2 VB(1) NOIP INCDIR(.,Generated_Source\PSoC3) FF(3) DB DF(NDEBUG) WL(2) PR(.\DP80
                    -51_Keil_951\Release/interruptions.lst) CD OT(8,SPEED) OJ(.\DP8051_Keil_951\Release\interruptions.obj)

line level    source

*** MESSAGE C286 IN LINE 0 OF (null): license limits optimization to level 5
   1          // ----------------------------------------------------------------------------
   2          // BSD 3-Clause License
   3          
   4          // Copyright (c) 2016, qbrobotics
   5          // Copyright (c) 2017, Centro "E.Piaggio"
   6          // All rights reserved.
   7          
   8          // Redistribution and use in source and binary forms, with or without
   9          // modification, are permitted provided that the following conditions are met:
  10          
  11          // * Redistributions of source code must retain the above copyright notice, this
  12          //   list of conditions and the following disclaimer.
  13          
  14          // * Redistributions in binary form must reproduce the above copyright notice,
  15          //   this list of conditions and the following disclaimer in the documentation
  16          //   and/or other materials provided with the distribution.
  17          
  18          // * Neither the name of the copyright holder nor the names of its
  19          //   contributors may be used to endorse or promote products derived from
  20          //   this software without specific prior written permission.
  21          
  22          // THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  23          // AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  24          // IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  25          // DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  26          // FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  27          // DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  28          // SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  29          // CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  30          // OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  31          // OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  32          // POSSIBILITY OF SUCH DAMAGE.
  33          // ----------------------------------------------------------------------------
  34          
  35          /**
  36          * \file         interruptions.c
  37          *
  38          * \brief        Interruption handling and firmware core functions
  39          * \date         June 06, 2016
  40          * \author       _qbrobotics_
  41          * \copyright    (C) 2012-2016 qbrobotics. All rights reserved.
  42          * \copyright    (C) 2017 Centro "E.Piaggio". All rights reserved.
  43          */
  44          
  45          
  46          //=================================================================     includes
  47          #include <interruptions.h>
  48          #include <command_processing.h>
  49          #include <globals.h>
  50          #include <utils.h>
  51          
  52          
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 2   

  53          //==============================================================================
  54          //                                                            RS485 RX INTERRUPT
  55          //==============================================================================
  56          // Processing RS-485 data frame:
  57          //
  58          // - 0:     Waits for beggining characters
  59          // - 1:     Waits for ID;
  60          // - 2:     Data length;
  61          // - 3:     Receive all bytes;
  62          // - 4:     Wait for another device end of transmission;
  63          //
  64          //==============================================================================
  65          
  66          // PWM values needed to obtain 11.5 V given a certain input tension
  67          // Numbers are sperimentally calculated //[index] (millivolts)
  68          static const uint8 pwm_preload_values[29] = {100,    //0 (11500)
  69                                                        83,
  70                                                        78,
  71                                                        76,
  72                                                        74,
  73                                                        72,    //5 (14000)
  74                                                        70,
  75                                                        68,
  76                                                        67,
  77                                                        65,
  78                                                        64,    //10 (16500)
  79                                                        63,
  80                                                        62,
  81                                                        61,
  82                                                        60,
  83                                                        59,    //15 (19000)
  84                                                        58,
  85                                                        57,
  86                                                        56,
  87                                                        56,
  88                                                        55,    //20 (21500)
  89                                                        54,
  90                                                        54,
  91                                                        53,
  92                                                        52,
  93                                                        52,    //25 (24000)
  94                                                        52,
  95                                                        51,
  96                                                        51};   //28 (25500)
  97          
  98          //==============================================================================
  99          //                                                            WATCHDOG INTERRUPT
 100          //==============================================================================
 101          
 102          CY_ISR(ISR_WATCHDOG_Handler){
 103   1      
 104   1          // Set WDT flag
 105   1          
 106   1          watchdog_flag = TRUE;
 107   1      
 108   1      }
 109          
 110          //==============================================================================
 111          //                                                            RS485 RX INTERRUPT
 112          //==============================================================================
 113          
 114          CY_ISR(ISR_RS485_RX_ExInterrupt) {
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 3   

 115   1      
 116   1          // Set RS485 flag
 117   1          
 118   1          interrupt_flag = TRUE;
 119   1           
 120   1      }
 121          
 122          //==============================================================================
 123          //                                                             INTERRUPT MANAGER
 124          //==============================================================================
 125          // Manage interrupt from RS485 
 126          //==============================================================================
 127          // Processing RS-485 data frame:
 128          //
 129          // - WAIT_START:    Waits for beginning characters;
 130          // - WAIT_ID:       Waits for ID;
 131          // - WAIT_LENGTH:   Data length;
 132          // - RECEIVE:       Receive all bytes;
 133          // - UNLOAD:        Wait for another device end of transmission;
 134          //
 135          //==============================================================================
 136          
 137          void interrupt_manager(){
 138   1      
 139   1          
 140   1          //===========================================     local variables definition
 141   1      
 142   1          static uint8 CYDATA state = WAIT_START;                      // state
 143   1          
 144   1          //------------------------------------------------- local data packet
 145   1          static uint8 CYDATA data_packet_index;
 146   1          static uint8 CYDATA data_packet_length;
 147   1          static uint8 data_packet_buffer[128];                     
 148   1          static uint8 CYDATA rx_queue[3];                    // last 2 bytes received
 149   1          //-------------------------------------------------
 150   1      
 151   1          uint8 CYDATA    rx_data;                            // RS485 UART rx data
 152   1          CYBIT           rx_data_type;                       // my id?
 153   1          uint8 CYDATA    package_count = 0;                     
 154   1      
 155   1          //======================================================     receive routine
 156   1          
 157   1          // Get data until buffer is not empty 
 158   1          
 159   1          while(UART_RS485_GetRxBufferSize() && (package_count < 6)){  
 160   2              // 6 stima di numero massimo di pacchetti che riesco a leggere senza bloccare l'esecuzione del fir
             -mware
 161   2              
 162   2              // Get next char
 163   2              rx_data = UART_RS485_GetChar();
 164   2              
 165   2              switch (state) {
 166   3                  //-----     wait for frame start     -------------------------------
 167   3                  case WAIT_START:
 168   3                  
 169   3                      rx_queue[0] = rx_queue[1];
 170   3                      rx_queue[1] = rx_queue[2];
 171   3                      rx_queue[2] = rx_data;
 172   3                      
 173   3                      // Check for header configuration package
 174   3                      if ((rx_queue[1] == 58) && (rx_queue[2] == 58)) {
 175   4                          rx_queue[0] = 0;
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 4   

 176   4                          rx_queue[1] = 0;
 177   4                          rx_queue[2] = 0;
 178   4                          state       = WAIT_ID;                    
 179   4                      }else
 180   3                          if ((rx_queue[0] == 63) &&      //ASCII - ?
 181   3                              (rx_queue[1] == 13) &&      //ASCII - CR
 182   3                              (rx_queue[2] == 10))        //ASCII - LF)
 183   3                              infoGet(INFO_ALL);
 184   3                      break;
 185   3      
 186   3                  //-----     wait for id     ----------------------------------------
 187   3                  case  WAIT_ID:
 188   3      
 189   3                      // packet is for my ID or is broadcast
 190   3                      if (rx_data == c_mem.id || rx_data == 0)
 191   3                          rx_data_type = FALSE;
 192   3                      else                //packet is for others
 193   3                          rx_data_type = TRUE;
 194   3                      
 195   3                      // Master with Rest position mode
 196   3                      if (receive_meas_from_hand == 1){
 197   4                          rx_data_type = FALSE;
 198   4                      }
 199   3                      
 200   3                      data_packet_length = 0;
 201   3                      state = WAIT_LENGTH;
 202   3                      break;
 203   3      
 204   3                  //-----     wait for length     ------------------------------------
 205   3                  case  WAIT_LENGTH:
 206   3      
 207   3       
 208   3                      data_packet_length = rx_data;
 209   3                      // check validity of pack length
 210   3                      if (data_packet_length <= 1) {
 211   4                          data_packet_length = 0;
 212   4                          state = WAIT_START;
 213   4                      } else if (data_packet_length > 128) {
 214   4                          data_packet_length = 0;
 215   4                          state = WAIT_START;
 216   4                      } else {
 217   4                          data_packet_index = 0;
 218   4                          
 219   4                          if(rx_data_type == FALSE)
 220   4                              state = RECEIVE;          // packet for me or broadcast
 221   4                          else
 222   4                              state = UNLOAD;           // packet for others
 223   4                      }
 224   3                      break;
 225   3      
 226   3                  //-----     receiving     -------------------------------------------
 227   3                  case RECEIVE:
 228   3      
 229   3                      data_packet_buffer[data_packet_index] = rx_data;
 230   3                      data_packet_index++;
 231   3                      
 232   3                      // check end of transmission
 233   3                      if (data_packet_index >= data_packet_length) {
 234   4                          // verify if frame ID corresponded to the device ID
 235   4                          if (rx_data_type == FALSE) {
 236   5                              // copying data from buffer to global packet
 237   5                              memcpy(g_rx.buffer, data_packet_buffer, data_packet_length);
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 5   

 238   5                              g_rx.length = data_packet_length;
 239   5                              g_rx.ready  = 1;
 240   5                              
 241   5                              // Master with Rest position mode
 242   5                              if (receive_meas_from_hand == 1){
 243   6                                  g_rx.buffer[0] = CMD_GET_HAND_MEASUREMENTS;
 244   6                              }
 245   5                      
 246   5                              commProcess();
 247   5                          }
 248   4                          
 249   4                          data_packet_index  = 0;
 250   4                          data_packet_length = 0;
 251   4                          state = WAIT_START;
 252   4                          package_count++;
 253   4                      
 254   4                      }
 255   3                      break;
 256   3      
 257   3                  //-----     other device is receving     ---------------------------
 258   3                  case UNLOAD:
 259   3                      if (!(--data_packet_length)) {
 260   4                          data_packet_index  = 0;
 261   4                          data_packet_length = 0;
 262   4                          RS485_CTS_Write(1);
 263   4                          RS485_CTS_Write(0);
 264   4                          state              = WAIT_START;
 265   4                          package_count++;
 266   4                      }
 267   3                      break;
 268   3              }
 269   2          }
 270   1      }
 271          //==============================================================================
 272          //                                                            FUNCTION SCHEDULER
 273          //==============================================================================
 274          // Call all the function with the right frequency
 275          //==============================================================================
 276          // Base frequency 1000 Hz
 277          //==============================================================================
 278          
 279          void function_scheduler(void) {
 280   1       
 281   1          static uint16 counter_calibration = DIV_INIT_VALUE;
 282   1      
 283   1          timer_value0 = (uint32)MY_TIMER_ReadCounter();
 284   1      
 285   1          // Start ADC Conversion, SOC = 1
 286   1      
 287   1          ADC_SOC_Write(0x01); 
 288   1          
 289   1          // Check Interrupt 
 290   1      
 291   1          if (interrupt_flag){
 292   2              interrupt_flag = FALSE;
 293   2              interrupt_manager();
 294   2          }
 295   1        
 296   1          //---------------------------------- Get Encoders
 297   1      
 298   1          encoder_reading(0); 
 299   1          
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 6   

 300   1          // Check Interrupt     
 301   1          
 302   1          if (interrupt_flag){
 303   2              interrupt_flag = FALSE;
 304   2              interrupt_manager();
 305   2          }   
 306   1          
 307   1          encoder_reading(1);
 308   1          
 309   1          // Check Interrupt 
 310   1          
 311   1          if (interrupt_flag){
 312   2              interrupt_flag = FALSE;
 313   2              interrupt_manager();
 314   2          }
 315   1          
 316   1          encoder_reading(2);
 317   1          
 318   1          // Check Interrupt 
 319   1          
 320   1          if (interrupt_flag){
 321   2              interrupt_flag = FALSE;
 322   2              interrupt_manager();
 323   2          }
 324   1      
 325   1          //---------------------------------- Control Motor
 326   1         
 327   1          motor_control();
 328   1      
 329   1          // Check Interrupt 
 330   1      
 331   1          if (interrupt_flag){
 332   2              interrupt_flag = FALSE;
 333   2              interrupt_manager();
 334   2          }
 335   1      
 336   1          //---------------------------------- Read conversion buffer - LOCK function
 337   1      
 338   1          analog_read_end();
 339   1      
 340   1          if (interrupt_flag){
 341   2              interrupt_flag = FALSE;
 342   2              interrupt_manager();
 343   2          }
 344   1      
 345   1          //---------------------------------- Control Overcurrent
 346   1      
 347   1          overcurrent_control();
 348   1          
 349   1          // Check Interrupt 
 350   1          
 351   1          if (interrupt_flag){
 352   2              interrupt_flag = FALSE;
 353   2              interrupt_manager();
 354   2          }
 355   1          
 356   1          //---------------------------------- Master Mode
 357   1            
 358   1          if(master_mode){
 359   2              // Rest position check (only if Master mode is enabled)
 360   2              if (c_mem.control_mode == CONTROL_ANGLE_AND_REST_POS){
 361   3                  if (counter_calibration == CALIBRATION_DIV) {
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 7   

 362   4                      
 363   4                          // Read Measure (valid since this routine is enabled only in Master mode)
 364   4                          curr_pos_res = (int32)commReadMeasFromAnother();
 365   4      
 366   4                          check_rest_position();
 367   4                          counter_calibration = 0;
 368   4                  }
 369   3                  counter_calibration++;
 370   3      
 371   3                  // Check Interrupt     
 372   3                  if (interrupt_flag){
 373   4                      interrupt_flag = FALSE;
 374   4                      interrupt_manager();
 375   4                  }
 376   3              }
 377   2              
 378   2              command_slave();        
 379   2          }
 380   1                  
 381   1          // Check Interrupt 
 382   1          
 383   1          if (interrupt_flag){
 384   2              interrupt_flag = FALSE;
 385   2              interrupt_manager();
 386   2          }
 387   1      
 388   1          //---------------------------------- Calibration 
 389   1      
 390   1          // Divider 10, freq = 500 Hz
 391   1          if (calib.enabled == TRUE) {
 392   2              if (counter_calibration == CALIBRATION_DIV) {
 393   3                  calibration();
 394   3                  counter_calibration = 0;
 395   3              }
 396   2              counter_calibration++;
 397   2          }
 398   1      
 399   1          // Check Interrupt 
 400   1          
 401   1          if (interrupt_flag){
 402   2              interrupt_flag = FALSE;
 403   2              interrupt_manager();
 404   2          }
 405   1          
 406   1          
 407   1          //---------------------------------- Update States
 408   1          
 409   1          // Load k-1 state
 410   1          memcpy( &g_measOld, &g_meas, sizeof(g_meas) );
 411   1          memcpy( &g_refOld, &g_ref, sizeof(g_ref) );
 412   1      
 413   1          // Load k+1 state
 414   1          memcpy( &g_ref, &g_refNew, sizeof(g_ref) );
 415   1      
 416   1          if (interrupt_flag){
 417   2              interrupt_flag = FALSE;
 418   2              interrupt_manager();
 419   2          }
 420   1      
 421   1          timer_value = (uint32)MY_TIMER_ReadCounter();
 422   1          MY_TIMER_WriteCounter(5000000);
 423   1      
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 8   

 424   1      }
 425          
 426          //==============================================================================
 427          //                                                                MOTORS CONTROL
 428          //==============================================================================
 429          
 430          void motor_control() {
 431   1      
 432   1          int32 CYDATA pwm_input = 0;
 433   1      
 434   1          int32 CYDATA pos_error;         // position error
 435   1          int32 CYDATA curr_error;        // current error
 436   1      
 437   1          int32 CYDATA i_ref;             // current reference
 438   1          int32 CYDATA handle_value;
 439   1      
 440   1          int32 CYDATA err_emg_1, err_emg_2;
 441   1      
 442   1          int32 CYDATA k_p = c_mem.k_p;  
 443   1          int32 CYDATA k_i = c_mem.k_i; 
 444   1          int32 CYDATA k_d = c_mem.k_d; 
 445   1      
 446   1          int32 CYDATA k_p_c = c_mem.k_p_c;  
 447   1          int32 CYDATA k_i_c = c_mem.k_i_c; 
 448   1          int32 CYDATA k_d_c = c_mem.k_d_c;   
 449   1      
 450   1          int32 CYDATA k_p_dl = c_mem.k_p_dl;  
 451   1          int32 CYDATA k_i_dl = c_mem.k_i_dl; 
 452   1          int32 CYDATA k_d_dl = c_mem.k_d_dl;
 453   1          
 454   1          int32 CYDATA k_p_c_dl = c_mem.k_p_c_dl;  
 455   1          int32 CYDATA k_i_c_dl = c_mem.k_i_c_dl; 
 456   1          int32 CYDATA k_d_c_dl = c_mem.k_d_c_dl;   
 457   1      
 458   1          // Static Variables
 459   1      
 460   1          static int32 pos_error_sum;     // position error sum for integral
 461   1          static int32 curr_error_sum;    // current error sum for integral
 462   1          
 463   1          static int32 prev_pos_err;      // previous position error for deriv. control
 464   1          static int32 prev_curr_err;     // previous current error for deriv. control
 465   1      
 466   1          static CYBIT motor_dir = FALSE;
 467   1      
 468   1          static uint8 current_emg = 0;   // 0 NONE
 469   1                                          // 1 EMG 1
 470   1                                          // 2 EMG 2
 471   1                                          // wait for both to get down
 472   1      
 473   1          err_emg_1 = g_meas.emg[0] - c_mem.emg_threshold[0];
 474   1          err_emg_2 = g_meas.emg[1] - c_mem.emg_threshold[1];
 475   1      
 476   1          // =========================== POSITION INPUT ==============================
 477   1          switch(c_mem.input_mode) {
 478   2      
 479   2              case INPUT_MODE_ENCODER3:
 480   2      
 481   2                  // Calculate handle value based on position of handle in the
 482   2                  // sensor chain and multiplication factor between handle and motor position
 483   2                  if (c_mem.double_encoder_on_off) 
 484   2                      handle_value = g_meas.pos[2] * c_mem.motor_handle_ratio;
 485   2                  else
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 9   

 486   2                      handle_value = g_meas.pos[1] * c_mem.motor_handle_ratio;
 487   2                  
 488   2      
 489   2                  // Read handle and use it as reference for the motor
 490   2                  if (((handle_value - g_ref.pos[0]) > c_mem.max_step_pos) && (c_mem.max_step_pos != 0))
 491   2                      g_ref.pos[0] += c_mem.max_step_pos;
 492   2                  else {
 493   3                      if (((handle_value - g_ref.pos[0]) < c_mem.max_step_neg) && (c_mem.max_step_neg != 0))
 494   3                          g_ref.pos[0] += c_mem.max_step_neg;
 495   3                      else
 496   3                          g_ref.pos[0] = handle_value;
 497   3                  }
 498   2                  break;
 499   2      
 500   2              case INPUT_MODE_EMG_PROPORTIONAL:
 501   2                  if (err_emg_1 > 0)
 502   2                      g_ref.pos[0] = (err_emg_1 * g_mem.pos_lim_sup[0]) / (1024 - c_mem.emg_threshold[0]);
 503   2                  else
 504   2                      g_ref.pos[0] = 0;
 505   2                  break;
 506   2      
 507   2              case INPUT_MODE_EMG_INTEGRAL:
 508   2                  g_ref.pos[0] = g_refOld.pos[0];
 509   2                  if (err_emg_1 > 0) {
 510   3                      g_ref.pos[0] = g_refOld.pos[0] + (err_emg_1 * (int)g_mem.emg_speed * 2) / (1024 - c_mem.em
             -g_threshold[0]);
 511   3                  }
 512   2                  if (err_emg_2 > 0) {
 513   3                      g_ref.pos[0] = g_refOld.pos[0] - (err_emg_2 * (int)g_mem.emg_speed * 2) / (1024 - c_mem.em
             -g_threshold[1]);
 514   3                  }
 515   2                  break;
 516   2      
 517   2              case INPUT_MODE_EMG_FCFS:
 518   2                  g_ref.pos[0] = g_refOld.pos[0];
 519   2                  switch (current_emg) {
 520   3                      case 0:
 521   3                          // Look for the first EMG passing the threshold
 522   3                          if (err_emg_1 > 0) {
 523   4                              current_emg = 1;
 524   4                              break;
 525   4                          }
 526   3                          if (err_emg_2 > 0) {
 527   4                              current_emg = 2;
 528   4                              break;
 529   4                          }
 530   3                          break;
 531   3      
 532   3                      case 1:
 533   3                          // EMG 1 is first
 534   3                          if (err_emg_1 < 0) {
 535   4                              current_emg = 0;
 536   4                              break;
 537   4                          }
 538   3                          g_ref.pos[0] = g_refOld.pos[0] + (err_emg_1 * g_mem.emg_speed * 2) / (1024 - c_mem.emg
             -_threshold[0]);
 539   3                          break;
 540   3      
 541   3                      case 2:
 542   3                          // EMG 2 is first
 543   3                          if (err_emg_2 < 0) {
 544   4                              current_emg = 0;
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 10  

 545   4                              break;
 546   4                          }
 547   3                          g_ref.pos[0] = g_refOld.pos[0] - (err_emg_2 * g_mem.emg_speed * 2) / (1024 - c_mem.emg
             -_threshold[1]);
 548   3                          break;
 549   3      
 550   3                      default:
 551   3                          break;
 552   3                  }
 553   2      
 554   2                  break;
 555   2      
 556   2              case INPUT_MODE_EMG_FCFS_ADV:
 557   2                  g_ref.pos[0] = g_refOld.pos[0];
 558   2                  switch (current_emg) {
 559   3                      // Look for the first EMG passing the threshold
 560   3                      case 0:
 561   3                          if (err_emg_1 > 0) {
 562   4                              current_emg = 1;
 563   4                              break;
 564   4                          }
 565   3                          if (err_emg_2 > 0) {
 566   4                              current_emg = 2;
 567   4                              break;
 568   4                          }
 569   3                          break;
 570   3      
 571   3                      // EMG 1 is first
 572   3                      case 1:
 573   3                          // If both signals are under threshold go back to status 0
 574   3                          if ((err_emg_1 < 0) && (err_emg_2 < 0)) {
 575   4                              current_emg = 0;
 576   4                              break;
 577   4                          }
 578   3                          // but if the current signal come back over threshold, continue using it
 579   3                          if (err_emg_1 > 0) 
 580   3                              g_ref.pos[0] = g_refOld.pos[0] + (err_emg_1 * g_mem.emg_speed << 2) / (1024 - c_me
             -m.emg_threshold[0]);
 581   3                          
 582   3                          break;
 583   3      
 584   3                      // EMG 2 is first
 585   3                      case 2:
 586   3                          // If both signals are under threshold go back to status 0
 587   3                          if ((err_emg_1 < 0) && (err_emg_2 < 0)) {
 588   4                              current_emg = 0;
 589   4                              break;
 590   4                          }
 591   3                          // but if the current signal come back over threshold, continue using it
 592   3                          if (err_emg_2 > 0) {
 593   4                              g_ref.pos[0] = g_refOld.pos[0] - (err_emg_2 * c_mem.emg_speed << 2) / (1024 - c_me
             -m.emg_threshold[1]);
 594   4                          }
 595   3                          break;
 596   3      
 597   3                      default:
 598   3                          break;
 599   3                  }
 600   2      
 601   2              default:
 602   2                  break;
 603   2          }
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 11  

 604   1      
 605   1          // Position limit saturation
 606   1          if (c_mem.pos_lim_flag) {
 607   2              if (g_ref.pos[0] < c_mem.pos_lim_inf[0]) 
 608   2                  g_ref.pos[0] = c_mem.pos_lim_inf[0];
 609   2              if (g_ref.pos[0] > c_mem.pos_lim_sup[0]) 
 610   2                  g_ref.pos[0] = c_mem.pos_lim_sup[0];
 611   2          }
 612   1      
 613   1          switch(c_mem.control_mode) {
 614   2              // ======================= CURRENT AND POSITION CONTROL =======================
 615   2              case CURR_AND_POS_CONTROL:
 616   2                  pos_error = g_ref.pos[0] - g_meas.pos[0];
 617   2      
 618   2                  pos_error_sum += pos_error;
 619   2      
 620   2                  // error_sum saturation
 621   2                  if (pos_error_sum > POS_INTEGRAL_SAT_LIMIT)
 622   2                      pos_error_sum = POS_INTEGRAL_SAT_LIMIT;
 623   2                  else {
 624   3                      if (pos_error_sum < -POS_INTEGRAL_SAT_LIMIT) 
 625   3                          pos_error_sum = -POS_INTEGRAL_SAT_LIMIT;
 626   3                  }
 627   2                  
 628   2                  // ------ position PID control ------
 629   2      
 630   2                  i_ref = 0;
 631   2                  
 632   2                  // Proportional
 633   2                  if (k_p_dl != 0)
 634   2                      i_ref += (int32)(k_p_dl * pos_error) >> 16;
 635   2      
 636   2                  // Integral
 637   2                  if (k_i_dl != 0)
 638   2                      i_ref += (int32)(k_i_dl * pos_error_sum) >> 16;
 639   2      
 640   2                  // Derivative
 641   2                  if (k_d_dl != 0)
 642   2                      i_ref += (int32)(k_d_dl * (pos_error - prev_pos_err)) >> 16;
 643   2                              
 644   2                  // Update previous position
 645   2                  prev_pos_err = pos_error;
 646   2      
 647   2                  // // current set through position reference
 648   2                  // i_ref = g_ref.pos[0] >> g_mem.res[0];
 649   2      
 650   2                  // motor direction depends on i_ref
 651   2                  if (i_ref >= 0)
 652   2                      motor_dir = TRUE;
 653   2                  else
 654   2                      motor_dir = FALSE;
 655   2      
 656   2                  // current ref must be positive
 657   2                  //i_ref = abs(i_ref);
 658   2      
 659   2                  // saturate max current
 660   2                  if (i_ref > c_mem.current_limit)
 661   2                      i_ref = c_mem.current_limit;
 662   2                  else 
 663   2                      if (i_ref < -c_mem.current_limit)
 664   2                          i_ref = -c_mem.current_limit;
 665   2                  
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 12  

 666   2      
 667   2                  // saturate min current
 668   2                  /*if (i_ref < MIN_CURR_SAT_LIMIT && i_ref > 0) {
 669   2                      i_ref = MIN_CURR_SAT_LIMIT;
 670   2                  }*/
 671   2      
 672   2                  // // write i_ref on meas curr 2 for DEBUG
 673   2                  //g_meas.curr[1] = i_ref;
 674   2      
 675   2                  // current error and curr error sum
 676   2                  curr_error = i_ref - g_meas.curr[0];
 677   2                  curr_error_sum += curr_error;
 678   2                  
 679   2                  if (curr_error_sum > CURR_INTEGRAL_SAT_LIMIT)
 680   2                      curr_error_sum = CURR_INTEGRAL_SAT_LIMIT;
 681   2                  else {
 682   3                      if (curr_error_sum < -CURR_INTEGRAL_SAT_LIMIT)
 683   3                          curr_error_sum = -CURR_INTEGRAL_SAT_LIMIT;
 684   3                  }
 685   2      
 686   2                  // ----- current PID control -----
 687   2      
 688   2                  pwm_input = 0;
 689   2      
 690   2                  // Proportional
 691   2                  if (k_p_c_dl != 0)
 692   2                      pwm_input += (int32)(k_p_c_dl * curr_error) >> 16;
 693   2      
 694   2                  // Integral
 695   2                  if (k_i_c_dl != 0)
 696   2                      pwm_input += (int32)(k_i_c_dl * curr_error_sum) >> 16;
 697   2      
 698   2                  // Derivative
 699   2                  if (k_d_c_dl != 0)
 700   2                      pwm_input += (int32)(k_d_c_dl * (curr_error - prev_curr_err)) >> 16;
 701   2      
 702   2                  // pwm_input saturation
 703   2                  if (pwm_input < -PWM_MAX_VALUE) 
 704   2                      pwm_input = -PWM_MAX_VALUE;
 705   2                  else {
 706   3                      if (pwm_input > PWM_MAX_VALUE)
 707   3                          pwm_input = PWM_MAX_VALUE;
 708   3                  }
 709   2      
 710   2                  // Update previous current
 711   2                  prev_curr_err = curr_error;
 712   2      
 713   2              break;
 714   2      
 715   2              // ============================== POSITION CONTROL =====================
 716   2              case CONTROL_ANGLE:
 717   2                  pos_error = g_ref.pos[0] - g_meas.pos[0];
 718   2      
 719   2                  pos_error_sum += pos_error;
 720   2      
 721   2                  // anti-windup (for integral control)
 722   2                  if (pos_error_sum > ANTI_WINDUP) {
 723   3                      pos_error_sum = ANTI_WINDUP;
 724   3                  } else if (pos_error_sum < -ANTI_WINDUP) {
 725   3                      pos_error_sum = -ANTI_WINDUP;
 726   3                  }
 727   2      
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 13  

 728   2                  // Proportional
 729   2                  if (k_p != 0) 
 730   2                      pwm_input = (int32)(k_p * pos_error) >> 16;
 731   2                  
 732   2      
 733   2                  // Integral
 734   2                  if (k_i != 0) 
 735   2                      pwm_input += (int32)(k_i * pos_error_sum) >> 16;
 736   2                  
 737   2      
 738   2                  // Derivative
 739   2                  if (k_d != 0) 
 740   2                      pwm_input += (int32)(k_d * (pos_error - prev_pos_err)) >> 16;
 741   2                  
 742   2      
 743   2                  // Update measure
 744   2                  prev_pos_err = pos_error;
 745   2      
 746   2                  if (pwm_input > 0)
 747   2                      motor_dir = TRUE;
 748   2                  else
 749   2                      motor_dir = FALSE;
 750   2      
 751   2              break;
 752   2      
 753   2              // ========================== CURRENT CONTROL ==========================
 754   2              case CONTROL_CURRENT:
 755   2                  if(g_ref.onoff && tension_valid) {
 756   3                      
 757   3                      i_ref = g_ref.curr[0];
 758   3      
 759   3                      if (i_ref > c_mem.current_limit) 
 760   3                          i_ref = c_mem.current_limit;
 761   3                      else {
 762   4                          if (i_ref < -c_mem.current_limit)
 763   4                              i_ref = -c_mem.current_limit;
 764   4                      }
 765   3                      
 766   3                      // current error
 767   3                      curr_error = i_ref - g_meas.curr[0];            
 768   3                      curr_error_sum += curr_error;
 769   3                      
 770   3                      if (curr_error_sum > CURR_INTEGRAL_SAT_LIMIT)
 771   3                          curr_error_sum = CURR_INTEGRAL_SAT_LIMIT;
 772   3                      else {
 773   4                          if (curr_error_sum < -CURR_INTEGRAL_SAT_LIMIT) 
 774   4                              curr_error_sum = -CURR_INTEGRAL_SAT_LIMIT;
 775   4                      }
 776   3      
 777   3                      pwm_input = 0;
 778   3      
 779   3                      // Proportional
 780   3                      if (k_p_c != 0)
 781   3                          pwm_input += (int32)(k_p_c * curr_error) >> 16;
 782   3      
 783   3                      // Integral
 784   3                      if (k_i_c != 0)
 785   3                          pwm_input += (int32)(k_i_c * curr_error_sum) >> 16;
 786   3      
 787   3                      // Derivative
 788   3                      if (k_d_c != 0)
 789   3                          pwm_input += (int32)(k_d_c * (curr_error - prev_curr_err)) >> 16;
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 14  

 790   3                      
 791   3                      prev_curr_err = curr_error;
 792   3                      
 793   3                      if (pwm_input >= 0) 
 794   3                          motor_dir = TRUE;
 795   3                      else
 796   3                          motor_dir = FALSE;
 797   3                  }
 798   2              break;
 799   2              
 800   2              // ================= DIRECT PWM CONTROL ================================
 801   2              case CONTROL_PWM:
 802   2      
 803   2                  pwm_input = g_ref.pwm[0];
 804   2      
 805   2                  if (pwm_input > 0) 
 806   2                      motor_dir = TRUE;
 807   2                  else 
 808   2                      motor_dir = FALSE;
 809   2                  
 810   2      
 811   2                  // pwm_input saturation
 812   2                  if (pwm_input < -PWM_MAX_VALUE) 
 813   2                      pwm_input = -PWM_MAX_VALUE;
 814   2                   else if (pwm_input > PWM_MAX_VALUE) 
 815   2                      pwm_input = PWM_MAX_VALUE;
 816   2                  
 817   2      
 818   2              break;
 819   2      
 820   2          }
 821   1      
 822   1          ////////////////////////////////////////////////////////////////////////////
 823   1      
 824   1          if(pwm_input >  PWM_MAX_VALUE) 
 825   1              pwm_input =  PWM_MAX_VALUE;
 826   1          if(pwm_input < -PWM_MAX_VALUE) 
 827   1              pwm_input = -PWM_MAX_VALUE;
 828   1      
 829   1      
 830   1          if (c_mem.control_mode != CONTROL_PWM) 
 831   1              pwm_input = (((pwm_input << 10) / PWM_MAX_VALUE) * dev_pwm_limit) >> 10;
 832   1          
 833   1      
 834   1          pwm_sign = SIGN(pwm_input);
 835   1      
 836   1          if (motor_dir)
 837   1              MOTOR_DIR_Write(0x01);
 838   1          else
 839   1              MOTOR_DIR_Write(0x00);
 840   1      
 841   1          PWM_MOTORS_WriteCompare1(abs(pwm_input));
 842   1      }
 843          
 844          //==============================================================================
 845          //                                                                   ENCODER READING
 846          //==============================================================================
 847          
 848          void encoder_reading(const uint8 idx) {
 849   1      
 850   1          uint8 CYDATA index = idx;
 851   1          
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 15  

 852   1          uint8 jj;
 853   1          
 854   1          uint32 data_encoder;
 855   1          int32 value_encoder;
 856   1          int32 speed_encoder;
 857   1          int32 accel_encoder;
 858   1          int32 aux;
 859   1      
 860   1          static int32 last_value_encoder[NUM_OF_SENSORS];
 861   1      
 862   1          static uint8 error[NUM_OF_SENSORS];
 863   1          
 864   1          static CYBIT only_first_time = TRUE;
 865   1      
 866   1          static uint8 one_time_execute = 0;
 867   1          static CYBIT pos_reconstruct = FALSE;
 868   1      
 869   1          static int32 v_value[NUM_OF_SENSORS];   //last value for velocity
 870   1          static int32 vv_value[NUM_OF_SENSORS];  //last last value for velocity
 871   1          static int32 vvv_value[NUM_OF_SENSORS];  //last last last value for velocity
 872   1          
 873   1          static int32 a_value[NUM_OF_SENSORS];   //last value for acceleration
 874   1          static int32 aa_value[NUM_OF_SENSORS];  //last last value for acceleration
 875   1          static int32 aaa_value[NUM_OF_SENSORS];  //last last last value for acceleration
 876   1      
 877   1          if (index >= NUM_OF_SENSORS)
 878   1              return;
 879   1          
 880   1          if (reset_last_value_flag) {
 881   2              for (jj = NUM_OF_SENSORS; jj--;) 
 882   2                  last_value_encoder[jj] = 0;
 883   2              
 884   2              reset_last_value_flag = 0;
 885   2          }
 886   1      
 887   1          //======================================================     reading sensors
 888   1              // Shift 1 right to erase Dummy bit of chain
 889   1          if (index == 0)
 890   1                  data_encoder = (SHIFTREG_ENC_1_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 891   1          else {
 892   2              if (index == 1)
 893   2                  data_encoder = (SHIFTREG_ENC_2_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 894   2              else // index == 2
 895   2                  data_encoder = (SHIFTREG_ENC_3_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 896   2          }
 897   1             
 898   1      
 899   1          if (check_enc_data(&data_encoder)) {
 900   2      
 901   2              value_encoder = (int16) (((data_encoder & 0x3FFC0) - 0x20000) >> 2 ) + g_mem.m_off[index];
 902   2                                                          // reset last 6 bit 
 903   2                                                          // -> |:|:|id|dim|CMD|CHK|(data---
 904   2                                                          // subtract half of max value
 905   2                                                          // and shift to have 16 bit val
 906   2      
 907   2              // Initialize last_value_encoder
 908   2              if (only_first_time) {
 909   3                  last_value_encoder[index] = value_encoder;
 910   3                  if (index == 2)
 911   3                      only_first_time = 0;
 912   3              }
 913   2      
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 16  

 914   2              // Take care of rotations
 915   2              aux = value_encoder - last_value_encoder[index];
 916   2      
 917   2              // ====================== 1 TURN ======================
 918   2              // -32768                    0                    32767 -32768                   0                
             -     32767
 919   2              // |-------------------------|-------------------------|-------------------------|----------------
             ----------|
 920   2              //              |                         |      |           |      |                         |
 921   2              //           -16384                     16383    |           |   -16384                     16383
 922   2              //                                               |           |
 923   2              //                                           24575           -24576
 924   2              //                                               |___________|
 925   2              //                                                   49152
 926   2      
 927   2              // if we are in the right interval, take care of rotation
 928   2              // and update the variable only if the difference between
 929   2              // one measure and another is less than 1/4 of turn
 930   2      
 931   2              // Considering we are sampling at 1kHz, this means that our shaft needs
 932   2              // to go slower than 1/4 turn every ms -> 1 turn every 4ms
 933   2              // equal to 250 turn/s -> 15000 RPM
 934   2      
 935   2              if (aux > 49152)
 936   2                  g_meas.rot[index]--;
 937   2              else{ 
 938   3                  if (aux < -49152)
 939   3                      g_meas.rot[index]++;
 940   3                  else{
 941   4                      if (abs(aux) > 16384) { // if two measure are too far
 942   5                          error[index]++;
 943   5                          if (error[index] < 10)
 944   5                              // Discard
 945   5                              return;
 946   5                      }
 947   4                  }
 948   3              }
 949   2      
 950   2              error[index] = 0;
 951   2      
 952   2              last_value_encoder[index] = value_encoder;
 953   2      
 954   2              value_encoder += (int32)g_meas.rot[index] << 16;
 955   2      
 956   2              if (c_mem.m_mult[index] != 1.0) {
 957   3                  value_encoder *= c_mem.m_mult[index];
 958   3              }
 959   2      
 960   2              g_meas.pos[index] = value_encoder;
 961   2          }
 962   1          
 963   1          switch(index) {
 964   2              case 0: {
 965   3                  speed_encoder = (int16)filter_vel_1((3*value_encoder + v_value[0] - vv_value[0] - 3*vvv_value[
             -0])*10);
 966   3                  break;
 967   3              }
 968   2              case 1: {
 969   3                  speed_encoder = (int16)filter_vel_2((3*value_encoder + v_value[1] - vv_value[1] - 3*vvv_value[
             -1])*10);
 970   3                  break;
 971   3              }
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 17  

 972   2              case 2: {
 973   3                  speed_encoder = (int16)filter_vel_3((3*value_encoder + v_value[2] - vv_value[2] - 3*vvv_value[
             -2])*10);
 974   3                  break;
 975   3              }
 976   2          }
 977   1          //Update current speed
 978   1          g_meas.vel[index] = speed_encoder;
 979   1          
 980   1          //Encoder rotational acceleration calculation
 981   1          switch(index) {
 982   2              case 0:
 983   2                  accel_encoder = (int16)filter_acc_1((3*speed_encoder + a_value[0] - aa_value[0] - 3*aaa_value[
             -0])*10);
 984   2                  break;
 985   2              
 986   2              case 1:
 987   2                  accel_encoder = (int16)filter_acc_2((3*speed_encoder + a_value[1] - aa_value[1] - 3*aaa_value[
             -1])*10);
 988   2                  break;
 989   2              
 990   2              case 2:
 991   2                  accel_encoder = (int16)filter_acc_3((3*speed_encoder + a_value[2] - aa_value[2] - 3*aaa_value[
             -2])*10);
 992   2                  break;
 993   2          }
 994   1          //Update current acceleration
 995   1          g_meas.acc[index] = accel_encoder;
 996   1      
 997   1          // update old velocity and acceleration values
 998   1          vvv_value[index] = vv_value[index];
 999   1          vv_value[index] = v_value[index];
1000   1          v_value[index] = value_encoder;
1001   1      
1002   1          aaa_value[index] = aa_value[index];
1003   1          aa_value[index] = a_value[index];
1004   1          a_value[index] = speed_encoder;
1005   1      
1006   1      
1007   1          // wait at least 3 * max_num_of_error (10) + 5 = 35 cycles to reconstruct the right turn
1008   1          if (pos_reconstruct == FALSE){
1009   2              if (one_time_execute < 34) 
1010   2                  one_time_execute++;
1011   2              else {
1012   3                  //Double encoder translation
1013   3                  if (c_mem.double_encoder_on_off)
1014   3                      g_meas.rot[0] = calc_turns_fcn(g_meas.pos[0], g_meas.pos[1]);
1015   3      
1016   3                  g_meas.pos[0] += (int32) g_meas.rot[0] << 16;
1017   3      
1018   3                  // If necessary activate motors
1019   3                  g_refNew.pos[0] = g_meas.pos[0];
1020   3      
1021   3                  MOTOR_ON_OFF_Write(g_ref.onoff);
1022   3                  
1023   3                  pos_reconstruct = TRUE;
1024   3              }
1025   2          }
1026   1      }
1027          
1028          //==============================================================================
1029          //                                                           ANALOG MEASUREMENTS
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 18  

1030          //==============================================================================
1031          
1032          void analog_read_end() {
1033   1      
1034   1          /* =========================================================================
1035   1          /   Ideal formulation to calculate tension and current
1036   1          /
1037   1          /   tension = ((read_value_mV - offset) * 101) / gain -> [mV]
1038   1          /   current = ((read_value_mV - offset) * 375) / (gain * resistor) -> [mA]
1039   1          /
1040   1          /   Definition:
1041   1          /   read_value_mV = counts_read / 0.819 -> conversion from counts to mV
1042   1          /   offset = 2000 -> hardware amplifier bias in mV
1043   1          /   gain = 8.086 -> amplifier gain
1044   1          /   resistor = 18 -> resistor of voltage divider in KOhm 
1045   1          /
1046   1          /   Real formulation: tradeoff in good performance and accurancy, ADC_buf[] 
1047   1          /   and offset unit of measurment is counts, instead dev_tension and
1048   1          /   g_meas.curr[] are converted in properly unit.
1049   1          /  =========================================================================
1050   1          */
1051   1      
1052   1          int32 CYDATA i_aux;
1053   1      
1054   1          static emg_status CYDATA emg_1_status = RESET; 
1055   1          static emg_status CYDATA emg_2_status = RESET;                                             
1056   1          
1057   1          static uint16 emg_counter_1 = 0;
1058   1          static uint16 emg_counter_2 = 0;
1059   1          
1060   1          static uint8 first_tension_valid = TRUE;
1061   1          static uint32 count = 0;
1062   1      
1063   1          // Wait for conversion end
1064   1          
1065   1          while(!ADC_STATUS_Read()){
1066   2              if (interrupt_flag){
1067   3                  interrupt_flag = FALSE;
1068   3                  interrupt_manager();
1069   3              }
1070   2          }
1071   1          
1072   1          // Convert tension read
1073   1          dev_tension = ((int32)(ADC_buf[0] - 1638) * 1952) >> 7;
1074   1          
1075   1          if (interrupt_flag){
1076   2              interrupt_flag = FALSE;
1077   2              interrupt_manager();
1078   2          }
1079   1          
1080   1          if (first_tension_valid && tension_valid) {
1081   2              if (dev_tension < 9000) {   // 8 V case
1082   3                  pow_tension = 8000;
1083   3              }
1084   2              else {      // 12 V - 24 V cases
1085   3                  if (dev_tension < 13000) {
1086   4                      pow_tension = 12000;
1087   4                  }
1088   3                  else
1089   3                      pow_tension = 24000;
1090   3              }
1091   2      
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 19  

1092   2              first_tension_valid = FALSE;
1093   2          }
1094   1      
1095   1          // Until there is no valid input tension repeat this measurement
1096   1          
1097   1          if (dev_tension > 7000) {       //at least > 7.36 V (92% of 8 V) that is minimum charge of smallest ba
             -ttery
1098   2              // Set tension valid bit to TRUE
1099   2      
1100   2              if (count == 1000){
1101   3                  tension_valid = TRUE;   
1102   3              }
1103   2              else {                      // wait for battery voltage stabilization
1104   3                  count = count + 1;
1105   3                  dev_tension_f = filter_voltage(dev_tension);
1106   3              }
1107   2      
1108   2              if(g_mem.activate_pwm_rescaling)        //pwm rescaling is activated
1109   2                  pwm_limit_search();                 //only for 12V motors
1110   2      
1111   2              // Filter and Set currents
1112   2              g_meas.curr[0] = filter_i1((int16) (((int32)(ADC_buf[1] - 1638) * 25771) >> 13) * pwm_sign);
1113   2              
1114   2              // Check Interrupt 
1115   2          
1116   2              if (interrupt_flag){
1117   3                  interrupt_flag = FALSE;
1118   3                  interrupt_manager();
1119   3              }
1120   2      
1121   2              // if calibration is not needed go to "normal execution"
1122   2              if (!g_mem.emg_calibration_flag){
1123   3                  emg_1_status = NORMAL; // normal execution
1124   3                  emg_2_status = NORMAL; // normal execution
1125   3              }
1126   2      
1127   2              // EMG 1 calibration state machine
1128   2              
1129   2              // Calibration state machine
1130   2              switch(emg_1_status) {
1131   3                  case NORMAL: // normal execution
1132   3                      i_aux = (int32)ADC_buf[2];
1133   3                      i_aux = filter_ch1(i_aux);
1134   3                      i_aux = (i_aux << 10) / g_mem.emg_max_value[0];
1135   3          
1136   3                      if (interrupt_flag){
1137   4                          interrupt_flag = FALSE;
1138   4                          interrupt_manager();
1139   4                      }
1140   3                      //Saturation
1141   3                      if (i_aux < 0)
1142   3                          i_aux = 0;
1143   3                      else
1144   3                          if (i_aux > 1024) 
1145   3                              i_aux = 1024;
1146   3                      
1147   3                      g_meas.emg[0] = i_aux;
1148   3          
1149   3                      if (interrupt_flag){
1150   4                          interrupt_flag = FALSE;
1151   4                          interrupt_manager();
1152   4                      }
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 20  

1153   3                      
1154   3                      break;
1155   3      
1156   3                  case RESET: // reset variables
1157   3                      emg_counter_1 = 0;
1158   3                      g_mem.emg_max_value[0] = 0;
1159   3                      emg_1_status = DISCARD; // goto next status
1160   3                      
1161   3                      break;
1162   3      
1163   3                  case DISCARD: // discard first EMG_SAMPLE_TO_DISCARD samples
1164   3                      emg_counter_1++;
1165   3                      if (emg_counter_1 == EMG_SAMPLE_TO_DISCARD) {
1166   4                          emg_counter_1 = 0;          // reset counter
1167   4                          
1168   4                          // turn on LED
1169   4                          LED_CTRL_Write(1);
1170   4                          //PWM Blink Enable
1171   4                          LED_BLINK_EN_Write(0);
1172   4                              
1173   4                          if (interrupt_flag){
1174   5                              interrupt_flag = FALSE;
1175   5                              interrupt_manager();
1176   5                          }
1177   4                          
1178   4                          emg_1_status = SUM_AND_MEAN;           // sum and mean status
1179   4                      }
1180   3                      break;
1181   3      
1182   3                  case SUM_AND_MEAN: // sum first SAMPLES_FOR_EMG_MEAN samples
1183   3                      // NOTE max(value)*SAMPLES_FOR_EMG_MEAN must fit in 32bit
1184   3                      emg_counter_1++;
1185   3                      g_mem.emg_max_value[0] += filter_ch1((int32)ADC_buf[2]);
1186   3                      
1187   3                      if (interrupt_flag){
1188   4                          interrupt_flag = FALSE;
1189   4                          interrupt_manager();
1190   4                      }
1191   3                      
1192   3                      if (emg_counter_1 == SAMPLES_FOR_EMG_MEAN) {
1193   4                          g_mem.emg_max_value[0] = g_mem.emg_max_value[0] / SAMPLES_FOR_EMG_MEAN; // calc mean
1194   4          
1195   4                          if (interrupt_flag){
1196   5                              interrupt_flag = FALSE;
1197   5                              interrupt_manager();
1198   5                          }                    
1199   4                          
1200   4                          // turn off LED
1201   4                          LED_CTRL_Write(0);
1202   4                          //PWM Blink Enable
1203   4                          LED_BLINK_EN_Write(0);
1204   4                          
1205   4                          emg_counter_1 = 0;          // reset counter
1206   4      
1207   4                          emg_1_status = NORMAL;           // goto normal execution
1208   4                      }
1209   3                      break;
1210   3      
1211   3                  default:
1212   3                      break;
1213   3              }
1214   2          
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 21  

1215   2              if (interrupt_flag){
1216   3                  interrupt_flag = FALSE;
1217   3                  interrupt_manager();
1218   3              }
1219   2              // EMG 2 calibration state machine
1220   2              switch(emg_2_status) {
1221   3                  case NORMAL: // normal execution
1222   3                      i_aux = (int32)ADC_buf[3];
1223   3                      i_aux = filter_ch2(i_aux);
1224   3                      i_aux = (i_aux << 10) / g_mem.emg_max_value[1];
1225   3          
1226   3                      if (interrupt_flag){
1227   4                          interrupt_flag = FALSE;
1228   4                          interrupt_manager();
1229   4                      }
1230   3                      
1231   3                      if (i_aux < 0) 
1232   3                          i_aux = 0;
1233   3                      else
1234   3                          if (i_aux > 1024)
1235   3                              i_aux = 1024;
1236   3                      
1237   3                      g_meas.emg[1] = i_aux;
1238   3      
1239   3                      break;
1240   3      
1241   3                  case RESET: // reset variables
1242   3                      emg_counter_2 = 0;
1243   3                      g_mem.emg_max_value[1] = 0;
1244   3          
1245   3                      if (interrupt_flag){
1246   4                          interrupt_flag = FALSE;
1247   4                          interrupt_manager();
1248   4                      }
1249   3                      
1250   3                      emg_2_status = WAIT; // wait for EMG 1 calibration
1251   3                      break;
1252   3      
1253   3                  case DISCARD: // discard first EMG_SAMPLE_TO_DISCARD samples
1254   3                      emg_counter_2++;
1255   3                      if (emg_counter_2 == EMG_SAMPLE_TO_DISCARD) {
1256   4                          emg_counter_2 = 0;          // reset counter
1257   4                          
1258   4                          // turn on LED
1259   4                          LED_CTRL_Write(1);
1260   4                          //PWM Blink Enable
1261   4                          LED_BLINK_EN_Write(0);
1262   4          
1263   4                          if (interrupt_flag){
1264   5                              interrupt_flag = FALSE;
1265   5                              interrupt_manager();
1266   5                          }
1267   4                          
1268   4                          emg_2_status = SUM_AND_MEAN;           // sum and mean status
1269   4                      }
1270   3                      break;
1271   3      
1272   3                  case SUM_AND_MEAN: // sum first SAMPLES_FOR_EMG_MEAN samples
1273   3                      // NOTE max(value)*SAMPLES_FOR_EMG_MEAN must fit in 32bit
1274   3                      emg_counter_2++;
1275   3                      g_mem.emg_max_value[1] += filter_ch2((int32)ADC_buf[3]);
1276   3          
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 22  

1277   3                      if (interrupt_flag){
1278   4                          interrupt_flag = FALSE;
1279   4                          interrupt_manager();
1280   4                      }
1281   3                      
1282   3                      if (emg_counter_2 == SAMPLES_FOR_EMG_MEAN) {
1283   4                          g_mem.emg_max_value[1] = g_mem.emg_max_value[1] / SAMPLES_FOR_EMG_MEAN; // calc mean
1284   4                          
1285   4                          // turn off LED
1286   4                          LED_CTRL_Write(0);
1287   4                          //PWM Blink Enable
1288   4                          LED_BLINK_EN_Write(0);
1289   4                          
1290   4                          emg_counter_2 = 0;          // reset counter
1291   4                      
1292   4                          if (interrupt_flag){
1293   5                              interrupt_flag = FALSE;
1294   5                              interrupt_manager();
1295   5                          }
1296   4                          
1297   4                          emg_2_status = WAIT_EoC;           // goto end of calibration wait
1298   4                      }
1299   3                      break;
1300   3      
1301   3                  case WAIT: // wait for EMG calibration to be done
1302   3                      if (emg_1_status == NORMAL)
1303   3                          emg_2_status = DISCARD;           // goto discard sample
1304   3                      break;
1305   3                  
1306   3                  case WAIT_EoC:  // wait for end of calibration procedure (only for LED visibility reasons)
1307   3                      emg_counter_2++;
1308   3                      if (emg_counter_2 == EMG_SAMPLE_TO_DISCARD) {
1309   4                          emg_counter_2 = 0;          // reset counter
1310   4      
1311   4                          if (interrupt_flag){
1312   5                              interrupt_flag = FALSE;
1313   5                              interrupt_manager();
1314   5                          }
1315   4                          
1316   4                          // if EMG control mode active, activate motors accordingly with startup value
1317   4                          if ((c_mem.input_mode == INPUT_MODE_EMG_PROPORTIONAL) ||
1318   4                              (c_mem.input_mode == INPUT_MODE_EMG_INTEGRAL) ||
1319   4                              (c_mem.input_mode == INPUT_MODE_EMG_FCFS) ||
1320   4                              (c_mem.input_mode == INPUT_MODE_EMG_FCFS_ADV)) {
1321   5                              if (c_mem.control_mode == CONTROL_ANGLE) {
1322   6                                  g_ref.pos[0] = g_meas.pos[0];
1323   6                                  g_ref.pos[1] = g_meas.pos[1];
1324   6                              }
1325   5                              g_ref.onoff = c_mem.activ;
1326   5                              MOTOR_ON_OFF_Write(g_ref.onoff);
1327   5                          }
1328   4                              
1329   4                          emg_2_status = NORMAL;           // goto normal execution
1330   4                      }
1331   3                      break;
1332   3      
1333   3                  default:
1334   3                      break;
1335   3              }
1336   2                  
1337   2              if (interrupt_flag){
1338   3                  interrupt_flag = FALSE;
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 23  

1339   3                  interrupt_manager();
1340   3              }
1341   2          }
1342   1          else {
1343   2      
1344   2              emg_1_status = RESET; 
1345   2              emg_2_status = RESET;
1346   2      
1347   2              tension_valid = FALSE;
1348   2              
1349   2              //fixed
1350   2              LED_CTRL_Write(1);
1351   2              //PWM Blink Enable
1352   2              LED_BLINK_EN_Write(0);
1353   2                  
1354   2              if (interrupt_flag){
1355   3                  interrupt_flag = FALSE;
1356   3                  interrupt_manager();
1357   3              }
1358   2              
1359   2              if (c_mem.emg_calibration_flag) {
1360   3                  if ((c_mem.input_mode == INPUT_MODE_EMG_PROPORTIONAL) ||
1361   3                      (c_mem.input_mode == INPUT_MODE_EMG_INTEGRAL) ||
1362   3                      (c_mem.input_mode == INPUT_MODE_EMG_FCFS) ||
1363   3                      (c_mem.input_mode == INPUT_MODE_EMG_FCFS_ADV)) {
1364   4                      g_ref.onoff = 0x00;
1365   4                      MOTOR_ON_OFF_Write(g_ref.onoff);
1366   4                  }
1367   3              }
1368   2      
1369   2              // Reset current
1370   2              g_meas.curr[0] = 0;
1371   2      
1372   2              // Reset emg
1373   2              g_meas.emg[0] = 0;
1374   2              g_meas.emg[1] = 0;
1375   2      
1376   2          }
1377   1          
1378   1          // The board LED blinks if attached battery is not fully charged
1379   1          if (emg_1_status == NORMAL && emg_2_status == NORMAL && !first_tension_valid && tension_valid == TRUE)
             -{
1380   2              dev_tension_f = filter_voltage(dev_tension);
1381   2              if (dev_tension_f > 0.92 * pow_tension){
1382   3                  //fixed
1383   3                  LED_CTRL_Write(1);
1384   3                  
1385   3                  //PWM Blink Enable
1386   3                  LED_BLINK_EN_Write(0);
1387   3              }
1388   2              else {
1389   3                  // blink
1390   3                  LED_CTRL_Write(0);
1391   3                  
1392   3                  //PWM Blink Enable
1393   3                  LED_BLINK_EN_Write(1);
1394   3                  
1395   3                  // Disable slave or motors because of not fully charged battery
1396   3                  if (master_mode) {
1397   4                      deactivate_slave();
1398   4                      
1399   4                      // Check Interrupt 
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 24  

1400   4                      if (interrupt_flag){
1401   5                          interrupt_flag = FALSE;
1402   5                          interrupt_manager();
1403   5                      }
1404   4                      
1405   4                      master_mode = 0;        // exit from master mode
1406   4                  }
1407   3                  else {
1408   4                      g_refNew.onoff = 0x00;
1409   4                      MOTOR_ON_OFF_Write(g_refNew.onoff); // Deactivate motors
1410   4                  }
1411   3              }
1412   2          }
1413   1              
1414   1          if (interrupt_flag){
1415   2              interrupt_flag = FALSE;
1416   2              interrupt_manager();
1417   2          }
1418   1      }
1419          
1420          //==============================================================================
1421          //                                                           OVERCURRENT CONTROL
1422          //==============================================================================
1423          
1424          void overcurrent_control() {
1425   1          if (c_mem.current_limit != 0) {
1426   2              // if the current is over the limit
1427   2              if (g_meas.curr[0] > c_mem.current_limit) {
1428   3                  //decrese pwm_limit
1429   3                  dev_pwm_limit--;
1430   3              // if the current is in the safe zone
1431   3              } else if (g_meas.curr[0] < (c_mem.current_limit - CURRENT_HYSTERESIS)) {
1432   3                  //increase pwm_limit
1433   3                  dev_pwm_limit++;
1434   3              }
1435   2      
1436   2              // Bound pwm_limit
1437   2              if (dev_pwm_limit < 0) 
1438   2                  dev_pwm_limit = 0;
1439   2              else 
1440   2                  if (dev_pwm_limit > 100) 
1441   2                      dev_pwm_limit = 100;
1442   2          }
1443   1      }
1444          
1445          //==============================================================================
1446          //                                                              PWM_LIMIT_SEARCH
1447          //==============================================================================
1448          
1449          void pwm_limit_search() {
1450   1      
1451   1          uint8 CYDATA index;
1452   1      
1453   1          if (dev_tension > 25500) {
1454   2              dev_pwm_limit = 0;
1455   2          } else if (dev_tension < 11500) {
1456   2              dev_pwm_limit = 100;
1457   2          } else {
1458   2              index = (uint8)((dev_tension - 11500) >> 9);
1459   2              dev_pwm_limit = pwm_preload_values[index];
1460   2          }
1461   1      }
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 25  

1462          
1463          
1464          //==============================================================================
1465          //                                                                 COMMAND SLAVE
1466          //==============================================================================
1467           
1468          void command_slave() {
1469   1          uint8 packet_data[10];
1470   1          uint8 packet_lenght;
1471   1          
1472   1          // If not a emg input mode is set, exit from master_mode
1473   1          if(c_mem.input_mode != INPUT_MODE_EMG_PROPORTIONAL  &&
1474   1              c_mem.input_mode != INPUT_MODE_EMG_INTEGRAL      &&
1475   1              c_mem.input_mode != INPUT_MODE_EMG_FCFS          &&
1476   1              c_mem.input_mode != INPUT_MODE_EMG_FCFS_ADV     ){
1477   2              master_mode = 0;
1478   2              return;
1479   2          }
1480   1          
1481   1          //Sends a Set inputs command to a second board
1482   1          packet_data[0] = CMD_SET_INPUTS;
1483   1      
1484   1          *((int16 *) &packet_data[1]) = (int16) (g_ref.pos[0] >> g_mem.res[0]);
1485   1          *((int16 *) &packet_data[3]) = 0;
1486   1          packet_lenght = 6;
1487   1          packet_data[packet_lenght - 1] = LCRChecksum(packet_data,packet_lenght - 1);
1488   1          
1489   1          commWriteAnother(packet_data, packet_lenght);
1490   1          
1491   1      }
1492          
1493          //==============================================================================
1494          //                                                              DEACTIVATE SLAVE
1495          //==============================================================================
1496           
1497          void deactivate_slave() {
1498   1          uint8 packet_data[10];
1499   1          uint8 packet_lenght;
1500   1          
1501   1          // If not a emg input mode is set, exit from master_mode
1502   1          if((c_mem.input_mode != INPUT_MODE_EMG_PROPORTIONAL  &&
1503   1              c_mem.input_mode != INPUT_MODE_EMG_INTEGRAL      &&
1504   1              c_mem.input_mode != INPUT_MODE_EMG_FCFS          &&
1505   1              c_mem.input_mode != INPUT_MODE_EMG_FCFS_ADV     )||
1506   1              tension_valid == FALSE                   ) {
1507   2              master_mode = 0;
1508   2              return;
1509   2          }
1510   1          
1511   1          //Sends a Set inputs command to a second board
1512   1          packet_data[0] = CMD_ACTIVATE;
1513   1      
1514   1          *((int16 *) &packet_data[1]) = 0;   //3 to activate, 0 to deactivate
1515   1          packet_lenght = 3;
1516   1          packet_data[packet_lenght - 1] = LCRChecksum(packet_data,packet_lenght - 1);
1517   1          
1518   1          commWriteAnother(packet_data, packet_lenght);
1519   1          
1520   1      }
1521          /* [] END OF FILE */
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 26  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION ISR_WATCHDOG_Handler (BEGIN)
                                           ; SOURCE LINE # 102
                                           ; SOURCE LINE # 106
0000 D200        E     SETB    watchdog_flag
                                           ; SOURCE LINE # 108
0002 32                RETI    
             ; FUNCTION ISR_WATCHDOG_Handler (END)

             ; FUNCTION ISR_RS485_RX_ExInterrupt (BEGIN)
                                           ; SOURCE LINE # 114
                                           ; SOURCE LINE # 118
0000 D200        E     SETB    interrupt_flag
                                           ; SOURCE LINE # 120
0002 32                RETI    
             ; FUNCTION ISR_RS485_RX_ExInterrupt (END)

             ; FUNCTION interrupt_manager (BEGIN)
                                           ; SOURCE LINE # 137
                                           ; SOURCE LINE # 153
0000 E4                CLR     A
0001 F500        R     MOV     package_count,A
0003         ?C0003:
                                           ; SOURCE LINE # 159
0003 120000      E     LCALL   UART_RS485_GetRxBufferSize
0006 EF                MOV     A,R7
0007 7003              JNZ     $ + 5H
0009 020000      R     LJMP    ?C0028
000C E500        R     MOV     A,package_count
000E C3                CLR     C
000F 9406              SUBB    A,#06H
0011 4003              JC      $ + 5H
0013 020000      R     LJMP    ?C0028
                                           ; SOURCE LINE # 163
0016 120000      E     LCALL   UART_RS485_GetChar
0019 8F00        R     MOV     rx_data,R7
                                           ; SOURCE LINE # 165
001B E500        R     MOV     A,state
001D 14                DEC     A
001E 6049              JZ      ?C0010
0020 14                DEC     A
0021 606A              JZ      ?C0015
0023 14                DEC     A
0024 7003              JNZ     $ + 5H
0026 020000      R     LJMP    ?C0022
0029 14                DEC     A
002A 7003              JNZ     $ + 5H
002C 020000      R     LJMP    ?C0026
002F 2404              ADD     A,#04H
0031 70D0              JNZ     ?C0003
                                           ; SOURCE LINE # 167
0033         ?C0006:
                                           ; SOURCE LINE # 169
0033 850000      R     MOV     rx_queue,rx_queue+01H
                                           ; SOURCE LINE # 170
0036 850000      R     MOV     rx_queue+01H,rx_queue+02H
                                           ; SOURCE LINE # 171
0039 850000      R     MOV     rx_queue+02H,rx_data
                                           ; SOURCE LINE # 174
003C E500        R     MOV     A,rx_queue+01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 27  

003E B43A11            CJNE    A,#03AH,?C0007
0041 E500        R     MOV     A,rx_queue+02H
0043 B43A0C            CJNE    A,#03AH,?C0007
                                           ; SOURCE LINE # 175
0046 E4                CLR     A
0047 F500        R     MOV     rx_queue,A
                                           ; SOURCE LINE # 176
0049 F500        R     MOV     rx_queue+01H,A
                                           ; SOURCE LINE # 177
004B F500        R     MOV     rx_queue+02H,A
                                           ; SOURCE LINE # 178
004D 750001      R     MOV     state,#01H
                                           ; SOURCE LINE # 179
0050 80B1              SJMP    ?C0003
0052         ?C0007:
                                           ; SOURCE LINE # 180
0052 E500        R     MOV     A,rx_queue
0054 B43FAC            CJNE    A,#03FH,?C0003
0057 E500        R     MOV     A,rx_queue+01H
0059 B40DA7            CJNE    A,#0DH,?C0003
005C E500        R     MOV     A,rx_queue+02H
005E 640A              XRL     A,#0AH
0060 70A1              JNZ     ?C0003
                                           ; SOURCE LINE # 183
0062 FF                MOV     R7,A
0063 FE                MOV     R6,A
0064 120000      E     LCALL   _infoGet
                                           ; SOURCE LINE # 184
0067 809A              SJMP    ?C0003
                                           ; SOURCE LINE # 187
0069         ?C0010:
                                           ; SOURCE LINE # 190
0069 900000      E     MOV     DPTR,#c_mem+01H
006C E0                MOVX    A,@DPTR
006D 6500        R     XRL     A,rx_data
006F 6004              JZ      ?C0012
0071 E500        R     MOV     A,rx_data
0073 7004              JNZ     ?C0011
0075         ?C0012:
                                           ; SOURCE LINE # 191
0075 C200        R     CLR     rx_data_type
0077 8002              SJMP    ?C0013
0079         ?C0011:
                                           ; SOURCE LINE # 193
0079 D200        R     SETB    rx_data_type
007B         ?C0013:
                                           ; SOURCE LINE # 196
007B 900000      E     MOV     DPTR,#receive_meas_from_hand
007E E0                MOVX    A,@DPTR
007F B40102            CJNE    A,#01H,?C0014
                                           ; SOURCE LINE # 197
0082 C200        R     CLR     rx_data_type
                                           ; SOURCE LINE # 198
0084         ?C0014:
                                           ; SOURCE LINE # 200
0084 E4                CLR     A
0085 F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 201
0087 750002      R     MOV     state,#02H
                                           ; SOURCE LINE # 202
008A 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 205
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 28  

008D         ?C0015:
                                           ; SOURCE LINE # 208
008D 850000      R     MOV     data_packet_length,rx_data
                                           ; SOURCE LINE # 210
0090 E500        R     MOV     A,data_packet_length
0092 D3                SETB    C
0093 9401              SUBB    A,#01H
0095 5008              JNC     ?C0016
                                           ; SOURCE LINE # 211
0097 E4                CLR     A
0098 F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 212
009A F500        R     MOV     state,A
                                           ; SOURCE LINE # 213
009C 020000      R     LJMP    ?C0003
009F         ?C0016:
009F E500        R     MOV     A,data_packet_length
00A1 D3                SETB    C
00A2 9480              SUBB    A,#080H
00A4 4008              JC      ?C0018
                                           ; SOURCE LINE # 214
00A6 E4                CLR     A
00A7 F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 215
00A9 F500        R     MOV     state,A
                                           ; SOURCE LINE # 216
00AB 020000      R     LJMP    ?C0003
00AE         ?C0018:
                                           ; SOURCE LINE # 217
00AE E4                CLR     A
00AF F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 219
00B1 200006            JB      rx_data_type,?C0020
                                           ; SOURCE LINE # 220
00B4 750003      R     MOV     state,#03H
00B7 020000      R     LJMP    ?C0003
00BA         ?C0020:
                                           ; SOURCE LINE # 222
00BA 750004      R     MOV     state,#04H
                                           ; SOURCE LINE # 223
                                           ; SOURCE LINE # 224
00BD 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 227
00C0         ?C0022:
                                           ; SOURCE LINE # 229
00C0 7400        R     MOV     A,#LOW data_packet_buffer
00C2 2500        R     ADD     A,data_packet_index
00C4 F582              MOV     DPL,A
00C6 E4                CLR     A
00C7 3400        R     ADDC    A,#HIGH data_packet_buffer
00C9 F583              MOV     DPH,A
00CB E500        R     MOV     A,rx_data
00CD F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 230
00CE 0500        R     INC     data_packet_index
                                           ; SOURCE LINE # 233
00D0 E500        R     MOV     A,data_packet_index
00D2 C3                CLR     C
00D3 9500        R     SUBB    A,data_packet_length
00D5 5003              JNC     $ + 5H
00D7 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 235
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 29  

00DA 200032            JB      rx_data_type,?C0024
                                           ; SOURCE LINE # 237
00DD AF00        R     MOV     R7,data_packet_length
00DF 7E00              MOV     R6,#00H
00E1 7800        E     MOV     R0,#LOW g_rx
00E3 7C00        E     MOV     R4,#HIGH g_rx
00E5 7D01              MOV     R5,#01H
00E7 7B01              MOV     R3,#01H
00E9 7A00        R     MOV     R2,#HIGH data_packet_buffer
00EB 7900        R     MOV     R1,#LOW data_packet_buffer
00ED 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 238
00F0 900000      E     MOV     DPTR,#g_rx+080H
00F3 E4                CLR     A
00F4 F0                MOVX    @DPTR,A
00F5 A3                INC     DPTR
00F6 E500        R     MOV     A,data_packet_length
00F8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 239
00F9 900000      E     MOV     DPTR,#g_rx+084H
00FC 7401              MOV     A,#01H
00FE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 242
00FF 900000      E     MOV     DPTR,#receive_meas_from_hand
0102 E0                MOVX    A,@DPTR
0103 B40106            CJNE    A,#01H,?C0025
                                           ; SOURCE LINE # 243
0106 900000      E     MOV     DPTR,#g_rx
0109 7493              MOV     A,#093H
010B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 244
010C         ?C0025:
                                           ; SOURCE LINE # 246
010C 120000      E     LCALL   commProcess
                                           ; SOURCE LINE # 247
010F         ?C0024:
                                           ; SOURCE LINE # 249
010F E4                CLR     A
0110 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 250
0112 F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 251
0114 F500        R     MOV     state,A
                                           ; SOURCE LINE # 252
0116 0500        R     INC     package_count
                                           ; SOURCE LINE # 254
                                           ; SOURCE LINE # 255
0118 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 258
011B         ?C0026:
                                           ; SOURCE LINE # 259
011B 1500        R     DEC     data_packet_length
011D E500        R     MOV     A,data_packet_length
011F 6003              JZ      $ + 5H
0121 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 260
0124 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 261
0126 F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 262
0128 7F01              MOV     R7,#01H
012A 120000      E     LCALL   _RS485_CTS_Write
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 30  

                                           ; SOURCE LINE # 263
012D E4                CLR     A
012E FF                MOV     R7,A
012F 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 264
0132 E4                CLR     A
0133 F500        R     MOV     state,A
                                           ; SOURCE LINE # 265
0135 0500        R     INC     package_count
                                           ; SOURCE LINE # 266
                                           ; SOURCE LINE # 267
0137 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 268
                                           ; SOURCE LINE # 269
013A 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 270
013D         ?C0028:
013D 22                RET     
             ; FUNCTION interrupt_manager (END)

             ; FUNCTION function_scheduler (BEGIN)
                                           ; SOURCE LINE # 279
                                           ; SOURCE LINE # 283
0000 120000      E     LCALL   MY_TIMER_ReadCounter
0003 900000      E     MOV     DPTR,#timer_value0
0006 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 287
0009 7F01              MOV     R7,#01H
000B 120000      E     LCALL   _ADC_SOC_Write
                                           ; SOURCE LINE # 291
000E 300005            JNB     interrupt_flag,?C0029
                                           ; SOURCE LINE # 292
0011 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 293
0013 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 294
0016         ?C0029:
                                           ; SOURCE LINE # 298
0016 E4                CLR     A
0017 FF                MOV     R7,A
0018 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 302
001B 300005            JNB     interrupt_flag,?C0030
                                           ; SOURCE LINE # 303
001E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 304
0020 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 305
0023         ?C0030:
                                           ; SOURCE LINE # 307
0023 7F01              MOV     R7,#01H
0025 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 311
0028 300005            JNB     interrupt_flag,?C0031
                                           ; SOURCE LINE # 312
002B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 313
002D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 314
0030         ?C0031:
                                           ; SOURCE LINE # 316
0030 7F02              MOV     R7,#02H
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 31  

0032 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 320
0035 300005            JNB     interrupt_flag,?C0032
                                           ; SOURCE LINE # 321
0038 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 322
003A 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 323
003D         ?C0032:
                                           ; SOURCE LINE # 327
003D 120000      R     LCALL   motor_control
                                           ; SOURCE LINE # 331
0040 300005            JNB     interrupt_flag,?C0033
                                           ; SOURCE LINE # 332
0043 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 333
0045 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 334
0048         ?C0033:
                                           ; SOURCE LINE # 338
0048 120000      R     LCALL   analog_read_end
                                           ; SOURCE LINE # 340
004B 300005            JNB     interrupt_flag,?C0034
                                           ; SOURCE LINE # 341
004E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 342
0050 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 343
0053         ?C0034:
                                           ; SOURCE LINE # 347
0053 120000      R     LCALL   overcurrent_control
                                           ; SOURCE LINE # 351
0056 300005            JNB     interrupt_flag,?C0035
                                           ; SOURCE LINE # 352
0059 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 353
005B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 354
005E         ?C0035:
                                           ; SOURCE LINE # 358
005E 900000      E     MOV     DPTR,#master_mode
0061 E0                MOVX    A,@DPTR
0062 603F              JZ      ?C0036
                                           ; SOURCE LINE # 360
0064 900000      E     MOV     DPTR,#c_mem+034H
0067 E0                MOVX    A,@DPTR
0068 B40435            CJNE    A,#04H,?C0037
                                           ; SOURCE LINE # 361
006B 900000      R     MOV     DPTR,#counter_calibration
006E E0                MOVX    A,@DPTR
006F 7004              JNZ     ?C0264
0071 A3                INC     DPTR
0072 E0                MOVX    A,@DPTR
0073 640A              XRL     A,#0AH
0075         ?C0264:
0075 7013              JNZ     ?C0038
                                           ; SOURCE LINE # 364
0077 120000      E     LCALL   commReadMeasFromAnother
007A 900000      E     MOV     DPTR,#curr_pos_res
007D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 366
0080 120000      E     LCALL   check_rest_position
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 32  

                                           ; SOURCE LINE # 367
0083 E4                CLR     A
0084 900000      R     MOV     DPTR,#counter_calibration
0087 F0                MOVX    @DPTR,A
0088 A3                INC     DPTR
0089 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 368
008A         ?C0038:
                                           ; SOURCE LINE # 369
008A 900000      R     MOV     DPTR,#counter_calibration+01H
008D E0                MOVX    A,@DPTR
008E 04                INC     A
008F F0                MOVX    @DPTR,A
0090 7006              JNZ     ?C0265
0092 900000      R     MOV     DPTR,#counter_calibration
0095 E0                MOVX    A,@DPTR
0096 04                INC     A
0097 F0                MOVX    @DPTR,A
0098         ?C0265:
                                           ; SOURCE LINE # 372
0098 300005            JNB     interrupt_flag,?C0037
                                           ; SOURCE LINE # 373
009B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 374
009D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 375
                                           ; SOURCE LINE # 376
00A0         ?C0037:
                                           ; SOURCE LINE # 378
00A0 120000      R     LCALL   command_slave
                                           ; SOURCE LINE # 379
00A3         ?C0036:
                                           ; SOURCE LINE # 383
00A3 300005            JNB     interrupt_flag,?C0040
                                           ; SOURCE LINE # 384
00A6 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 385
00A8 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 386
00AB         ?C0040:
                                           ; SOURCE LINE # 391
00AB 900000      E     MOV     DPTR,#calib
00AE E0                MOVX    A,@DPTR
00AF B40124            CJNE    A,#01H,?C0041
                                           ; SOURCE LINE # 392
00B2 900000      R     MOV     DPTR,#counter_calibration
00B5 E0                MOVX    A,@DPTR
00B6 7004              JNZ     ?C0266
00B8 A3                INC     DPTR
00B9 E0                MOVX    A,@DPTR
00BA 640A              XRL     A,#0AH
00BC         ?C0266:
00BC 700A              JNZ     ?C0042
                                           ; SOURCE LINE # 393
00BE 120000      E     LCALL   calibration
                                           ; SOURCE LINE # 394
00C1 E4                CLR     A
00C2 900000      R     MOV     DPTR,#counter_calibration
00C5 F0                MOVX    @DPTR,A
00C6 A3                INC     DPTR
00C7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 395
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 33  

00C8         ?C0042:
                                           ; SOURCE LINE # 396
00C8 900000      R     MOV     DPTR,#counter_calibration+01H
00CB E0                MOVX    A,@DPTR
00CC 04                INC     A
00CD F0                MOVX    @DPTR,A
00CE 7006              JNZ     ?C0267
00D0 900000      R     MOV     DPTR,#counter_calibration
00D3 E0                MOVX    A,@DPTR
00D4 04                INC     A
00D5 F0                MOVX    @DPTR,A
00D6         ?C0267:
                                           ; SOURCE LINE # 397
00D6         ?C0041:
                                           ; SOURCE LINE # 401
00D6 300005            JNB     interrupt_flag,?C0043
                                           ; SOURCE LINE # 402
00D9 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 403
00DB 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 404
00DE         ?C0043:
                                           ; SOURCE LINE # 410
00DE 7800        E     MOV     R0,#LOW g_measOld
00E0 7C00        E     MOV     R4,#HIGH g_measOld
00E2 7D01              MOV     R5,#01H
00E4 7B01              MOV     R3,#01H
00E6 7A00        E     MOV     R2,#HIGH g_meas
00E8 7900        E     MOV     R1,#LOW g_meas
00EA 7E00              MOV     R6,#00H
00EC 7F3B              MOV     R7,#03BH
00EE 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 411
00F1 7800        E     MOV     R0,#LOW g_refOld
00F3 7C00        E     MOV     R4,#HIGH g_refOld
00F5 7D01              MOV     R5,#01H
00F7 7B01              MOV     R3,#01H
00F9 7A00        E     MOV     R2,#HIGH g_ref
00FB 7900        E     MOV     R1,#LOW g_ref
00FD 7E00              MOV     R6,#00H
00FF 7F19              MOV     R7,#019H
0101 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 414
0104 7800        E     MOV     R0,#LOW g_ref
0106 7C00        E     MOV     R4,#HIGH g_ref
0108 7D01              MOV     R5,#01H
010A 7B01              MOV     R3,#01H
010C 7A00        E     MOV     R2,#HIGH g_refNew
010E 7900        E     MOV     R1,#LOW g_refNew
0110 7E00              MOV     R6,#00H
0112 7F19              MOV     R7,#019H
0114 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 416
0117 300005            JNB     interrupt_flag,?C0044
                                           ; SOURCE LINE # 417
011A C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 418
011C 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 419
011F         ?C0044:
                                           ; SOURCE LINE # 421
011F 120000      E     LCALL   MY_TIMER_ReadCounter
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 34  

0122 900000      E     MOV     DPTR,#timer_value
0125 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 422
0128 7F40              MOV     R7,#040H
012A 7E4B              MOV     R6,#04BH
012C 7D4C              MOV     R5,#04CH
012E 7C00              MOV     R4,#00H
0130 120000      E     LCALL   _MY_TIMER_WriteCounter
                                           ; SOURCE LINE # 424
0133 22                RET     
             ; FUNCTION function_scheduler (END)

             ; FUNCTION motor_control (BEGIN)
                                           ; SOURCE LINE # 430
                                           ; SOURCE LINE # 432
0000 E4                CLR     A
0001 F500        R     MOV     pwm_input+03H,A
0003 F500        R     MOV     pwm_input+02H,A
0005 F500        R     MOV     pwm_input+01H,A
0007 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 442
0009 900000      E     MOV     DPTR,#c_mem+02H
000C E0                MOVX    A,@DPTR
000D FC                MOV     R4,A
000E A3                INC     DPTR
000F E0                MOVX    A,@DPTR
0010 FD                MOV     R5,A
0011 A3                INC     DPTR
0012 E0                MOVX    A,@DPTR
0013 FE                MOV     R6,A
0014 A3                INC     DPTR
0015 E0                MOVX    A,@DPTR
0016 F500        R     MOV     k_p+03H,A
0018 8E00        R     MOV     k_p+02H,R6
001A 8D00        R     MOV     k_p+01H,R5
001C 8C00        R     MOV     k_p,R4
                                           ; SOURCE LINE # 443
001E A3                INC     DPTR
001F E0                MOVX    A,@DPTR
0020 FC                MOV     R4,A
0021 A3                INC     DPTR
0022 E0                MOVX    A,@DPTR
0023 FD                MOV     R5,A
0024 A3                INC     DPTR
0025 E0                MOVX    A,@DPTR
0026 FE                MOV     R6,A
0027 A3                INC     DPTR
0028 E0                MOVX    A,@DPTR
0029 F500        R     MOV     k_i+03H,A
002B 8E00        R     MOV     k_i+02H,R6
002D 8D00        R     MOV     k_i+01H,R5
002F 8C00        R     MOV     k_i,R4
                                           ; SOURCE LINE # 444
0031 A3                INC     DPTR
0032 E0                MOVX    A,@DPTR
0033 FC                MOV     R4,A
0034 A3                INC     DPTR
0035 E0                MOVX    A,@DPTR
0036 FD                MOV     R5,A
0037 A3                INC     DPTR
0038 E0                MOVX    A,@DPTR
0039 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 35  

003A A3                INC     DPTR
003B E0                MOVX    A,@DPTR
003C F500        R     MOV     k_d+03H,A
003E 8E00        R     MOV     k_d+02H,R6
0040 8D00        R     MOV     k_d+01H,R5
0042 8C00        R     MOV     k_d,R4
                                           ; SOURCE LINE # 446
0044 A3                INC     DPTR
0045 E0                MOVX    A,@DPTR
0046 FC                MOV     R4,A
0047 A3                INC     DPTR
0048 E0                MOVX    A,@DPTR
0049 FD                MOV     R5,A
004A A3                INC     DPTR
004B E0                MOVX    A,@DPTR
004C FE                MOV     R6,A
004D A3                INC     DPTR
004E E0                MOVX    A,@DPTR
004F F500        R     MOV     k_p_c+03H,A
0051 8E00        R     MOV     k_p_c+02H,R6
0053 8D00        R     MOV     k_p_c+01H,R5
0055 8C00        R     MOV     k_p_c,R4
                                           ; SOURCE LINE # 447
0057 A3                INC     DPTR
0058 E0                MOVX    A,@DPTR
0059 FC                MOV     R4,A
005A A3                INC     DPTR
005B E0                MOVX    A,@DPTR
005C FD                MOV     R5,A
005D A3                INC     DPTR
005E E0                MOVX    A,@DPTR
005F FE                MOV     R6,A
0060 A3                INC     DPTR
0061 E0                MOVX    A,@DPTR
0062 F500        R     MOV     k_i_c+03H,A
0064 8E00        R     MOV     k_i_c+02H,R6
0066 8D00        R     MOV     k_i_c+01H,R5
0068 8C00        R     MOV     k_i_c,R4
                                           ; SOURCE LINE # 448
006A A3                INC     DPTR
006B E0                MOVX    A,@DPTR
006C FC                MOV     R4,A
006D A3                INC     DPTR
006E E0                MOVX    A,@DPTR
006F FD                MOV     R5,A
0070 A3                INC     DPTR
0071 E0                MOVX    A,@DPTR
0072 FE                MOV     R6,A
0073 A3                INC     DPTR
0074 E0                MOVX    A,@DPTR
0075 F500        R     MOV     k_d_c+03H,A
0077 8E00        R     MOV     k_d_c+02H,R6
0079 8D00        R     MOV     k_d_c+01H,R5
007B 8C00        R     MOV     k_d_c,R4
                                           ; SOURCE LINE # 450
007D A3                INC     DPTR
007E E0                MOVX    A,@DPTR
007F FC                MOV     R4,A
0080 A3                INC     DPTR
0081 E0                MOVX    A,@DPTR
0082 FD                MOV     R5,A
0083 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 36  

0084 E0                MOVX    A,@DPTR
0085 FE                MOV     R6,A
0086 A3                INC     DPTR
0087 E0                MOVX    A,@DPTR
0088 F500        R     MOV     k_p_dl+03H,A
008A 8E00        R     MOV     k_p_dl+02H,R6
008C 8D00        R     MOV     k_p_dl+01H,R5
008E 8C00        R     MOV     k_p_dl,R4
                                           ; SOURCE LINE # 451
0090 A3                INC     DPTR
0091 E0                MOVX    A,@DPTR
0092 FC                MOV     R4,A
0093 A3                INC     DPTR
0094 E0                MOVX    A,@DPTR
0095 FD                MOV     R5,A
0096 A3                INC     DPTR
0097 E0                MOVX    A,@DPTR
0098 FE                MOV     R6,A
0099 A3                INC     DPTR
009A E0                MOVX    A,@DPTR
009B F500        R     MOV     k_i_dl+03H,A
009D 8E00        R     MOV     k_i_dl+02H,R6
009F 8D00        R     MOV     k_i_dl+01H,R5
00A1 8C00        R     MOV     k_i_dl,R4
                                           ; SOURCE LINE # 452
00A3 A3                INC     DPTR
00A4 E0                MOVX    A,@DPTR
00A5 FC                MOV     R4,A
00A6 A3                INC     DPTR
00A7 E0                MOVX    A,@DPTR
00A8 FD                MOV     R5,A
00A9 A3                INC     DPTR
00AA E0                MOVX    A,@DPTR
00AB FE                MOV     R6,A
00AC A3                INC     DPTR
00AD E0                MOVX    A,@DPTR
00AE F500        R     MOV     k_d_dl+03H,A
00B0 8E00        R     MOV     k_d_dl+02H,R6
00B2 8D00        R     MOV     k_d_dl+01H,R5
00B4 8C00        R     MOV     k_d_dl,R4
                                           ; SOURCE LINE # 454
00B6 A3                INC     DPTR
00B7 E0                MOVX    A,@DPTR
00B8 FC                MOV     R4,A
00B9 A3                INC     DPTR
00BA E0                MOVX    A,@DPTR
00BB FD                MOV     R5,A
00BC A3                INC     DPTR
00BD E0                MOVX    A,@DPTR
00BE FE                MOV     R6,A
00BF A3                INC     DPTR
00C0 E0                MOVX    A,@DPTR
00C1 F500        R     MOV     k_p_c_dl+03H,A
00C3 8E00        R     MOV     k_p_c_dl+02H,R6
00C5 8D00        R     MOV     k_p_c_dl+01H,R5
00C7 8C00        R     MOV     k_p_c_dl,R4
                                           ; SOURCE LINE # 455
00C9 A3                INC     DPTR
00CA E0                MOVX    A,@DPTR
00CB FC                MOV     R4,A
00CC A3                INC     DPTR
00CD E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 37  

00CE FD                MOV     R5,A
00CF A3                INC     DPTR
00D0 E0                MOVX    A,@DPTR
00D1 FE                MOV     R6,A
00D2 A3                INC     DPTR
00D3 E0                MOVX    A,@DPTR
00D4 F500        R     MOV     k_i_c_dl+03H,A
00D6 8E00        R     MOV     k_i_c_dl+02H,R6
00D8 8D00        R     MOV     k_i_c_dl+01H,R5
00DA 8C00        R     MOV     k_i_c_dl,R4
                                           ; SOURCE LINE # 456
00DC A3                INC     DPTR
00DD E0                MOVX    A,@DPTR
00DE FC                MOV     R4,A
00DF A3                INC     DPTR
00E0 E0                MOVX    A,@DPTR
00E1 FD                MOV     R5,A
00E2 A3                INC     DPTR
00E3 E0                MOVX    A,@DPTR
00E4 FE                MOV     R6,A
00E5 A3                INC     DPTR
00E6 E0                MOVX    A,@DPTR
00E7 F500        R     MOV     k_d_c_dl+03H,A
00E9 8E00        R     MOV     k_d_c_dl+02H,R6
00EB 8D00        R     MOV     k_d_c_dl+01H,R5
00ED 8C00        R     MOV     k_d_c_dl,R4
                                           ; SOURCE LINE # 473
00EF 900000      E     MOV     DPTR,#c_mem+06BH
00F2 E0                MOVX    A,@DPTR
00F3 FE                MOV     R6,A
00F4 A3                INC     DPTR
00F5 E0                MOVX    A,@DPTR
00F6 FF                MOV     R7,A
00F7 FB                MOV     R3,A
00F8 AA06              MOV     R2,AR6
00FA E4                CLR     A
00FB 900000      E     MOV     DPTR,#g_meas+017H
00FE E0                MOVX    A,@DPTR
00FF FC                MOV     R4,A
0100 A3                INC     DPTR
0101 E0                MOVX    A,@DPTR
0102 FD                MOV     R5,A
0103 A3                INC     DPTR
0104 E0                MOVX    A,@DPTR
0105 FE                MOV     R6,A
0106 A3                INC     DPTR
0107 E0                MOVX    A,@DPTR
0108 C3                CLR     C
0109 9B                SUBB    A,R3
010A F500        R     MOV     err_emg_1+03H,A
010C EE                MOV     A,R6
010D 9A                SUBB    A,R2
010E F500        R     MOV     err_emg_1+02H,A
0110 ED                MOV     A,R5
0111 9400              SUBB    A,#00H
0113 F500        R     MOV     err_emg_1+01H,A
0115 EC                MOV     A,R4
0116 9400              SUBB    A,#00H
0118 F500        R     MOV     err_emg_1,A
                                           ; SOURCE LINE # 474
011A 900000      E     MOV     DPTR,#c_mem+06DH
011D E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 38  

011E FE                MOV     R6,A
011F A3                INC     DPTR
0120 E0                MOVX    A,@DPTR
0121 FF                MOV     R7,A
0122 FB                MOV     R3,A
0123 AA06              MOV     R2,AR6
0125 E4                CLR     A
0126 900000      E     MOV     DPTR,#g_meas+01BH
0129 E0                MOVX    A,@DPTR
012A FC                MOV     R4,A
012B A3                INC     DPTR
012C E0                MOVX    A,@DPTR
012D FD                MOV     R5,A
012E A3                INC     DPTR
012F E0                MOVX    A,@DPTR
0130 FE                MOV     R6,A
0131 A3                INC     DPTR
0132 E0                MOVX    A,@DPTR
0133 C3                CLR     C
0134 9B                SUBB    A,R3
0135 F500        R     MOV     err_emg_2+03H,A
0137 EE                MOV     A,R6
0138 9A                SUBB    A,R2
0139 F500        R     MOV     err_emg_2+02H,A
013B ED                MOV     A,R5
013C 9400              SUBB    A,#00H
013E F500        R     MOV     err_emg_2+01H,A
0140 EC                MOV     A,R4
0141 9400              SUBB    A,#00H
0143 F500        R     MOV     err_emg_2,A
                                           ; SOURCE LINE # 477
0145 900000      E     MOV     DPTR,#c_mem+033H
0148 E0                MOVX    A,@DPTR
0149 24FE              ADD     A,#0FEH
014B 7003              JNZ     $ + 5H
014D 020000      R     LJMP    ?C0054
0150 14                DEC     A
0151 7003              JNZ     $ + 5H
0153 020000      R     LJMP    ?C0057
0156 14                DEC     A
0157 7003              JNZ     $ + 5H
0159 020000      R     LJMP    ?C0060
015C 14                DEC     A
015D 7003              JNZ     $ + 5H
015F 020000      R     LJMP    ?C0070
0162 2404              ADD     A,#04H
0164 6003              JZ      $ + 5H
0166 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 479
0169         ?C0047:
                                           ; SOURCE LINE # 483
0169 900000      E     MOV     DPTR,#c_mem+079H
016C E0                MOVX    A,@DPTR
016D 6024              JZ      ?C0048
                                           ; SOURCE LINE # 484
016F A3                INC     DPTR
0170 E0                MOVX    A,@DPTR
0171 FF                MOV     R7,A
0172 33                RLC     A
0173 95E0              SUBB    A,ACC
0175 FE                MOV     R6,A
0176 FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 39  

0177 FC                MOV     R4,A
0178 900000      E     MOV     DPTR,#g_meas+08H
017B E0                MOVX    A,@DPTR
017C F8                MOV     R0,A
017D A3                INC     DPTR
017E E0                MOVX    A,@DPTR
017F F9                MOV     R1,A
0180 A3                INC     DPTR
0181 E0                MOVX    A,@DPTR
0182 FA                MOV     R2,A
0183 A3                INC     DPTR
0184 E0                MOVX    A,@DPTR
0185 FB                MOV     R3,A
0186 120000      E     LCALL   ?C?LMUL
0189 8F00        R     MOV     handle_value+03H,R7
018B 8E00        R     MOV     handle_value+02H,R6
018D 8D00        R     MOV     handle_value+01H,R5
018F 8C00        R     MOV     handle_value,R4
0191 8024              SJMP    ?C0049
0193         ?C0048:
                                           ; SOURCE LINE # 486
0193 900000      E     MOV     DPTR,#c_mem+07AH
0196 E0                MOVX    A,@DPTR
0197 FF                MOV     R7,A
0198 33                RLC     A
0199 95E0              SUBB    A,ACC
019B FE                MOV     R6,A
019C FD                MOV     R5,A
019D FC                MOV     R4,A
019E 900000      E     MOV     DPTR,#g_meas+04H
01A1 E0                MOVX    A,@DPTR
01A2 F8                MOV     R0,A
01A3 A3                INC     DPTR
01A4 E0                MOVX    A,@DPTR
01A5 F9                MOV     R1,A
01A6 A3                INC     DPTR
01A7 E0                MOVX    A,@DPTR
01A8 FA                MOV     R2,A
01A9 A3                INC     DPTR
01AA E0                MOVX    A,@DPTR
01AB FB                MOV     R3,A
01AC 120000      E     LCALL   ?C?LMUL
01AF 8F00        R     MOV     handle_value+03H,R7
01B1 8E00        R     MOV     handle_value+02H,R6
01B3 8D00        R     MOV     handle_value+01H,R5
01B5 8C00        R     MOV     handle_value,R4
01B7         ?C0049:
                                           ; SOURCE LINE # 490
01B7 900000      E     MOV     DPTR,#g_ref
01BA E0                MOVX    A,@DPTR
01BB F8                MOV     R0,A
01BC A3                INC     DPTR
01BD E0                MOVX    A,@DPTR
01BE F9                MOV     R1,A
01BF A3                INC     DPTR
01C0 E0                MOVX    A,@DPTR
01C1 FA                MOV     R2,A
01C2 A3                INC     DPTR
01C3 E0                MOVX    A,@DPTR
01C4 FB                MOV     R3,A
01C5 C3                CLR     C
01C6 E500        R     MOV     A,handle_value+03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 40  

01C8 9B                SUBB    A,R3
01C9 FF                MOV     R7,A
01CA E500        R     MOV     A,handle_value+02H
01CC 9A                SUBB    A,R2
01CD FE                MOV     R6,A
01CE E500        R     MOV     A,handle_value+01H
01D0 99                SUBB    A,R1
01D1 FD                MOV     R5,A
01D2 E500        R     MOV     A,handle_value
01D4 98                SUBB    A,R0
01D5 FC                MOV     R4,A
01D6 900000      E     MOV     DPTR,#c_mem+061H
01D9 E0                MOVX    A,@DPTR
01DA F8                MOV     R0,A
01DB A3                INC     DPTR
01DC E0                MOVX    A,@DPTR
01DD F9                MOV     R1,A
01DE A3                INC     DPTR
01DF E0                MOVX    A,@DPTR
01E0 FA                MOV     R2,A
01E1 A3                INC     DPTR
01E2 E0                MOVX    A,@DPTR
01E3 FB                MOV     R3,A
01E4 C3                CLR     C
01E5 120000      E     LCALL   ?C?SLCMP
01E8 5044              JNC     ?C0050
01EA E4                CLR     A
01EB FF                MOV     R7,A
01EC FE                MOV     R6,A
01ED FD                MOV     R5,A
01EE FC                MOV     R4,A
01EF 900000      E     MOV     DPTR,#c_mem+061H
01F2 E0                MOVX    A,@DPTR
01F3 F8                MOV     R0,A
01F4 A3                INC     DPTR
01F5 E0                MOVX    A,@DPTR
01F6 A3                INC     DPTR
01F7 E0                MOVX    A,@DPTR
01F8 A3                INC     DPTR
01F9 E0                MOVX    A,@DPTR
01FA C3                CLR     C
01FB 120000      E     LCALL   ?C?SLCMP
01FE 602E              JZ      ?C0050
                                           ; SOURCE LINE # 491
0200 900000      E     MOV     DPTR,#g_ref
0203 E0                MOVX    A,@DPTR
0204 FC                MOV     R4,A
0205 A3                INC     DPTR
0206 E0                MOVX    A,@DPTR
0207 FD                MOV     R5,A
0208 A3                INC     DPTR
0209 E0                MOVX    A,@DPTR
020A FE                MOV     R6,A
020B A3                INC     DPTR
020C E0                MOVX    A,@DPTR
020D FF                MOV     R7,A
020E 900000      E     MOV     DPTR,#c_mem+061H
0211 E0                MOVX    A,@DPTR
0212 F8                MOV     R0,A
0213 A3                INC     DPTR
0214 E0                MOVX    A,@DPTR
0215 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 41  

0216 E0                MOVX    A,@DPTR
0217 A3                INC     DPTR
0218 E0                MOVX    A,@DPTR
0219 EF                MOV     A,R7
021A 2B                ADD     A,R3
021B FF                MOV     R7,A
021C EE                MOV     A,R6
021D 3A                ADDC    A,R2
021E FE                MOV     R6,A
021F ED                MOV     A,R5
0220 39                ADDC    A,R1
0221 FD                MOV     R5,A
0222 EC                MOV     A,R4
0223 38                ADDC    A,R0
0224 FC                MOV     R4,A
0225 900000      E     MOV     DPTR,#g_ref
0228 120000      E     LCALL   ?C?LSTXDATA
022B 020000      R     LJMP    ?C0046
022E         ?C0050:
                                           ; SOURCE LINE # 492
                                           ; SOURCE LINE # 493
022E 900000      E     MOV     DPTR,#g_ref
0231 E0                MOVX    A,@DPTR
0232 F8                MOV     R0,A
0233 A3                INC     DPTR
0234 E0                MOVX    A,@DPTR
0235 F9                MOV     R1,A
0236 A3                INC     DPTR
0237 E0                MOVX    A,@DPTR
0238 FA                MOV     R2,A
0239 A3                INC     DPTR
023A E0                MOVX    A,@DPTR
023B FB                MOV     R3,A
023C C3                CLR     C
023D E500        R     MOV     A,handle_value+03H
023F 9B                SUBB    A,R3
0240 FF                MOV     R7,A
0241 E500        R     MOV     A,handle_value+02H
0243 9A                SUBB    A,R2
0244 FE                MOV     R6,A
0245 E500        R     MOV     A,handle_value+01H
0247 99                SUBB    A,R1
0248 FD                MOV     R5,A
0249 E500        R     MOV     A,handle_value
024B 98                SUBB    A,R0
024C FC                MOV     R4,A
024D 900000      E     MOV     DPTR,#c_mem+065H
0250 E0                MOVX    A,@DPTR
0251 F8                MOV     R0,A
0252 A3                INC     DPTR
0253 E0                MOVX    A,@DPTR
0254 F9                MOV     R1,A
0255 A3                INC     DPTR
0256 E0                MOVX    A,@DPTR
0257 FA                MOV     R2,A
0258 A3                INC     DPTR
0259 E0                MOVX    A,@DPTR
025A FB                MOV     R3,A
025B D3                SETB    C
025C 120000      E     LCALL   ?C?SLCMP
025F 4043              JC      ?C0052
0261 E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 42  

0262 FF                MOV     R7,A
0263 FE                MOV     R6,A
0264 FD                MOV     R5,A
0265 FC                MOV     R4,A
0266 900000      E     MOV     DPTR,#c_mem+065H
0269 E0                MOVX    A,@DPTR
026A F8                MOV     R0,A
026B A3                INC     DPTR
026C E0                MOVX    A,@DPTR
026D A3                INC     DPTR
026E E0                MOVX    A,@DPTR
026F A3                INC     DPTR
0270 E0                MOVX    A,@DPTR
0271 120000      E     LCALL   ?C?SLCMP
0274 602E              JZ      ?C0052
                                           ; SOURCE LINE # 494
0276 900000      E     MOV     DPTR,#g_ref
0279 E0                MOVX    A,@DPTR
027A FC                MOV     R4,A
027B A3                INC     DPTR
027C E0                MOVX    A,@DPTR
027D FD                MOV     R5,A
027E A3                INC     DPTR
027F E0                MOVX    A,@DPTR
0280 FE                MOV     R6,A
0281 A3                INC     DPTR
0282 E0                MOVX    A,@DPTR
0283 FF                MOV     R7,A
0284 900000      E     MOV     DPTR,#c_mem+065H
0287 E0                MOVX    A,@DPTR
0288 F8                MOV     R0,A
0289 A3                INC     DPTR
028A E0                MOVX    A,@DPTR
028B A3                INC     DPTR
028C E0                MOVX    A,@DPTR
028D A3                INC     DPTR
028E E0                MOVX    A,@DPTR
028F EF                MOV     A,R7
0290 2B                ADD     A,R3
0291 FF                MOV     R7,A
0292 EE                MOV     A,R6
0293 3A                ADDC    A,R2
0294 FE                MOV     R6,A
0295 ED                MOV     A,R5
0296 39                ADDC    A,R1
0297 FD                MOV     R5,A
0298 EC                MOV     A,R4
0299 38                ADDC    A,R0
029A FC                MOV     R4,A
029B 900000      E     MOV     DPTR,#g_ref
029E 120000      E     LCALL   ?C?LSTXDATA
02A1 020000      R     LJMP    ?C0046
02A4         ?C0052:
                                           ; SOURCE LINE # 496
02A4 AF00        R     MOV     R7,handle_value+03H
02A6 AE00        R     MOV     R6,handle_value+02H
02A8 AD00        R     MOV     R5,handle_value+01H
02AA AC00        R     MOV     R4,handle_value
02AC 900000      E     MOV     DPTR,#g_ref
02AF 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 497
                                           ; SOURCE LINE # 498
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 43  

02B2 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 500
02B5         ?C0054:
                                           ; SOURCE LINE # 501
02B5 E4                CLR     A
02B6 FF                MOV     R7,A
02B7 FE                MOV     R6,A
02B8 FD                MOV     R5,A
02B9 FC                MOV     R4,A
02BA AB00        R     MOV     R3,err_emg_1+03H
02BC AA00        R     MOV     R2,err_emg_1+02H
02BE A900        R     MOV     R1,err_emg_1+01H
02C0 A800        R     MOV     R0,err_emg_1
02C2 D3                SETB    C
02C3 120000      E     LCALL   ?C?SLCMP
02C6 403D              JC      ?C0055
                                           ; SOURCE LINE # 502
02C8 900000      E     MOV     DPTR,#g_mem+059H
02CB E0                MOVX    A,@DPTR
02CC FC                MOV     R4,A
02CD A3                INC     DPTR
02CE E0                MOVX    A,@DPTR
02CF FD                MOV     R5,A
02D0 A3                INC     DPTR
02D1 E0                MOVX    A,@DPTR
02D2 FE                MOV     R6,A
02D3 A3                INC     DPTR
02D4 E0                MOVX    A,@DPTR
02D5 FF                MOV     R7,A
02D6 A800        R     MOV     R0,err_emg_1
02D8 120000      E     LCALL   ?C?LMUL
02DB C006              PUSH    AR6
02DD C007              PUSH    AR7
02DF 900000      E     MOV     DPTR,#c_mem+06BH
02E2 E0                MOVX    A,@DPTR
02E3 FE                MOV     R6,A
02E4 A3                INC     DPTR
02E5 E0                MOVX    A,@DPTR
02E6 FF                MOV     R7,A
02E7 C3                CLR     C
02E8 E4                CLR     A
02E9 9F                SUBB    A,R7
02EA FF                MOV     R7,A
02EB 7404              MOV     A,#04H
02ED 9E                SUBB    A,R6
02EE FE                MOV     R6,A
02EF AB07              MOV     R3,AR7
02F1 FA                MOV     R2,A
02F2 E4                CLR     A
02F3 F9                MOV     R1,A
02F4 F8                MOV     R0,A
02F5 D007              POP     AR7
02F7 D006              POP     AR6
02F9 120000      E     LCALL   ?C?SLDIV
02FC 900000      E     MOV     DPTR,#g_ref
02FF 120000      E     LCALL   ?C?LSTXDATA
0302 020000      R     LJMP    ?C0046
0305         ?C0055:
                                           ; SOURCE LINE # 504
0305 E4                CLR     A
0306 FF                MOV     R7,A
0307 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 44  

0308 FD                MOV     R5,A
0309 FC                MOV     R4,A
030A 900000      E     MOV     DPTR,#g_ref
030D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 505
0310 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 507
0313         ?C0057:
                                           ; SOURCE LINE # 508
0313 900000      E     MOV     DPTR,#g_refOld
0316 E0                MOVX    A,@DPTR
0317 FC                MOV     R4,A
0318 A3                INC     DPTR
0319 E0                MOVX    A,@DPTR
031A FD                MOV     R5,A
031B A3                INC     DPTR
031C E0                MOVX    A,@DPTR
031D FE                MOV     R6,A
031E A3                INC     DPTR
031F E0                MOVX    A,@DPTR
0320 FF                MOV     R7,A
0321 900000      E     MOV     DPTR,#g_ref
0324 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 509
0327 E4                CLR     A
0328 FF                MOV     R7,A
0329 FE                MOV     R6,A
032A FD                MOV     R5,A
032B FC                MOV     R4,A
032C AB00        R     MOV     R3,err_emg_1+03H
032E AA00        R     MOV     R2,err_emg_1+02H
0330 A900        R     MOV     R1,err_emg_1+01H
0332 A800        R     MOV     R0,err_emg_1
0334 D3                SETB    C
0335 120000      E     LCALL   ?C?SLCMP
0338 4056              JC      ?C0058
                                           ; SOURCE LINE # 510
033A 900000      E     MOV     DPTR,#g_mem+078H
033D E0                MOVX    A,@DPTR
033E FF                MOV     R7,A
033F E4                CLR     A
0340 FC                MOV     R4,A
0341 FD                MOV     R5,A
0342 FE                MOV     R6,A
0343 A800        R     MOV     R0,err_emg_1
0345 120000      E     LCALL   ?C?LMUL
0348 E4                CLR     A
0349 7B02              MOV     R3,#02H
034B FA                MOV     R2,A
034C F9                MOV     R1,A
034D F8                MOV     R0,A
034E 120000      E     LCALL   ?C?LMUL
0351 C006              PUSH    AR6
0353 C007              PUSH    AR7
0355 900000      E     MOV     DPTR,#c_mem+06BH
0358 E0                MOVX    A,@DPTR
0359 FE                MOV     R6,A
035A A3                INC     DPTR
035B E0                MOVX    A,@DPTR
035C FF                MOV     R7,A
035D C3                CLR     C
035E E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 45  

035F 9F                SUBB    A,R7
0360 FF                MOV     R7,A
0361 7404              MOV     A,#04H
0363 9E                SUBB    A,R6
0364 FE                MOV     R6,A
0365 AB07              MOV     R3,AR7
0367 FA                MOV     R2,A
0368 E4                CLR     A
0369 F9                MOV     R1,A
036A F8                MOV     R0,A
036B D007              POP     AR7
036D D006              POP     AR6
036F 120000      E     LCALL   ?C?SLDIV
0372 900000      E     MOV     DPTR,#g_refOld
0375 E0                MOVX    A,@DPTR
0376 F8                MOV     R0,A
0377 A3                INC     DPTR
0378 E0                MOVX    A,@DPTR
0379 F9                MOV     R1,A
037A A3                INC     DPTR
037B E0                MOVX    A,@DPTR
037C FA                MOV     R2,A
037D A3                INC     DPTR
037E E0                MOVX    A,@DPTR
037F 2F                ADD     A,R7
0380 FF                MOV     R7,A
0381 EA                MOV     A,R2
0382 3E                ADDC    A,R6
0383 FE                MOV     R6,A
0384 E9                MOV     A,R1
0385 3D                ADDC    A,R5
0386 FD                MOV     R5,A
0387 E8                MOV     A,R0
0388 3C                ADDC    A,R4
0389 FC                MOV     R4,A
038A 900000      E     MOV     DPTR,#g_ref
038D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 511
0390         ?C0058:
                                           ; SOURCE LINE # 512
0390 E4                CLR     A
0391 FF                MOV     R7,A
0392 FE                MOV     R6,A
0393 FD                MOV     R5,A
0394 FC                MOV     R4,A
0395 AB00        R     MOV     R3,err_emg_2+03H
0397 AA00        R     MOV     R2,err_emg_2+02H
0399 A900        R     MOV     R1,err_emg_2+01H
039B A800        R     MOV     R0,err_emg_2
039D D3                SETB    C
039E 120000      E     LCALL   ?C?SLCMP
03A1 5003              JNC     $ + 5H
03A3 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 513
03A6 900000      E     MOV     DPTR,#g_mem+078H
03A9 E0                MOVX    A,@DPTR
03AA FF                MOV     R7,A
03AB E4                CLR     A
03AC FC                MOV     R4,A
03AD FD                MOV     R5,A
03AE FE                MOV     R6,A
03AF A800        R     MOV     R0,err_emg_2
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 46  

03B1 120000      E     LCALL   ?C?LMUL
03B4 E4                CLR     A
03B5 7B02              MOV     R3,#02H
03B7 FA                MOV     R2,A
03B8 F9                MOV     R1,A
03B9 F8                MOV     R0,A
03BA 120000      E     LCALL   ?C?LMUL
03BD C006              PUSH    AR6
03BF C007              PUSH    AR7
03C1 900000      E     MOV     DPTR,#c_mem+06DH
03C4 E0                MOVX    A,@DPTR
03C5 FE                MOV     R6,A
03C6 A3                INC     DPTR
03C7 E0                MOVX    A,@DPTR
03C8 FF                MOV     R7,A
03C9 C3                CLR     C
03CA E4                CLR     A
03CB 9F                SUBB    A,R7
03CC FF                MOV     R7,A
03CD 7404              MOV     A,#04H
03CF 9E                SUBB    A,R6
03D0 FE                MOV     R6,A
03D1 AB07              MOV     R3,AR7
03D3 FA                MOV     R2,A
03D4 E4                CLR     A
03D5 F9                MOV     R1,A
03D6 F8                MOV     R0,A
03D7 D007              POP     AR7
03D9 D006              POP     AR6
03DB 120000      E     LCALL   ?C?SLDIV
03DE A804              MOV     R0,AR4
03E0 A905              MOV     R1,AR5
03E2 AA06              MOV     R2,AR6
03E4 AB07              MOV     R3,AR7
03E6 900000      E     MOV     DPTR,#g_refOld
03E9 E0                MOVX    A,@DPTR
03EA FC                MOV     R4,A
03EB A3                INC     DPTR
03EC E0                MOVX    A,@DPTR
03ED FD                MOV     R5,A
03EE A3                INC     DPTR
03EF E0                MOVX    A,@DPTR
03F0 FE                MOV     R6,A
03F1 A3                INC     DPTR
03F2 E0                MOVX    A,@DPTR
03F3 C3                CLR     C
03F4 9B                SUBB    A,R3
03F5 FF                MOV     R7,A
03F6 EE                MOV     A,R6
03F7 9A                SUBB    A,R2
03F8 FE                MOV     R6,A
03F9 ED                MOV     A,R5
03FA 99                SUBB    A,R1
03FB FD                MOV     R5,A
03FC EC                MOV     A,R4
03FD 98                SUBB    A,R0
03FE FC                MOV     R4,A
03FF 900000      E     MOV     DPTR,#g_ref
0402 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 514
                                           ; SOURCE LINE # 515
0405 020000      R     LJMP    ?C0046
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 47  

                                           ; SOURCE LINE # 517
0408         ?C0060:
                                           ; SOURCE LINE # 518
0408 900000      E     MOV     DPTR,#g_refOld
040B E0                MOVX    A,@DPTR
040C FC                MOV     R4,A
040D A3                INC     DPTR
040E E0                MOVX    A,@DPTR
040F FD                MOV     R5,A
0410 A3                INC     DPTR
0411 E0                MOVX    A,@DPTR
0412 FE                MOV     R6,A
0413 A3                INC     DPTR
0414 E0                MOVX    A,@DPTR
0415 FF                MOV     R7,A
0416 900000      E     MOV     DPTR,#g_ref
0419 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 519
041C 900000      R     MOV     DPTR,#current_emg
041F E0                MOVX    A,@DPTR
0420 14                DEC     A
0421 6048              JZ      ?C0065
0423 14                DEC     A
0424 7003              JNZ     $ + 5H
0426 020000      R     LJMP    ?C0067
0429 2402              ADD     A,#02H
042B 6003              JZ      $ + 5H
042D 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 520
0430         ?C0062:
                                           ; SOURCE LINE # 522
0430 E4                CLR     A
0431 FF                MOV     R7,A
0432 FE                MOV     R6,A
0433 FD                MOV     R5,A
0434 FC                MOV     R4,A
0435 AB00        R     MOV     R3,err_emg_1+03H
0437 AA00        R     MOV     R2,err_emg_1+02H
0439 A900        R     MOV     R1,err_emg_1+01H
043B A800        R     MOV     R0,err_emg_1
043D D3                SETB    C
043E 120000      E     LCALL   ?C?SLCMP
0441 4009              JC      ?C0063
                                           ; SOURCE LINE # 523
0443 900000      R     MOV     DPTR,#current_emg
0446 7401              MOV     A,#01H
0448 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 524
0449 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 525
044C         ?C0063:
                                           ; SOURCE LINE # 526
044C E4                CLR     A
044D FF                MOV     R7,A
044E FE                MOV     R6,A
044F FD                MOV     R5,A
0450 FC                MOV     R4,A
0451 AB00        R     MOV     R3,err_emg_2+03H
0453 AA00        R     MOV     R2,err_emg_2+02H
0455 A900        R     MOV     R1,err_emg_2+01H
0457 A800        R     MOV     R0,err_emg_2
0459 D3                SETB    C
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 48  

045A 120000      E     LCALL   ?C?SLCMP
045D 5003              JNC     $ + 5H
045F 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 527
0462 900000      R     MOV     DPTR,#current_emg
0465 7402              MOV     A,#02H
0467 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 528
0468 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 529
                                           ; SOURCE LINE # 530
                                           ; SOURCE LINE # 532
046B         ?C0065:
                                           ; SOURCE LINE # 534
046B E4                CLR     A
046C FF                MOV     R7,A
046D FE                MOV     R6,A
046E FD                MOV     R5,A
046F FC                MOV     R4,A
0470 AB00        R     MOV     R3,err_emg_1+03H
0472 AA00        R     MOV     R2,err_emg_1+02H
0474 A900        R     MOV     R1,err_emg_1+01H
0476 A800        R     MOV     R0,err_emg_1
0478 C3                CLR     C
0479 120000      E     LCALL   ?C?SLCMP
047C 5008              JNC     ?C0066
                                           ; SOURCE LINE # 535
047E E4                CLR     A
047F 900000      R     MOV     DPTR,#current_emg
0482 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 536
0483 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 537
0486         ?C0066:
                                           ; SOURCE LINE # 538
0486 900000      E     MOV     DPTR,#g_mem+078H
0489 E0                MOVX    A,@DPTR
048A FF                MOV     R7,A
048B E4                CLR     A
048C FC                MOV     R4,A
048D FD                MOV     R5,A
048E FE                MOV     R6,A
048F AB00        R     MOV     R3,err_emg_1+03H
0491 AA00        R     MOV     R2,err_emg_1+02H
0493 A900        R     MOV     R1,err_emg_1+01H
0495 A800        R     MOV     R0,err_emg_1
0497 120000      E     LCALL   ?C?LMUL
049A E4                CLR     A
049B 7B02              MOV     R3,#02H
049D FA                MOV     R2,A
049E F9                MOV     R1,A
049F F8                MOV     R0,A
04A0 120000      E     LCALL   ?C?LMUL
04A3 C006              PUSH    AR6
04A5 C007              PUSH    AR7
04A7 900000      E     MOV     DPTR,#c_mem+06BH
04AA E0                MOVX    A,@DPTR
04AB FE                MOV     R6,A
04AC A3                INC     DPTR
04AD E0                MOVX    A,@DPTR
04AE FF                MOV     R7,A
04AF C3                CLR     C
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 49  

04B0 E4                CLR     A
04B1 9F                SUBB    A,R7
04B2 FF                MOV     R7,A
04B3 7404              MOV     A,#04H
04B5 9E                SUBB    A,R6
04B6 FE                MOV     R6,A
04B7 AB07              MOV     R3,AR7
04B9 FA                MOV     R2,A
04BA E4                CLR     A
04BB F9                MOV     R1,A
04BC F8                MOV     R0,A
04BD D007              POP     AR7
04BF D006              POP     AR6
04C1 120000      E     LCALL   ?C?SLDIV
04C4 900000      E     MOV     DPTR,#g_refOld
04C7 E0                MOVX    A,@DPTR
04C8 F8                MOV     R0,A
04C9 A3                INC     DPTR
04CA E0                MOVX    A,@DPTR
04CB F9                MOV     R1,A
04CC A3                INC     DPTR
04CD E0                MOVX    A,@DPTR
04CE FA                MOV     R2,A
04CF A3                INC     DPTR
04D0 E0                MOVX    A,@DPTR
04D1 2F                ADD     A,R7
04D2 FF                MOV     R7,A
04D3 EA                MOV     A,R2
04D4 3E                ADDC    A,R6
04D5 FE                MOV     R6,A
04D6 E9                MOV     A,R1
04D7 3D                ADDC    A,R5
04D8 FD                MOV     R5,A
04D9 E8                MOV     A,R0
04DA 3C                ADDC    A,R4
04DB FC                MOV     R4,A
04DC 900000      E     MOV     DPTR,#g_ref
04DF 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 539
04E2 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 541
04E5         ?C0067:
                                           ; SOURCE LINE # 543
04E5 E4                CLR     A
04E6 FF                MOV     R7,A
04E7 FE                MOV     R6,A
04E8 FD                MOV     R5,A
04E9 FC                MOV     R4,A
04EA AB00        R     MOV     R3,err_emg_2+03H
04EC AA00        R     MOV     R2,err_emg_2+02H
04EE A900        R     MOV     R1,err_emg_2+01H
04F0 A800        R     MOV     R0,err_emg_2
04F2 C3                CLR     C
04F3 120000      E     LCALL   ?C?SLCMP
04F6 5008              JNC     ?C0068
                                           ; SOURCE LINE # 544
04F8 E4                CLR     A
04F9 900000      R     MOV     DPTR,#current_emg
04FC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 545
04FD 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 546
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 50  

0500         ?C0068:
                                           ; SOURCE LINE # 547
0500 900000      E     MOV     DPTR,#g_mem+078H
0503 E0                MOVX    A,@DPTR
0504 FF                MOV     R7,A
0505 E4                CLR     A
0506 FC                MOV     R4,A
0507 FD                MOV     R5,A
0508 FE                MOV     R6,A
0509 AB00        R     MOV     R3,err_emg_2+03H
050B AA00        R     MOV     R2,err_emg_2+02H
050D A900        R     MOV     R1,err_emg_2+01H
050F A800        R     MOV     R0,err_emg_2
0511 120000      E     LCALL   ?C?LMUL
0514 E4                CLR     A
0515 7B02              MOV     R3,#02H
0517 FA                MOV     R2,A
0518 F9                MOV     R1,A
0519 F8                MOV     R0,A
051A 120000      E     LCALL   ?C?LMUL
051D C006              PUSH    AR6
051F C007              PUSH    AR7
0521 900000      E     MOV     DPTR,#c_mem+06DH
0524 E0                MOVX    A,@DPTR
0525 FE                MOV     R6,A
0526 A3                INC     DPTR
0527 E0                MOVX    A,@DPTR
0528 FF                MOV     R7,A
0529 C3                CLR     C
052A E4                CLR     A
052B 9F                SUBB    A,R7
052C FF                MOV     R7,A
052D 7404              MOV     A,#04H
052F 9E                SUBB    A,R6
0530 FE                MOV     R6,A
0531 AB07              MOV     R3,AR7
0533 FA                MOV     R2,A
0534 E4                CLR     A
0535 F9                MOV     R1,A
0536 F8                MOV     R0,A
0537 D007              POP     AR7
0539 D006              POP     AR6
053B 120000      E     LCALL   ?C?SLDIV
053E A804              MOV     R0,AR4
0540 A905              MOV     R1,AR5
0542 AA06              MOV     R2,AR6
0544 AB07              MOV     R3,AR7
0546 900000      E     MOV     DPTR,#g_refOld
0549 E0                MOVX    A,@DPTR
054A FC                MOV     R4,A
054B A3                INC     DPTR
054C E0                MOVX    A,@DPTR
054D FD                MOV     R5,A
054E A3                INC     DPTR
054F E0                MOVX    A,@DPTR
0550 FE                MOV     R6,A
0551 A3                INC     DPTR
0552 E0                MOVX    A,@DPTR
0553 C3                CLR     C
0554 9B                SUBB    A,R3
0555 FF                MOV     R7,A
0556 EE                MOV     A,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 51  

0557 9A                SUBB    A,R2
0558 FE                MOV     R6,A
0559 ED                MOV     A,R5
055A 99                SUBB    A,R1
055B FD                MOV     R5,A
055C EC                MOV     A,R4
055D 98                SUBB    A,R0
055E FC                MOV     R4,A
055F 900000      E     MOV     DPTR,#g_ref
0562 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 548
0565 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 550
                                           ; SOURCE LINE # 551
                                           ; SOURCE LINE # 552
                                           ; SOURCE LINE # 554
0568 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 556
056B         ?C0070:
                                           ; SOURCE LINE # 557
056B 900000      E     MOV     DPTR,#g_refOld
056E E0                MOVX    A,@DPTR
056F FC                MOV     R4,A
0570 A3                INC     DPTR
0571 E0                MOVX    A,@DPTR
0572 FD                MOV     R5,A
0573 A3                INC     DPTR
0574 E0                MOVX    A,@DPTR
0575 FE                MOV     R6,A
0576 A3                INC     DPTR
0577 E0                MOVX    A,@DPTR
0578 FF                MOV     R7,A
0579 900000      E     MOV     DPTR,#g_ref
057C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 558
057F 900000      R     MOV     DPTR,#current_emg
0582 E0                MOVX    A,@DPTR
0583 14                DEC     A
0584 6048              JZ      ?C0075
0586 14                DEC     A
0587 7003              JNZ     $ + 5H
0589 020000      R     LJMP    ?C0078
058C 2402              ADD     A,#02H
058E 6003              JZ      $ + 5H
0590 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 560
0593         ?C0072:
                                           ; SOURCE LINE # 561
0593 E4                CLR     A
0594 FF                MOV     R7,A
0595 FE                MOV     R6,A
0596 FD                MOV     R5,A
0597 FC                MOV     R4,A
0598 AB00        R     MOV     R3,err_emg_1+03H
059A AA00        R     MOV     R2,err_emg_1+02H
059C A900        R     MOV     R1,err_emg_1+01H
059E A800        R     MOV     R0,err_emg_1
05A0 D3                SETB    C
05A1 120000      E     LCALL   ?C?SLCMP
05A4 4009              JC      ?C0073
                                           ; SOURCE LINE # 562
05A6 900000      R     MOV     DPTR,#current_emg
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 52  

05A9 7401              MOV     A,#01H
05AB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 563
05AC 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 564
05AF         ?C0073:
                                           ; SOURCE LINE # 565
05AF E4                CLR     A
05B0 FF                MOV     R7,A
05B1 FE                MOV     R6,A
05B2 FD                MOV     R5,A
05B3 FC                MOV     R4,A
05B4 AB00        R     MOV     R3,err_emg_2+03H
05B6 AA00        R     MOV     R2,err_emg_2+02H
05B8 A900        R     MOV     R1,err_emg_2+01H
05BA A800        R     MOV     R0,err_emg_2
05BC D3                SETB    C
05BD 120000      E     LCALL   ?C?SLCMP
05C0 5003              JNC     $ + 5H
05C2 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 566
05C5 900000      R     MOV     DPTR,#current_emg
05C8 7402              MOV     A,#02H
05CA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 567
05CB 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 568
                                           ; SOURCE LINE # 569
                                           ; SOURCE LINE # 572
05CE         ?C0075:
                                           ; SOURCE LINE # 574
05CE E4                CLR     A
05CF FF                MOV     R7,A
05D0 FE                MOV     R6,A
05D1 FD                MOV     R5,A
05D2 FC                MOV     R4,A
05D3 AB00        R     MOV     R3,err_emg_1+03H
05D5 AA00        R     MOV     R2,err_emg_1+02H
05D7 A900        R     MOV     R1,err_emg_1+01H
05D9 A800        R     MOV     R0,err_emg_1
05DB C3                CLR     C
05DC 120000      E     LCALL   ?C?SLCMP
05DF 501B              JNC     ?C0076
05E1 E4                CLR     A
05E2 FF                MOV     R7,A
05E3 FE                MOV     R6,A
05E4 FD                MOV     R5,A
05E5 FC                MOV     R4,A
05E6 AB00        R     MOV     R3,err_emg_2+03H
05E8 AA00        R     MOV     R2,err_emg_2+02H
05EA A900        R     MOV     R1,err_emg_2+01H
05EC A800        R     MOV     R0,err_emg_2
05EE C3                CLR     C
05EF 120000      E     LCALL   ?C?SLCMP
05F2 5008              JNC     ?C0076
                                           ; SOURCE LINE # 575
05F4 E4                CLR     A
05F5 900000      R     MOV     DPTR,#current_emg
05F8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 576
05F9 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 577
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 53  

05FC         ?C0076:
                                           ; SOURCE LINE # 579
05FC E4                CLR     A
05FD FF                MOV     R7,A
05FE FE                MOV     R6,A
05FF FD                MOV     R5,A
0600 FC                MOV     R4,A
0601 AB00        R     MOV     R3,err_emg_1+03H
0603 AA00        R     MOV     R2,err_emg_1+02H
0605 A900        R     MOV     R1,err_emg_1+01H
0607 A800        R     MOV     R0,err_emg_1
0609 D3                SETB    C
060A 120000      E     LCALL   ?C?SLCMP
060D 5003              JNC     $ + 5H
060F 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 580
0612 900000      E     MOV     DPTR,#g_mem+078H
0615 E0                MOVX    A,@DPTR
0616 FF                MOV     R7,A
0617 E4                CLR     A
0618 FC                MOV     R4,A
0619 FD                MOV     R5,A
061A FE                MOV     R6,A
061B A800        R     MOV     R0,err_emg_1
061D 120000      E     LCALL   ?C?LMUL
0620 7802              MOV     R0,#02H
0622 120000      E     LCALL   ?C?LSHL
0625 C006              PUSH    AR6
0627 C007              PUSH    AR7
0629 900000      E     MOV     DPTR,#c_mem+06BH
062C E0                MOVX    A,@DPTR
062D FE                MOV     R6,A
062E A3                INC     DPTR
062F E0                MOVX    A,@DPTR
0630 FF                MOV     R7,A
0631 C3                CLR     C
0632 E4                CLR     A
0633 9F                SUBB    A,R7
0634 FF                MOV     R7,A
0635 7404              MOV     A,#04H
0637 9E                SUBB    A,R6
0638 FE                MOV     R6,A
0639 AB07              MOV     R3,AR7
063B FA                MOV     R2,A
063C E4                CLR     A
063D F9                MOV     R1,A
063E F8                MOV     R0,A
063F D007              POP     AR7
0641 D006              POP     AR6
0643 120000      E     LCALL   ?C?SLDIV
0646 900000      E     MOV     DPTR,#g_refOld
0649 E0                MOVX    A,@DPTR
064A F8                MOV     R0,A
064B A3                INC     DPTR
064C E0                MOVX    A,@DPTR
064D F9                MOV     R1,A
064E A3                INC     DPTR
064F E0                MOVX    A,@DPTR
0650 FA                MOV     R2,A
0651 A3                INC     DPTR
0652 E0                MOVX    A,@DPTR
0653 2F                ADD     A,R7
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 54  

0654 FF                MOV     R7,A
0655 EA                MOV     A,R2
0656 3E                ADDC    A,R6
0657 FE                MOV     R6,A
0658 E9                MOV     A,R1
0659 3D                ADDC    A,R5
065A FD                MOV     R5,A
065B E8                MOV     A,R0
065C 3C                ADDC    A,R4
065D FC                MOV     R4,A
065E 900000      E     MOV     DPTR,#g_ref
0661 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 582
0664 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 585
0667         ?C0078:
                                           ; SOURCE LINE # 587
0667 E4                CLR     A
0668 FF                MOV     R7,A
0669 FE                MOV     R6,A
066A FD                MOV     R5,A
066B FC                MOV     R4,A
066C AB00        R     MOV     R3,err_emg_1+03H
066E AA00        R     MOV     R2,err_emg_1+02H
0670 A900        R     MOV     R1,err_emg_1+01H
0672 A800        R     MOV     R0,err_emg_1
0674 C3                CLR     C
0675 120000      E     LCALL   ?C?SLCMP
0678 501A              JNC     ?C0079
067A E4                CLR     A
067B FF                MOV     R7,A
067C FE                MOV     R6,A
067D FD                MOV     R5,A
067E FC                MOV     R4,A
067F AB00        R     MOV     R3,err_emg_2+03H
0681 AA00        R     MOV     R2,err_emg_2+02H
0683 A900        R     MOV     R1,err_emg_2+01H
0685 A800        R     MOV     R0,err_emg_2
0687 C3                CLR     C
0688 120000      E     LCALL   ?C?SLCMP
068B 5007              JNC     ?C0079
                                           ; SOURCE LINE # 588
068D E4                CLR     A
068E 900000      R     MOV     DPTR,#current_emg
0691 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 589
0692 806E              SJMP    ?C0046
                                           ; SOURCE LINE # 590
0694         ?C0079:
                                           ; SOURCE LINE # 592
0694 E4                CLR     A
0695 FF                MOV     R7,A
0696 FE                MOV     R6,A
0697 FD                MOV     R5,A
0698 FC                MOV     R4,A
0699 AB00        R     MOV     R3,err_emg_2+03H
069B AA00        R     MOV     R2,err_emg_2+02H
069D A900        R     MOV     R1,err_emg_2+01H
069F A800        R     MOV     R0,err_emg_2
06A1 D3                SETB    C
06A2 120000      E     LCALL   ?C?SLCMP
06A5 405B              JC      ?C0046
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 55  

                                           ; SOURCE LINE # 593
06A7 900000      E     MOV     DPTR,#c_mem+078H
06AA E0                MOVX    A,@DPTR
06AB FF                MOV     R7,A
06AC E4                CLR     A
06AD FC                MOV     R4,A
06AE FD                MOV     R5,A
06AF FE                MOV     R6,A
06B0 A800        R     MOV     R0,err_emg_2
06B2 120000      E     LCALL   ?C?LMUL
06B5 7802              MOV     R0,#02H
06B7 120000      E     LCALL   ?C?LSHL
06BA C006              PUSH    AR6
06BC C007              PUSH    AR7
06BE 900000      E     MOV     DPTR,#c_mem+06DH
06C1 E0                MOVX    A,@DPTR
06C2 FE                MOV     R6,A
06C3 A3                INC     DPTR
06C4 E0                MOVX    A,@DPTR
06C5 FF                MOV     R7,A
06C6 C3                CLR     C
06C7 E4                CLR     A
06C8 9F                SUBB    A,R7
06C9 FF                MOV     R7,A
06CA 7404              MOV     A,#04H
06CC 9E                SUBB    A,R6
06CD FE                MOV     R6,A
06CE AB07              MOV     R3,AR7
06D0 FA                MOV     R2,A
06D1 E4                CLR     A
06D2 F9                MOV     R1,A
06D3 F8                MOV     R0,A
06D4 D007              POP     AR7
06D6 D006              POP     AR6
06D8 120000      E     LCALL   ?C?SLDIV
06DB A804              MOV     R0,AR4
06DD A905              MOV     R1,AR5
06DF AA06              MOV     R2,AR6
06E1 AB07              MOV     R3,AR7
06E3 900000      E     MOV     DPTR,#g_refOld
06E6 E0                MOVX    A,@DPTR
06E7 FC                MOV     R4,A
06E8 A3                INC     DPTR
06E9 E0                MOVX    A,@DPTR
06EA FD                MOV     R5,A
06EB A3                INC     DPTR
06EC E0                MOVX    A,@DPTR
06ED FE                MOV     R6,A
06EE A3                INC     DPTR
06EF E0                MOVX    A,@DPTR
06F0 C3                CLR     C
06F1 9B                SUBB    A,R3
06F2 FF                MOV     R7,A
06F3 EE                MOV     A,R6
06F4 9A                SUBB    A,R2
06F5 FE                MOV     R6,A
06F6 ED                MOV     A,R5
06F7 99                SUBB    A,R1
06F8 FD                MOV     R5,A
06F9 EC                MOV     A,R4
06FA 98                SUBB    A,R0
06FB FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 56  

06FC 900000      E     MOV     DPTR,#g_ref
06FF 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 594
                                           ; SOURCE LINE # 595
                                           ; SOURCE LINE # 597
                                           ; SOURCE LINE # 598
                                           ; SOURCE LINE # 599
                                           ; SOURCE LINE # 601
                                           ; SOURCE LINE # 602
                                           ; SOURCE LINE # 603
0702         ?C0046:
                                           ; SOURCE LINE # 606
0702 900000      E     MOV     DPTR,#c_mem+050H
0705 E0                MOVX    A,@DPTR
0706 606A              JZ      ?C0083
                                           ; SOURCE LINE # 607
0708 A3                INC     DPTR
0709 E0                MOVX    A,@DPTR
070A FC                MOV     R4,A
070B A3                INC     DPTR
070C E0                MOVX    A,@DPTR
070D FD                MOV     R5,A
070E A3                INC     DPTR
070F E0                MOVX    A,@DPTR
0710 FE                MOV     R6,A
0711 A3                INC     DPTR
0712 E0                MOVX    A,@DPTR
0713 FF                MOV     R7,A
0714 900000      E     MOV     DPTR,#g_ref
0717 E0                MOVX    A,@DPTR
0718 F8                MOV     R0,A
0719 A3                INC     DPTR
071A E0                MOVX    A,@DPTR
071B F9                MOV     R1,A
071C A3                INC     DPTR
071D E0                MOVX    A,@DPTR
071E FA                MOV     R2,A
071F A3                INC     DPTR
0720 E0                MOVX    A,@DPTR
0721 FB                MOV     R3,A
0722 C3                CLR     C
0723 120000      E     LCALL   ?C?SLCMP
0726 5014              JNC     ?C0084
                                           ; SOURCE LINE # 608
0728 900000      E     MOV     DPTR,#c_mem+051H
072B E0                MOVX    A,@DPTR
072C FC                MOV     R4,A
072D A3                INC     DPTR
072E E0                MOVX    A,@DPTR
072F FD                MOV     R5,A
0730 A3                INC     DPTR
0731 E0                MOVX    A,@DPTR
0732 FE                MOV     R6,A
0733 A3                INC     DPTR
0734 E0                MOVX    A,@DPTR
0735 FF                MOV     R7,A
0736 900000      E     MOV     DPTR,#g_ref
0739 120000      E     LCALL   ?C?LSTXDATA
073C         ?C0084:
                                           ; SOURCE LINE # 609
073C 900000      E     MOV     DPTR,#c_mem+059H
073F E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 57  

0740 FC                MOV     R4,A
0741 A3                INC     DPTR
0742 E0                MOVX    A,@DPTR
0743 FD                MOV     R5,A
0744 A3                INC     DPTR
0745 E0                MOVX    A,@DPTR
0746 FE                MOV     R6,A
0747 A3                INC     DPTR
0748 E0                MOVX    A,@DPTR
0749 FF                MOV     R7,A
074A 900000      E     MOV     DPTR,#g_ref
074D E0                MOVX    A,@DPTR
074E F8                MOV     R0,A
074F A3                INC     DPTR
0750 E0                MOVX    A,@DPTR
0751 F9                MOV     R1,A
0752 A3                INC     DPTR
0753 E0                MOVX    A,@DPTR
0754 FA                MOV     R2,A
0755 A3                INC     DPTR
0756 E0                MOVX    A,@DPTR
0757 FB                MOV     R3,A
0758 D3                SETB    C
0759 120000      E     LCALL   ?C?SLCMP
075C 4014              JC      ?C0083
                                           ; SOURCE LINE # 610
075E 900000      E     MOV     DPTR,#c_mem+059H
0761 E0                MOVX    A,@DPTR
0762 FC                MOV     R4,A
0763 A3                INC     DPTR
0764 E0                MOVX    A,@DPTR
0765 FD                MOV     R5,A
0766 A3                INC     DPTR
0767 E0                MOVX    A,@DPTR
0768 FE                MOV     R6,A
0769 A3                INC     DPTR
076A E0                MOVX    A,@DPTR
076B FF                MOV     R7,A
076C 900000      E     MOV     DPTR,#g_ref
076F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 611
0772         ?C0083:
                                           ; SOURCE LINE # 613
0772 900000      E     MOV     DPTR,#c_mem+034H
0775 E0                MOVX    A,@DPTR
0776 7003              JNZ     $ + 5H
0778 020000      R     LJMP    ?C0108
077B 14                DEC     A
077C 7003              JNZ     $ + 5H
077E 020000      R     LJMP    ?C0130
0781 14                DEC     A
0782 7003              JNZ     $ + 5H
0784 020000      R     LJMP    ?C0117
0787 14                DEC     A
0788 6003              JZ      $ + 5H
078A 020000      R     LJMP    ?C0086
                                           ; SOURCE LINE # 615
078D         ?C0087:
                                           ; SOURCE LINE # 616
078D 900000      E     MOV     DPTR,#g_meas
0790 E0                MOVX    A,@DPTR
0791 F8                MOV     R0,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 58  

0792 A3                INC     DPTR
0793 E0                MOVX    A,@DPTR
0794 F9                MOV     R1,A
0795 A3                INC     DPTR
0796 E0                MOVX    A,@DPTR
0797 FA                MOV     R2,A
0798 A3                INC     DPTR
0799 E0                MOVX    A,@DPTR
079A FB                MOV     R3,A
079B 900000      E     MOV     DPTR,#g_ref
079E E0                MOVX    A,@DPTR
079F FC                MOV     R4,A
07A0 A3                INC     DPTR
07A1 E0                MOVX    A,@DPTR
07A2 FD                MOV     R5,A
07A3 A3                INC     DPTR
07A4 E0                MOVX    A,@DPTR
07A5 FE                MOV     R6,A
07A6 A3                INC     DPTR
07A7 E0                MOVX    A,@DPTR
07A8 C3                CLR     C
07A9 9B                SUBB    A,R3
07AA F500        R     MOV     pos_error+03H,A
07AC EE                MOV     A,R6
07AD 9A                SUBB    A,R2
07AE F500        R     MOV     pos_error+02H,A
07B0 ED                MOV     A,R5
07B1 99                SUBB    A,R1
07B2 F500        R     MOV     pos_error+01H,A
07B4 EC                MOV     A,R4
07B5 98                SUBB    A,R0
07B6 F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 618
07B8 900000      R     MOV     DPTR,#pos_error_sum
07BB E0                MOVX    A,@DPTR
07BC FC                MOV     R4,A
07BD A3                INC     DPTR
07BE E0                MOVX    A,@DPTR
07BF FD                MOV     R5,A
07C0 A3                INC     DPTR
07C1 E0                MOVX    A,@DPTR
07C2 FE                MOV     R6,A
07C3 A3                INC     DPTR
07C4 E0                MOVX    A,@DPTR
07C5 2500        R     ADD     A,pos_error+03H
07C7 FF                MOV     R7,A
07C8 EE                MOV     A,R6
07C9 3500        R     ADDC    A,pos_error+02H
07CB FE                MOV     R6,A
07CC ED                MOV     A,R5
07CD 3500        R     ADDC    A,pos_error+01H
07CF FD                MOV     R5,A
07D0 EC                MOV     A,R4
07D1 3500        R     ADDC    A,pos_error
07D3 FC                MOV     R4,A
07D4 900000      R     MOV     DPTR,#pos_error_sum
07D7 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 621
07DA 7F80              MOV     R7,#080H
07DC 7EF0              MOV     R6,#0F0H
07DE 7DFA              MOV     R5,#0FAH
07E0 7C02              MOV     R4,#02H
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 59  

07E2 900000      R     MOV     DPTR,#pos_error_sum
07E5 E0                MOVX    A,@DPTR
07E6 F8                MOV     R0,A
07E7 A3                INC     DPTR
07E8 E0                MOVX    A,@DPTR
07E9 F9                MOV     R1,A
07EA A3                INC     DPTR
07EB E0                MOVX    A,@DPTR
07EC FA                MOV     R2,A
07ED A3                INC     DPTR
07EE E0                MOVX    A,@DPTR
07EF FB                MOV     R3,A
07F0 D3                SETB    C
07F1 120000      E     LCALL   ?C?SLCMP
07F4 4010              JC      ?C0088
                                           ; SOURCE LINE # 622
07F6 7F80              MOV     R7,#080H
07F8 7EF0              MOV     R6,#0F0H
07FA 7DFA              MOV     R5,#0FAH
07FC 7C02              MOV     R4,#02H
07FE 900000      R     MOV     DPTR,#pos_error_sum
0801 120000      E     LCALL   ?C?LSTXDATA
0804 802A              SJMP    ?C0089
0806         ?C0088:
                                           ; SOURCE LINE # 623
                                           ; SOURCE LINE # 624
0806 7F80              MOV     R7,#080H
0808 7E0F              MOV     R6,#0FH
080A 7D05              MOV     R5,#05H
080C 7CFD              MOV     R4,#0FDH
080E 900000      R     MOV     DPTR,#pos_error_sum
0811 E0                MOVX    A,@DPTR
0812 F8                MOV     R0,A
0813 A3                INC     DPTR
0814 E0                MOVX    A,@DPTR
0815 F9                MOV     R1,A
0816 A3                INC     DPTR
0817 E0                MOVX    A,@DPTR
0818 FA                MOV     R2,A
0819 A3                INC     DPTR
081A E0                MOVX    A,@DPTR
081B FB                MOV     R3,A
081C C3                CLR     C
081D 120000      E     LCALL   ?C?SLCMP
0820 500E              JNC     ?C0089
                                           ; SOURCE LINE # 625
0822 7F80              MOV     R7,#080H
0824 7E0F              MOV     R6,#0FH
0826 7D05              MOV     R5,#05H
0828 7CFD              MOV     R4,#0FDH
082A 900000      R     MOV     DPTR,#pos_error_sum
082D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 626
0830         ?C0089:
                                           ; SOURCE LINE # 630
0830 E4                CLR     A
0831 F500        R     MOV     i_ref+03H,A
0833 F500        R     MOV     i_ref+02H,A
0835 F500        R     MOV     i_ref+01H,A
0837 F500        R     MOV     i_ref,A
                                           ; SOURCE LINE # 633
0839 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 60  

083A FE                MOV     R6,A
083B FD                MOV     R5,A
083C FC                MOV     R4,A
083D AB00        R     MOV     R3,k_p_dl+03H
083F AA00        R     MOV     R2,k_p_dl+02H
0841 A900        R     MOV     R1,k_p_dl+01H
0843 A800        R     MOV     R0,k_p_dl
0845 C3                CLR     C
0846 120000      E     LCALL   ?C?SLCMP
0849 6026              JZ      ?C0091
                                           ; SOURCE LINE # 634
084B AF00        R     MOV     R7,pos_error+03H
084D AE00        R     MOV     R6,pos_error+02H
084F AD00        R     MOV     R5,pos_error+01H
0851 AC00        R     MOV     R4,pos_error
0853 A800        R     MOV     R0,k_p_dl
0855 120000      E     LCALL   ?C?LMUL
0858 7810              MOV     R0,#010H
085A 120000      E     LCALL   ?C?SLSHR
085D E500        R     MOV     A,i_ref+03H
085F 2F                ADD     A,R7
0860 F500        R     MOV     i_ref+03H,A
0862 E500        R     MOV     A,i_ref+02H
0864 3E                ADDC    A,R6
0865 F500        R     MOV     i_ref+02H,A
0867 E500        R     MOV     A,i_ref+01H
0869 3D                ADDC    A,R5
086A F500        R     MOV     i_ref+01H,A
086C E500        R     MOV     A,i_ref
086E 3C                ADDC    A,R4
086F F500        R     MOV     i_ref,A
0871         ?C0091:
                                           ; SOURCE LINE # 637
0871 E4                CLR     A
0872 FF                MOV     R7,A
0873 FE                MOV     R6,A
0874 FD                MOV     R5,A
0875 FC                MOV     R4,A
0876 AB00        R     MOV     R3,k_i_dl+03H
0878 AA00        R     MOV     R2,k_i_dl+02H
087A A900        R     MOV     R1,k_i_dl+01H
087C A800        R     MOV     R0,k_i_dl
087E C3                CLR     C
087F 120000      E     LCALL   ?C?SLCMP
0882 602C              JZ      ?C0092
                                           ; SOURCE LINE # 638
0884 900000      R     MOV     DPTR,#pos_error_sum
0887 E0                MOVX    A,@DPTR
0888 FC                MOV     R4,A
0889 A3                INC     DPTR
088A E0                MOVX    A,@DPTR
088B FD                MOV     R5,A
088C A3                INC     DPTR
088D E0                MOVX    A,@DPTR
088E FE                MOV     R6,A
088F A3                INC     DPTR
0890 E0                MOVX    A,@DPTR
0891 FF                MOV     R7,A
0892 A800        R     MOV     R0,k_i_dl
0894 120000      E     LCALL   ?C?LMUL
0897 7810              MOV     R0,#010H
0899 120000      E     LCALL   ?C?SLSHR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 61  

089C E500        R     MOV     A,i_ref+03H
089E 2F                ADD     A,R7
089F F500        R     MOV     i_ref+03H,A
08A1 E500        R     MOV     A,i_ref+02H
08A3 3E                ADDC    A,R6
08A4 F500        R     MOV     i_ref+02H,A
08A6 E500        R     MOV     A,i_ref+01H
08A8 3D                ADDC    A,R5
08A9 F500        R     MOV     i_ref+01H,A
08AB E500        R     MOV     A,i_ref
08AD 3C                ADDC    A,R4
08AE F500        R     MOV     i_ref,A
08B0         ?C0092:
                                           ; SOURCE LINE # 641
08B0 E4                CLR     A
08B1 FF                MOV     R7,A
08B2 FE                MOV     R6,A
08B3 FD                MOV     R5,A
08B4 FC                MOV     R4,A
08B5 AB00        R     MOV     R3,k_d_dl+03H
08B7 AA00        R     MOV     R2,k_d_dl+02H
08B9 A900        R     MOV     R1,k_d_dl+01H
08BB A800        R     MOV     R0,k_d_dl
08BD C3                CLR     C
08BE 120000      E     LCALL   ?C?SLCMP
08C1 6043              JZ      ?C0093
                                           ; SOURCE LINE # 642
08C3 900000      R     MOV     DPTR,#prev_pos_err
08C6 E0                MOVX    A,@DPTR
08C7 F8                MOV     R0,A
08C8 A3                INC     DPTR
08C9 E0                MOVX    A,@DPTR
08CA F9                MOV     R1,A
08CB A3                INC     DPTR
08CC E0                MOVX    A,@DPTR
08CD FA                MOV     R2,A
08CE A3                INC     DPTR
08CF E0                MOVX    A,@DPTR
08D0 FB                MOV     R3,A
08D1 C3                CLR     C
08D2 E500        R     MOV     A,pos_error+03H
08D4 9B                SUBB    A,R3
08D5 FF                MOV     R7,A
08D6 E500        R     MOV     A,pos_error+02H
08D8 9A                SUBB    A,R2
08D9 FE                MOV     R6,A
08DA E500        R     MOV     A,pos_error+01H
08DC 99                SUBB    A,R1
08DD FD                MOV     R5,A
08DE E500        R     MOV     A,pos_error
08E0 98                SUBB    A,R0
08E1 FC                MOV     R4,A
08E2 AB00        R     MOV     R3,k_d_dl+03H
08E4 AA00        R     MOV     R2,k_d_dl+02H
08E6 A900        R     MOV     R1,k_d_dl+01H
08E8 A800        R     MOV     R0,k_d_dl
08EA 120000      E     LCALL   ?C?LMUL
08ED 7810              MOV     R0,#010H
08EF 120000      E     LCALL   ?C?SLSHR
08F2 E500        R     MOV     A,i_ref+03H
08F4 2F                ADD     A,R7
08F5 F500        R     MOV     i_ref+03H,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 62  

08F7 E500        R     MOV     A,i_ref+02H
08F9 3E                ADDC    A,R6
08FA F500        R     MOV     i_ref+02H,A
08FC E500        R     MOV     A,i_ref+01H
08FE 3D                ADDC    A,R5
08FF F500        R     MOV     i_ref+01H,A
0901 E500        R     MOV     A,i_ref
0903 3C                ADDC    A,R4
0904 F500        R     MOV     i_ref,A
0906         ?C0093:
                                           ; SOURCE LINE # 645
0906 AF00        R     MOV     R7,pos_error+03H
0908 AE00        R     MOV     R6,pos_error+02H
090A AD00        R     MOV     R5,pos_error+01H
090C AC00        R     MOV     R4,pos_error
090E 900000      R     MOV     DPTR,#prev_pos_err
0911 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 651
0914 E4                CLR     A
0915 FF                MOV     R7,A
0916 FE                MOV     R6,A
0917 FD                MOV     R5,A
0918 FC                MOV     R4,A
0919 AB00        R     MOV     R3,i_ref+03H
091B AA00        R     MOV     R2,i_ref+02H
091D A900        R     MOV     R1,i_ref+01H
091F A800        R     MOV     R0,i_ref
0921 C3                CLR     C
0922 120000      E     LCALL   ?C?SLCMP
0925 4004              JC      ?C0094
                                           ; SOURCE LINE # 652
0927 D200        R     SETB    motor_dir
0929 8002              SJMP    ?C0095
092B         ?C0094:
                                           ; SOURCE LINE # 654
092B C200        R     CLR     motor_dir
092D         ?C0095:
                                           ; SOURCE LINE # 660
092D 900000      E     MOV     DPTR,#c_mem+069H
0930 E0                MOVX    A,@DPTR
0931 FE                MOV     R6,A
0932 A3                INC     DPTR
0933 E0                MOVX    A,@DPTR
0934 FF                MOV     R7,A
0935 EE                MOV     A,R6
0936 33                RLC     A
0937 95E0              SUBB    A,ACC
0939 FD                MOV     R5,A
093A FC                MOV     R4,A
093B AB00        R     MOV     R3,i_ref+03H
093D AA00        R     MOV     R2,i_ref+02H
093F A900        R     MOV     R1,i_ref+01H
0941 A800        R     MOV     R0,i_ref
0943 D3                SETB    C
0944 120000      E     LCALL   ?C?SLCMP
0947 4016              JC      ?C0096
                                           ; SOURCE LINE # 661
0949 900000      E     MOV     DPTR,#c_mem+069H
094C E0                MOVX    A,@DPTR
094D FE                MOV     R6,A
094E A3                INC     DPTR
094F E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 63  

0950 FF                MOV     R7,A
0951 EE                MOV     A,R6
0952 33                RLC     A
0953 95E0              SUBB    A,ACC
0955 8F00        R     MOV     i_ref+03H,R7
0957 8E00        R     MOV     i_ref+02H,R6
0959 F500        R     MOV     i_ref+01H,A
095B F500        R     MOV     i_ref,A
095D 803C              SJMP    ?C0097
095F         ?C0096:
                                           ; SOURCE LINE # 663
095F 900000      E     MOV     DPTR,#c_mem+069H
0962 E0                MOVX    A,@DPTR
0963 FE                MOV     R6,A
0964 A3                INC     DPTR
0965 E0                MOVX    A,@DPTR
0966 FF                MOV     R7,A
0967 C3                CLR     C
0968 E4                CLR     A
0969 9F                SUBB    A,R7
096A FF                MOV     R7,A
096B E4                CLR     A
096C 9E                SUBB    A,R6
096D FE                MOV     R6,A
096E 33                RLC     A
096F 95E0              SUBB    A,ACC
0971 FD                MOV     R5,A
0972 FC                MOV     R4,A
0973 AB00        R     MOV     R3,i_ref+03H
0975 AA00        R     MOV     R2,i_ref+02H
0977 A900        R     MOV     R1,i_ref+01H
0979 A800        R     MOV     R0,i_ref
097B C3                CLR     C
097C 120000      E     LCALL   ?C?SLCMP
097F 501A              JNC     ?C0097
                                           ; SOURCE LINE # 664
0981 900000      E     MOV     DPTR,#c_mem+069H
0984 E0                MOVX    A,@DPTR
0985 FE                MOV     R6,A
0986 A3                INC     DPTR
0987 E0                MOVX    A,@DPTR
0988 FF                MOV     R7,A
0989 C3                CLR     C
098A E4                CLR     A
098B 9F                SUBB    A,R7
098C FF                MOV     R7,A
098D E4                CLR     A
098E 9E                SUBB    A,R6
098F FE                MOV     R6,A
0990 33                RLC     A
0991 95E0              SUBB    A,ACC
0993 8F00        R     MOV     i_ref+03H,R7
0995 8E00        R     MOV     i_ref+02H,R6
0997 F500        R     MOV     i_ref+01H,A
0999 F500        R     MOV     i_ref,A
099B         ?C0097:
                                           ; SOURCE LINE # 676
099B 900000      E     MOV     DPTR,#g_meas+0CH
099E E0                MOVX    A,@DPTR
099F F8                MOV     R0,A
09A0 A3                INC     DPTR
09A1 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 64  

09A2 F9                MOV     R1,A
09A3 A3                INC     DPTR
09A4 E0                MOVX    A,@DPTR
09A5 FA                MOV     R2,A
09A6 A3                INC     DPTR
09A7 E0                MOVX    A,@DPTR
09A8 FB                MOV     R3,A
09A9 C3                CLR     C
09AA E500        R     MOV     A,i_ref+03H
09AC 9B                SUBB    A,R3
09AD F500        R     MOV     curr_error+03H,A
09AF E500        R     MOV     A,i_ref+02H
09B1 9A                SUBB    A,R2
09B2 F500        R     MOV     curr_error+02H,A
09B4 E500        R     MOV     A,i_ref+01H
09B6 99                SUBB    A,R1
09B7 F500        R     MOV     curr_error+01H,A
09B9 E500        R     MOV     A,i_ref
09BB 98                SUBB    A,R0
09BC F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 677
09BE 900000      R     MOV     DPTR,#curr_error_sum
09C1 E0                MOVX    A,@DPTR
09C2 FC                MOV     R4,A
09C3 A3                INC     DPTR
09C4 E0                MOVX    A,@DPTR
09C5 FD                MOV     R5,A
09C6 A3                INC     DPTR
09C7 E0                MOVX    A,@DPTR
09C8 FE                MOV     R6,A
09C9 A3                INC     DPTR
09CA E0                MOVX    A,@DPTR
09CB 2500        R     ADD     A,curr_error+03H
09CD FF                MOV     R7,A
09CE EE                MOV     A,R6
09CF 3500        R     ADDC    A,curr_error+02H
09D1 FE                MOV     R6,A
09D2 ED                MOV     A,R5
09D3 3500        R     ADDC    A,curr_error+01H
09D5 FD                MOV     R5,A
09D6 EC                MOV     A,R4
09D7 3500        R     ADDC    A,curr_error
09D9 FC                MOV     R4,A
09DA 900000      R     MOV     DPTR,#curr_error_sum
09DD 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 679
09E0 7FA0              MOV     R7,#0A0H
09E2 7E86              MOV     R6,#086H
09E4 7D01              MOV     R5,#01H
09E6 7C00              MOV     R4,#00H
09E8 900000      R     MOV     DPTR,#curr_error_sum
09EB E0                MOVX    A,@DPTR
09EC F8                MOV     R0,A
09ED A3                INC     DPTR
09EE E0                MOVX    A,@DPTR
09EF F9                MOV     R1,A
09F0 A3                INC     DPTR
09F1 E0                MOVX    A,@DPTR
09F2 FA                MOV     R2,A
09F3 A3                INC     DPTR
09F4 E0                MOVX    A,@DPTR
09F5 FB                MOV     R3,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 65  

09F6 D3                SETB    C
09F7 120000      E     LCALL   ?C?SLCMP
09FA 4010              JC      ?C0099
                                           ; SOURCE LINE # 680
09FC 7FA0              MOV     R7,#0A0H
09FE 7E86              MOV     R6,#086H
0A00 7D01              MOV     R5,#01H
0A02 7C00              MOV     R4,#00H
0A04 900000      R     MOV     DPTR,#curr_error_sum
0A07 120000      E     LCALL   ?C?LSTXDATA
0A0A 802A              SJMP    ?C0100
0A0C         ?C0099:
                                           ; SOURCE LINE # 681
                                           ; SOURCE LINE # 682
0A0C 7F60              MOV     R7,#060H
0A0E 7E79              MOV     R6,#079H
0A10 7DFE              MOV     R5,#0FEH
0A12 7CFF              MOV     R4,#0FFH
0A14 900000      R     MOV     DPTR,#curr_error_sum
0A17 E0                MOVX    A,@DPTR
0A18 F8                MOV     R0,A
0A19 A3                INC     DPTR
0A1A E0                MOVX    A,@DPTR
0A1B F9                MOV     R1,A
0A1C A3                INC     DPTR
0A1D E0                MOVX    A,@DPTR
0A1E FA                MOV     R2,A
0A1F A3                INC     DPTR
0A20 E0                MOVX    A,@DPTR
0A21 FB                MOV     R3,A
0A22 C3                CLR     C
0A23 120000      E     LCALL   ?C?SLCMP
0A26 500E              JNC     ?C0100
                                           ; SOURCE LINE # 683
0A28 7F60              MOV     R7,#060H
0A2A 7E79              MOV     R6,#079H
0A2C 7DFE              MOV     R5,#0FEH
0A2E 7CFF              MOV     R4,#0FFH
0A30 900000      R     MOV     DPTR,#curr_error_sum
0A33 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 684
0A36         ?C0100:
                                           ; SOURCE LINE # 688
0A36 E4                CLR     A
0A37 F500        R     MOV     pwm_input+03H,A
0A39 F500        R     MOV     pwm_input+02H,A
0A3B F500        R     MOV     pwm_input+01H,A
0A3D F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 691
0A3F FF                MOV     R7,A
0A40 FE                MOV     R6,A
0A41 FD                MOV     R5,A
0A42 FC                MOV     R4,A
0A43 AB00        R     MOV     R3,k_p_c_dl+03H
0A45 AA00        R     MOV     R2,k_p_c_dl+02H
0A47 A900        R     MOV     R1,k_p_c_dl+01H
0A49 A800        R     MOV     R0,k_p_c_dl
0A4B C3                CLR     C
0A4C 120000      E     LCALL   ?C?SLCMP
0A4F 6026              JZ      ?C0102
                                           ; SOURCE LINE # 692
0A51 AF00        R     MOV     R7,curr_error+03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 66  

0A53 AE00        R     MOV     R6,curr_error+02H
0A55 AD00        R     MOV     R5,curr_error+01H
0A57 AC00        R     MOV     R4,curr_error
0A59 A800        R     MOV     R0,k_p_c_dl
0A5B 120000      E     LCALL   ?C?LMUL
0A5E 7810              MOV     R0,#010H
0A60 120000      E     LCALL   ?C?SLSHR
0A63 E500        R     MOV     A,pwm_input+03H
0A65 2F                ADD     A,R7
0A66 F500        R     MOV     pwm_input+03H,A
0A68 E500        R     MOV     A,pwm_input+02H
0A6A 3E                ADDC    A,R6
0A6B F500        R     MOV     pwm_input+02H,A
0A6D E500        R     MOV     A,pwm_input+01H
0A6F 3D                ADDC    A,R5
0A70 F500        R     MOV     pwm_input+01H,A
0A72 E500        R     MOV     A,pwm_input
0A74 3C                ADDC    A,R4
0A75 F500        R     MOV     pwm_input,A
0A77         ?C0102:
                                           ; SOURCE LINE # 695
0A77 E4                CLR     A
0A78 FF                MOV     R7,A
0A79 FE                MOV     R6,A
0A7A FD                MOV     R5,A
0A7B FC                MOV     R4,A
0A7C AB00        R     MOV     R3,k_i_c_dl+03H
0A7E AA00        R     MOV     R2,k_i_c_dl+02H
0A80 A900        R     MOV     R1,k_i_c_dl+01H
0A82 A800        R     MOV     R0,k_i_c_dl
0A84 C3                CLR     C
0A85 120000      E     LCALL   ?C?SLCMP
0A88 602C              JZ      ?C0103
                                           ; SOURCE LINE # 696
0A8A 900000      R     MOV     DPTR,#curr_error_sum
0A8D E0                MOVX    A,@DPTR
0A8E FC                MOV     R4,A
0A8F A3                INC     DPTR
0A90 E0                MOVX    A,@DPTR
0A91 FD                MOV     R5,A
0A92 A3                INC     DPTR
0A93 E0                MOVX    A,@DPTR
0A94 FE                MOV     R6,A
0A95 A3                INC     DPTR
0A96 E0                MOVX    A,@DPTR
0A97 FF                MOV     R7,A
0A98 A800        R     MOV     R0,k_i_c_dl
0A9A 120000      E     LCALL   ?C?LMUL
0A9D 7810              MOV     R0,#010H
0A9F 120000      E     LCALL   ?C?SLSHR
0AA2 E500        R     MOV     A,pwm_input+03H
0AA4 2F                ADD     A,R7
0AA5 F500        R     MOV     pwm_input+03H,A
0AA7 E500        R     MOV     A,pwm_input+02H
0AA9 3E                ADDC    A,R6
0AAA F500        R     MOV     pwm_input+02H,A
0AAC E500        R     MOV     A,pwm_input+01H
0AAE 3D                ADDC    A,R5
0AAF F500        R     MOV     pwm_input+01H,A
0AB1 E500        R     MOV     A,pwm_input
0AB3 3C                ADDC    A,R4
0AB4 F500        R     MOV     pwm_input,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 67  

0AB6         ?C0103:
                                           ; SOURCE LINE # 699
0AB6 E4                CLR     A
0AB7 FF                MOV     R7,A
0AB8 FE                MOV     R6,A
0AB9 FD                MOV     R5,A
0ABA FC                MOV     R4,A
0ABB AB00        R     MOV     R3,k_d_c_dl+03H
0ABD AA00        R     MOV     R2,k_d_c_dl+02H
0ABF A900        R     MOV     R1,k_d_c_dl+01H
0AC1 A800        R     MOV     R0,k_d_c_dl
0AC3 C3                CLR     C
0AC4 120000      E     LCALL   ?C?SLCMP
0AC7 6043              JZ      ?C0104
                                           ; SOURCE LINE # 700
0AC9 900000      R     MOV     DPTR,#prev_curr_err
0ACC E0                MOVX    A,@DPTR
0ACD F8                MOV     R0,A
0ACE A3                INC     DPTR
0ACF E0                MOVX    A,@DPTR
0AD0 F9                MOV     R1,A
0AD1 A3                INC     DPTR
0AD2 E0                MOVX    A,@DPTR
0AD3 FA                MOV     R2,A
0AD4 A3                INC     DPTR
0AD5 E0                MOVX    A,@DPTR
0AD6 FB                MOV     R3,A
0AD7 C3                CLR     C
0AD8 E500        R     MOV     A,curr_error+03H
0ADA 9B                SUBB    A,R3
0ADB FF                MOV     R7,A
0ADC E500        R     MOV     A,curr_error+02H
0ADE 9A                SUBB    A,R2
0ADF FE                MOV     R6,A
0AE0 E500        R     MOV     A,curr_error+01H
0AE2 99                SUBB    A,R1
0AE3 FD                MOV     R5,A
0AE4 E500        R     MOV     A,curr_error
0AE6 98                SUBB    A,R0
0AE7 FC                MOV     R4,A
0AE8 AB00        R     MOV     R3,k_d_c_dl+03H
0AEA AA00        R     MOV     R2,k_d_c_dl+02H
0AEC A900        R     MOV     R1,k_d_c_dl+01H
0AEE A800        R     MOV     R0,k_d_c_dl
0AF0 120000      E     LCALL   ?C?LMUL
0AF3 7810              MOV     R0,#010H
0AF5 120000      E     LCALL   ?C?SLSHR
0AF8 E500        R     MOV     A,pwm_input+03H
0AFA 2F                ADD     A,R7
0AFB F500        R     MOV     pwm_input+03H,A
0AFD E500        R     MOV     A,pwm_input+02H
0AFF 3E                ADDC    A,R6
0B00 F500        R     MOV     pwm_input+02H,A
0B02 E500        R     MOV     A,pwm_input+01H
0B04 3D                ADDC    A,R5
0B05 F500        R     MOV     pwm_input+01H,A
0B07 E500        R     MOV     A,pwm_input
0B09 3C                ADDC    A,R4
0B0A F500        R     MOV     pwm_input,A
0B0C         ?C0104:
                                           ; SOURCE LINE # 703
0B0C 74FF              MOV     A,#0FFH
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 68  

0B0E 7F9C              MOV     R7,#09CH
0B10 FE                MOV     R6,A
0B11 FD                MOV     R5,A
0B12 FC                MOV     R4,A
0B13 AB00        R     MOV     R3,pwm_input+03H
0B15 AA00        R     MOV     R2,pwm_input+02H
0B17 A900        R     MOV     R1,pwm_input+01H
0B19 A800        R     MOV     R0,pwm_input
0B1B C3                CLR     C
0B1C 120000      E     LCALL   ?C?SLCMP
0B1F 500D              JNC     ?C0105
                                           ; SOURCE LINE # 704
0B21 74FF              MOV     A,#0FFH
0B23 75009C      R     MOV     pwm_input+03H,#09CH
0B26 F500        R     MOV     pwm_input+02H,A
0B28 F500        R     MOV     pwm_input+01H,A
0B2A F500        R     MOV     pwm_input,A
0B2C 801E              SJMP    ?C0106
0B2E         ?C0105:
                                           ; SOURCE LINE # 705
                                           ; SOURCE LINE # 706
0B2E E4                CLR     A
0B2F 7F64              MOV     R7,#064H
0B31 FE                MOV     R6,A
0B32 FD                MOV     R5,A
0B33 FC                MOV     R4,A
0B34 AB00        R     MOV     R3,pwm_input+03H
0B36 AA00        R     MOV     R2,pwm_input+02H
0B38 A900        R     MOV     R1,pwm_input+01H
0B3A A800        R     MOV     R0,pwm_input
0B3C D3                SETB    C
0B3D 120000      E     LCALL   ?C?SLCMP
0B40 400A              JC      ?C0106
                                           ; SOURCE LINE # 707
0B42 E4                CLR     A
0B43 750064      R     MOV     pwm_input+03H,#064H
0B46 F500        R     MOV     pwm_input+02H,A
0B48 F500        R     MOV     pwm_input+01H,A
0B4A F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 708
0B4C         ?C0106:
                                           ; SOURCE LINE # 711
0B4C AF00        R     MOV     R7,curr_error+03H
0B4E AE00        R     MOV     R6,curr_error+02H
0B50 AD00        R     MOV     R5,curr_error+01H
0B52 AC00        R     MOV     R4,curr_error
0B54 900000      R     MOV     DPTR,#prev_curr_err
0B57 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 713
0B5A 020000      R     LJMP    ?C0086
                                           ; SOURCE LINE # 716
0B5D         ?C0108:
                                           ; SOURCE LINE # 717
0B5D 900000      E     MOV     DPTR,#g_meas
0B60 E0                MOVX    A,@DPTR
0B61 F8                MOV     R0,A
0B62 A3                INC     DPTR
0B63 E0                MOVX    A,@DPTR
0B64 F9                MOV     R1,A
0B65 A3                INC     DPTR
0B66 E0                MOVX    A,@DPTR
0B67 FA                MOV     R2,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 69  

0B68 A3                INC     DPTR
0B69 E0                MOVX    A,@DPTR
0B6A FB                MOV     R3,A
0B6B 900000      E     MOV     DPTR,#g_ref
0B6E E0                MOVX    A,@DPTR
0B6F FC                MOV     R4,A
0B70 A3                INC     DPTR
0B71 E0                MOVX    A,@DPTR
0B72 FD                MOV     R5,A
0B73 A3                INC     DPTR
0B74 E0                MOVX    A,@DPTR
0B75 FE                MOV     R6,A
0B76 A3                INC     DPTR
0B77 E0                MOVX    A,@DPTR
0B78 C3                CLR     C
0B79 9B                SUBB    A,R3
0B7A F500        R     MOV     pos_error+03H,A
0B7C EE                MOV     A,R6
0B7D 9A                SUBB    A,R2
0B7E F500        R     MOV     pos_error+02H,A
0B80 ED                MOV     A,R5
0B81 99                SUBB    A,R1
0B82 F500        R     MOV     pos_error+01H,A
0B84 EC                MOV     A,R4
0B85 98                SUBB    A,R0
0B86 F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 719
0B88 900000      R     MOV     DPTR,#pos_error_sum
0B8B E0                MOVX    A,@DPTR
0B8C FC                MOV     R4,A
0B8D A3                INC     DPTR
0B8E E0                MOVX    A,@DPTR
0B8F FD                MOV     R5,A
0B90 A3                INC     DPTR
0B91 E0                MOVX    A,@DPTR
0B92 FE                MOV     R6,A
0B93 A3                INC     DPTR
0B94 E0                MOVX    A,@DPTR
0B95 2500        R     ADD     A,pos_error+03H
0B97 FF                MOV     R7,A
0B98 EE                MOV     A,R6
0B99 3500        R     ADDC    A,pos_error+02H
0B9B FE                MOV     R6,A
0B9C ED                MOV     A,R5
0B9D 3500        R     ADDC    A,pos_error+01H
0B9F FD                MOV     R5,A
0BA0 EC                MOV     A,R4
0BA1 3500        R     ADDC    A,pos_error
0BA3 FC                MOV     R4,A
0BA4 900000      R     MOV     DPTR,#pos_error_sum
0BA7 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 722
0BAA E4                CLR     A
0BAB 7FE8              MOV     R7,#0E8H
0BAD 7E03              MOV     R6,#03H
0BAF FD                MOV     R5,A
0BB0 FC                MOV     R4,A
0BB1 900000      R     MOV     DPTR,#pos_error_sum
0BB4 E0                MOVX    A,@DPTR
0BB5 F8                MOV     R0,A
0BB6 A3                INC     DPTR
0BB7 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 70  

0BB8 F9                MOV     R1,A
0BB9 A3                INC     DPTR
0BBA E0                MOVX    A,@DPTR
0BBB FA                MOV     R2,A
0BBC A3                INC     DPTR
0BBD E0                MOVX    A,@DPTR
0BBE FB                MOV     R3,A
0BBF D3                SETB    C
0BC0 120000      E     LCALL   ?C?SLCMP
0BC3 400F              JC      ?C0109
                                           ; SOURCE LINE # 723
0BC5 E4                CLR     A
0BC6 7FE8              MOV     R7,#0E8H
0BC8 7E03              MOV     R6,#03H
0BCA FD                MOV     R5,A
0BCB FC                MOV     R4,A
0BCC 900000      R     MOV     DPTR,#pos_error_sum
0BCF 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 724
0BD2 802A              SJMP    ?C0110
0BD4         ?C0109:
0BD4 7F18              MOV     R7,#018H
0BD6 7EFC              MOV     R6,#0FCH
0BD8 7DFF              MOV     R5,#0FFH
0BDA 7CFF              MOV     R4,#0FFH
0BDC 900000      R     MOV     DPTR,#pos_error_sum
0BDF E0                MOVX    A,@DPTR
0BE0 F8                MOV     R0,A
0BE1 A3                INC     DPTR
0BE2 E0                MOVX    A,@DPTR
0BE3 F9                MOV     R1,A
0BE4 A3                INC     DPTR
0BE5 E0                MOVX    A,@DPTR
0BE6 FA                MOV     R2,A
0BE7 A3                INC     DPTR
0BE8 E0                MOVX    A,@DPTR
0BE9 FB                MOV     R3,A
0BEA C3                CLR     C
0BEB 120000      E     LCALL   ?C?SLCMP
0BEE 500E              JNC     ?C0110
                                           ; SOURCE LINE # 725
0BF0 7F18              MOV     R7,#018H
0BF2 7EFC              MOV     R6,#0FCH
0BF4 7DFF              MOV     R5,#0FFH
0BF6 7CFF              MOV     R4,#0FFH
0BF8 900000      R     MOV     DPTR,#pos_error_sum
0BFB 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 726
0BFE         ?C0110:
                                           ; SOURCE LINE # 729
0BFE E4                CLR     A
0BFF FF                MOV     R7,A
0C00 FE                MOV     R6,A
0C01 FD                MOV     R5,A
0C02 FC                MOV     R4,A
0C03 AB00        R     MOV     R3,k_p+03H
0C05 AA00        R     MOV     R2,k_p+02H
0C07 A900        R     MOV     R1,k_p+01H
0C09 A800        R     MOV     R0,k_p
0C0B C3                CLR     C
0C0C 120000      E     LCALL   ?C?SLCMP
0C0F 601A              JZ      ?C0112
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 71  

                                           ; SOURCE LINE # 730
0C11 AF00        R     MOV     R7,pos_error+03H
0C13 AE00        R     MOV     R6,pos_error+02H
0C15 AD00        R     MOV     R5,pos_error+01H
0C17 AC00        R     MOV     R4,pos_error
0C19 A800        R     MOV     R0,k_p
0C1B 120000      E     LCALL   ?C?LMUL
0C1E 7810              MOV     R0,#010H
0C20 120000      E     LCALL   ?C?SLSHR
0C23 8F00        R     MOV     pwm_input+03H,R7
0C25 8E00        R     MOV     pwm_input+02H,R6
0C27 8D00        R     MOV     pwm_input+01H,R5
0C29 8C00        R     MOV     pwm_input,R4
0C2B         ?C0112:
                                           ; SOURCE LINE # 734
0C2B E4                CLR     A
0C2C FF                MOV     R7,A
0C2D FE                MOV     R6,A
0C2E FD                MOV     R5,A
0C2F FC                MOV     R4,A
0C30 AB00        R     MOV     R3,k_i+03H
0C32 AA00        R     MOV     R2,k_i+02H
0C34 A900        R     MOV     R1,k_i+01H
0C36 A800        R     MOV     R0,k_i
0C38 C3                CLR     C
0C39 120000      E     LCALL   ?C?SLCMP
0C3C 602C              JZ      ?C0113
                                           ; SOURCE LINE # 735
0C3E 900000      R     MOV     DPTR,#pos_error_sum
0C41 E0                MOVX    A,@DPTR
0C42 FC                MOV     R4,A
0C43 A3                INC     DPTR
0C44 E0                MOVX    A,@DPTR
0C45 FD                MOV     R5,A
0C46 A3                INC     DPTR
0C47 E0                MOVX    A,@DPTR
0C48 FE                MOV     R6,A
0C49 A3                INC     DPTR
0C4A E0                MOVX    A,@DPTR
0C4B FF                MOV     R7,A
0C4C A800        R     MOV     R0,k_i
0C4E 120000      E     LCALL   ?C?LMUL
0C51 7810              MOV     R0,#010H
0C53 120000      E     LCALL   ?C?SLSHR
0C56 E500        R     MOV     A,pwm_input+03H
0C58 2F                ADD     A,R7
0C59 F500        R     MOV     pwm_input+03H,A
0C5B E500        R     MOV     A,pwm_input+02H
0C5D 3E                ADDC    A,R6
0C5E F500        R     MOV     pwm_input+02H,A
0C60 E500        R     MOV     A,pwm_input+01H
0C62 3D                ADDC    A,R5
0C63 F500        R     MOV     pwm_input+01H,A
0C65 E500        R     MOV     A,pwm_input
0C67 3C                ADDC    A,R4
0C68 F500        R     MOV     pwm_input,A
0C6A         ?C0113:
                                           ; SOURCE LINE # 739
0C6A E4                CLR     A
0C6B FF                MOV     R7,A
0C6C FE                MOV     R6,A
0C6D FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 72  

0C6E FC                MOV     R4,A
0C6F AB00        R     MOV     R3,k_d+03H
0C71 AA00        R     MOV     R2,k_d+02H
0C73 A900        R     MOV     R1,k_d+01H
0C75 A800        R     MOV     R0,k_d
0C77 C3                CLR     C
0C78 120000      E     LCALL   ?C?SLCMP
0C7B 6043              JZ      ?C0114
                                           ; SOURCE LINE # 740
0C7D 900000      R     MOV     DPTR,#prev_pos_err
0C80 E0                MOVX    A,@DPTR
0C81 F8                MOV     R0,A
0C82 A3                INC     DPTR
0C83 E0                MOVX    A,@DPTR
0C84 F9                MOV     R1,A
0C85 A3                INC     DPTR
0C86 E0                MOVX    A,@DPTR
0C87 FA                MOV     R2,A
0C88 A3                INC     DPTR
0C89 E0                MOVX    A,@DPTR
0C8A FB                MOV     R3,A
0C8B C3                CLR     C
0C8C E500        R     MOV     A,pos_error+03H
0C8E 9B                SUBB    A,R3
0C8F FF                MOV     R7,A
0C90 E500        R     MOV     A,pos_error+02H
0C92 9A                SUBB    A,R2
0C93 FE                MOV     R6,A
0C94 E500        R     MOV     A,pos_error+01H
0C96 99                SUBB    A,R1
0C97 FD                MOV     R5,A
0C98 E500        R     MOV     A,pos_error
0C9A 98                SUBB    A,R0
0C9B FC                MOV     R4,A
0C9C AB00        R     MOV     R3,k_d+03H
0C9E AA00        R     MOV     R2,k_d+02H
0CA0 A900        R     MOV     R1,k_d+01H
0CA2 A800        R     MOV     R0,k_d
0CA4 120000      E     LCALL   ?C?LMUL
0CA7 7810              MOV     R0,#010H
0CA9 120000      E     LCALL   ?C?SLSHR
0CAC E500        R     MOV     A,pwm_input+03H
0CAE 2F                ADD     A,R7
0CAF F500        R     MOV     pwm_input+03H,A
0CB1 E500        R     MOV     A,pwm_input+02H
0CB3 3E                ADDC    A,R6
0CB4 F500        R     MOV     pwm_input+02H,A
0CB6 E500        R     MOV     A,pwm_input+01H
0CB8 3D                ADDC    A,R5
0CB9 F500        R     MOV     pwm_input+01H,A
0CBB E500        R     MOV     A,pwm_input
0CBD 3C                ADDC    A,R4
0CBE F500        R     MOV     pwm_input,A
0CC0         ?C0114:
                                           ; SOURCE LINE # 744
0CC0 AF00        R     MOV     R7,pos_error+03H
0CC2 AE00        R     MOV     R6,pos_error+02H
0CC4 AD00        R     MOV     R5,pos_error+01H
0CC6 AC00        R     MOV     R4,pos_error
0CC8 900000      R     MOV     DPTR,#prev_pos_err
0CCB 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 746
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 73  

0CCE E4                CLR     A
0CCF FF                MOV     R7,A
0CD0 FE                MOV     R6,A
0CD1 FD                MOV     R5,A
0CD2 FC                MOV     R4,A
0CD3 AB00        R     MOV     R3,pwm_input+03H
0CD5 AA00        R     MOV     R2,pwm_input+02H
0CD7 A900        R     MOV     R1,pwm_input+01H
0CD9 A800        R     MOV     R0,pwm_input
0CDB D3                SETB    C
0CDC 120000      E     LCALL   ?C?SLCMP
0CDF 4005              JC      ?C0115
                                           ; SOURCE LINE # 747
0CE1 D200        R     SETB    motor_dir
0CE3 020000      R     LJMP    ?C0086
0CE6         ?C0115:
                                           ; SOURCE LINE # 749
0CE6 C200        R     CLR     motor_dir
                                           ; SOURCE LINE # 751
0CE8 020000      R     LJMP    ?C0086
                                           ; SOURCE LINE # 754
0CEB         ?C0117:
                                           ; SOURCE LINE # 755
0CEB 900000      E     MOV     DPTR,#g_ref+018H
0CEE E0                MOVX    A,@DPTR
0CEF 7003              JNZ     $ + 5H
0CF1 020000      R     LJMP    ?C0086
0CF4 200003      E     JB      tension_valid,$ + 6H
0CF7 020000      R     LJMP    ?C0086
                                           ; SOURCE LINE # 757
0CFA 900000      E     MOV     DPTR,#g_ref+08H
0CFD E0                MOVX    A,@DPTR
0CFE FC                MOV     R4,A
0CFF A3                INC     DPTR
0D00 E0                MOVX    A,@DPTR
0D01 FD                MOV     R5,A
0D02 A3                INC     DPTR
0D03 E0                MOVX    A,@DPTR
0D04 FE                MOV     R6,A
0D05 A3                INC     DPTR
0D06 E0                MOVX    A,@DPTR
0D07 F500        R     MOV     i_ref+03H,A
0D09 8E00        R     MOV     i_ref+02H,R6
0D0B 8D00        R     MOV     i_ref+01H,R5
0D0D 8C00        R     MOV     i_ref,R4
                                           ; SOURCE LINE # 759
0D0F 900000      E     MOV     DPTR,#c_mem+069H
0D12 E0                MOVX    A,@DPTR
0D13 FE                MOV     R6,A
0D14 A3                INC     DPTR
0D15 E0                MOVX    A,@DPTR
0D16 FF                MOV     R7,A
0D17 EE                MOV     A,R6
0D18 33                RLC     A
0D19 95E0              SUBB    A,ACC
0D1B FD                MOV     R5,A
0D1C FC                MOV     R4,A
0D1D AB00        R     MOV     R3,i_ref+03H
0D1F AA00        R     MOV     R2,i_ref+02H
0D21 A900        R     MOV     R1,i_ref+01H
0D23 A800        R     MOV     R0,i_ref
0D25 D3                SETB    C
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 74  

0D26 120000      E     LCALL   ?C?SLCMP
0D29 4016              JC      ?C0119
                                           ; SOURCE LINE # 760
0D2B 900000      E     MOV     DPTR,#c_mem+069H
0D2E E0                MOVX    A,@DPTR
0D2F FE                MOV     R6,A
0D30 A3                INC     DPTR
0D31 E0                MOVX    A,@DPTR
0D32 FF                MOV     R7,A
0D33 EE                MOV     A,R6
0D34 33                RLC     A
0D35 95E0              SUBB    A,ACC
0D37 8F00        R     MOV     i_ref+03H,R7
0D39 8E00        R     MOV     i_ref+02H,R6
0D3B F500        R     MOV     i_ref+01H,A
0D3D F500        R     MOV     i_ref,A
0D3F 803C              SJMP    ?C0120
0D41         ?C0119:
                                           ; SOURCE LINE # 761
                                           ; SOURCE LINE # 762
0D41 900000      E     MOV     DPTR,#c_mem+069H
0D44 E0                MOVX    A,@DPTR
0D45 FE                MOV     R6,A
0D46 A3                INC     DPTR
0D47 E0                MOVX    A,@DPTR
0D48 FF                MOV     R7,A
0D49 C3                CLR     C
0D4A E4                CLR     A
0D4B 9F                SUBB    A,R7
0D4C FF                MOV     R7,A
0D4D E4                CLR     A
0D4E 9E                SUBB    A,R6
0D4F FE                MOV     R6,A
0D50 33                RLC     A
0D51 95E0              SUBB    A,ACC
0D53 FD                MOV     R5,A
0D54 FC                MOV     R4,A
0D55 AB00        R     MOV     R3,i_ref+03H
0D57 AA00        R     MOV     R2,i_ref+02H
0D59 A900        R     MOV     R1,i_ref+01H
0D5B A800        R     MOV     R0,i_ref
0D5D C3                CLR     C
0D5E 120000      E     LCALL   ?C?SLCMP
0D61 501A              JNC     ?C0120
                                           ; SOURCE LINE # 763
0D63 900000      E     MOV     DPTR,#c_mem+069H
0D66 E0                MOVX    A,@DPTR
0D67 FE                MOV     R6,A
0D68 A3                INC     DPTR
0D69 E0                MOVX    A,@DPTR
0D6A FF                MOV     R7,A
0D6B C3                CLR     C
0D6C E4                CLR     A
0D6D 9F                SUBB    A,R7
0D6E FF                MOV     R7,A
0D6F E4                CLR     A
0D70 9E                SUBB    A,R6
0D71 FE                MOV     R6,A
0D72 33                RLC     A
0D73 95E0              SUBB    A,ACC
0D75 8F00        R     MOV     i_ref+03H,R7
0D77 8E00        R     MOV     i_ref+02H,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 75  

0D79 F500        R     MOV     i_ref+01H,A
0D7B F500        R     MOV     i_ref,A
                                           ; SOURCE LINE # 764
0D7D         ?C0120:
                                           ; SOURCE LINE # 767
0D7D 900000      E     MOV     DPTR,#g_meas+0CH
0D80 E0                MOVX    A,@DPTR
0D81 F8                MOV     R0,A
0D82 A3                INC     DPTR
0D83 E0                MOVX    A,@DPTR
0D84 F9                MOV     R1,A
0D85 A3                INC     DPTR
0D86 E0                MOVX    A,@DPTR
0D87 FA                MOV     R2,A
0D88 A3                INC     DPTR
0D89 E0                MOVX    A,@DPTR
0D8A FB                MOV     R3,A
0D8B C3                CLR     C
0D8C E500        R     MOV     A,i_ref+03H
0D8E 9B                SUBB    A,R3
0D8F F500        R     MOV     curr_error+03H,A
0D91 E500        R     MOV     A,i_ref+02H
0D93 9A                SUBB    A,R2
0D94 F500        R     MOV     curr_error+02H,A
0D96 E500        R     MOV     A,i_ref+01H
0D98 99                SUBB    A,R1
0D99 F500        R     MOV     curr_error+01H,A
0D9B E500        R     MOV     A,i_ref
0D9D 98                SUBB    A,R0
0D9E F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 768
0DA0 900000      R     MOV     DPTR,#curr_error_sum
0DA3 E0                MOVX    A,@DPTR
0DA4 FC                MOV     R4,A
0DA5 A3                INC     DPTR
0DA6 E0                MOVX    A,@DPTR
0DA7 FD                MOV     R5,A
0DA8 A3                INC     DPTR
0DA9 E0                MOVX    A,@DPTR
0DAA FE                MOV     R6,A
0DAB A3                INC     DPTR
0DAC E0                MOVX    A,@DPTR
0DAD 2500        R     ADD     A,curr_error+03H
0DAF FF                MOV     R7,A
0DB0 EE                MOV     A,R6
0DB1 3500        R     ADDC    A,curr_error+02H
0DB3 FE                MOV     R6,A
0DB4 ED                MOV     A,R5
0DB5 3500        R     ADDC    A,curr_error+01H
0DB7 FD                MOV     R5,A
0DB8 EC                MOV     A,R4
0DB9 3500        R     ADDC    A,curr_error
0DBB FC                MOV     R4,A
0DBC 900000      R     MOV     DPTR,#curr_error_sum
0DBF 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 770
0DC2 7FA0              MOV     R7,#0A0H
0DC4 7E86              MOV     R6,#086H
0DC6 7D01              MOV     R5,#01H
0DC8 7C00              MOV     R4,#00H
0DCA 900000      R     MOV     DPTR,#curr_error_sum
0DCD E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 76  

0DCE F8                MOV     R0,A
0DCF A3                INC     DPTR
0DD0 E0                MOVX    A,@DPTR
0DD1 F9                MOV     R1,A
0DD2 A3                INC     DPTR
0DD3 E0                MOVX    A,@DPTR
0DD4 FA                MOV     R2,A
0DD5 A3                INC     DPTR
0DD6 E0                MOVX    A,@DPTR
0DD7 FB                MOV     R3,A
0DD8 D3                SETB    C
0DD9 120000      E     LCALL   ?C?SLCMP
0DDC 4010              JC      ?C0122
                                           ; SOURCE LINE # 771
0DDE 7FA0              MOV     R7,#0A0H
0DE0 7E86              MOV     R6,#086H
0DE2 7D01              MOV     R5,#01H
0DE4 7C00              MOV     R4,#00H
0DE6 900000      R     MOV     DPTR,#curr_error_sum
0DE9 120000      E     LCALL   ?C?LSTXDATA
0DEC 802A              SJMP    ?C0123
0DEE         ?C0122:
                                           ; SOURCE LINE # 772
                                           ; SOURCE LINE # 773
0DEE 7F60              MOV     R7,#060H
0DF0 7E79              MOV     R6,#079H
0DF2 7DFE              MOV     R5,#0FEH
0DF4 7CFF              MOV     R4,#0FFH
0DF6 900000      R     MOV     DPTR,#curr_error_sum
0DF9 E0                MOVX    A,@DPTR
0DFA F8                MOV     R0,A
0DFB A3                INC     DPTR
0DFC E0                MOVX    A,@DPTR
0DFD F9                MOV     R1,A
0DFE A3                INC     DPTR
0DFF E0                MOVX    A,@DPTR
0E00 FA                MOV     R2,A
0E01 A3                INC     DPTR
0E02 E0                MOVX    A,@DPTR
0E03 FB                MOV     R3,A
0E04 C3                CLR     C
0E05 120000      E     LCALL   ?C?SLCMP
0E08 500E              JNC     ?C0123
                                           ; SOURCE LINE # 774
0E0A 7F60              MOV     R7,#060H
0E0C 7E79              MOV     R6,#079H
0E0E 7DFE              MOV     R5,#0FEH
0E10 7CFF              MOV     R4,#0FFH
0E12 900000      R     MOV     DPTR,#curr_error_sum
0E15 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 775
0E18         ?C0123:
                                           ; SOURCE LINE # 777
0E18 E4                CLR     A
0E19 F500        R     MOV     pwm_input+03H,A
0E1B F500        R     MOV     pwm_input+02H,A
0E1D F500        R     MOV     pwm_input+01H,A
0E1F F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 780
0E21 FF                MOV     R7,A
0E22 FE                MOV     R6,A
0E23 FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 77  

0E24 FC                MOV     R4,A
0E25 AB00        R     MOV     R3,k_p_c+03H
0E27 AA00        R     MOV     R2,k_p_c+02H
0E29 A900        R     MOV     R1,k_p_c+01H
0E2B A800        R     MOV     R0,k_p_c
0E2D C3                CLR     C
0E2E 120000      E     LCALL   ?C?SLCMP
0E31 6026              JZ      ?C0125
                                           ; SOURCE LINE # 781
0E33 AF00        R     MOV     R7,curr_error+03H
0E35 AE00        R     MOV     R6,curr_error+02H
0E37 AD00        R     MOV     R5,curr_error+01H
0E39 AC00        R     MOV     R4,curr_error
0E3B A800        R     MOV     R0,k_p_c
0E3D 120000      E     LCALL   ?C?LMUL
0E40 7810              MOV     R0,#010H
0E42 120000      E     LCALL   ?C?SLSHR
0E45 E500        R     MOV     A,pwm_input+03H
0E47 2F                ADD     A,R7
0E48 F500        R     MOV     pwm_input+03H,A
0E4A E500        R     MOV     A,pwm_input+02H
0E4C 3E                ADDC    A,R6
0E4D F500        R     MOV     pwm_input+02H,A
0E4F E500        R     MOV     A,pwm_input+01H
0E51 3D                ADDC    A,R5
0E52 F500        R     MOV     pwm_input+01H,A
0E54 E500        R     MOV     A,pwm_input
0E56 3C                ADDC    A,R4
0E57 F500        R     MOV     pwm_input,A
0E59         ?C0125:
                                           ; SOURCE LINE # 784
0E59 E4                CLR     A
0E5A FF                MOV     R7,A
0E5B FE                MOV     R6,A
0E5C FD                MOV     R5,A
0E5D FC                MOV     R4,A
0E5E AB00        R     MOV     R3,k_i_c+03H
0E60 AA00        R     MOV     R2,k_i_c+02H
0E62 A900        R     MOV     R1,k_i_c+01H
0E64 A800        R     MOV     R0,k_i_c
0E66 C3                CLR     C
0E67 120000      E     LCALL   ?C?SLCMP
0E6A 602C              JZ      ?C0126
                                           ; SOURCE LINE # 785
0E6C 900000      R     MOV     DPTR,#curr_error_sum
0E6F E0                MOVX    A,@DPTR
0E70 FC                MOV     R4,A
0E71 A3                INC     DPTR
0E72 E0                MOVX    A,@DPTR
0E73 FD                MOV     R5,A
0E74 A3                INC     DPTR
0E75 E0                MOVX    A,@DPTR
0E76 FE                MOV     R6,A
0E77 A3                INC     DPTR
0E78 E0                MOVX    A,@DPTR
0E79 FF                MOV     R7,A
0E7A A800        R     MOV     R0,k_i_c
0E7C 120000      E     LCALL   ?C?LMUL
0E7F 7810              MOV     R0,#010H
0E81 120000      E     LCALL   ?C?SLSHR
0E84 E500        R     MOV     A,pwm_input+03H
0E86 2F                ADD     A,R7
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 78  

0E87 F500        R     MOV     pwm_input+03H,A
0E89 E500        R     MOV     A,pwm_input+02H
0E8B 3E                ADDC    A,R6
0E8C F500        R     MOV     pwm_input+02H,A
0E8E E500        R     MOV     A,pwm_input+01H
0E90 3D                ADDC    A,R5
0E91 F500        R     MOV     pwm_input+01H,A
0E93 E500        R     MOV     A,pwm_input
0E95 3C                ADDC    A,R4
0E96 F500        R     MOV     pwm_input,A
0E98         ?C0126:
                                           ; SOURCE LINE # 788
0E98 E4                CLR     A
0E99 FF                MOV     R7,A
0E9A FE                MOV     R6,A
0E9B FD                MOV     R5,A
0E9C FC                MOV     R4,A
0E9D AB00        R     MOV     R3,k_d_c+03H
0E9F AA00        R     MOV     R2,k_d_c+02H
0EA1 A900        R     MOV     R1,k_d_c+01H
0EA3 A800        R     MOV     R0,k_d_c
0EA5 C3                CLR     C
0EA6 120000      E     LCALL   ?C?SLCMP
0EA9 6043              JZ      ?C0127
                                           ; SOURCE LINE # 789
0EAB 900000      R     MOV     DPTR,#prev_curr_err
0EAE E0                MOVX    A,@DPTR
0EAF F8                MOV     R0,A
0EB0 A3                INC     DPTR
0EB1 E0                MOVX    A,@DPTR
0EB2 F9                MOV     R1,A
0EB3 A3                INC     DPTR
0EB4 E0                MOVX    A,@DPTR
0EB5 FA                MOV     R2,A
0EB6 A3                INC     DPTR
0EB7 E0                MOVX    A,@DPTR
0EB8 FB                MOV     R3,A
0EB9 C3                CLR     C
0EBA E500        R     MOV     A,curr_error+03H
0EBC 9B                SUBB    A,R3
0EBD FF                MOV     R7,A
0EBE E500        R     MOV     A,curr_error+02H
0EC0 9A                SUBB    A,R2
0EC1 FE                MOV     R6,A
0EC2 E500        R     MOV     A,curr_error+01H
0EC4 99                SUBB    A,R1
0EC5 FD                MOV     R5,A
0EC6 E500        R     MOV     A,curr_error
0EC8 98                SUBB    A,R0
0EC9 FC                MOV     R4,A
0ECA AB00        R     MOV     R3,k_d_c+03H
0ECC AA00        R     MOV     R2,k_d_c+02H
0ECE A900        R     MOV     R1,k_d_c+01H
0ED0 A800        R     MOV     R0,k_d_c
0ED2 120000      E     LCALL   ?C?LMUL
0ED5 7810              MOV     R0,#010H
0ED7 120000      E     LCALL   ?C?SLSHR
0EDA E500        R     MOV     A,pwm_input+03H
0EDC 2F                ADD     A,R7
0EDD F500        R     MOV     pwm_input+03H,A
0EDF E500        R     MOV     A,pwm_input+02H
0EE1 3E                ADDC    A,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 79  

0EE2 F500        R     MOV     pwm_input+02H,A
0EE4 E500        R     MOV     A,pwm_input+01H
0EE6 3D                ADDC    A,R5
0EE7 F500        R     MOV     pwm_input+01H,A
0EE9 E500        R     MOV     A,pwm_input
0EEB 3C                ADDC    A,R4
0EEC F500        R     MOV     pwm_input,A
0EEE         ?C0127:
                                           ; SOURCE LINE # 791
0EEE AF00        R     MOV     R7,curr_error+03H
0EF0 AE00        R     MOV     R6,curr_error+02H
0EF2 AD00        R     MOV     R5,curr_error+01H
0EF4 AC00        R     MOV     R4,curr_error
0EF6 900000      R     MOV     DPTR,#prev_curr_err
0EF9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 793
0EFC E4                CLR     A
0EFD FF                MOV     R7,A
0EFE FE                MOV     R6,A
0EFF FD                MOV     R5,A
0F00 FC                MOV     R4,A
0F01 AB00        R     MOV     R3,pwm_input+03H
0F03 AA00        R     MOV     R2,pwm_input+02H
0F05 A900        R     MOV     R1,pwm_input+01H
0F07 A800        R     MOV     R0,pwm_input
0F09 C3                CLR     C
0F0A 120000      E     LCALL   ?C?SLCMP
0F0D 4004              JC      ?C0128
                                           ; SOURCE LINE # 794
0F0F D200        R     SETB    motor_dir
0F11 8072              SJMP    ?C0086
0F13         ?C0128:
                                           ; SOURCE LINE # 796
0F13 C200        R     CLR     motor_dir
                                           ; SOURCE LINE # 797
                                           ; SOURCE LINE # 798
0F15 806E              SJMP    ?C0086
                                           ; SOURCE LINE # 801
0F17         ?C0130:
                                           ; SOURCE LINE # 803
0F17 900000      E     MOV     DPTR,#g_ref+010H
0F1A E0                MOVX    A,@DPTR
0F1B FC                MOV     R4,A
0F1C A3                INC     DPTR
0F1D E0                MOVX    A,@DPTR
0F1E FD                MOV     R5,A
0F1F A3                INC     DPTR
0F20 E0                MOVX    A,@DPTR
0F21 FE                MOV     R6,A
0F22 A3                INC     DPTR
0F23 E0                MOVX    A,@DPTR
0F24 F500        R     MOV     pwm_input+03H,A
0F26 8E00        R     MOV     pwm_input+02H,R6
0F28 8D00        R     MOV     pwm_input+01H,R5
0F2A 8C00        R     MOV     pwm_input,R4
                                           ; SOURCE LINE # 805
0F2C E4                CLR     A
0F2D FF                MOV     R7,A
0F2E FE                MOV     R6,A
0F2F FD                MOV     R5,A
0F30 FC                MOV     R4,A
0F31 AB00        R     MOV     R3,pwm_input+03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 80  

0F33 AA00        R     MOV     R2,pwm_input+02H
0F35 A900        R     MOV     R1,pwm_input+01H
0F37 A800        R     MOV     R0,pwm_input
0F39 D3                SETB    C
0F3A 120000      E     LCALL   ?C?SLCMP
0F3D 4004              JC      ?C0131
                                           ; SOURCE LINE # 806
0F3F D200        R     SETB    motor_dir
0F41 8002              SJMP    ?C0132
0F43         ?C0131:
                                           ; SOURCE LINE # 808
0F43 C200        R     CLR     motor_dir
0F45         ?C0132:
                                           ; SOURCE LINE # 812
0F45 74FF              MOV     A,#0FFH
0F47 7F9C              MOV     R7,#09CH
0F49 FE                MOV     R6,A
0F4A FD                MOV     R5,A
0F4B FC                MOV     R4,A
0F4C AB00        R     MOV     R3,pwm_input+03H
0F4E AA00        R     MOV     R2,pwm_input+02H
0F50 A900        R     MOV     R1,pwm_input+01H
0F52 A800        R     MOV     R0,pwm_input
0F54 C3                CLR     C
0F55 120000      E     LCALL   ?C?SLCMP
0F58 500D              JNC     ?C0133
                                           ; SOURCE LINE # 813
0F5A 74FF              MOV     A,#0FFH
0F5C 75009C      R     MOV     pwm_input+03H,#09CH
0F5F F500        R     MOV     pwm_input+02H,A
0F61 F500        R     MOV     pwm_input+01H,A
0F63 F500        R     MOV     pwm_input,A
0F65 801E              SJMP    ?C0086
0F67         ?C0133:
                                           ; SOURCE LINE # 814
0F67 E4                CLR     A
0F68 7F64              MOV     R7,#064H
0F6A FE                MOV     R6,A
0F6B FD                MOV     R5,A
0F6C FC                MOV     R4,A
0F6D AB00        R     MOV     R3,pwm_input+03H
0F6F AA00        R     MOV     R2,pwm_input+02H
0F71 A900        R     MOV     R1,pwm_input+01H
0F73 A800        R     MOV     R0,pwm_input
0F75 D3                SETB    C
0F76 120000      E     LCALL   ?C?SLCMP
0F79 400A              JC      ?C0086
                                           ; SOURCE LINE # 815
0F7B E4                CLR     A
0F7C 750064      R     MOV     pwm_input+03H,#064H
0F7F F500        R     MOV     pwm_input+02H,A
0F81 F500        R     MOV     pwm_input+01H,A
0F83 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 818
                                           ; SOURCE LINE # 820
0F85         ?C0086:
                                           ; SOURCE LINE # 824
0F85 E4                CLR     A
0F86 7F64              MOV     R7,#064H
0F88 FE                MOV     R6,A
0F89 FD                MOV     R5,A
0F8A FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 81  

0F8B AB00        R     MOV     R3,pwm_input+03H
0F8D AA00        R     MOV     R2,pwm_input+02H
0F8F A900        R     MOV     R1,pwm_input+01H
0F91 A800        R     MOV     R0,pwm_input
0F93 D3                SETB    C
0F94 120000      E     LCALL   ?C?SLCMP
0F97 400A              JC      ?C0136
                                           ; SOURCE LINE # 825
0F99 E4                CLR     A
0F9A 750064      R     MOV     pwm_input+03H,#064H
0F9D F500        R     MOV     pwm_input+02H,A
0F9F F500        R     MOV     pwm_input+01H,A
0FA1 F500        R     MOV     pwm_input,A
0FA3         ?C0136:
                                           ; SOURCE LINE # 826
0FA3 74FF              MOV     A,#0FFH
0FA5 7F9C              MOV     R7,#09CH
0FA7 FE                MOV     R6,A
0FA8 FD                MOV     R5,A
0FA9 FC                MOV     R4,A
0FAA AB00        R     MOV     R3,pwm_input+03H
0FAC AA00        R     MOV     R2,pwm_input+02H
0FAE A900        R     MOV     R1,pwm_input+01H
0FB0 A800        R     MOV     R0,pwm_input
0FB2 C3                CLR     C
0FB3 120000      E     LCALL   ?C?SLCMP
0FB6 500B              JNC     ?C0137
                                           ; SOURCE LINE # 827
0FB8 74FF              MOV     A,#0FFH
0FBA 75009C      R     MOV     pwm_input+03H,#09CH
0FBD F500        R     MOV     pwm_input+02H,A
0FBF F500        R     MOV     pwm_input+01H,A
0FC1 F500        R     MOV     pwm_input,A
0FC3         ?C0137:
                                           ; SOURCE LINE # 830
0FC3 900000      E     MOV     DPTR,#c_mem+034H
0FC6 E0                MOVX    A,@DPTR
0FC7 6401              XRL     A,#01H
0FC9 6037              JZ      ?C0138
                                           ; SOURCE LINE # 831
0FCB AF00        R     MOV     R7,pwm_input+03H
0FCD AE00        R     MOV     R6,pwm_input+02H
0FCF AD00        R     MOV     R5,pwm_input+01H
0FD1 AC00        R     MOV     R4,pwm_input
0FD3 780A              MOV     R0,#0AH
0FD5 120000      E     LCALL   ?C?LSHL
0FD8 E4                CLR     A
0FD9 7B64              MOV     R3,#064H
0FDB FA                MOV     R2,A
0FDC F9                MOV     R1,A
0FDD F8                MOV     R0,A
0FDE 120000      E     LCALL   ?C?SLDIV
0FE1 A804              MOV     R0,AR4
0FE3 A905              MOV     R1,AR5
0FE5 AA06              MOV     R2,AR6
0FE7 AB07              MOV     R3,AR7
0FE9 900000      E     MOV     DPTR,#dev_pwm_limit
0FEC E0                MOVX    A,@DPTR
0FED FF                MOV     R7,A
0FEE E4                CLR     A
0FEF FC                MOV     R4,A
0FF0 FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 82  

0FF1 FE                MOV     R6,A
0FF2 120000      E     LCALL   ?C?LMUL
0FF5 780A              MOV     R0,#0AH
0FF7 120000      E     LCALL   ?C?SLSHR
0FFA 8F00        R     MOV     pwm_input+03H,R7
0FFC 8E00        R     MOV     pwm_input+02H,R6
0FFE 8D00        R     MOV     pwm_input+01H,R5
1000 8C00        R     MOV     pwm_input,R4
1002         ?C0138:
                                           ; SOURCE LINE # 834
1002 E4                CLR     A
1003 FF                MOV     R7,A
1004 FE                MOV     R6,A
1005 FD                MOV     R5,A
1006 FC                MOV     R4,A
1007 AB00        R     MOV     R3,pwm_input+03H
1009 AA00        R     MOV     R2,pwm_input+02H
100B A900        R     MOV     R1,pwm_input+01H
100D A800        R     MOV     R0,pwm_input
100F C3                CLR     C
1010 120000      E     LCALL   ?C?SLCMP
1013 4004              JC      ?C0139
1015 7F01              MOV     R7,#01H
1017 8002              SJMP    ?C0140
1019         ?C0139:
1019 7FFF              MOV     R7,#0FFH
101B         ?C0140:
101B 900000      E     MOV     DPTR,#pwm_sign
101E EF                MOV     A,R7
101F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 836
1020 300007            JNB     motor_dir,?C0141
                                           ; SOURCE LINE # 837
1023 7F01              MOV     R7,#01H
1025 120000      E     LCALL   _MOTOR_DIR_Write
1028 8005              SJMP    ?C0142
102A         ?C0141:
                                           ; SOURCE LINE # 839
102A E4                CLR     A
102B FF                MOV     R7,A
102C 120000      E     LCALL   _MOTOR_DIR_Write
102F         ?C0142:
                                           ; SOURCE LINE # 841
102F AE00        R     MOV     R6,pwm_input+02H
1031 AF00        R     MOV     R7,pwm_input+03H
1033 120000      E     LCALL   _abs
1036 120000      E     LCALL   _PWM_MOTORS_WriteCompare1
                                           ; SOURCE LINE # 842
1039 22                RET     
             ; FUNCTION motor_control (END)

             ; FUNCTION _encoder_reading (BEGIN)
                                           ; SOURCE LINE # 848
;---- Variable 'idx' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 850
0000 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 877
0002 E500        R     MOV     A,index
0004 C3                CLR     C
0005 9403              SUBB    A,#03H
0007 4003              JC      $ + 5H
0009 020000      R     LJMP    ?C0145
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 83  

000C         ?C0144:
                                           ; SOURCE LINE # 880
000C 300022            JNB     reset_last_value_flag,?C0146
                                           ; SOURCE LINE # 881
;---- Variable 'jj' assigned to Register 'R3' ----
000F 7B03              MOV     R3,#03H
0011         ?C0147:
0011 AF03              MOV     R7,AR3
0013 1B                DEC     R3
0014 EF                MOV     A,R7
0015 6018              JZ      ?C0148
                                           ; SOURCE LINE # 882
0017 E4                CLR     A
0018 FF                MOV     R7,A
0019 FE                MOV     R6,A
001A FD                MOV     R5,A
001B FC                MOV     R4,A
001C EB                MOV     A,R3
001D 25E0              ADD     A,ACC
001F 25E0              ADD     A,ACC
0021 2400        R     ADD     A,#LOW last_value_encoder
0023 F582              MOV     DPL,A
0025 E4                CLR     A
0026 3400        R     ADDC    A,#HIGH last_value_encoder
0028 F583              MOV     DPH,A
002A 120000      E     LCALL   ?C?LSTXDATA
002D 80E2              SJMP    ?C0147
002F         ?C0148:
                                           ; SOURCE LINE # 884
002F C200        E     CLR     reset_last_value_flag
                                           ; SOURCE LINE # 885
0031         ?C0146:
                                           ; SOURCE LINE # 889
0031 E500        R     MOV     A,index
0033 7018              JNZ     ?C0149
                                           ; SOURCE LINE # 890
0035 120000      E     LCALL   SHIFTREG_ENC_1_ReadData
0038 7801              MOV     R0,#01H
003A 120000      E     LCALL   ?C?ULSHR
003D EF                MOV     A,R7
003E EE                MOV     A,R6
003F ED                MOV     A,R5
0040 5403              ANL     A,#03H
0042 FD                MOV     R5,A
0043 E4                CLR     A
0044 FC                MOV     R4,A
0045 900000      R     MOV     DPTR,#data_encoder
0048 120000      E     LCALL   ?C?LSTXDATA
004B 8033              SJMP    ?C0150
004D         ?C0149:
                                           ; SOURCE LINE # 891
                                           ; SOURCE LINE # 892
004D E500        R     MOV     A,index
004F B40118            CJNE    A,#01H,?C0151
                                           ; SOURCE LINE # 893
0052 120000      E     LCALL   SHIFTREG_ENC_2_ReadData
0055 7801              MOV     R0,#01H
0057 120000      E     LCALL   ?C?ULSHR
005A EF                MOV     A,R7
005B EE                MOV     A,R6
005C ED                MOV     A,R5
005D 5403              ANL     A,#03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 84  

005F FD                MOV     R5,A
0060 E4                CLR     A
0061 FC                MOV     R4,A
0062 900000      R     MOV     DPTR,#data_encoder
0065 120000      E     LCALL   ?C?LSTXDATA
0068 8016              SJMP    ?C0150
006A         ?C0151:
                                           ; SOURCE LINE # 895
006A 120000      E     LCALL   SHIFTREG_ENC_3_ReadData
006D 7801              MOV     R0,#01H
006F 120000      E     LCALL   ?C?ULSHR
0072 EF                MOV     A,R7
0073 EE                MOV     A,R6
0074 ED                MOV     A,R5
0075 5403              ANL     A,#03H
0077 FD                MOV     R5,A
0078 E4                CLR     A
0079 FC                MOV     R4,A
007A 900000      R     MOV     DPTR,#data_encoder
007D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 896
0080         ?C0150:
                                           ; SOURCE LINE # 899
0080 7B01              MOV     R3,#01H
0082 7A00        R     MOV     R2,#HIGH data_encoder
0084 7900        R     MOV     R1,#LOW data_encoder
0086 120000      E     LCALL   _check_enc_data
0089 4003              JC      $ + 5H
008B 020000      R     LJMP    ?C0153
                                           ; SOURCE LINE # 901
008E 900000      R     MOV     DPTR,#data_encoder
0091 E0                MOVX    A,@DPTR
0092 FC                MOV     R4,A
0093 A3                INC     DPTR
0094 E0                MOVX    A,@DPTR
0095 FD                MOV     R5,A
0096 A3                INC     DPTR
0097 E0                MOVX    A,@DPTR
0098 FE                MOV     R6,A
0099 A3                INC     DPTR
009A E0                MOVX    A,@DPTR
009B 54C0              ANL     A,#0C0H
009D FF                MOV     R7,A
009E EE                MOV     A,R6
009F ED                MOV     A,R5
00A0 5403              ANL     A,#03H
00A2 FD                MOV     R5,A
00A3 E4                CLR     A
00A4 2F                ADD     A,R7
00A5 FF                MOV     R7,A
00A6 E4                CLR     A
00A7 3E                ADDC    A,R6
00A8 FE                MOV     R6,A
00A9 ED                MOV     A,R5
00AA 34FE              ADDC    A,#0FEH
00AC FD                MOV     R5,A
00AD E4                CLR     A
00AE 34FF              ADDC    A,#0FFH
00B0 FC                MOV     R4,A
00B1 7802              MOV     R0,#02H
00B3 120000      E     LCALL   ?C?ULSHR
00B6 EE                MOV     A,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 85  

00B7 33                RLC     A
00B8 95E0              SUBB    A,ACC
00BA FD                MOV     R5,A
00BB FC                MOV     R4,A
00BC E500        R     MOV     A,index
00BE 25E0              ADD     A,ACC
00C0 25E0              ADD     A,ACC
00C2 2400        E     ADD     A,#LOW g_mem+038H
00C4 F582              MOV     DPL,A
00C6 E4                CLR     A
00C7 3400        E     ADDC    A,#HIGH g_mem+038H
00C9 F583              MOV     DPH,A
00CB E0                MOVX    A,@DPTR
00CC F8                MOV     R0,A
00CD A3                INC     DPTR
00CE E0                MOVX    A,@DPTR
00CF F9                MOV     R1,A
00D0 A3                INC     DPTR
00D1 E0                MOVX    A,@DPTR
00D2 FA                MOV     R2,A
00D3 A3                INC     DPTR
00D4 E0                MOVX    A,@DPTR
00D5 2F                ADD     A,R7
00D6 FF                MOV     R7,A
00D7 EA                MOV     A,R2
00D8 3E                ADDC    A,R6
00D9 FE                MOV     R6,A
00DA E9                MOV     A,R1
00DB 3D                ADDC    A,R5
00DC FD                MOV     R5,A
00DD E8                MOV     A,R0
00DE 3C                ADDC    A,R4
00DF FC                MOV     R4,A
00E0 900000      R     MOV     DPTR,#value_encoder
00E3 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 908
00E6 300027            JNB     only_first_time,?C0154
                                           ; SOURCE LINE # 909
00E9 900000      R     MOV     DPTR,#value_encoder
00EC E0                MOVX    A,@DPTR
00ED FC                MOV     R4,A
00EE A3                INC     DPTR
00EF E0                MOVX    A,@DPTR
00F0 FD                MOV     R5,A
00F1 A3                INC     DPTR
00F2 E0                MOVX    A,@DPTR
00F3 FE                MOV     R6,A
00F4 A3                INC     DPTR
00F5 E0                MOVX    A,@DPTR
00F6 FF                MOV     R7,A
00F7 E500        R     MOV     A,index
00F9 25E0              ADD     A,ACC
00FB 25E0              ADD     A,ACC
00FD 2400        R     ADD     A,#LOW last_value_encoder
00FF F582              MOV     DPL,A
0101 E4                CLR     A
0102 3400        R     ADDC    A,#HIGH last_value_encoder
0104 F583              MOV     DPH,A
0106 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 910
0109 E500        R     MOV     A,index
010B B40202            CJNE    A,#02H,?C0154
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 86  

                                           ; SOURCE LINE # 911
010E C200        R     CLR     only_first_time
                                           ; SOURCE LINE # 912
0110         ?C0154:
                                           ; SOURCE LINE # 915
0110 E500        R     MOV     A,index
0112 25E0              ADD     A,ACC
0114 25E0              ADD     A,ACC
0116 2400        R     ADD     A,#LOW last_value_encoder
0118 F582              MOV     DPL,A
011A E4                CLR     A
011B 3400        R     ADDC    A,#HIGH last_value_encoder
011D F583              MOV     DPH,A
011F E0                MOVX    A,@DPTR
0120 F8                MOV     R0,A
0121 A3                INC     DPTR
0122 E0                MOVX    A,@DPTR
0123 F9                MOV     R1,A
0124 A3                INC     DPTR
0125 E0                MOVX    A,@DPTR
0126 FA                MOV     R2,A
0127 A3                INC     DPTR
0128 E0                MOVX    A,@DPTR
0129 FB                MOV     R3,A
012A 900000      R     MOV     DPTR,#value_encoder
012D E0                MOVX    A,@DPTR
012E FC                MOV     R4,A
012F A3                INC     DPTR
0130 E0                MOVX    A,@DPTR
0131 FD                MOV     R5,A
0132 A3                INC     DPTR
0133 E0                MOVX    A,@DPTR
0134 FE                MOV     R6,A
0135 A3                INC     DPTR
0136 E0                MOVX    A,@DPTR
0137 C3                CLR     C
0138 9B                SUBB    A,R3
0139 FF                MOV     R7,A
013A EE                MOV     A,R6
013B 9A                SUBB    A,R2
013C FE                MOV     R6,A
013D ED                MOV     A,R5
013E 99                SUBB    A,R1
013F FD                MOV     R5,A
0140 EC                MOV     A,R4
0141 98                SUBB    A,R0
0142 FC                MOV     R4,A
0143 900000      R     MOV     DPTR,#aux
0146 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 935
0149 E4                CLR     A
014A FF                MOV     R7,A
014B 7EC0              MOV     R6,#0C0H
014D FD                MOV     R5,A
014E FC                MOV     R4,A
014F 900000      R     MOV     DPTR,#aux
0152 E0                MOVX    A,@DPTR
0153 F8                MOV     R0,A
0154 A3                INC     DPTR
0155 E0                MOVX    A,@DPTR
0156 F9                MOV     R1,A
0157 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 87  

0158 E0                MOVX    A,@DPTR
0159 FA                MOV     R2,A
015A A3                INC     DPTR
015B E0                MOVX    A,@DPTR
015C FB                MOV     R3,A
015D D3                SETB    C
015E 120000      E     LCALL   ?C?SLCMP
0161 4010              JC      ?C0156
                                           ; SOURCE LINE # 936
0163 7400        E     MOV     A,#LOW g_meas+014H
0165 2500        R     ADD     A,index
0167 F582              MOV     DPL,A
0169 E4                CLR     A
016A 3400        E     ADDC    A,#HIGH g_meas+014H
016C F583              MOV     DPH,A
016E E0                MOVX    A,@DPTR
016F 14                DEC     A
0170 F0                MOVX    @DPTR,A
0171 8068              SJMP    ?C0157
0173         ?C0156:
                                           ; SOURCE LINE # 937
                                           ; SOURCE LINE # 938
0173 7F00              MOV     R7,#00H
0175 7E40              MOV     R6,#040H
0177 7DFF              MOV     R5,#0FFH
0179 7CFF              MOV     R4,#0FFH
017B 900000      R     MOV     DPTR,#aux
017E E0                MOVX    A,@DPTR
017F F8                MOV     R0,A
0180 A3                INC     DPTR
0181 E0                MOVX    A,@DPTR
0182 F9                MOV     R1,A
0183 A3                INC     DPTR
0184 E0                MOVX    A,@DPTR
0185 FA                MOV     R2,A
0186 A3                INC     DPTR
0187 E0                MOVX    A,@DPTR
0188 FB                MOV     R3,A
0189 C3                CLR     C
018A 120000      E     LCALL   ?C?SLCMP
018D 5010              JNC     ?C0158
                                           ; SOURCE LINE # 939
018F 7400        E     MOV     A,#LOW g_meas+014H
0191 2500        R     ADD     A,index
0193 F582              MOV     DPL,A
0195 E4                CLR     A
0196 3400        E     ADDC    A,#HIGH g_meas+014H
0198 F583              MOV     DPH,A
019A E0                MOVX    A,@DPTR
019B 04                INC     A
019C F0                MOVX    @DPTR,A
019D 803C              SJMP    ?C0157
019F         ?C0158:
                                           ; SOURCE LINE # 940
                                           ; SOURCE LINE # 941
019F 900000      R     MOV     DPTR,#aux
01A2 E0                MOVX    A,@DPTR
01A3 A3                INC     DPTR
01A4 E0                MOVX    A,@DPTR
01A5 A3                INC     DPTR
01A6 E0                MOVX    A,@DPTR
01A7 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 88  

01A8 A3                INC     DPTR
01A9 E0                MOVX    A,@DPTR
01AA FF                MOV     R7,A
01AB 120000      E     LCALL   _abs
01AE D3                SETB    C
01AF EF                MOV     A,R7
01B0 9400              SUBB    A,#00H
01B2 EE                MOV     A,R6
01B3 6480              XRL     A,#080H
01B5 94C0              SUBB    A,#0C0H
01B7 4022              JC      ?C0157
                                           ; SOURCE LINE # 942
01B9 7400        R     MOV     A,#LOW error
01BB 2500        R     ADD     A,index
01BD F582              MOV     DPL,A
01BF E4                CLR     A
01C0 3400        R     ADDC    A,#HIGH error
01C2 F583              MOV     DPH,A
01C4 E0                MOVX    A,@DPTR
01C5 04                INC     A
01C6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 943
01C7 7400        R     MOV     A,#LOW error
01C9 2500        R     ADD     A,index
01CB F582              MOV     DPL,A
01CD E4                CLR     A
01CE 3400        R     ADDC    A,#HIGH error
01D0 F583              MOV     DPH,A
01D2 E0                MOVX    A,@DPTR
01D3 C3                CLR     C
01D4 940A              SUBB    A,#0AH
01D6 5003              JNC     $ + 5H
01D8 020000      R     LJMP    ?C0145
01DB         ?C0161:
                                           ; SOURCE LINE # 946
                                           ; SOURCE LINE # 947
                                           ; SOURCE LINE # 948
01DB         ?C0157:
                                           ; SOURCE LINE # 950
01DB 7400        R     MOV     A,#LOW error
01DD 2500        R     ADD     A,index
01DF F582              MOV     DPL,A
01E1 E4                CLR     A
01E2 3400        R     ADDC    A,#HIGH error
01E4 F583              MOV     DPH,A
01E6 E4                CLR     A
01E7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 952
01E8 900000      R     MOV     DPTR,#value_encoder
01EB E0                MOVX    A,@DPTR
01EC FC                MOV     R4,A
01ED A3                INC     DPTR
01EE E0                MOVX    A,@DPTR
01EF FD                MOV     R5,A
01F0 A3                INC     DPTR
01F1 E0                MOVX    A,@DPTR
01F2 FE                MOV     R6,A
01F3 A3                INC     DPTR
01F4 E0                MOVX    A,@DPTR
01F5 FF                MOV     R7,A
01F6 E500        R     MOV     A,index
01F8 25E0              ADD     A,ACC
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 89  

01FA 25E0              ADD     A,ACC
01FC 2400        R     ADD     A,#LOW last_value_encoder
01FE F582              MOV     DPL,A
0200 E4                CLR     A
0201 3400        R     ADDC    A,#HIGH last_value_encoder
0203 F583              MOV     DPH,A
0205 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 954
0208 900000      R     MOV     DPTR,#value_encoder
020B E0                MOVX    A,@DPTR
020C F8                MOV     R0,A
020D A3                INC     DPTR
020E E0                MOVX    A,@DPTR
020F F9                MOV     R1,A
0210 A3                INC     DPTR
0211 E0                MOVX    A,@DPTR
0212 FA                MOV     R2,A
0213 A3                INC     DPTR
0214 E0                MOVX    A,@DPTR
0215 FB                MOV     R3,A
0216 C000              PUSH    AR0
0218 7400        E     MOV     A,#LOW g_meas+014H
021A 2500        R     ADD     A,index
021C F582              MOV     DPL,A
021E E4                CLR     A
021F 3400        E     ADDC    A,#HIGH g_meas+014H
0221 F583              MOV     DPH,A
0223 E0                MOVX    A,@DPTR
0224 FF                MOV     R7,A
0225 33                RLC     A
0226 95E0              SUBB    A,ACC
0228 FE                MOV     R6,A
0229 FD                MOV     R5,A
022A FC                MOV     R4,A
022B 7810              MOV     R0,#010H
022D 120000      E     LCALL   ?C?LSHL
0230 D000              POP     AR0
0232 EB                MOV     A,R3
0233 2F                ADD     A,R7
0234 FF                MOV     R7,A
0235 EA                MOV     A,R2
0236 3E                ADDC    A,R6
0237 FE                MOV     R6,A
0238 E9                MOV     A,R1
0239 3D                ADDC    A,R5
023A FD                MOV     R5,A
023B E8                MOV     A,R0
023C 3C                ADDC    A,R4
023D FC                MOV     R4,A
023E 900000      R     MOV     DPTR,#value_encoder
0241 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 956
0244 E500        R     MOV     A,index
0246 25E0              ADD     A,ACC
0248 25E0              ADD     A,ACC
024A 2400        E     ADD     A,#LOW c_mem+044H
024C F582              MOV     DPL,A
024E E4                CLR     A
024F 3400        E     ADDC    A,#HIGH c_mem+044H
0251 F583              MOV     DPH,A
0253 E0                MOVX    A,@DPTR
0254 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 90  

0255 A3                INC     DPTR
0256 E0                MOVX    A,@DPTR
0257 FD                MOV     R5,A
0258 A3                INC     DPTR
0259 E0                MOVX    A,@DPTR
025A FE                MOV     R6,A
025B A3                INC     DPTR
025C E0                MOVX    A,@DPTR
025D FF                MOV     R7,A
025E E4                CLR     A
025F FB                MOV     R3,A
0260 FA                MOV     R2,A
0261 7980              MOV     R1,#080H
0263 783F              MOV     R0,#03FH
0265 120000      E     LCALL   ?C?FPCMP3
0268 6038              JZ      ?C0162
                                           ; SOURCE LINE # 957
026A 900000      R     MOV     DPTR,#value_encoder
026D E0                MOVX    A,@DPTR
026E FC                MOV     R4,A
026F A3                INC     DPTR
0270 E0                MOVX    A,@DPTR
0271 FD                MOV     R5,A
0272 A3                INC     DPTR
0273 E0                MOVX    A,@DPTR
0274 FE                MOV     R6,A
0275 A3                INC     DPTR
0276 E0                MOVX    A,@DPTR
0277 FF                MOV     R7,A
0278 EC                MOV     A,R4
0279 120000      E     LCALL   ?C?FCASTL
027C E500        R     MOV     A,index
027E 25E0              ADD     A,ACC
0280 25E0              ADD     A,ACC
0282 2400        E     ADD     A,#LOW c_mem+044H
0284 F582              MOV     DPL,A
0286 E4                CLR     A
0287 3400        E     ADDC    A,#HIGH c_mem+044H
0289 F583              MOV     DPH,A
028B E0                MOVX    A,@DPTR
028C F8                MOV     R0,A
028D A3                INC     DPTR
028E E0                MOVX    A,@DPTR
028F F9                MOV     R1,A
0290 A3                INC     DPTR
0291 E0                MOVX    A,@DPTR
0292 FA                MOV     R2,A
0293 A3                INC     DPTR
0294 E0                MOVX    A,@DPTR
0295 FB                MOV     R3,A
0296 120000      E     LCALL   ?C?FPMUL
0299 120000      E     LCALL   ?C?CASTF
029C 900000      R     MOV     DPTR,#value_encoder
029F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 958
02A2         ?C0162:
                                           ; SOURCE LINE # 960
02A2 900000      R     MOV     DPTR,#value_encoder
02A5 E0                MOVX    A,@DPTR
02A6 FC                MOV     R4,A
02A7 A3                INC     DPTR
02A8 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 91  

02A9 FD                MOV     R5,A
02AA A3                INC     DPTR
02AB E0                MOVX    A,@DPTR
02AC FE                MOV     R6,A
02AD A3                INC     DPTR
02AE E0                MOVX    A,@DPTR
02AF FF                MOV     R7,A
02B0 E500        R     MOV     A,index
02B2 25E0              ADD     A,ACC
02B4 25E0              ADD     A,ACC
02B6 2400        E     ADD     A,#LOW g_meas
02B8 F582              MOV     DPL,A
02BA E4                CLR     A
02BB 3400        E     ADDC    A,#HIGH g_meas
02BD F583              MOV     DPH,A
02BF 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 961
02C2         ?C0153:
                                           ; SOURCE LINE # 963
02C2 E500        R     MOV     A,index
02C4 14                DEC     A
02C5 7003              JNZ     $ + 5H
02C7 020000      R     LJMP    ?C0165
02CA 14                DEC     A
02CB 7003              JNZ     $ + 5H
02CD 020000      R     LJMP    ?C0166
02D0 2402              ADD     A,#02H
02D2 6003              JZ      $ + 5H
02D4 020000      R     LJMP    ?C0163
                                           ; SOURCE LINE # 964
02D7         ?C0164:
                                           ; SOURCE LINE # 965
02D7 E4                CLR     A
02D8 7F03              MOV     R7,#03H
02DA FE                MOV     R6,A
02DB FD                MOV     R5,A
02DC FC                MOV     R4,A
02DD 900000      R     MOV     DPTR,#value_encoder
02E0 E0                MOVX    A,@DPTR
02E1 F8                MOV     R0,A
02E2 A3                INC     DPTR
02E3 E0                MOVX    A,@DPTR
02E4 F9                MOV     R1,A
02E5 A3                INC     DPTR
02E6 E0                MOVX    A,@DPTR
02E7 FA                MOV     R2,A
02E8 A3                INC     DPTR
02E9 E0                MOVX    A,@DPTR
02EA FB                MOV     R3,A
02EB 120000      E     LCALL   ?C?LMUL
02EE 900000      R     MOV     DPTR,#v_value
02F1 E0                MOVX    A,@DPTR
02F2 F8                MOV     R0,A
02F3 A3                INC     DPTR
02F4 E0                MOVX    A,@DPTR
02F5 F9                MOV     R1,A
02F6 A3                INC     DPTR
02F7 E0                MOVX    A,@DPTR
02F8 FA                MOV     R2,A
02F9 A3                INC     DPTR
02FA E0                MOVX    A,@DPTR
02FB 2F                ADD     A,R7
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 92  

02FC FF                MOV     R7,A
02FD EA                MOV     A,R2
02FE 3E                ADDC    A,R6
02FF FE                MOV     R6,A
0300 E9                MOV     A,R1
0301 3D                ADDC    A,R5
0302 FD                MOV     R5,A
0303 E8                MOV     A,R0
0304 3C                ADDC    A,R4
0305 FC                MOV     R4,A
0306 900000      R     MOV     DPTR,#vv_value
0309 E0                MOVX    A,@DPTR
030A F8                MOV     R0,A
030B A3                INC     DPTR
030C E0                MOVX    A,@DPTR
030D F9                MOV     R1,A
030E A3                INC     DPTR
030F E0                MOVX    A,@DPTR
0310 FA                MOV     R2,A
0311 A3                INC     DPTR
0312 E0                MOVX    A,@DPTR
0313 FB                MOV     R3,A
0314 C3                CLR     C
0315 EF                MOV     A,R7
0316 9B                SUBB    A,R3
0317 FF                MOV     R7,A
0318 EE                MOV     A,R6
0319 9A                SUBB    A,R2
031A FE                MOV     R6,A
031B ED                MOV     A,R5
031C 99                SUBB    A,R1
031D FD                MOV     R5,A
031E EC                MOV     A,R4
031F 98                SUBB    A,R0
0320 FC                MOV     R4,A
0321 C004              PUSH    AR4
0323 C005              PUSH    AR5
0325 C006              PUSH    AR6
0327 C007              PUSH    AR7
0329 E4                CLR     A
032A 7F03              MOV     R7,#03H
032C FE                MOV     R6,A
032D FD                MOV     R5,A
032E FC                MOV     R4,A
032F 900000      R     MOV     DPTR,#vvv_value
0332 E0                MOVX    A,@DPTR
0333 F8                MOV     R0,A
0334 A3                INC     DPTR
0335 E0                MOVX    A,@DPTR
0336 F9                MOV     R1,A
0337 A3                INC     DPTR
0338 E0                MOVX    A,@DPTR
0339 FA                MOV     R2,A
033A A3                INC     DPTR
033B E0                MOVX    A,@DPTR
033C FB                MOV     R3,A
033D 120000      E     LCALL   ?C?LMUL
0340 A804              MOV     R0,AR4
0342 A905              MOV     R1,AR5
0344 AA06              MOV     R2,AR6
0346 AB07              MOV     R3,AR7
0348 D007              POP     AR7
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 93  

034A D006              POP     AR6
034C D005              POP     AR5
034E D004              POP     AR4
0350 C3                CLR     C
0351 EF                MOV     A,R7
0352 9B                SUBB    A,R3
0353 FF                MOV     R7,A
0354 EE                MOV     A,R6
0355 9A                SUBB    A,R2
0356 FE                MOV     R6,A
0357 ED                MOV     A,R5
0358 99                SUBB    A,R1
0359 FD                MOV     R5,A
035A EC                MOV     A,R4
035B 98                SUBB    A,R0
035C FC                MOV     R4,A
035D E4                CLR     A
035E 7B0A              MOV     R3,#0AH
0360 FA                MOV     R2,A
0361 F9                MOV     R1,A
0362 F8                MOV     R0,A
0363 120000      E     LCALL   ?C?LMUL
0366 120000      E     LCALL   _filter_vel_1
0369 EE                MOV     A,R6
036A 33                RLC     A
036B 95E0              SUBB    A,ACC
036D FD                MOV     R5,A
036E FC                MOV     R4,A
036F 900000      R     MOV     DPTR,#speed_encoder
0372 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 966
0375 020000      R     LJMP    ?C0163
                                           ; SOURCE LINE # 967
                                           ; SOURCE LINE # 968
0378         ?C0165:
                                           ; SOURCE LINE # 969
0378 E4                CLR     A
0379 7F03              MOV     R7,#03H
037B FE                MOV     R6,A
037C FD                MOV     R5,A
037D FC                MOV     R4,A
037E 900000      R     MOV     DPTR,#value_encoder
0381 E0                MOVX    A,@DPTR
0382 F8                MOV     R0,A
0383 A3                INC     DPTR
0384 E0                MOVX    A,@DPTR
0385 F9                MOV     R1,A
0386 A3                INC     DPTR
0387 E0                MOVX    A,@DPTR
0388 FA                MOV     R2,A
0389 A3                INC     DPTR
038A E0                MOVX    A,@DPTR
038B FB                MOV     R3,A
038C 120000      E     LCALL   ?C?LMUL
038F 900000      R     MOV     DPTR,#v_value+04H
0392 E0                MOVX    A,@DPTR
0393 F8                MOV     R0,A
0394 A3                INC     DPTR
0395 E0                MOVX    A,@DPTR
0396 F9                MOV     R1,A
0397 A3                INC     DPTR
0398 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 94  

0399 FA                MOV     R2,A
039A A3                INC     DPTR
039B E0                MOVX    A,@DPTR
039C 2F                ADD     A,R7
039D FF                MOV     R7,A
039E EA                MOV     A,R2
039F 3E                ADDC    A,R6
03A0 FE                MOV     R6,A
03A1 E9                MOV     A,R1
03A2 3D                ADDC    A,R5
03A3 FD                MOV     R5,A
03A4 E8                MOV     A,R0
03A5 3C                ADDC    A,R4
03A6 FC                MOV     R4,A
03A7 900000      R     MOV     DPTR,#vv_value+04H
03AA E0                MOVX    A,@DPTR
03AB F8                MOV     R0,A
03AC A3                INC     DPTR
03AD E0                MOVX    A,@DPTR
03AE F9                MOV     R1,A
03AF A3                INC     DPTR
03B0 E0                MOVX    A,@DPTR
03B1 FA                MOV     R2,A
03B2 A3                INC     DPTR
03B3 E0                MOVX    A,@DPTR
03B4 FB                MOV     R3,A
03B5 C3                CLR     C
03B6 EF                MOV     A,R7
03B7 9B                SUBB    A,R3
03B8 FF                MOV     R7,A
03B9 EE                MOV     A,R6
03BA 9A                SUBB    A,R2
03BB FE                MOV     R6,A
03BC ED                MOV     A,R5
03BD 99                SUBB    A,R1
03BE FD                MOV     R5,A
03BF EC                MOV     A,R4
03C0 98                SUBB    A,R0
03C1 FC                MOV     R4,A
03C2 C004              PUSH    AR4
03C4 C005              PUSH    AR5
03C6 C006              PUSH    AR6
03C8 C007              PUSH    AR7
03CA E4                CLR     A
03CB 7F03              MOV     R7,#03H
03CD FE                MOV     R6,A
03CE FD                MOV     R5,A
03CF FC                MOV     R4,A
03D0 900000      R     MOV     DPTR,#vvv_value+04H
03D3 E0                MOVX    A,@DPTR
03D4 F8                MOV     R0,A
03D5 A3                INC     DPTR
03D6 E0                MOVX    A,@DPTR
03D7 F9                MOV     R1,A
03D8 A3                INC     DPTR
03D9 E0                MOVX    A,@DPTR
03DA FA                MOV     R2,A
03DB A3                INC     DPTR
03DC E0                MOVX    A,@DPTR
03DD FB                MOV     R3,A
03DE 120000      E     LCALL   ?C?LMUL
03E1 A804              MOV     R0,AR4
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 95  

03E3 A905              MOV     R1,AR5
03E5 AA06              MOV     R2,AR6
03E7 AB07              MOV     R3,AR7
03E9 D007              POP     AR7
03EB D006              POP     AR6
03ED D005              POP     AR5
03EF D004              POP     AR4
03F1 C3                CLR     C
03F2 EF                MOV     A,R7
03F3 9B                SUBB    A,R3
03F4 FF                MOV     R7,A
03F5 EE                MOV     A,R6
03F6 9A                SUBB    A,R2
03F7 FE                MOV     R6,A
03F8 ED                MOV     A,R5
03F9 99                SUBB    A,R1
03FA FD                MOV     R5,A
03FB EC                MOV     A,R4
03FC 98                SUBB    A,R0
03FD FC                MOV     R4,A
03FE E4                CLR     A
03FF 7B0A              MOV     R3,#0AH
0401 FA                MOV     R2,A
0402 F9                MOV     R1,A
0403 F8                MOV     R0,A
0404 120000      E     LCALL   ?C?LMUL
0407 120000      E     LCALL   _filter_vel_2
040A EE                MOV     A,R6
040B 33                RLC     A
040C 95E0              SUBB    A,ACC
040E FD                MOV     R5,A
040F FC                MOV     R4,A
0410 900000      R     MOV     DPTR,#speed_encoder
0413 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 970
0416 020000      R     LJMP    ?C0163
                                           ; SOURCE LINE # 971
                                           ; SOURCE LINE # 972
0419         ?C0166:
                                           ; SOURCE LINE # 973
0419 E4                CLR     A
041A 7F03              MOV     R7,#03H
041C FE                MOV     R6,A
041D FD                MOV     R5,A
041E FC                MOV     R4,A
041F 900000      R     MOV     DPTR,#value_encoder
0422 E0                MOVX    A,@DPTR
0423 F8                MOV     R0,A
0424 A3                INC     DPTR
0425 E0                MOVX    A,@DPTR
0426 F9                MOV     R1,A
0427 A3                INC     DPTR
0428 E0                MOVX    A,@DPTR
0429 FA                MOV     R2,A
042A A3                INC     DPTR
042B E0                MOVX    A,@DPTR
042C FB                MOV     R3,A
042D 120000      E     LCALL   ?C?LMUL
0430 900000      R     MOV     DPTR,#v_value+08H
0433 E0                MOVX    A,@DPTR
0434 F8                MOV     R0,A
0435 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 96  

0436 E0                MOVX    A,@DPTR
0437 F9                MOV     R1,A
0438 A3                INC     DPTR
0439 E0                MOVX    A,@DPTR
043A FA                MOV     R2,A
043B A3                INC     DPTR
043C E0                MOVX    A,@DPTR
043D 2F                ADD     A,R7
043E FF                MOV     R7,A
043F EA                MOV     A,R2
0440 3E                ADDC    A,R6
0441 FE                MOV     R6,A
0442 E9                MOV     A,R1
0443 3D                ADDC    A,R5
0444 FD                MOV     R5,A
0445 E8                MOV     A,R0
0446 3C                ADDC    A,R4
0447 FC                MOV     R4,A
0448 900000      R     MOV     DPTR,#vv_value+08H
044B E0                MOVX    A,@DPTR
044C F8                MOV     R0,A
044D A3                INC     DPTR
044E E0                MOVX    A,@DPTR
044F F9                MOV     R1,A
0450 A3                INC     DPTR
0451 E0                MOVX    A,@DPTR
0452 FA                MOV     R2,A
0453 A3                INC     DPTR
0454 E0                MOVX    A,@DPTR
0455 FB                MOV     R3,A
0456 C3                CLR     C
0457 EF                MOV     A,R7
0458 9B                SUBB    A,R3
0459 FF                MOV     R7,A
045A EE                MOV     A,R6
045B 9A                SUBB    A,R2
045C FE                MOV     R6,A
045D ED                MOV     A,R5
045E 99                SUBB    A,R1
045F FD                MOV     R5,A
0460 EC                MOV     A,R4
0461 98                SUBB    A,R0
0462 FC                MOV     R4,A
0463 C004              PUSH    AR4
0465 C005              PUSH    AR5
0467 C006              PUSH    AR6
0469 C007              PUSH    AR7
046B E4                CLR     A
046C 7F03              MOV     R7,#03H
046E FE                MOV     R6,A
046F FD                MOV     R5,A
0470 FC                MOV     R4,A
0471 900000      R     MOV     DPTR,#vvv_value+08H
0474 E0                MOVX    A,@DPTR
0475 F8                MOV     R0,A
0476 A3                INC     DPTR
0477 E0                MOVX    A,@DPTR
0478 F9                MOV     R1,A
0479 A3                INC     DPTR
047A E0                MOVX    A,@DPTR
047B FA                MOV     R2,A
047C A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 97  

047D E0                MOVX    A,@DPTR
047E FB                MOV     R3,A
047F 120000      E     LCALL   ?C?LMUL
0482 A804              MOV     R0,AR4
0484 A905              MOV     R1,AR5
0486 AA06              MOV     R2,AR6
0488 AB07              MOV     R3,AR7
048A D007              POP     AR7
048C D006              POP     AR6
048E D005              POP     AR5
0490 D004              POP     AR4
0492 C3                CLR     C
0493 EF                MOV     A,R7
0494 9B                SUBB    A,R3
0495 FF                MOV     R7,A
0496 EE                MOV     A,R6
0497 9A                SUBB    A,R2
0498 FE                MOV     R6,A
0499 ED                MOV     A,R5
049A 99                SUBB    A,R1
049B FD                MOV     R5,A
049C EC                MOV     A,R4
049D 98                SUBB    A,R0
049E FC                MOV     R4,A
049F E4                CLR     A
04A0 7B0A              MOV     R3,#0AH
04A2 FA                MOV     R2,A
04A3 F9                MOV     R1,A
04A4 F8                MOV     R0,A
04A5 120000      E     LCALL   ?C?LMUL
04A8 120000      E     LCALL   _filter_vel_3
04AB EE                MOV     A,R6
04AC 33                RLC     A
04AD 95E0              SUBB    A,ACC
04AF FD                MOV     R5,A
04B0 FC                MOV     R4,A
04B1 900000      R     MOV     DPTR,#speed_encoder
04B4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 974
                                           ; SOURCE LINE # 975
                                           ; SOURCE LINE # 976
04B7         ?C0163:
                                           ; SOURCE LINE # 978
04B7 900000      R     MOV     DPTR,#speed_encoder
04BA E0                MOVX    A,@DPTR
04BB FC                MOV     R4,A
04BC A3                INC     DPTR
04BD E0                MOVX    A,@DPTR
04BE FD                MOV     R5,A
04BF A3                INC     DPTR
04C0 E0                MOVX    A,@DPTR
04C1 FE                MOV     R6,A
04C2 A3                INC     DPTR
04C3 E0                MOVX    A,@DPTR
04C4 FF                MOV     R7,A
04C5 E500        R     MOV     A,index
04C7 25E0              ADD     A,ACC
04C9 25E0              ADD     A,ACC
04CB 2400        E     ADD     A,#LOW g_meas+01FH
04CD F582              MOV     DPL,A
04CF E4                CLR     A
04D0 3400        E     ADDC    A,#HIGH g_meas+01FH
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 98  

04D2 F583              MOV     DPH,A
04D4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 981
04D7 E500        R     MOV     A,index
04D9 14                DEC     A
04DA 7003              JNZ     $ + 5H
04DC 020000      R     LJMP    ?C0169
04DF 14                DEC     A
04E0 7003              JNZ     $ + 5H
04E2 020000      R     LJMP    ?C0170
04E5 2402              ADD     A,#02H
04E7 6003              JZ      $ + 5H
04E9 020000      R     LJMP    ?C0167
                                           ; SOURCE LINE # 982
04EC         ?C0168:
                                           ; SOURCE LINE # 983
04EC E4                CLR     A
04ED 7F03              MOV     R7,#03H
04EF FE                MOV     R6,A
04F0 FD                MOV     R5,A
04F1 FC                MOV     R4,A
04F2 900000      R     MOV     DPTR,#speed_encoder
04F5 E0                MOVX    A,@DPTR
04F6 F8                MOV     R0,A
04F7 A3                INC     DPTR
04F8 E0                MOVX    A,@DPTR
04F9 F9                MOV     R1,A
04FA A3                INC     DPTR
04FB E0                MOVX    A,@DPTR
04FC FA                MOV     R2,A
04FD A3                INC     DPTR
04FE E0                MOVX    A,@DPTR
04FF FB                MOV     R3,A
0500 120000      E     LCALL   ?C?LMUL
0503 900000      R     MOV     DPTR,#a_value
0506 E0                MOVX    A,@DPTR
0507 F8                MOV     R0,A
0508 A3                INC     DPTR
0509 E0                MOVX    A,@DPTR
050A F9                MOV     R1,A
050B A3                INC     DPTR
050C E0                MOVX    A,@DPTR
050D FA                MOV     R2,A
050E A3                INC     DPTR
050F E0                MOVX    A,@DPTR
0510 2F                ADD     A,R7
0511 FF                MOV     R7,A
0512 EA                MOV     A,R2
0513 3E                ADDC    A,R6
0514 FE                MOV     R6,A
0515 E9                MOV     A,R1
0516 3D                ADDC    A,R5
0517 FD                MOV     R5,A
0518 E8                MOV     A,R0
0519 3C                ADDC    A,R4
051A FC                MOV     R4,A
051B 900000      R     MOV     DPTR,#aa_value
051E E0                MOVX    A,@DPTR
051F F8                MOV     R0,A
0520 A3                INC     DPTR
0521 E0                MOVX    A,@DPTR
0522 F9                MOV     R1,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 99  

0523 A3                INC     DPTR
0524 E0                MOVX    A,@DPTR
0525 FA                MOV     R2,A
0526 A3                INC     DPTR
0527 E0                MOVX    A,@DPTR
0528 FB                MOV     R3,A
0529 C3                CLR     C
052A EF                MOV     A,R7
052B 9B                SUBB    A,R3
052C FF                MOV     R7,A
052D EE                MOV     A,R6
052E 9A                SUBB    A,R2
052F FE                MOV     R6,A
0530 ED                MOV     A,R5
0531 99                SUBB    A,R1
0532 FD                MOV     R5,A
0533 EC                MOV     A,R4
0534 98                SUBB    A,R0
0535 FC                MOV     R4,A
0536 C004              PUSH    AR4
0538 C005              PUSH    AR5
053A C006              PUSH    AR6
053C C007              PUSH    AR7
053E E4                CLR     A
053F 7F03              MOV     R7,#03H
0541 FE                MOV     R6,A
0542 FD                MOV     R5,A
0543 FC                MOV     R4,A
0544 900000      R     MOV     DPTR,#aaa_value
0547 E0                MOVX    A,@DPTR
0548 F8                MOV     R0,A
0549 A3                INC     DPTR
054A E0                MOVX    A,@DPTR
054B F9                MOV     R1,A
054C A3                INC     DPTR
054D E0                MOVX    A,@DPTR
054E FA                MOV     R2,A
054F A3                INC     DPTR
0550 E0                MOVX    A,@DPTR
0551 FB                MOV     R3,A
0552 120000      E     LCALL   ?C?LMUL
0555 A804              MOV     R0,AR4
0557 A905              MOV     R1,AR5
0559 AA06              MOV     R2,AR6
055B AB07              MOV     R3,AR7
055D D007              POP     AR7
055F D006              POP     AR6
0561 D005              POP     AR5
0563 D004              POP     AR4
0565 C3                CLR     C
0566 EF                MOV     A,R7
0567 9B                SUBB    A,R3
0568 FF                MOV     R7,A
0569 EE                MOV     A,R6
056A 9A                SUBB    A,R2
056B FE                MOV     R6,A
056C ED                MOV     A,R5
056D 99                SUBB    A,R1
056E FD                MOV     R5,A
056F EC                MOV     A,R4
0570 98                SUBB    A,R0
0571 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 100 

0572 E4                CLR     A
0573 7B0A              MOV     R3,#0AH
0575 FA                MOV     R2,A
0576 F9                MOV     R1,A
0577 F8                MOV     R0,A
0578 120000      E     LCALL   ?C?LMUL
057B 120000      E     LCALL   _filter_acc_1
057E EE                MOV     A,R6
057F 33                RLC     A
0580 95E0              SUBB    A,ACC
0582 FD                MOV     R5,A
0583 FC                MOV     R4,A
0584 900000      R     MOV     DPTR,#accel_encoder
0587 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 984
058A 020000      R     LJMP    ?C0167
                                           ; SOURCE LINE # 986
058D         ?C0169:
                                           ; SOURCE LINE # 987
058D E4                CLR     A
058E 7F03              MOV     R7,#03H
0590 FE                MOV     R6,A
0591 FD                MOV     R5,A
0592 FC                MOV     R4,A
0593 900000      R     MOV     DPTR,#speed_encoder
0596 E0                MOVX    A,@DPTR
0597 F8                MOV     R0,A
0598 A3                INC     DPTR
0599 E0                MOVX    A,@DPTR
059A F9                MOV     R1,A
059B A3                INC     DPTR
059C E0                MOVX    A,@DPTR
059D FA                MOV     R2,A
059E A3                INC     DPTR
059F E0                MOVX    A,@DPTR
05A0 FB                MOV     R3,A
05A1 120000      E     LCALL   ?C?LMUL
05A4 900000      R     MOV     DPTR,#a_value+04H
05A7 E0                MOVX    A,@DPTR
05A8 F8                MOV     R0,A
05A9 A3                INC     DPTR
05AA E0                MOVX    A,@DPTR
05AB F9                MOV     R1,A
05AC A3                INC     DPTR
05AD E0                MOVX    A,@DPTR
05AE FA                MOV     R2,A
05AF A3                INC     DPTR
05B0 E0                MOVX    A,@DPTR
05B1 2F                ADD     A,R7
05B2 FF                MOV     R7,A
05B3 EA                MOV     A,R2
05B4 3E                ADDC    A,R6
05B5 FE                MOV     R6,A
05B6 E9                MOV     A,R1
05B7 3D                ADDC    A,R5
05B8 FD                MOV     R5,A
05B9 E8                MOV     A,R0
05BA 3C                ADDC    A,R4
05BB FC                MOV     R4,A
05BC 900000      R     MOV     DPTR,#aa_value+04H
05BF E0                MOVX    A,@DPTR
05C0 F8                MOV     R0,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 101 

05C1 A3                INC     DPTR
05C2 E0                MOVX    A,@DPTR
05C3 F9                MOV     R1,A
05C4 A3                INC     DPTR
05C5 E0                MOVX    A,@DPTR
05C6 FA                MOV     R2,A
05C7 A3                INC     DPTR
05C8 E0                MOVX    A,@DPTR
05C9 FB                MOV     R3,A
05CA C3                CLR     C
05CB EF                MOV     A,R7
05CC 9B                SUBB    A,R3
05CD FF                MOV     R7,A
05CE EE                MOV     A,R6
05CF 9A                SUBB    A,R2
05D0 FE                MOV     R6,A
05D1 ED                MOV     A,R5
05D2 99                SUBB    A,R1
05D3 FD                MOV     R5,A
05D4 EC                MOV     A,R4
05D5 98                SUBB    A,R0
05D6 FC                MOV     R4,A
05D7 C004              PUSH    AR4
05D9 C005              PUSH    AR5
05DB C006              PUSH    AR6
05DD C007              PUSH    AR7
05DF E4                CLR     A
05E0 7F03              MOV     R7,#03H
05E2 FE                MOV     R6,A
05E3 FD                MOV     R5,A
05E4 FC                MOV     R4,A
05E5 900000      R     MOV     DPTR,#aaa_value+04H
05E8 E0                MOVX    A,@DPTR
05E9 F8                MOV     R0,A
05EA A3                INC     DPTR
05EB E0                MOVX    A,@DPTR
05EC F9                MOV     R1,A
05ED A3                INC     DPTR
05EE E0                MOVX    A,@DPTR
05EF FA                MOV     R2,A
05F0 A3                INC     DPTR
05F1 E0                MOVX    A,@DPTR
05F2 FB                MOV     R3,A
05F3 120000      E     LCALL   ?C?LMUL
05F6 A804              MOV     R0,AR4
05F8 A905              MOV     R1,AR5
05FA AA06              MOV     R2,AR6
05FC AB07              MOV     R3,AR7
05FE D007              POP     AR7
0600 D006              POP     AR6
0602 D005              POP     AR5
0604 D004              POP     AR4
0606 C3                CLR     C
0607 EF                MOV     A,R7
0608 9B                SUBB    A,R3
0609 FF                MOV     R7,A
060A EE                MOV     A,R6
060B 9A                SUBB    A,R2
060C FE                MOV     R6,A
060D ED                MOV     A,R5
060E 99                SUBB    A,R1
060F FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 102 

0610 EC                MOV     A,R4
0611 98                SUBB    A,R0
0612 FC                MOV     R4,A
0613 E4                CLR     A
0614 7B0A              MOV     R3,#0AH
0616 FA                MOV     R2,A
0617 F9                MOV     R1,A
0618 F8                MOV     R0,A
0619 120000      E     LCALL   ?C?LMUL
061C 120000      E     LCALL   _filter_acc_2
061F EE                MOV     A,R6
0620 33                RLC     A
0621 95E0              SUBB    A,ACC
0623 FD                MOV     R5,A
0624 FC                MOV     R4,A
0625 900000      R     MOV     DPTR,#accel_encoder
0628 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 988
062B 020000      R     LJMP    ?C0167
                                           ; SOURCE LINE # 990
062E         ?C0170:
                                           ; SOURCE LINE # 991
062E E4                CLR     A
062F 7F03              MOV     R7,#03H
0631 FE                MOV     R6,A
0632 FD                MOV     R5,A
0633 FC                MOV     R4,A
0634 900000      R     MOV     DPTR,#speed_encoder
0637 E0                MOVX    A,@DPTR
0638 F8                MOV     R0,A
0639 A3                INC     DPTR
063A E0                MOVX    A,@DPTR
063B F9                MOV     R1,A
063C A3                INC     DPTR
063D E0                MOVX    A,@DPTR
063E FA                MOV     R2,A
063F A3                INC     DPTR
0640 E0                MOVX    A,@DPTR
0641 FB                MOV     R3,A
0642 120000      E     LCALL   ?C?LMUL
0645 900000      R     MOV     DPTR,#a_value+08H
0648 E0                MOVX    A,@DPTR
0649 F8                MOV     R0,A
064A A3                INC     DPTR
064B E0                MOVX    A,@DPTR
064C F9                MOV     R1,A
064D A3                INC     DPTR
064E E0                MOVX    A,@DPTR
064F FA                MOV     R2,A
0650 A3                INC     DPTR
0651 E0                MOVX    A,@DPTR
0652 2F                ADD     A,R7
0653 FF                MOV     R7,A
0654 EA                MOV     A,R2
0655 3E                ADDC    A,R6
0656 FE                MOV     R6,A
0657 E9                MOV     A,R1
0658 3D                ADDC    A,R5
0659 FD                MOV     R5,A
065A E8                MOV     A,R0
065B 3C                ADDC    A,R4
065C FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 103 

065D 900000      R     MOV     DPTR,#aa_value+08H
0660 E0                MOVX    A,@DPTR
0661 F8                MOV     R0,A
0662 A3                INC     DPTR
0663 E0                MOVX    A,@DPTR
0664 F9                MOV     R1,A
0665 A3                INC     DPTR
0666 E0                MOVX    A,@DPTR
0667 FA                MOV     R2,A
0668 A3                INC     DPTR
0669 E0                MOVX    A,@DPTR
066A FB                MOV     R3,A
066B C3                CLR     C
066C EF                MOV     A,R7
066D 9B                SUBB    A,R3
066E FF                MOV     R7,A
066F EE                MOV     A,R6
0670 9A                SUBB    A,R2
0671 FE                MOV     R6,A
0672 ED                MOV     A,R5
0673 99                SUBB    A,R1
0674 FD                MOV     R5,A
0675 EC                MOV     A,R4
0676 98                SUBB    A,R0
0677 FC                MOV     R4,A
0678 C004              PUSH    AR4
067A C005              PUSH    AR5
067C C006              PUSH    AR6
067E C007              PUSH    AR7
0680 E4                CLR     A
0681 7F03              MOV     R7,#03H
0683 FE                MOV     R6,A
0684 FD                MOV     R5,A
0685 FC                MOV     R4,A
0686 900000      R     MOV     DPTR,#aaa_value+08H
0689 E0                MOVX    A,@DPTR
068A F8                MOV     R0,A
068B A3                INC     DPTR
068C E0                MOVX    A,@DPTR
068D F9                MOV     R1,A
068E A3                INC     DPTR
068F E0                MOVX    A,@DPTR
0690 FA                MOV     R2,A
0691 A3                INC     DPTR
0692 E0                MOVX    A,@DPTR
0693 FB                MOV     R3,A
0694 120000      E     LCALL   ?C?LMUL
0697 A804              MOV     R0,AR4
0699 A905              MOV     R1,AR5
069B AA06              MOV     R2,AR6
069D AB07              MOV     R3,AR7
069F D007              POP     AR7
06A1 D006              POP     AR6
06A3 D005              POP     AR5
06A5 D004              POP     AR4
06A7 C3                CLR     C
06A8 EF                MOV     A,R7
06A9 9B                SUBB    A,R3
06AA FF                MOV     R7,A
06AB EE                MOV     A,R6
06AC 9A                SUBB    A,R2
06AD FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 104 

06AE ED                MOV     A,R5
06AF 99                SUBB    A,R1
06B0 FD                MOV     R5,A
06B1 EC                MOV     A,R4
06B2 98                SUBB    A,R0
06B3 FC                MOV     R4,A
06B4 E4                CLR     A
06B5 7B0A              MOV     R3,#0AH
06B7 FA                MOV     R2,A
06B8 F9                MOV     R1,A
06B9 F8                MOV     R0,A
06BA 120000      E     LCALL   ?C?LMUL
06BD 120000      E     LCALL   _filter_acc_3
06C0 EE                MOV     A,R6
06C1 33                RLC     A
06C2 95E0              SUBB    A,ACC
06C4 FD                MOV     R5,A
06C5 FC                MOV     R4,A
06C6 900000      R     MOV     DPTR,#accel_encoder
06C9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 992
                                           ; SOURCE LINE # 993
06CC         ?C0167:
                                           ; SOURCE LINE # 995
06CC 900000      R     MOV     DPTR,#accel_encoder
06CF E0                MOVX    A,@DPTR
06D0 FC                MOV     R4,A
06D1 A3                INC     DPTR
06D2 E0                MOVX    A,@DPTR
06D3 FD                MOV     R5,A
06D4 A3                INC     DPTR
06D5 E0                MOVX    A,@DPTR
06D6 FE                MOV     R6,A
06D7 A3                INC     DPTR
06D8 E0                MOVX    A,@DPTR
06D9 FF                MOV     R7,A
06DA E500        R     MOV     A,index
06DC 25E0              ADD     A,ACC
06DE 25E0              ADD     A,ACC
06E0 2400        E     ADD     A,#LOW g_meas+02BH
06E2 F582              MOV     DPL,A
06E4 E4                CLR     A
06E5 3400        E     ADDC    A,#HIGH g_meas+02BH
06E7 F583              MOV     DPH,A
06E9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 998
06EC E500        R     MOV     A,index
06EE 25E0              ADD     A,ACC
06F0 25E0              ADD     A,ACC
06F2 2400        R     ADD     A,#LOW vv_value
06F4 F582              MOV     DPL,A
06F6 E4                CLR     A
06F7 3400        R     ADDC    A,#HIGH vv_value
06F9 F583              MOV     DPH,A
06FB E0                MOVX    A,@DPTR
06FC FC                MOV     R4,A
06FD A3                INC     DPTR
06FE E0                MOVX    A,@DPTR
06FF FD                MOV     R5,A
0700 A3                INC     DPTR
0701 E0                MOVX    A,@DPTR
0702 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 105 

0703 A3                INC     DPTR
0704 E0                MOVX    A,@DPTR
0705 FF                MOV     R7,A
0706 E500        R     MOV     A,index
0708 25E0              ADD     A,ACC
070A 25E0              ADD     A,ACC
070C 2400        R     ADD     A,#LOW vvv_value
070E F582              MOV     DPL,A
0710 E4                CLR     A
0711 3400        R     ADDC    A,#HIGH vvv_value
0713 F583              MOV     DPH,A
0715 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 999
0718 E500        R     MOV     A,index
071A 25E0              ADD     A,ACC
071C 25E0              ADD     A,ACC
071E 2400        R     ADD     A,#LOW v_value
0720 F582              MOV     DPL,A
0722 E4                CLR     A
0723 3400        R     ADDC    A,#HIGH v_value
0725 F583              MOV     DPH,A
0727 E0                MOVX    A,@DPTR
0728 FC                MOV     R4,A
0729 A3                INC     DPTR
072A E0                MOVX    A,@DPTR
072B FD                MOV     R5,A
072C A3                INC     DPTR
072D E0                MOVX    A,@DPTR
072E FE                MOV     R6,A
072F A3                INC     DPTR
0730 E0                MOVX    A,@DPTR
0731 FF                MOV     R7,A
0732 E500        R     MOV     A,index
0734 25E0              ADD     A,ACC
0736 25E0              ADD     A,ACC
0738 2400        R     ADD     A,#LOW vv_value
073A F582              MOV     DPL,A
073C E4                CLR     A
073D 3400        R     ADDC    A,#HIGH vv_value
073F F583              MOV     DPH,A
0741 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1000
0744 900000      R     MOV     DPTR,#value_encoder
0747 E0                MOVX    A,@DPTR
0748 FC                MOV     R4,A
0749 A3                INC     DPTR
074A E0                MOVX    A,@DPTR
074B FD                MOV     R5,A
074C A3                INC     DPTR
074D E0                MOVX    A,@DPTR
074E FE                MOV     R6,A
074F A3                INC     DPTR
0750 E0                MOVX    A,@DPTR
0751 FF                MOV     R7,A
0752 E500        R     MOV     A,index
0754 25E0              ADD     A,ACC
0756 25E0              ADD     A,ACC
0758 2400        R     ADD     A,#LOW v_value
075A F582              MOV     DPL,A
075C E4                CLR     A
075D 3400        R     ADDC    A,#HIGH v_value
075F F583              MOV     DPH,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 106 

0761 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1002
0764 E500        R     MOV     A,index
0766 25E0              ADD     A,ACC
0768 25E0              ADD     A,ACC
076A 2400        R     ADD     A,#LOW aa_value
076C F582              MOV     DPL,A
076E E4                CLR     A
076F 3400        R     ADDC    A,#HIGH aa_value
0771 F583              MOV     DPH,A
0773 E0                MOVX    A,@DPTR
0774 FC                MOV     R4,A
0775 A3                INC     DPTR
0776 E0                MOVX    A,@DPTR
0777 FD                MOV     R5,A
0778 A3                INC     DPTR
0779 E0                MOVX    A,@DPTR
077A FE                MOV     R6,A
077B A3                INC     DPTR
077C E0                MOVX    A,@DPTR
077D FF                MOV     R7,A
077E E500        R     MOV     A,index
0780 25E0              ADD     A,ACC
0782 25E0              ADD     A,ACC
0784 2400        R     ADD     A,#LOW aaa_value
0786 F582              MOV     DPL,A
0788 E4                CLR     A
0789 3400        R     ADDC    A,#HIGH aaa_value
078B F583              MOV     DPH,A
078D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1003
0790 E500        R     MOV     A,index
0792 25E0              ADD     A,ACC
0794 25E0              ADD     A,ACC
0796 2400        R     ADD     A,#LOW a_value
0798 F582              MOV     DPL,A
079A E4                CLR     A
079B 3400        R     ADDC    A,#HIGH a_value
079D F583              MOV     DPH,A
079F E0                MOVX    A,@DPTR
07A0 FC                MOV     R4,A
07A1 A3                INC     DPTR
07A2 E0                MOVX    A,@DPTR
07A3 FD                MOV     R5,A
07A4 A3                INC     DPTR
07A5 E0                MOVX    A,@DPTR
07A6 FE                MOV     R6,A
07A7 A3                INC     DPTR
07A8 E0                MOVX    A,@DPTR
07A9 FF                MOV     R7,A
07AA E500        R     MOV     A,index
07AC 25E0              ADD     A,ACC
07AE 25E0              ADD     A,ACC
07B0 2400        R     ADD     A,#LOW aa_value
07B2 F582              MOV     DPL,A
07B4 E4                CLR     A
07B5 3400        R     ADDC    A,#HIGH aa_value
07B7 F583              MOV     DPH,A
07B9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1004
07BC 900000      R     MOV     DPTR,#speed_encoder
07BF E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 107 

07C0 FC                MOV     R4,A
07C1 A3                INC     DPTR
07C2 E0                MOVX    A,@DPTR
07C3 FD                MOV     R5,A
07C4 A3                INC     DPTR
07C5 E0                MOVX    A,@DPTR
07C6 FE                MOV     R6,A
07C7 A3                INC     DPTR
07C8 E0                MOVX    A,@DPTR
07C9 FF                MOV     R7,A
07CA E500        R     MOV     A,index
07CC 25E0              ADD     A,ACC
07CE 25E0              ADD     A,ACC
07D0 2400        R     ADD     A,#LOW a_value
07D2 F582              MOV     DPL,A
07D4 E4                CLR     A
07D5 3400        R     ADDC    A,#HIGH a_value
07D7 F583              MOV     DPH,A
07D9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1008
07DC 300003      R     JNB     pos_reconstruct,$ + 6H
07DF 020000      R     LJMP    ?C0145
                                           ; SOURCE LINE # 1009
07E2 900000      R     MOV     DPTR,#one_time_execute
07E5 E0                MOVX    A,@DPTR
07E6 C3                CLR     C
07E7 9422              SUBB    A,#022H
07E9 5004              JNC     ?C0172
                                           ; SOURCE LINE # 1010
07EB E0                MOVX    A,@DPTR
07EC 04                INC     A
07ED F0                MOVX    @DPTR,A
07EE 22                RET     
07EF         ?C0172:
                                           ; SOURCE LINE # 1011
                                           ; SOURCE LINE # 1013
07EF 900000      E     MOV     DPTR,#c_mem+079H
07F2 E0                MOVX    A,@DPTR
07F3 602A              JZ      ?C0174
                                           ; SOURCE LINE # 1014
07F5 900000      E     MOV     DPTR,#g_meas+04H
07F8 E0                MOVX    A,@DPTR
07F9 FC                MOV     R4,A
07FA A3                INC     DPTR
07FB E0                MOVX    A,@DPTR
07FC FD                MOV     R5,A
07FD A3                INC     DPTR
07FE E0                MOVX    A,@DPTR
07FF FE                MOV     R6,A
0800 A3                INC     DPTR
0801 E0                MOVX    A,@DPTR
0802 FF                MOV     R7,A
0803 900000      E     MOV     DPTR,#?_calc_turns_fcn?BYTE+04H
0806 120000      E     LCALL   ?C?LSTXDATA
0809 900000      E     MOV     DPTR,#g_meas
080C E0                MOVX    A,@DPTR
080D FC                MOV     R4,A
080E A3                INC     DPTR
080F E0                MOVX    A,@DPTR
0810 FD                MOV     R5,A
0811 A3                INC     DPTR
0812 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 108 

0813 FE                MOV     R6,A
0814 A3                INC     DPTR
0815 E0                MOVX    A,@DPTR
0816 FF                MOV     R7,A
0817 120000      E     LCALL   _calc_turns_fcn
081A 900000      E     MOV     DPTR,#g_meas+014H
081D EF                MOV     A,R7
081E F0                MOVX    @DPTR,A
081F         ?C0174:
                                           ; SOURCE LINE # 1016
081F 900000      E     MOV     DPTR,#g_meas
0822 E0                MOVX    A,@DPTR
0823 F8                MOV     R0,A
0824 A3                INC     DPTR
0825 E0                MOVX    A,@DPTR
0826 F9                MOV     R1,A
0827 A3                INC     DPTR
0828 E0                MOVX    A,@DPTR
0829 FA                MOV     R2,A
082A A3                INC     DPTR
082B E0                MOVX    A,@DPTR
082C FB                MOV     R3,A
082D C000              PUSH    AR0
082F 900000      E     MOV     DPTR,#g_meas+014H
0832 E0                MOVX    A,@DPTR
0833 FF                MOV     R7,A
0834 33                RLC     A
0835 95E0              SUBB    A,ACC
0837 FE                MOV     R6,A
0838 FD                MOV     R5,A
0839 FC                MOV     R4,A
083A 7810              MOV     R0,#010H
083C 120000      E     LCALL   ?C?LSHL
083F D000              POP     AR0
0841 EB                MOV     A,R3
0842 2F                ADD     A,R7
0843 FF                MOV     R7,A
0844 EA                MOV     A,R2
0845 3E                ADDC    A,R6
0846 FE                MOV     R6,A
0847 E9                MOV     A,R1
0848 3D                ADDC    A,R5
0849 FD                MOV     R5,A
084A E8                MOV     A,R0
084B 3C                ADDC    A,R4
084C FC                MOV     R4,A
084D 900000      E     MOV     DPTR,#g_meas
0850 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1019
0853 900000      E     MOV     DPTR,#g_meas
0856 E0                MOVX    A,@DPTR
0857 FC                MOV     R4,A
0858 A3                INC     DPTR
0859 E0                MOVX    A,@DPTR
085A FD                MOV     R5,A
085B A3                INC     DPTR
085C E0                MOVX    A,@DPTR
085D FE                MOV     R6,A
085E A3                INC     DPTR
085F E0                MOVX    A,@DPTR
0860 FF                MOV     R7,A
0861 900000      E     MOV     DPTR,#g_refNew
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 109 

0864 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1021
0867 900000      E     MOV     DPTR,#g_ref+018H
086A E0                MOVX    A,@DPTR
086B FF                MOV     R7,A
086C 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1023
086F D200        R     SETB    pos_reconstruct
                                           ; SOURCE LINE # 1024
                                           ; SOURCE LINE # 1025
                                           ; SOURCE LINE # 1026
0871         ?C0145:
0871 22                RET     
             ; FUNCTION _encoder_reading (END)

             ; FUNCTION analog_read_end (BEGIN)
                                           ; SOURCE LINE # 1032
0000         ?C0175:
                                           ; SOURCE LINE # 1065
0000 120000      E     LCALL   ADC_STATUS_Read
0003 EF                MOV     A,R7
0004 700A              JNZ     ?C0176
                                           ; SOURCE LINE # 1066
0006 3000F7            JNB     interrupt_flag,?C0175
                                           ; SOURCE LINE # 1067
0009 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1068
000B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1069
                                           ; SOURCE LINE # 1070
000E 80F0              SJMP    ?C0175
0010         ?C0176:
                                           ; SOURCE LINE # 1073
0010 900000      E     MOV     DPTR,#ADC_buf+01H
0013 E0                MOVX    A,@DPTR
0014 249A              ADD     A,#09AH
0016 FF                MOV     R7,A
0017 900000      E     MOV     DPTR,#ADC_buf
001A E0                MOVX    A,@DPTR
001B 34F9              ADDC    A,#0F9H
001D FE                MOV     R6,A
001E 33                RLC     A
001F 95E0              SUBB    A,ACC
0021 FD                MOV     R5,A
0022 FC                MOV     R4,A
0023 E4                CLR     A
0024 7BA0              MOV     R3,#0A0H
0026 7A07              MOV     R2,#07H
0028 F9                MOV     R1,A
0029 F8                MOV     R0,A
002A 120000      E     LCALL   ?C?LMUL
002D 7807              MOV     R0,#07H
002F 120000      E     LCALL   ?C?SLSHR
0032 900000      E     MOV     DPTR,#dev_tension
0035 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1075
0038 300005            JNB     interrupt_flag,?C0178
                                           ; SOURCE LINE # 1076
003B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1077
003D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1078
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 110 

0040         ?C0178:
                                           ; SOURCE LINE # 1080
0040 900000      R     MOV     DPTR,#first_tension_valid
0043 E0                MOVX    A,@DPTR
0044 6069              JZ      ?C0179
0046 300066            JNB     tension_valid,?C0179
                                           ; SOURCE LINE # 1081
0049 E4                CLR     A
004A 7F28              MOV     R7,#028H
004C 7E23              MOV     R6,#023H
004E FD                MOV     R5,A
004F FC                MOV     R4,A
0050 900000      E     MOV     DPTR,#dev_tension
0053 E0                MOVX    A,@DPTR
0054 F8                MOV     R0,A
0055 A3                INC     DPTR
0056 E0                MOVX    A,@DPTR
0057 F9                MOV     R1,A
0058 A3                INC     DPTR
0059 E0                MOVX    A,@DPTR
005A FA                MOV     R2,A
005B A3                INC     DPTR
005C E0                MOVX    A,@DPTR
005D FB                MOV     R3,A
005E C3                CLR     C
005F 120000      E     LCALL   ?C?SLCMP
0062 500F              JNC     ?C0180
                                           ; SOURCE LINE # 1082
0064 E4                CLR     A
0065 7F40              MOV     R7,#040H
0067 7E1F              MOV     R6,#01FH
0069 FD                MOV     R5,A
006A FC                MOV     R4,A
006B 900000      E     MOV     DPTR,#pow_tension
006E 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1083
0071 8037              SJMP    ?C0181
0073         ?C0180:
                                           ; SOURCE LINE # 1084
                                           ; SOURCE LINE # 1085
0073 E4                CLR     A
0074 7FC8              MOV     R7,#0C8H
0076 7E32              MOV     R6,#032H
0078 FD                MOV     R5,A
0079 FC                MOV     R4,A
007A 900000      E     MOV     DPTR,#dev_tension
007D E0                MOVX    A,@DPTR
007E F8                MOV     R0,A
007F A3                INC     DPTR
0080 E0                MOVX    A,@DPTR
0081 F9                MOV     R1,A
0082 A3                INC     DPTR
0083 E0                MOVX    A,@DPTR
0084 FA                MOV     R2,A
0085 A3                INC     DPTR
0086 E0                MOVX    A,@DPTR
0087 FB                MOV     R3,A
0088 C3                CLR     C
0089 120000      E     LCALL   ?C?SLCMP
008C 500F              JNC     ?C0182
                                           ; SOURCE LINE # 1086
008E E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 111 

008F 7FE0              MOV     R7,#0E0H
0091 7E2E              MOV     R6,#02EH
0093 FD                MOV     R5,A
0094 FC                MOV     R4,A
0095 900000      E     MOV     DPTR,#pow_tension
0098 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1087
009B 800D              SJMP    ?C0181
009D         ?C0182:
                                           ; SOURCE LINE # 1089
009D E4                CLR     A
009E 7FC0              MOV     R7,#0C0H
00A0 7E5D              MOV     R6,#05DH
00A2 FD                MOV     R5,A
00A3 FC                MOV     R4,A
00A4 900000      E     MOV     DPTR,#pow_tension
00A7 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1090
00AA         ?C0181:
                                           ; SOURCE LINE # 1092
00AA E4                CLR     A
00AB 900000      R     MOV     DPTR,#first_tension_valid
00AE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1093
00AF         ?C0179:
                                           ; SOURCE LINE # 1097
00AF E4                CLR     A
00B0 7F58              MOV     R7,#058H
00B2 7E1B              MOV     R6,#01BH
00B4 FD                MOV     R5,A
00B5 FC                MOV     R4,A
00B6 900000      E     MOV     DPTR,#dev_tension
00B9 E0                MOVX    A,@DPTR
00BA F8                MOV     R0,A
00BB A3                INC     DPTR
00BC E0                MOVX    A,@DPTR
00BD F9                MOV     R1,A
00BE A3                INC     DPTR
00BF E0                MOVX    A,@DPTR
00C0 FA                MOV     R2,A
00C1 A3                INC     DPTR
00C2 E0                MOVX    A,@DPTR
00C3 FB                MOV     R3,A
00C4 D3                SETB    C
00C5 120000      E     LCALL   ?C?SLCMP
00C8 5003              JNC     $ + 5H
00CA 020000      R     LJMP    ?C0184
                                           ; SOURCE LINE # 1100
00CD E4                CLR     A
00CE 7FE8              MOV     R7,#0E8H
00D0 7E03              MOV     R6,#03H
00D2 FD                MOV     R5,A
00D3 FC                MOV     R4,A
00D4 900000      R     MOV     DPTR,#count
00D7 E0                MOVX    A,@DPTR
00D8 F8                MOV     R0,A
00D9 A3                INC     DPTR
00DA E0                MOVX    A,@DPTR
00DB F9                MOV     R1,A
00DC A3                INC     DPTR
00DD E0                MOVX    A,@DPTR
00DE FA                MOV     R2,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 112 

00DF A3                INC     DPTR
00E0 E0                MOVX    A,@DPTR
00E1 FB                MOV     R3,A
00E2 120000      E     LCALL   ?C?ULCMP
00E5 7004              JNZ     ?C0185
                                           ; SOURCE LINE # 1101
00E7 D200        E     SETB    tension_valid
                                           ; SOURCE LINE # 1102
00E9 8036              SJMP    ?C0186
00EB         ?C0185:
                                           ; SOURCE LINE # 1103
                                           ; SOURCE LINE # 1104
00EB 900000      R     MOV     DPTR,#count
00EE E0                MOVX    A,@DPTR
00EF FC                MOV     R4,A
00F0 A3                INC     DPTR
00F1 E0                MOVX    A,@DPTR
00F2 FD                MOV     R5,A
00F3 A3                INC     DPTR
00F4 E0                MOVX    A,@DPTR
00F5 FE                MOV     R6,A
00F6 A3                INC     DPTR
00F7 E0                MOVX    A,@DPTR
00F8 2401              ADD     A,#01H
00FA FF                MOV     R7,A
00FB E4                CLR     A
00FC 3E                ADDC    A,R6
00FD FE                MOV     R6,A
00FE E4                CLR     A
00FF 3D                ADDC    A,R5
0100 FD                MOV     R5,A
0101 E4                CLR     A
0102 3C                ADDC    A,R4
0103 FC                MOV     R4,A
0104 900000      R     MOV     DPTR,#count
0107 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1105
010A 900000      E     MOV     DPTR,#dev_tension
010D E0                MOVX    A,@DPTR
010E FC                MOV     R4,A
010F A3                INC     DPTR
0110 E0                MOVX    A,@DPTR
0111 FD                MOV     R5,A
0112 A3                INC     DPTR
0113 E0                MOVX    A,@DPTR
0114 FE                MOV     R6,A
0115 A3                INC     DPTR
0116 E0                MOVX    A,@DPTR
0117 FF                MOV     R7,A
0118 120000      E     LCALL   _filter_voltage
011B 900000      E     MOV     DPTR,#dev_tension_f
011E 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1106
0121         ?C0186:
                                           ; SOURCE LINE # 1108
0121 900000      E     MOV     DPTR,#g_mem+07BH
0124 E0                MOVX    A,@DPTR
0125 6003              JZ      ?C0187
                                           ; SOURCE LINE # 1109
0127 120000      R     LCALL   pwm_limit_search
012A         ?C0187:
                                           ; SOURCE LINE # 1112
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 113 

012A 900000      E     MOV     DPTR,#ADC_buf+03H
012D E0                MOVX    A,@DPTR
012E 249A              ADD     A,#09AH
0130 FF                MOV     R7,A
0131 900000      E     MOV     DPTR,#ADC_buf+02H
0134 E0                MOVX    A,@DPTR
0135 34F9              ADDC    A,#0F9H
0137 FE                MOV     R6,A
0138 33                RLC     A
0139 95E0              SUBB    A,ACC
013B FD                MOV     R5,A
013C FC                MOV     R4,A
013D E4                CLR     A
013E 7BAB              MOV     R3,#0ABH
0140 7A64              MOV     R2,#064H
0142 F9                MOV     R1,A
0143 F8                MOV     R0,A
0144 120000      E     LCALL   ?C?LMUL
0147 780D              MOV     R0,#0DH
0149 120000      E     LCALL   ?C?SLSHR
014C 900000      E     MOV     DPTR,#pwm_sign
014F E0                MOVX    A,@DPTR
0150 FD                MOV     R5,A
0151 33                RLC     A
0152 95E0              SUBB    A,ACC
0154 FC                MOV     R4,A
0155 120000      E     LCALL   ?C?IMUL
0158 EE                MOV     A,R6
0159 33                RLC     A
015A 95E0              SUBB    A,ACC
015C FD                MOV     R5,A
015D FC                MOV     R4,A
015E 120000      E     LCALL   _filter_i1
0161 900000      E     MOV     DPTR,#g_meas+0CH
0164 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1116
0167 300005            JNB     interrupt_flag,?C0188
                                           ; SOURCE LINE # 1117
016A C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1118
016C 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1119
016F         ?C0188:
                                           ; SOURCE LINE # 1122
016F 900000      E     MOV     DPTR,#g_mem+06FH
0172 E0                MOVX    A,@DPTR
0173 7004              JNZ     ?C0189
                                           ; SOURCE LINE # 1123
0175 F500        R     MOV     emg_1_status,A
                                           ; SOURCE LINE # 1124
0177 F500        R     MOV     emg_2_status,A
                                           ; SOURCE LINE # 1125
0179         ?C0189:
                                           ; SOURCE LINE # 1130
0179 E500        R     MOV     A,emg_1_status
017B 14                DEC     A
017C 7003              JNZ     $ + 5H
017E 020000      R     LJMP    ?C0197
0181 14                DEC     A
0182 7003              JNZ     $ + 5H
0184 020000      R     LJMP    ?C0198
0187 14                DEC     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 114 

0188 7003              JNZ     $ + 5H
018A 020000      R     LJMP    ?C0201
018D 2403              ADD     A,#03H
018F 6003              JZ      $ + 5H
0191 020000      R     LJMP    ?C0190
                                           ; SOURCE LINE # 1131
0194         ?C0191:
                                           ; SOURCE LINE # 1132
0194 900000      E     MOV     DPTR,#ADC_buf+04H
0197 E0                MOVX    A,@DPTR
0198 FE                MOV     R6,A
0199 A3                INC     DPTR
019A E0                MOVX    A,@DPTR
019B FF                MOV     R7,A
019C EE                MOV     A,R6
019D 33                RLC     A
019E 95E0              SUBB    A,ACC
01A0 8F00        R     MOV     i_aux+03H,R7
01A2 8E00        R     MOV     i_aux+02H,R6
01A4 F500        R     MOV     i_aux+01H,A
01A6 F500        R     MOV     i_aux,A
                                           ; SOURCE LINE # 1133
01A8 AF00        R     MOV     R7,i_aux+03H
01AA AE00        R     MOV     R6,i_aux+02H
01AC FD                MOV     R5,A
01AD AC00        R     MOV     R4,i_aux
01AF 120000      E     LCALL   _filter_ch1
01B2 8F00        R     MOV     i_aux+03H,R7
01B4 8E00        R     MOV     i_aux+02H,R6
01B6 8D00        R     MOV     i_aux+01H,R5
01B8 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1134
01BA 780A              MOV     R0,#0AH
01BC 120000      E     LCALL   ?C?LSHL
01BF 900000      E     MOV     DPTR,#g_mem+070H
01C2 E0                MOVX    A,@DPTR
01C3 F8                MOV     R0,A
01C4 A3                INC     DPTR
01C5 E0                MOVX    A,@DPTR
01C6 F9                MOV     R1,A
01C7 A3                INC     DPTR
01C8 E0                MOVX    A,@DPTR
01C9 FA                MOV     R2,A
01CA A3                INC     DPTR
01CB E0                MOVX    A,@DPTR
01CC FB                MOV     R3,A
01CD 120000      E     LCALL   ?C?ULDIV
01D0 8F00        R     MOV     i_aux+03H,R7
01D2 8E00        R     MOV     i_aux+02H,R6
01D4 8D00        R     MOV     i_aux+01H,R5
01D6 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1136
01D8 300005            JNB     interrupt_flag,?C0192
                                           ; SOURCE LINE # 1137
01DB C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1138
01DD 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1139
01E0         ?C0192:
                                           ; SOURCE LINE # 1141
01E0 E4                CLR     A
01E1 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 115 

01E2 FE                MOV     R6,A
01E3 FD                MOV     R5,A
01E4 FC                MOV     R4,A
01E5 AB00        R     MOV     R3,i_aux+03H
01E7 AA00        R     MOV     R2,i_aux+02H
01E9 A900        R     MOV     R1,i_aux+01H
01EB A800        R     MOV     R0,i_aux
01ED C3                CLR     C
01EE 120000      E     LCALL   ?C?SLCMP
01F1 500B              JNC     ?C0193
                                           ; SOURCE LINE # 1142
01F3 E4                CLR     A
01F4 F500        R     MOV     i_aux+03H,A
01F6 F500        R     MOV     i_aux+02H,A
01F8 F500        R     MOV     i_aux+01H,A
01FA F500        R     MOV     i_aux,A
01FC 801E              SJMP    ?C0194
01FE         ?C0193:
                                           ; SOURCE LINE # 1144
01FE E4                CLR     A
01FF FF                MOV     R7,A
0200 7E04              MOV     R6,#04H
0202 FD                MOV     R5,A
0203 FC                MOV     R4,A
0204 AB00        R     MOV     R3,i_aux+03H
0206 AA00        R     MOV     R2,i_aux+02H
0208 A900        R     MOV     R1,i_aux+01H
020A A800        R     MOV     R0,i_aux
020C D3                SETB    C
020D 120000      E     LCALL   ?C?SLCMP
0210 400A              JC      ?C0194
                                           ; SOURCE LINE # 1145
0212 E4                CLR     A
0213 F500        R     MOV     i_aux+03H,A
0215 750004      R     MOV     i_aux+02H,#04H
0218 F500        R     MOV     i_aux+01H,A
021A F500        R     MOV     i_aux,A
021C         ?C0194:
                                           ; SOURCE LINE # 1147
021C AF00        R     MOV     R7,i_aux+03H
021E AE00        R     MOV     R6,i_aux+02H
0220 AD00        R     MOV     R5,i_aux+01H
0222 AC00        R     MOV     R4,i_aux
0224 900000      E     MOV     DPTR,#g_meas+017H
0227 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1149
022A 200003      E     JB      interrupt_flag,$ + 6H
022D 020000      R     LJMP    ?C0190
                                           ; SOURCE LINE # 1150
0230 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1151
0232 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1152
                                           ; SOURCE LINE # 1154
0235 020000      R     LJMP    ?C0190
                                           ; SOURCE LINE # 1156
0238         ?C0197:
                                           ; SOURCE LINE # 1157
0238 E4                CLR     A
0239 900000      R     MOV     DPTR,#emg_counter_1
023C F0                MOVX    @DPTR,A
023D A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 116 

023E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1158
023F FF                MOV     R7,A
0240 FE                MOV     R6,A
0241 FD                MOV     R5,A
0242 FC                MOV     R4,A
0243 900000      E     MOV     DPTR,#g_mem+070H
0246 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1159
0249 750002      R     MOV     emg_1_status,#02H
                                           ; SOURCE LINE # 1161
024C 020000      R     LJMP    ?C0190
                                           ; SOURCE LINE # 1163
024F         ?C0198:
                                           ; SOURCE LINE # 1164
024F 900000      R     MOV     DPTR,#emg_counter_1+01H
0252 E0                MOVX    A,@DPTR
0253 04                INC     A
0254 F0                MOVX    @DPTR,A
0255 7006              JNZ     ?C0268
0257 900000      R     MOV     DPTR,#emg_counter_1
025A E0                MOVX    A,@DPTR
025B 04                INC     A
025C F0                MOVX    @DPTR,A
025D         ?C0268:
                                           ; SOURCE LINE # 1165
025D 900000      R     MOV     DPTR,#emg_counter_1
0260 E0                MOVX    A,@DPTR
0261 6401              XRL     A,#01H
0263 7004              JNZ     ?C0269
0265 A3                INC     DPTR
0266 E0                MOVX    A,@DPTR
0267 64F4              XRL     A,#0F4H
0269         ?C0269:
0269 6003              JZ      $ + 5H
026B 020000      R     LJMP    ?C0190
                                           ; SOURCE LINE # 1166
026E 900000      R     MOV     DPTR,#emg_counter_1
0271 F0                MOVX    @DPTR,A
0272 A3                INC     DPTR
0273 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1169
0274 7F01              MOV     R7,#01H
0276 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1171
0279 E4                CLR     A
027A FF                MOV     R7,A
027B 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1173
027E 300005            JNB     interrupt_flag,?C0200
                                           ; SOURCE LINE # 1174
0281 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1175
0283 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1176
0286         ?C0200:
                                           ; SOURCE LINE # 1178
0286 750003      R     MOV     emg_1_status,#03H
                                           ; SOURCE LINE # 1179
                                           ; SOURCE LINE # 1180
0289 020000      R     LJMP    ?C0190
                                           ; SOURCE LINE # 1182
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 117 

028C         ?C0201:
                                           ; SOURCE LINE # 1184
028C 900000      R     MOV     DPTR,#emg_counter_1+01H
028F E0                MOVX    A,@DPTR
0290 04                INC     A
0291 F0                MOVX    @DPTR,A
0292 7006              JNZ     ?C0270
0294 900000      R     MOV     DPTR,#emg_counter_1
0297 E0                MOVX    A,@DPTR
0298 04                INC     A
0299 F0                MOVX    @DPTR,A
029A         ?C0270:
                                           ; SOURCE LINE # 1185
029A 900000      E     MOV     DPTR,#g_mem+070H
029D E0                MOVX    A,@DPTR
029E F8                MOV     R0,A
029F A3                INC     DPTR
02A0 E0                MOVX    A,@DPTR
02A1 F9                MOV     R1,A
02A2 A3                INC     DPTR
02A3 E0                MOVX    A,@DPTR
02A4 FA                MOV     R2,A
02A5 A3                INC     DPTR
02A6 E0                MOVX    A,@DPTR
02A7 FB                MOV     R3,A
02A8 C000              PUSH    AR0
02AA C001              PUSH    AR1
02AC C002              PUSH    AR2
02AE C003              PUSH    AR3
02B0 900000      E     MOV     DPTR,#ADC_buf+04H
02B3 E0                MOVX    A,@DPTR
02B4 FE                MOV     R6,A
02B5 A3                INC     DPTR
02B6 E0                MOVX    A,@DPTR
02B7 FF                MOV     R7,A
02B8 EE                MOV     A,R6
02B9 33                RLC     A
02BA 95E0              SUBB    A,ACC
02BC FD                MOV     R5,A
02BD FC                MOV     R4,A
02BE 120000      E     LCALL   _filter_ch1
02C1 D003              POP     AR3
02C3 D002              POP     AR2
02C5 D001              POP     AR1
02C7 D000              POP     AR0
02C9 EB                MOV     A,R3
02CA 2F                ADD     A,R7
02CB FF                MOV     R7,A
02CC EA                MOV     A,R2
02CD 3E                ADDC    A,R6
02CE FE                MOV     R6,A
02CF E9                MOV     A,R1
02D0 3D                ADDC    A,R5
02D1 FD                MOV     R5,A
02D2 E8                MOV     A,R0
02D3 3C                ADDC    A,R4
02D4 FC                MOV     R4,A
02D5 900000      E     MOV     DPTR,#g_mem+070H
02D8 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1187
02DB 300005            JNB     interrupt_flag,?C0202
                                           ; SOURCE LINE # 1188
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 118 

02DE C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1189
02E0 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1190
02E3         ?C0202:
                                           ; SOURCE LINE # 1192
02E3 900000      R     MOV     DPTR,#emg_counter_1
02E6 E0                MOVX    A,@DPTR
02E7 6403              XRL     A,#03H
02E9 7004              JNZ     ?C0271
02EB A3                INC     DPTR
02EC E0                MOVX    A,@DPTR
02ED 64E8              XRL     A,#0E8H
02EF         ?C0271:
02EF 7039              JNZ     ?C0190
                                           ; SOURCE LINE # 1193
02F1 900000      E     MOV     DPTR,#g_mem+070H
02F4 E0                MOVX    A,@DPTR
02F5 FC                MOV     R4,A
02F6 A3                INC     DPTR
02F7 E0                MOVX    A,@DPTR
02F8 FD                MOV     R5,A
02F9 A3                INC     DPTR
02FA E0                MOVX    A,@DPTR
02FB FE                MOV     R6,A
02FC A3                INC     DPTR
02FD E0                MOVX    A,@DPTR
02FE FF                MOV     R7,A
02FF E4                CLR     A
0300 7BE8              MOV     R3,#0E8H
0302 7A03              MOV     R2,#03H
0304 F9                MOV     R1,A
0305 F8                MOV     R0,A
0306 120000      E     LCALL   ?C?ULDIV
0309 900000      E     MOV     DPTR,#g_mem+070H
030C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1195
030F 300005            JNB     interrupt_flag,?C0204
                                           ; SOURCE LINE # 1196
0312 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1197
0314 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1198
0317         ?C0204:
                                           ; SOURCE LINE # 1201
0317 E4                CLR     A
0318 FF                MOV     R7,A
0319 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1203
031C E4                CLR     A
031D FF                MOV     R7,A
031E 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1205
0321 E4                CLR     A
0322 900000      R     MOV     DPTR,#emg_counter_1
0325 F0                MOVX    @DPTR,A
0326 A3                INC     DPTR
0327 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1207
0328 F500        R     MOV     emg_1_status,A
                                           ; SOURCE LINE # 1208
                                           ; SOURCE LINE # 1209
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 119 

                                           ; SOURCE LINE # 1211
                                           ; SOURCE LINE # 1212
                                           ; SOURCE LINE # 1213
032A         ?C0190:
                                           ; SOURCE LINE # 1215
032A 300005            JNB     interrupt_flag,?C0206
                                           ; SOURCE LINE # 1216
032D C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1217
032F 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1218
0332         ?C0206:
                                           ; SOURCE LINE # 1220
0332 E500        R     MOV     A,emg_2_status
0334 14                DEC     A
0335 7003              JNZ     $ + 5H
0337 020000      R     LJMP    ?C0213
033A 14                DEC     A
033B 7003              JNZ     $ + 5H
033D 020000      R     LJMP    ?C0215
0340 14                DEC     A
0341 7003              JNZ     $ + 5H
0343 020000      R     LJMP    ?C0218
0346 14                DEC     A
0347 7003              JNZ     $ + 5H
0349 020000      R     LJMP    ?C0222
034C 14                DEC     A
034D 7003              JNZ     $ + 5H
034F 020000      R     LJMP    ?C0224
0352 2405              ADD     A,#05H
0354 6003              JZ      $ + 5H
0356 020000      R     LJMP    ?C0207
                                           ; SOURCE LINE # 1221
0359         ?C0208:
                                           ; SOURCE LINE # 1222
0359 900000      E     MOV     DPTR,#ADC_buf+06H
035C E0                MOVX    A,@DPTR
035D FE                MOV     R6,A
035E A3                INC     DPTR
035F E0                MOVX    A,@DPTR
0360 FF                MOV     R7,A
0361 EE                MOV     A,R6
0362 33                RLC     A
0363 95E0              SUBB    A,ACC
0365 8F00        R     MOV     i_aux+03H,R7
0367 8E00        R     MOV     i_aux+02H,R6
0369 F500        R     MOV     i_aux+01H,A
036B F500        R     MOV     i_aux,A
                                           ; SOURCE LINE # 1223
036D AF00        R     MOV     R7,i_aux+03H
036F AE00        R     MOV     R6,i_aux+02H
0371 FD                MOV     R5,A
0372 AC00        R     MOV     R4,i_aux
0374 120000      E     LCALL   _filter_ch2
0377 8F00        R     MOV     i_aux+03H,R7
0379 8E00        R     MOV     i_aux+02H,R6
037B 8D00        R     MOV     i_aux+01H,R5
037D 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1224
037F 780A              MOV     R0,#0AH
0381 120000      E     LCALL   ?C?LSHL
0384 900000      E     MOV     DPTR,#g_mem+074H
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 120 

0387 E0                MOVX    A,@DPTR
0388 F8                MOV     R0,A
0389 A3                INC     DPTR
038A E0                MOVX    A,@DPTR
038B F9                MOV     R1,A
038C A3                INC     DPTR
038D E0                MOVX    A,@DPTR
038E FA                MOV     R2,A
038F A3                INC     DPTR
0390 E0                MOVX    A,@DPTR
0391 FB                MOV     R3,A
0392 120000      E     LCALL   ?C?ULDIV
0395 8F00        R     MOV     i_aux+03H,R7
0397 8E00        R     MOV     i_aux+02H,R6
0399 8D00        R     MOV     i_aux+01H,R5
039B 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1226
039D 300005            JNB     interrupt_flag,?C0209
                                           ; SOURCE LINE # 1227
03A0 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1228
03A2 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1229
03A5         ?C0209:
                                           ; SOURCE LINE # 1231
03A5 E4                CLR     A
03A6 FF                MOV     R7,A
03A7 FE                MOV     R6,A
03A8 FD                MOV     R5,A
03A9 FC                MOV     R4,A
03AA AB00        R     MOV     R3,i_aux+03H
03AC AA00        R     MOV     R2,i_aux+02H
03AE A900        R     MOV     R1,i_aux+01H
03B0 A800        R     MOV     R0,i_aux
03B2 C3                CLR     C
03B3 120000      E     LCALL   ?C?SLCMP
03B6 500B              JNC     ?C0210
                                           ; SOURCE LINE # 1232
03B8 E4                CLR     A
03B9 F500        R     MOV     i_aux+03H,A
03BB F500        R     MOV     i_aux+02H,A
03BD F500        R     MOV     i_aux+01H,A
03BF F500        R     MOV     i_aux,A
03C1 801E              SJMP    ?C0211
03C3         ?C0210:
                                           ; SOURCE LINE # 1234
03C3 E4                CLR     A
03C4 FF                MOV     R7,A
03C5 7E04              MOV     R6,#04H
03C7 FD                MOV     R5,A
03C8 FC                MOV     R4,A
03C9 AB00        R     MOV     R3,i_aux+03H
03CB AA00        R     MOV     R2,i_aux+02H
03CD A900        R     MOV     R1,i_aux+01H
03CF A800        R     MOV     R0,i_aux
03D1 D3                SETB    C
03D2 120000      E     LCALL   ?C?SLCMP
03D5 400A              JC      ?C0211
                                           ; SOURCE LINE # 1235
03D7 E4                CLR     A
03D8 F500        R     MOV     i_aux+03H,A
03DA 750004      R     MOV     i_aux+02H,#04H
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 121 

03DD F500        R     MOV     i_aux+01H,A
03DF F500        R     MOV     i_aux,A
03E1         ?C0211:
                                           ; SOURCE LINE # 1237
03E1 AF00        R     MOV     R7,i_aux+03H
03E3 AE00        R     MOV     R6,i_aux+02H
03E5 AD00        R     MOV     R5,i_aux+01H
03E7 AC00        R     MOV     R4,i_aux
03E9 900000      E     MOV     DPTR,#g_meas+01BH
03EC 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1239
03EF 020000      R     LJMP    ?C0207
                                           ; SOURCE LINE # 1241
03F2         ?C0213:
                                           ; SOURCE LINE # 1242
03F2 E4                CLR     A
03F3 900000      R     MOV     DPTR,#emg_counter_2
03F6 F0                MOVX    @DPTR,A
03F7 A3                INC     DPTR
03F8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1243
03F9 FF                MOV     R7,A
03FA FE                MOV     R6,A
03FB FD                MOV     R5,A
03FC FC                MOV     R4,A
03FD 900000      E     MOV     DPTR,#g_mem+074H
0400 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1245
0403 300005            JNB     interrupt_flag,?C0214
                                           ; SOURCE LINE # 1246
0406 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1247
0408 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1248
040B         ?C0214:
                                           ; SOURCE LINE # 1250
040B 750004      R     MOV     emg_2_status,#04H
                                           ; SOURCE LINE # 1251
040E 020000      R     LJMP    ?C0207
                                           ; SOURCE LINE # 1253
0411         ?C0215:
                                           ; SOURCE LINE # 1254
0411 900000      R     MOV     DPTR,#emg_counter_2+01H
0414 E0                MOVX    A,@DPTR
0415 04                INC     A
0416 F0                MOVX    @DPTR,A
0417 7006              JNZ     ?C0272
0419 900000      R     MOV     DPTR,#emg_counter_2
041C E0                MOVX    A,@DPTR
041D 04                INC     A
041E F0                MOVX    @DPTR,A
041F         ?C0272:
                                           ; SOURCE LINE # 1255
041F 900000      R     MOV     DPTR,#emg_counter_2
0422 E0                MOVX    A,@DPTR
0423 6401              XRL     A,#01H
0425 7004              JNZ     ?C0273
0427 A3                INC     DPTR
0428 E0                MOVX    A,@DPTR
0429 64F4              XRL     A,#0F4H
042B         ?C0273:
042B 6003              JZ      $ + 5H
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 122 

042D 020000      R     LJMP    ?C0207
                                           ; SOURCE LINE # 1256
0430 900000      R     MOV     DPTR,#emg_counter_2
0433 F0                MOVX    @DPTR,A
0434 A3                INC     DPTR
0435 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1259
0436 7F01              MOV     R7,#01H
0438 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1261
043B E4                CLR     A
043C FF                MOV     R7,A
043D 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1263
0440 300005            JNB     interrupt_flag,?C0217
                                           ; SOURCE LINE # 1264
0443 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1265
0445 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1266
0448         ?C0217:
                                           ; SOURCE LINE # 1268
0448 750003      R     MOV     emg_2_status,#03H
                                           ; SOURCE LINE # 1269
                                           ; SOURCE LINE # 1270
044B 020000      R     LJMP    ?C0207
                                           ; SOURCE LINE # 1272
044E         ?C0218:
                                           ; SOURCE LINE # 1274
044E 900000      R     MOV     DPTR,#emg_counter_2+01H
0451 E0                MOVX    A,@DPTR
0452 04                INC     A
0453 F0                MOVX    @DPTR,A
0454 7006              JNZ     ?C0274
0456 900000      R     MOV     DPTR,#emg_counter_2
0459 E0                MOVX    A,@DPTR
045A 04                INC     A
045B F0                MOVX    @DPTR,A
045C         ?C0274:
                                           ; SOURCE LINE # 1275
045C 900000      E     MOV     DPTR,#g_mem+074H
045F E0                MOVX    A,@DPTR
0460 F8                MOV     R0,A
0461 A3                INC     DPTR
0462 E0                MOVX    A,@DPTR
0463 F9                MOV     R1,A
0464 A3                INC     DPTR
0465 E0                MOVX    A,@DPTR
0466 FA                MOV     R2,A
0467 A3                INC     DPTR
0468 E0                MOVX    A,@DPTR
0469 FB                MOV     R3,A
046A C000              PUSH    AR0
046C C001              PUSH    AR1
046E C002              PUSH    AR2
0470 C003              PUSH    AR3
0472 900000      E     MOV     DPTR,#ADC_buf+06H
0475 E0                MOVX    A,@DPTR
0476 FE                MOV     R6,A
0477 A3                INC     DPTR
0478 E0                MOVX    A,@DPTR
0479 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 123 

047A EE                MOV     A,R6
047B 33                RLC     A
047C 95E0              SUBB    A,ACC
047E FD                MOV     R5,A
047F FC                MOV     R4,A
0480 120000      E     LCALL   _filter_ch2
0483 D003              POP     AR3
0485 D002              POP     AR2
0487 D001              POP     AR1
0489 D000              POP     AR0
048B EB                MOV     A,R3
048C 2F                ADD     A,R7
048D FF                MOV     R7,A
048E EA                MOV     A,R2
048F 3E                ADDC    A,R6
0490 FE                MOV     R6,A
0491 E9                MOV     A,R1
0492 3D                ADDC    A,R5
0493 FD                MOV     R5,A
0494 E8                MOV     A,R0
0495 3C                ADDC    A,R4
0496 FC                MOV     R4,A
0497 900000      E     MOV     DPTR,#g_mem+074H
049A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1277
049D 300005            JNB     interrupt_flag,?C0219
                                           ; SOURCE LINE # 1278
04A0 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1279
04A2 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1280
04A5         ?C0219:
                                           ; SOURCE LINE # 1282
04A5 900000      R     MOV     DPTR,#emg_counter_2
04A8 E0                MOVX    A,@DPTR
04A9 6403              XRL     A,#03H
04AB 7004              JNZ     ?C0275
04AD A3                INC     DPTR
04AE E0                MOVX    A,@DPTR
04AF 64E8              XRL     A,#0E8H
04B1         ?C0275:
04B1 6003              JZ      $ + 5H
04B3 020000      R     LJMP    ?C0207
                                           ; SOURCE LINE # 1283
04B6 900000      E     MOV     DPTR,#g_mem+074H
04B9 E0                MOVX    A,@DPTR
04BA FC                MOV     R4,A
04BB A3                INC     DPTR
04BC E0                MOVX    A,@DPTR
04BD FD                MOV     R5,A
04BE A3                INC     DPTR
04BF E0                MOVX    A,@DPTR
04C0 FE                MOV     R6,A
04C1 A3                INC     DPTR
04C2 E0                MOVX    A,@DPTR
04C3 FF                MOV     R7,A
04C4 E4                CLR     A
04C5 7BE8              MOV     R3,#0E8H
04C7 7A03              MOV     R2,#03H
04C9 F9                MOV     R1,A
04CA F8                MOV     R0,A
04CB 120000      E     LCALL   ?C?ULDIV
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 124 

04CE 900000      E     MOV     DPTR,#g_mem+074H
04D1 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1286
04D4 E4                CLR     A
04D5 FF                MOV     R7,A
04D6 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1288
04D9 E4                CLR     A
04DA FF                MOV     R7,A
04DB 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1290
04DE E4                CLR     A
04DF 900000      R     MOV     DPTR,#emg_counter_2
04E2 F0                MOVX    @DPTR,A
04E3 A3                INC     DPTR
04E4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1292
04E5 300005            JNB     interrupt_flag,?C0221
                                           ; SOURCE LINE # 1293
04E8 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1294
04EA 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1295
04ED         ?C0221:
                                           ; SOURCE LINE # 1297
04ED 750005      R     MOV     emg_2_status,#05H
                                           ; SOURCE LINE # 1298
                                           ; SOURCE LINE # 1299
04F0 020000      R     LJMP    ?C0207
                                           ; SOURCE LINE # 1301
04F3         ?C0222:
                                           ; SOURCE LINE # 1302
04F3 E500        R     MOV     A,emg_1_status
04F5 6003              JZ      $ + 5H
04F7 020000      R     LJMP    ?C0207
                                           ; SOURCE LINE # 1303
04FA 750002      R     MOV     emg_2_status,#02H
                                           ; SOURCE LINE # 1304
04FD 807E              SJMP    ?C0207
                                           ; SOURCE LINE # 1306
04FF         ?C0224:
                                           ; SOURCE LINE # 1307
04FF 900000      R     MOV     DPTR,#emg_counter_2+01H
0502 E0                MOVX    A,@DPTR
0503 04                INC     A
0504 F0                MOVX    @DPTR,A
0505 7006              JNZ     ?C0276
0507 900000      R     MOV     DPTR,#emg_counter_2
050A E0                MOVX    A,@DPTR
050B 04                INC     A
050C F0                MOVX    @DPTR,A
050D         ?C0276:
                                           ; SOURCE LINE # 1308
050D 900000      R     MOV     DPTR,#emg_counter_2
0510 E0                MOVX    A,@DPTR
0511 6401              XRL     A,#01H
0513 7004              JNZ     ?C0277
0515 A3                INC     DPTR
0516 E0                MOVX    A,@DPTR
0517 64F4              XRL     A,#0F4H
0519         ?C0277:
0519 7062              JNZ     ?C0207
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 125 

                                           ; SOURCE LINE # 1309
051B 900000      R     MOV     DPTR,#emg_counter_2
051E F0                MOVX    @DPTR,A
051F A3                INC     DPTR
0520 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1311
0521 300005            JNB     interrupt_flag,?C0226
                                           ; SOURCE LINE # 1312
0524 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1313
0526 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1314
0529         ?C0226:
                                           ; SOURCE LINE # 1317
0529 900000      E     MOV     DPTR,#c_mem+033H
052C E0                MOVX    A,@DPTR
052D FF                MOV     R7,A
052E 6402              XRL     A,#02H
0530 600E              JZ      ?C0228
0532 EF                MOV     A,R7
0533 6403              XRL     A,#03H
0535 6009              JZ      ?C0228
0537 EF                MOV     A,R7
0538 6404              XRL     A,#04H
053A 6004              JZ      ?C0228
053C EF                MOV     A,R7
053D B4053A            CJNE    A,#05H,?C0227
0540         ?C0228:
                                           ; SOURCE LINE # 1320
                                           ; SOURCE LINE # 1321
0540 900000      E     MOV     DPTR,#c_mem+034H
0543 E0                MOVX    A,@DPTR
0544 7028              JNZ     ?C0229
                                           ; SOURCE LINE # 1322
0546 900000      E     MOV     DPTR,#g_meas
0549 E0                MOVX    A,@DPTR
054A FC                MOV     R4,A
054B A3                INC     DPTR
054C E0                MOVX    A,@DPTR
054D FD                MOV     R5,A
054E A3                INC     DPTR
054F E0                MOVX    A,@DPTR
0550 FE                MOV     R6,A
0551 A3                INC     DPTR
0552 E0                MOVX    A,@DPTR
0553 FF                MOV     R7,A
0554 900000      E     MOV     DPTR,#g_ref
0557 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1323
055A 900000      E     MOV     DPTR,#g_meas+04H
055D E0                MOVX    A,@DPTR
055E FC                MOV     R4,A
055F A3                INC     DPTR
0560 E0                MOVX    A,@DPTR
0561 FD                MOV     R5,A
0562 A3                INC     DPTR
0563 E0                MOVX    A,@DPTR
0564 FE                MOV     R6,A
0565 A3                INC     DPTR
0566 E0                MOVX    A,@DPTR
0567 FF                MOV     R7,A
0568 900000      E     MOV     DPTR,#g_ref+04H
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 126 

056B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1324
056E         ?C0229:
                                           ; SOURCE LINE # 1325
056E 900000      E     MOV     DPTR,#c_mem+032H
0571 E0                MOVX    A,@DPTR
0572 FF                MOV     R7,A
0573 900000      E     MOV     DPTR,#g_ref+018H
0576 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1326
0577 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1327
057A         ?C0227:
                                           ; SOURCE LINE # 1329
057A E4                CLR     A
057B F500        R     MOV     emg_2_status,A
                                           ; SOURCE LINE # 1330
                                           ; SOURCE LINE # 1331
                                           ; SOURCE LINE # 1333
                                           ; SOURCE LINE # 1334
                                           ; SOURCE LINE # 1335
057D         ?C0207:
                                           ; SOURCE LINE # 1337
057D 300068            JNB     interrupt_flag,?C0232
                                           ; SOURCE LINE # 1338
0580 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1339
0582 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1340
                                           ; SOURCE LINE # 1341
0585 8061              SJMP    ?C0232
0587         ?C0184:
                                           ; SOURCE LINE # 1342
                                           ; SOURCE LINE # 1344
0587 750001      R     MOV     emg_1_status,#01H
                                           ; SOURCE LINE # 1345
058A 750001      R     MOV     emg_2_status,#01H
                                           ; SOURCE LINE # 1347
058D C200        E     CLR     tension_valid
                                           ; SOURCE LINE # 1350
058F 7F01              MOV     R7,#01H
0591 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1352
0594 E4                CLR     A
0595 FF                MOV     R7,A
0596 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1354
0599 300005            JNB     interrupt_flag,?C0233
                                           ; SOURCE LINE # 1355
059C C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1356
059E 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1357
05A1         ?C0233:
                                           ; SOURCE LINE # 1359
05A1 900000      E     MOV     DPTR,#c_mem+06FH
05A4 E0                MOVX    A,@DPTR
05A5 6020              JZ      ?C0234
                                           ; SOURCE LINE # 1360
05A7 900000      E     MOV     DPTR,#c_mem+033H
05AA E0                MOVX    A,@DPTR
05AB FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 127 

05AC 6402              XRL     A,#02H
05AE 600E              JZ      ?C0236
05B0 EF                MOV     A,R7
05B1 6403              XRL     A,#03H
05B3 6009              JZ      ?C0236
05B5 EF                MOV     A,R7
05B6 6404              XRL     A,#04H
05B8 6004              JZ      ?C0236
05BA EF                MOV     A,R7
05BB B40509            CJNE    A,#05H,?C0234
05BE         ?C0236:
                                           ; SOURCE LINE # 1363
                                           ; SOURCE LINE # 1364
05BE E4                CLR     A
05BF 900000      E     MOV     DPTR,#g_ref+018H
05C2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1365
05C3 FF                MOV     R7,A
05C4 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1366
                                           ; SOURCE LINE # 1367
05C7         ?C0234:
                                           ; SOURCE LINE # 1370
05C7 E4                CLR     A
05C8 FF                MOV     R7,A
05C9 FE                MOV     R6,A
05CA FD                MOV     R5,A
05CB FC                MOV     R4,A
05CC 900000      E     MOV     DPTR,#g_meas+0CH
05CF 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1373
05D2 E4                CLR     A
05D3 FF                MOV     R7,A
05D4 FE                MOV     R6,A
05D5 FD                MOV     R5,A
05D6 FC                MOV     R4,A
05D7 900000      E     MOV     DPTR,#g_meas+017H
05DA 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1374
05DD E4                CLR     A
05DE FF                MOV     R7,A
05DF FE                MOV     R6,A
05E0 FD                MOV     R5,A
05E1 FC                MOV     R4,A
05E2 900000      E     MOV     DPTR,#g_meas+01BH
05E5 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1376
05E8         ?C0232:
                                           ; SOURCE LINE # 1379
05E8 E500        R     MOV     A,emg_1_status
05EA 6003              JZ      $ + 5H
05EC 020000      R     LJMP    ?C0237
05EF E500        R     MOV     A,emg_2_status
05F1 6003              JZ      $ + 5H
05F3 020000      R     LJMP    ?C0237
05F6 900000      R     MOV     DPTR,#first_tension_valid
05F9 E0                MOVX    A,@DPTR
05FA 6003              JZ      $ + 5H
05FC 020000      R     LJMP    ?C0237
05FF 200003      E     JB      tension_valid,$ + 6H
0602 020000      R     LJMP    ?C0237
                                           ; SOURCE LINE # 1380
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 128 

0605 900000      E     MOV     DPTR,#dev_tension
0608 E0                MOVX    A,@DPTR
0609 FC                MOV     R4,A
060A A3                INC     DPTR
060B E0                MOVX    A,@DPTR
060C FD                MOV     R5,A
060D A3                INC     DPTR
060E E0                MOVX    A,@DPTR
060F FE                MOV     R6,A
0610 A3                INC     DPTR
0611 E0                MOVX    A,@DPTR
0612 FF                MOV     R7,A
0613 120000      E     LCALL   _filter_voltage
0616 900000      E     MOV     DPTR,#dev_tension_f
0619 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1381
061C 900000      E     MOV     DPTR,#pow_tension
061F E0                MOVX    A,@DPTR
0620 FC                MOV     R4,A
0621 A3                INC     DPTR
0622 E0                MOVX    A,@DPTR
0623 FD                MOV     R5,A
0624 A3                INC     DPTR
0625 E0                MOVX    A,@DPTR
0626 FE                MOV     R6,A
0627 A3                INC     DPTR
0628 E0                MOVX    A,@DPTR
0629 FF                MOV     R7,A
062A EC                MOV     A,R4
062B 120000      E     LCALL   ?C?FCASTL
062E 7B1F              MOV     R3,#01FH
0630 7A85              MOV     R2,#085H
0632 796B              MOV     R1,#06BH
0634 783F              MOV     R0,#03FH
0636 120000      E     LCALL   ?C?FPMUL
0639 C004              PUSH    AR4
063B C005              PUSH    AR5
063D C006              PUSH    AR6
063F C007              PUSH    AR7
0641 900000      E     MOV     DPTR,#dev_tension_f
0644 E0                MOVX    A,@DPTR
0645 FC                MOV     R4,A
0646 A3                INC     DPTR
0647 E0                MOVX    A,@DPTR
0648 FD                MOV     R5,A
0649 A3                INC     DPTR
064A E0                MOVX    A,@DPTR
064B FE                MOV     R6,A
064C A3                INC     DPTR
064D E0                MOVX    A,@DPTR
064E FF                MOV     R7,A
064F EC                MOV     A,R4
0650 120000      E     LCALL   ?C?FCASTL
0653 A804              MOV     R0,AR4
0655 A905              MOV     R1,AR5
0657 AA06              MOV     R2,AR6
0659 AB07              MOV     R3,AR7
065B D007              POP     AR7
065D D006              POP     AR6
065F D005              POP     AR5
0661 D004              POP     AR4
0663 120000      E     LCALL   ?C?FPCMP3
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 129 

0666 600E              JZ      ?C0238
0668 400C              JC      ?C0238
                                           ; SOURCE LINE # 1383
066A 7F01              MOV     R7,#01H
066C 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1386
066F E4                CLR     A
0670 FF                MOV     R7,A
0671 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1387
0674 802B              SJMP    ?C0237
0676         ?C0238:
                                           ; SOURCE LINE # 1388
                                           ; SOURCE LINE # 1390
0676 E4                CLR     A
0677 FF                MOV     R7,A
0678 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1393
067B 7F01              MOV     R7,#01H
067D 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1396
0680 900000      E     MOV     DPTR,#master_mode
0683 E0                MOVX    A,@DPTR
0684 6012              JZ      ?C0240
                                           ; SOURCE LINE # 1397
0686 120000      R     LCALL   deactivate_slave
                                           ; SOURCE LINE # 1400
0689 300005            JNB     interrupt_flag,?C0241
                                           ; SOURCE LINE # 1401
068C C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1402
068E 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1403
0691         ?C0241:
                                           ; SOURCE LINE # 1405
0691 E4                CLR     A
0692 900000      E     MOV     DPTR,#master_mode
0695 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1406
0696 8009              SJMP    ?C0237
0698         ?C0240:
                                           ; SOURCE LINE # 1407
                                           ; SOURCE LINE # 1408
0698 E4                CLR     A
0699 900000      E     MOV     DPTR,#g_refNew+018H
069C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1409
069D FF                MOV     R7,A
069E 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1410
                                           ; SOURCE LINE # 1411
                                           ; SOURCE LINE # 1412
06A1         ?C0237:
                                           ; SOURCE LINE # 1414
06A1 300005            JNB     interrupt_flag,?C0244
                                           ; SOURCE LINE # 1415
06A4 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1416
06A6 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1417
                                           ; SOURCE LINE # 1418
06A9         ?C0244:
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 130 

06A9 22                RET     
             ; FUNCTION analog_read_end (END)

             ; FUNCTION overcurrent_control (BEGIN)
                                           ; SOURCE LINE # 1424
                                           ; SOURCE LINE # 1425
0000 900000      E     MOV     DPTR,#c_mem+069H
0003 E0                MOVX    A,@DPTR
0004 FE                MOV     R6,A
0005 A3                INC     DPTR
0006 E0                MOVX    A,@DPTR
0007 FF                MOV     R7,A
0008 4E                ORL     A,R6
0009 6068              JZ      ?C0252
                                           ; SOURCE LINE # 1427
000B EE                MOV     A,R6
000C 33                RLC     A
000D 95E0              SUBB    A,ACC
000F FD                MOV     R5,A
0010 FC                MOV     R4,A
0011 900000      E     MOV     DPTR,#g_meas+0CH
0014 E0                MOVX    A,@DPTR
0015 F8                MOV     R0,A
0016 A3                INC     DPTR
0017 E0                MOVX    A,@DPTR
0018 F9                MOV     R1,A
0019 A3                INC     DPTR
001A E0                MOVX    A,@DPTR
001B FA                MOV     R2,A
001C A3                INC     DPTR
001D E0                MOVX    A,@DPTR
001E FB                MOV     R3,A
001F D3                SETB    C
0020 120000      E     LCALL   ?C?SLCMP
0023 4008              JC      ?C0246
                                           ; SOURCE LINE # 1429
0025 900000      E     MOV     DPTR,#dev_pwm_limit
0028 E0                MOVX    A,@DPTR
0029 14                DEC     A
002A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1431
002B 802D              SJMP    ?C0247
002D         ?C0246:
002D 900000      E     MOV     DPTR,#c_mem+06AH
0030 E0                MOVX    A,@DPTR
0031 24F6              ADD     A,#0F6H
0033 FF                MOV     R7,A
0034 900000      E     MOV     DPTR,#c_mem+069H
0037 E0                MOVX    A,@DPTR
0038 34FF              ADDC    A,#0FFH
003A FE                MOV     R6,A
003B 33                RLC     A
003C 95E0              SUBB    A,ACC
003E FD                MOV     R5,A
003F FC                MOV     R4,A
0040 900000      E     MOV     DPTR,#g_meas+0CH
0043 E0                MOVX    A,@DPTR
0044 F8                MOV     R0,A
0045 A3                INC     DPTR
0046 E0                MOVX    A,@DPTR
0047 F9                MOV     R1,A
0048 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 131 

0049 E0                MOVX    A,@DPTR
004A FA                MOV     R2,A
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
004D FB                MOV     R3,A
004E C3                CLR     C
004F 120000      E     LCALL   ?C?SLCMP
0052 5006              JNC     ?C0247
                                           ; SOURCE LINE # 1433
0054 900000      E     MOV     DPTR,#dev_pwm_limit
0057 E0                MOVX    A,@DPTR
0058 04                INC     A
0059 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1434
005A         ?C0247:
                                           ; SOURCE LINE # 1437
005A 900000      E     MOV     DPTR,#dev_pwm_limit
005D E0                MOVX    A,@DPTR
005E FF                MOV     R7,A
005F C3                CLR     C
0060 9400              SUBB    A,#00H
0062 5003              JNC     ?C0249
                                           ; SOURCE LINE # 1438
0064 E4                CLR     A
0065 F0                MOVX    @DPTR,A
0066 22                RET     
0067         ?C0249:
                                           ; SOURCE LINE # 1440
0067 EF                MOV     A,R7
0068 D3                SETB    C
0069 9464              SUBB    A,#064H
006B 4006              JC      ?C0252
                                           ; SOURCE LINE # 1441
006D 900000      E     MOV     DPTR,#dev_pwm_limit
0070 7464              MOV     A,#064H
0072 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1442
                                           ; SOURCE LINE # 1443
0073         ?C0252:
0073 22                RET     
             ; FUNCTION overcurrent_control (END)

             ; FUNCTION pwm_limit_search (BEGIN)
                                           ; SOURCE LINE # 1449
                                           ; SOURCE LINE # 1453
0000 E4                CLR     A
0001 7F9C              MOV     R7,#09CH
0003 7E63              MOV     R6,#063H
0005 FD                MOV     R5,A
0006 FC                MOV     R4,A
0007 900000      E     MOV     DPTR,#dev_tension
000A E0                MOVX    A,@DPTR
000B F8                MOV     R0,A
000C A3                INC     DPTR
000D E0                MOVX    A,@DPTR
000E F9                MOV     R1,A
000F A3                INC     DPTR
0010 E0                MOVX    A,@DPTR
0011 FA                MOV     R2,A
0012 A3                INC     DPTR
0013 E0                MOVX    A,@DPTR
0014 FB                MOV     R3,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 132 

0015 D3                SETB    C
0016 120000      E     LCALL   ?C?SLCMP
0019 4006              JC      ?C0253
                                           ; SOURCE LINE # 1454
001B E4                CLR     A
001C 900000      E     MOV     DPTR,#dev_pwm_limit
001F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1455
0020 22                RET     
0021         ?C0253:
0021 E4                CLR     A
0022 7FEC              MOV     R7,#0ECH
0024 7E2C              MOV     R6,#02CH
0026 FD                MOV     R5,A
0027 FC                MOV     R4,A
0028 900000      E     MOV     DPTR,#dev_tension
002B E0                MOVX    A,@DPTR
002C F8                MOV     R0,A
002D A3                INC     DPTR
002E E0                MOVX    A,@DPTR
002F F9                MOV     R1,A
0030 A3                INC     DPTR
0031 E0                MOVX    A,@DPTR
0032 FA                MOV     R2,A
0033 A3                INC     DPTR
0034 E0                MOVX    A,@DPTR
0035 FB                MOV     R3,A
0036 C3                CLR     C
0037 120000      E     LCALL   ?C?SLCMP
003A 5007              JNC     ?C0255
                                           ; SOURCE LINE # 1456
003C 900000      E     MOV     DPTR,#dev_pwm_limit
003F 7464              MOV     A,#064H
0041 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1457
0042 22                RET     
0043         ?C0255:
                                           ; SOURCE LINE # 1458
0043 900000      E     MOV     DPTR,#dev_tension
0046 E0                MOVX    A,@DPTR
0047 FC                MOV     R4,A
0048 A3                INC     DPTR
0049 E0                MOVX    A,@DPTR
004A FD                MOV     R5,A
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
004D FE                MOV     R6,A
004E A3                INC     DPTR
004F E0                MOVX    A,@DPTR
0050 2414              ADD     A,#014H
0052 FF                MOV     R7,A
0053 EE                MOV     A,R6
0054 34D3              ADDC    A,#0D3H
0056 FE                MOV     R6,A
0057 ED                MOV     A,R5
0058 34FF              ADDC    A,#0FFH
005A FD                MOV     R5,A
005B EC                MOV     A,R4
005C 34FF              ADDC    A,#0FFH
005E FC                MOV     R4,A
005F 7809              MOV     R0,#09H
0061 120000      E     LCALL   ?C?SLSHR
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 133 

0064 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 1459
0066 7400        R     MOV     A,#LOW pwm_preload_values
0068 2F                ADD     A,R7
0069 F582              MOV     DPL,A
006B E4                CLR     A
006C 3400        R     ADDC    A,#HIGH pwm_preload_values
006E F583              MOV     DPH,A
0070 E0                MOVX    A,@DPTR
0071 900000      E     MOV     DPTR,#dev_pwm_limit
0074 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1460
                                           ; SOURCE LINE # 1461
0075         ?C0257:
0075 22                RET     
             ; FUNCTION pwm_limit_search (END)

             ; FUNCTION command_slave (BEGIN)
                                           ; SOURCE LINE # 1468
                                           ; SOURCE LINE # 1473
0000 900000      E     MOV     DPTR,#c_mem+033H
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 6402              XRL     A,#02H
0007 6015              JZ      ?C0258
0009 EF                MOV     A,R7
000A 6403              XRL     A,#03H
000C 6010              JZ      ?C0258
000E EF                MOV     A,R7
000F 6404              XRL     A,#04H
0011 600B              JZ      ?C0258
0013 EF                MOV     A,R7
0014 6405              XRL     A,#05H
0016 6006              JZ      ?C0258
                                           ; SOURCE LINE # 1476
                                           ; SOURCE LINE # 1477
0018 E4                CLR     A
0019 900000      E     MOV     DPTR,#master_mode
001C F0                MOVX    @DPTR,A
001D 22                RET     
                                           ; SOURCE LINE # 1479
001E         ?C0258:
                                           ; SOURCE LINE # 1482
001E 900000      R     MOV     DPTR,#packet_data
0021 7482              MOV     A,#082H
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1484
0024 900000      E     MOV     DPTR,#g_ref
0027 E0                MOVX    A,@DPTR
0028 FC                MOV     R4,A
0029 A3                INC     DPTR
002A E0                MOVX    A,@DPTR
002B FD                MOV     R5,A
002C A3                INC     DPTR
002D E0                MOVX    A,@DPTR
002E FE                MOV     R6,A
002F A3                INC     DPTR
0030 E0                MOVX    A,@DPTR
0031 FF                MOV     R7,A
0032 900000      E     MOV     DPTR,#g_mem+035H
0035 E0                MOVX    A,@DPTR
0036 F9                MOV     R1,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 134 

0037 F8                MOV     R0,A
0038 120000      E     LCALL   ?C?SLSHR
003B 900000      R     MOV     DPTR,#packet_data+01H
003E EE                MOV     A,R6
003F F0                MOVX    @DPTR,A
0040 A3                INC     DPTR
0041 EF                MOV     A,R7
0042 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1485
0043 E4                CLR     A
0044 A3                INC     DPTR
0045 F0                MOVX    @DPTR,A
0046 A3                INC     DPTR
0047 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1486
0048 900000      R     MOV     DPTR,#packet_lenght
004B 7406              MOV     A,#06H
004D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1487
004E 7B01              MOV     R3,#01H
0050 7A00        R     MOV     R2,#HIGH packet_data
0052 7900        R     MOV     R1,#LOW packet_data
0054 14                DEC     A
0055 FD                MOV     R5,A
0056 120000      E     LCALL   _LCRChecksum
0059 900000      R     MOV     DPTR,#packet_lenght
005C E0                MOVX    A,@DPTR
005D FE                MOV     R6,A
005E 2400        R     ADD     A,#LOW packet_data+0FFFFH
0060 F582              MOV     DPL,A
0062 E4                CLR     A
0063 3400        R     ADDC    A,#HIGH packet_data+0FFFFH
0065 F583              MOV     DPH,A
0067 EF                MOV     A,R7
0068 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1489
0069 7B01              MOV     R3,#01H
006B 7A00        R     MOV     R2,#HIGH packet_data
006D 7900        R     MOV     R1,#LOW packet_data
006F EE                MOV     A,R6
0070 FD                MOV     R5,A
0071 7C00              MOV     R4,#00H
0073 120000      E     LCALL   _commWriteAnother
                                           ; SOURCE LINE # 1491
0076         ?C0259:
0076 22                RET     
             ; FUNCTION command_slave (END)

             ; FUNCTION deactivate_slave (BEGIN)
                                           ; SOURCE LINE # 1497
                                           ; SOURCE LINE # 1502
0000 900000      E     MOV     DPTR,#c_mem+033H
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 6402              XRL     A,#02H
0007 600E              JZ      ?C0262
0009 EF                MOV     A,R7
000A 6403              XRL     A,#03H
000C 6009              JZ      ?C0262
000E EF                MOV     A,R7
000F 6404              XRL     A,#04H
0011 6004              JZ      ?C0262
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 135 

0013 EF                MOV     A,R7
0014 B40503            CJNE    A,#05H,?C0261
0017         ?C0262:
0017 200006            JB      tension_valid,?C0260
001A         ?C0261:
                                           ; SOURCE LINE # 1506
                                           ; SOURCE LINE # 1507
001A E4                CLR     A
001B 900000      E     MOV     DPTR,#master_mode
001E F0                MOVX    @DPTR,A
001F 22                RET     
                                           ; SOURCE LINE # 1509
0020         ?C0260:
                                           ; SOURCE LINE # 1512
0020 900000      R     MOV     DPTR,#packet_data
0023 7480              MOV     A,#080H
0025 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1514
0026 E4                CLR     A
0027 A3                INC     DPTR
0028 F0                MOVX    @DPTR,A
0029 A3                INC     DPTR
002A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1515
002B 900000      R     MOV     DPTR,#packet_lenght
002E 7403              MOV     A,#03H
0030 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1516
0031 7B01              MOV     R3,#01H
0033 7A00        R     MOV     R2,#HIGH packet_data
0035 7900        R     MOV     R1,#LOW packet_data
0037 14                DEC     A
0038 FD                MOV     R5,A
0039 120000      E     LCALL   _LCRChecksum
003C 900000      R     MOV     DPTR,#packet_lenght
003F E0                MOVX    A,@DPTR
0040 FE                MOV     R6,A
0041 2400        R     ADD     A,#LOW packet_data+0FFFFH
0043 F582              MOV     DPL,A
0045 E4                CLR     A
0046 3400        R     ADDC    A,#HIGH packet_data+0FFFFH
0048 F583              MOV     DPH,A
004A EF                MOV     A,R7
004B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1518
004C 7B01              MOV     R3,#01H
004E 7A00        R     MOV     R2,#HIGH packet_data
0050 7900        R     MOV     R1,#LOW packet_data
0052 EE                MOV     A,R6
0053 FD                MOV     R5,A
0054 7C00              MOV     R4,#00H
0056 120000      E     LCALL   _commWriteAnother
                                           ; SOURCE LINE # 1520
0059         ?C0263:
0059 22                RET     
             ; FUNCTION deactivate_slave (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   9097    ----
   CONSTANT SIZE    =   ----    ----
C51 COMPILER V9.51   INTERRUPTIONS                                                         07/13/2017 11:33:35 PAGE 136 

   XDATA SIZE       =    273      42
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8      84
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3       1
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
